// ========================================
// CREATE MALWARE RELATIONSHIPS
// Auto-generated from relationships_norm.csv
// ========================================

// Total Malware relationships: 267

// ========================================
// 1. CREATE CONSTRAINTS
// ========================================

CREATE CONSTRAINT IF NOT EXISTS FOR (a:Attackers) REQUIRE a.id IS UNIQUE;
CREATE CONSTRAINT IF NOT EXISTS FOR (m:Malware) REQUIRE m.id IS UNIQUE;
CREATE CONSTRAINT IF NOT EXISTS FOR (t:Tools) REQUIRE t.id IS UNIQUE;
CREATE CONSTRAINT IF NOT EXISTS FOR (v:Vulnerabilities) REQUIRE v.id IS UNIQUE;
CREATE CONSTRAINT IF NOT EXISTS FOR (f:Files) REQUIRE f.id IS UNIQUE;
CREATE CONSTRAINT IF NOT EXISTS FOR (h:Hashes) REQUIRE h.id IS UNIQUE;
CREATE CONSTRAINT IF NOT EXISTS FOR (i:Ips) REQUIRE i.id IS UNIQUE;
CREATE CONSTRAINT IF NOT EXISTS FOR (u:Urls) REQUIRE u.id IS UNIQUE;
CREATE CONSTRAINT IF NOT EXISTS FOR (d:Devices) REQUIRE d.id IS UNIQUE;
CREATE CONSTRAINT IF NOT EXISTS FOR (tech:Techniques) REQUIRE tech.id IS UNIQUE;

// ========================================
// 2. MALWARE RELATIONSHIPS
// ========================================

// Lcrypt0rx used by H2miner
MATCH (source:Malware {id: 'MAL57'}), (target:Tools {id: 'TOO120'})
MERGE (source)-[:USED_BY {
    source_name: 'Lcrypt0rx',
    target_name: 'H2miner',
    relationship_id: 'REL2',
    original_relation: 'used by',
    created_at: datetime()
}]->(target);

// Dark 101 target FortiSandbox 5.0
MATCH (source:Malware {id: 'MAL26'}), (target:Tools {id: 'TOO104'})
MERGE (source)-[:TARGET {
    source_name: 'Dark 101',
    target_name: 'FortiSandbox 5.0',
    relationship_id: 'REL3',
    original_relation: 'target',
    created_at: datetime()
}]->(target);

// NordDragonScan uses TBK DVRs
MATCH (source:Malware {id: 'MAL76'}), (target:Tools {id: 'TOO244'})
MERGE (source)-[:USES {
    source_name: 'NordDragonScan',
    target_name: 'TBK DVRs',
    relationship_id: 'REL5',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// NordDragonScan uses Four-Fa
MATCH (source:Malware {id: 'MAL76'}), (target:Tools {id: 'TOO105'})
MERGE (source)-[:USES {
    source_name: 'NordDragonScan',
    target_name: 'Four-Fa',
    relationship_id: 'REL6',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// NailaoLocker is a Ransomware
MATCH (source:Malware {id: 'MAL72'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS_A {
    source_name: 'NailaoLocker',
    target_name: 'Ransomware',
    relationship_id: 'REL7',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// NailaoLocker targets Microsoft Windows
MATCH (source:Malware {id: 'MAL72'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'NailaoLocker',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL8',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// NailaoLocker drop usysdiag.exe
MATCH (source:Malware {id: 'MAL72'}), (target:Files {id: 'FIL143'})
MERGE (source)-[:DROP {
    source_name: 'NailaoLocker',
    target_name: 'usysdiag.exe',
    relationship_id: 'REL9',
    original_relation: 'drop',
    created_at: datetime()
}]->(target);

// NailaoLocker drop sensapi
MATCH (source:Malware {id: 'MAL72'}), (target:Files {id: 'FIL128'})
MERGE (source)-[:DROP {
    source_name: 'NailaoLocker',
    target_name: 'sensapi',
    relationship_id: 'REL10',
    original_relation: 'drop',
    created_at: datetime()
}]->(target);

// Lcryx is a Ransomware
MATCH (source:Malware {id: 'MAL58'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS_A {
    source_name: 'Lcryx',
    target_name: 'Ransomware',
    relationship_id: 'REL14',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// Lcrypt0rx is a Lcryx
MATCH (source:Malware {id: 'MAL57'}), (target:Malware {id: 'MAL58'})
MERGE (source)-[:IS_A {
    source_name: 'Lcrypt0rx',
    target_name: 'Lcryx',
    relationship_id: 'REL15',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// Lcryx uses Lumma Stealer
MATCH (source:Malware {id: 'MAL58'}), (target:Tools {id: 'TOO159'})
MERGE (source)-[:USES {
    source_name: 'Lcryx',
    target_name: 'Lumma Stealer',
    relationship_id: 'REL16',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Lcryx uses DCRAT
MATCH (source:Malware {id: 'MAL58'}), (target:Tools {id: 'TOO75'})
MERGE (source)-[:USES {
    source_name: 'Lcryx',
    target_name: 'DCRAT',
    relationship_id: 'REL17',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Lcryx uses Cobalt Strike
MATCH (source:Malware {id: 'MAL58'}), (target:Tools {id: 'TOO54'})
MERGE (source)-[:USES {
    source_name: 'Lcryx',
    target_name: 'Cobalt Strike',
    relationship_id: 'REL18',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Dark 101 is Ransomware
MATCH (source:Malware {id: 'MAL26'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS {
    source_name: 'Dark 101',
    target_name: 'Ransomware',
    relationship_id: 'REL23',
    original_relation: 'is',
    created_at: datetime()
}]->(target);

// Dark 101 use Bitcoin
MATCH (source:Malware {id: 'MAL26'}), (target:Tools {id: 'TOO29'})
MERGE (source)-[:USE {
    source_name: 'Dark 101',
    target_name: 'Bitcoin',
    relationship_id: 'REL24',
    original_relation: 'use',
    created_at: datetime()
}]->(target);

// NordDragonScan drop NordDragonScan
MATCH (source:Malware {id: 'MAL76'}), (target:Malware {id: 'MAL76'})
MERGE (source)-[:DROP {
    source_name: 'NordDragonScan',
    target_name: 'NordDragonScan',
    relationship_id: 'REL26',
    original_relation: 'drop',
    created_at: datetime()
}]->(target);

// HoldingHands RAT aka Gh0stBins
MATCH (source:Malware {id: 'MAL48'}), (target:Malware {id: 'MAL38'})
MERGE (source)-[:AKA {
    source_name: 'HoldingHands RAT',
    target_name: 'Gh0stBins',
    relationship_id: 'REL40',
    original_relation: 'aka',
    created_at: datetime()
}]->(target);

// RolandSkimmer targets Bulgaria
MATCH (source:Malware {id: 'MAL96'}), (target:Tools {id: 'TOO36'})
MERGE (source)-[:TARGETS {
    source_name: 'RolandSkimmer',
    target_name: 'Bulgaria',
    relationship_id: 'REL41',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// RolandSkimmer uses LNK file
MATCH (source:Malware {id: 'MAL96'}), (target:Files {id: 'FIL100'})
MERGE (source)-[:USES {
    source_name: 'RolandSkimmer',
    target_name: 'LNK file',
    relationship_id: 'REL42',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// RolandSkimmer uses faktura_1065170.lnk
MATCH (source:Malware {id: 'MAL96'}), (target:Files {id: 'FIL78'})
MERGE (source)-[:USES {
    source_name: 'RolandSkimmer',
    target_name: 'faktura_1065170.lnk',
    relationship_id: 'REL43',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// RolandSkimmer target Microsoft Windows
MATCH (source:Malware {id: 'MAL96'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGET {
    source_name: 'RolandSkimmer',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL45',
    original_relation: 'target',
    created_at: datetime()
}]->(target);

// RolandSkimmer associated with 2025 Global Threat Landscape Report
MATCH (source:Malware {id: 'MAL96'}), (target:Attackers {id: 'ATT1'})
MERGE (source)-[:ASSOCIATED_WITH {
    source_name: 'RolandSkimmer',
    target_name: '2025 Global Threat Landscape Report',
    relationship_id: 'REL46',
    original_relation: 'associated with',
    created_at: datetime()
}]->(target);

// FormBook collects login credentials
MATCH (source:Malware {id: 'MAL37'}), (target:Tools {id: 'TOO157'})
MERGE (source)-[:COLLECTS {
    source_name: 'FormBook',
    target_name: 'login credentials',
    relationship_id: 'REL52',
    original_relation: 'collects',
    created_at: datetime()
}]->(target);

// FormBook collects keystrokes
MATCH (source:Malware {id: 'MAL37'}), (target:Tools {id: 'TOO144'})
MERGE (source)-[:COLLECTS {
    source_name: 'FormBook',
    target_name: 'keystrokes',
    relationship_id: 'REL53',
    original_relation: 'collects',
    created_at: datetime()
}]->(target);

// FormBook collects clipboard information
MATCH (source:Malware {id: 'MAL37'}), (target:Tools {id: 'TOO53'})
MERGE (source)-[:COLLECTS {
    source_name: 'FormBook',
    target_name: 'clipboard information',
    relationship_id: 'REL54',
    original_relation: 'collects',
    created_at: datetime()
}]->(target);

// FormBook exploits CVE-2017-11882
MATCH (source:Malware {id: 'MAL37'}), (target:Vulnerabilities {id: 'VUL7'})
MERGE (source)-[:EXPLOITS {
    source_name: 'FormBook',
    target_name: 'CVE-2017-11882',
    relationship_id: 'REL65',
    original_relation: 'exploits',
    created_at: datetime()
}]->(target);

// FormBook uses ImagingDevices.exe
MATCH (source:Malware {id: 'MAL37'}), (target:Files {id: 'FIL92'})
MERGE (source)-[:USES {
    source_name: 'FormBook',
    target_name: 'ImagingDevices.exe',
    relationship_id: 'REL66',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// FormBook communicatesWith C2 server
MATCH (source:Malware {id: 'MAL37'}), (target:Tools {id: 'TOO38'})
MERGE (source)-[:COMMUNICATESWITH {
    source_name: 'FormBook',
    target_name: 'C2 server',
    relationship_id: 'REL67',
    original_relation: 'communicatesWith',
    created_at: datetime()
}]->(target);

// VanHelsing is Ransomware
MATCH (source:Malware {id: 'MAL118'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS {
    source_name: 'VanHelsing',
    target_name: 'Ransomware',
    relationship_id: 'REL68',
    original_relation: 'is',
    created_at: datetime()
}]->(target);

// VanHelsing targets Microsoft Windows
MATCH (source:Malware {id: 'MAL118'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'VanHelsing',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL69',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// VanHelsing hash SHA2: 99959C5141F62D4FBB60EFDC05260B6E956651963D29C36845F435815062FD98
MATCH (source:Malware {id: 'MAL118'}), (target:Hashes {id: 'HAS4'})
MERGE (source)-[:HASH {
    source_name: 'VanHelsing',
    target_name: 'SHA2: 99959C5141F62D4FBB60EFDC05260B6E956651963D29C36845F435815062FD98',
    relationship_id: 'REL70',
    original_relation: 'hash',
    created_at: datetime()
}]->(target);

// Horabot uses phishing
MATCH (source:Malware {id: 'MAL49'}), (target:Tools {id: 'TOO192'})
MERGE (source)-[:USES {
    source_name: 'Horabot',
    target_name: 'phishing',
    relationship_id: 'REL71',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Horabot uses VBScript
MATCH (source:Malware {id: 'MAL49'}), (target:Tools {id: 'TOO267'})
MERGE (source)-[:USES {
    source_name: 'Horabot',
    target_name: 'VBScript',
    relationship_id: 'REL72',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Horabot uses AutoIt
MATCH (source:Malware {id: 'MAL49'}), (target:Tools {id: 'TOO22'})
MERGE (source)-[:USES {
    source_name: 'Horabot',
    target_name: 'AutoIt',
    relationship_id: 'REL73',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Horabot uses PowerShell
MATCH (source:Malware {id: 'MAL49'}), (target:Tools {id: 'TOO201'})
MERGE (source)-[:USES {
    source_name: 'Horabot',
    target_name: 'PowerShell',
    relationship_id: 'REL74',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Horabot steals email credentials
MATCH (source:Malware {id: 'MAL49'}), (target:Files {id: 'FIL69'})
MERGE (source)-[:STEALS {
    source_name: 'Horabot',
    target_name: 'email credentials',
    relationship_id: 'REL75',
    original_relation: 'steals',
    created_at: datetime()
}]->(target);

// Horabot harvests contact lists
MATCH (source:Malware {id: 'MAL49'}), (target:Files {id: 'FIL56'})
MERGE (source)-[:HARVESTS {
    source_name: 'Horabot',
    target_name: 'contact lists',
    relationship_id: 'REL76',
    original_relation: 'harvests',
    created_at: datetime()
}]->(target);

// Horabot installs banking trojans
MATCH (source:Malware {id: 'MAL49'}), (target:Malware {id: 'MAL16'})
MERGE (source)-[:INSTALLS {
    source_name: 'Horabot',
    target_name: 'banking trojans',
    relationship_id: 'REL77',
    original_relation: 'installs',
    created_at: datetime()
}]->(target);

// Horabot targets Latin America
MATCH (source:Malware {id: 'MAL49'}), (target:Tools {id: 'TOO151'})
MERGE (source)-[:TARGETS {
    source_name: 'Horabot',
    target_name: 'Latin America',
    relationship_id: 'REL78',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Horabot targets Mexico
MATCH (source:Malware {id: 'MAL49'}), (target:Tools {id: 'TOO165'})
MERGE (source)-[:TARGETS {
    source_name: 'Horabot',
    target_name: 'Mexico',
    relationship_id: 'REL79',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Horabot targets Guatemala
MATCH (source:Malware {id: 'MAL49'}), (target:Tools {id: 'TOO119'})
MERGE (source)-[:TARGETS {
    source_name: 'Horabot',
    target_name: 'Guatemala',
    relationship_id: 'REL80',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Horabot targets Colombia
MATCH (source:Malware {id: 'MAL49'}), (target:Tools {id: 'TOO55'})
MERGE (source)-[:TARGETS {
    source_name: 'Horabot',
    target_name: 'Colombia',
    relationship_id: 'REL81',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Horabot targets Peru
MATCH (source:Malware {id: 'MAL49'}), (target:Tools {id: 'TOO191'})
MERGE (source)-[:TARGETS {
    source_name: 'Horabot',
    target_name: 'Peru',
    relationship_id: 'REL82',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Horabot targets Chile
MATCH (source:Malware {id: 'MAL49'}), (target:Tools {id: 'TOO47'})
MERGE (source)-[:TARGETS {
    source_name: 'Horabot',
    target_name: 'Chile',
    relationship_id: 'REL83',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Horabot targets Argentina
MATCH (source:Malware {id: 'MAL49'}), (target:Tools {id: 'TOO20'})
MERGE (source)-[:TARGETS {
    source_name: 'Horabot',
    target_name: 'Argentina',
    relationship_id: 'REL84',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Horabot uses Factura Adjunta
MATCH (source:Malware {id: 'MAL49'}), (target:Files {id: 'FIL76'})
MERGE (source)-[:USES {
    source_name: 'Horabot',
    target_name: 'Factura Adjunta',
    relationship_id: 'REL85',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Remote Access Trojan is RAT
MATCH (source:Malware {id: 'MAL93'}), (target:Tools {id: 'TOO212'})
MERGE (source)-[:IS {
    source_name: 'Remote Access Trojan',
    target_name: 'RAT',
    relationship_id: 'REL86',
    original_relation: 'is',
    created_at: datetime()
}]->(target);

// RATty uses file-sharing platforms
MATCH (source:Malware {id: 'MAL87'}), (target:Files {id: 'FIL83'})
MERGE (source)-[:USES {
    source_name: 'RATty',
    target_name: 'file-sharing platforms',
    relationship_id: 'REL91',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// RATty uses Ngrok
MATCH (source:Malware {id: 'MAL87'}), (target:Tools {id: 'TOO182'})
MERGE (source)-[:USES {
    source_name: 'RATty',
    target_name: 'Ngrok',
    relationship_id: 'REL92',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// FormBook steal keystrokes
MATCH (source:Malware {id: 'MAL37'}), (target:Tools {id: 'TOO144'})
MERGE (source)-[:STEAL {
    source_name: 'FormBook',
    target_name: 'keystrokes',
    relationship_id: 'REL110',
    original_relation: 'steal',
    created_at: datetime()
}]->(target);

// Havoc Demon Agent uses SharePoint
MATCH (source:Malware {id: 'MAL46'}), (target:Tools {id: 'TOO225'})
MERGE (source)-[:USES {
    source_name: 'Havoc Demon Agent',
    target_name: 'SharePoint',
    relationship_id: 'REL116',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Havoc Demon Agent uses Microsoft Graph API
MATCH (source:Malware {id: 'MAL46'}), (target:Tools {id: 'TOO166'})
MERGE (source)-[:USES {
    source_name: 'Havoc Demon Agent',
    target_name: 'Microsoft Graph API',
    relationship_id: 'REL117',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// AutoIt/Injector.GTY!tr aka 404 Keylogger
MATCH (source:Malware {id: 'MAL13'}), (target:Tools {id: 'TOO7'})
MERGE (source)-[:AKA {
    source_name: 'AutoIt/Injector.GTY!tr',
    target_name: '404 Keylogger',
    relationship_id: 'REL124',
    original_relation: 'aka',
    created_at: datetime()
}]->(target);

// AutoIt/Injector.GTY!tr targets Windows Users
MATCH (source:Malware {id: 'MAL13'}), (target:Tools {id: 'TOO277'})
MERGE (source)-[:TARGETS {
    source_name: 'AutoIt/Injector.GTY!tr',
    target_name: 'Windows Users',
    relationship_id: 'REL125',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// AutoIt/Injector.GTY!tr uses SMTP
MATCH (source:Malware {id: 'MAL13'}), (target:Tools {id: 'TOO231'})
MERGE (source)-[:USES {
    source_name: 'AutoIt/Injector.GTY!tr',
    target_name: 'SMTP',
    relationship_id: 'REL126',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// AutoIt/Injector.GTY!tr uses Telegram
MATCH (source:Malware {id: 'MAL13'}), (target:Tools {id: 'TOO245'})
MERGE (source)-[:USES {
    source_name: 'AutoIt/Injector.GTY!tr',
    target_name: 'Telegram',
    relationship_id: 'REL127',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// AutoIt/Injector.GTY!tr uses Chrome
MATCH (source:Malware {id: 'MAL13'}), (target:Tools {id: 'TOO50'})
MERGE (source)-[:USES {
    source_name: 'AutoIt/Injector.GTY!tr',
    target_name: 'Chrome',
    relationship_id: 'REL128',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// AutoIt/Injector.GTY!tr uses Edge
MATCH (source:Malware {id: 'MAL13'}), (target:Tools {id: 'TOO85'})
MERGE (source)-[:USES {
    source_name: 'AutoIt/Injector.GTY!tr',
    target_name: 'Edge',
    relationship_id: 'REL129',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// AutoIt/Injector.GTY!tr uses Firefox
MATCH (source:Malware {id: 'MAL13'}), (target:Tools {id: 'TOO94'})
MERGE (source)-[:USES {
    source_name: 'AutoIt/Injector.GTY!tr',
    target_name: 'Firefox',
    relationship_id: 'REL130',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// AutoIt/Injector.GTY!tr communicatesWith C2 server
MATCH (source:Malware {id: 'MAL13'}), (target:Tools {id: 'TOO38'})
MERGE (source)-[:COMMUNICATESWITH {
    source_name: 'AutoIt/Injector.GTY!tr',
    target_name: 'C2 server',
    relationship_id: 'REL131',
    original_relation: 'communicatesWith',
    created_at: datetime()
}]->(target);

// Lynx is a Ransomware
MATCH (source:Malware {id: 'MAL63'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS_A {
    source_name: 'Lynx',
    target_name: 'Ransomware',
    relationship_id: 'REL132',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// INC is a Ransomware
MATCH (source:Malware {id: 'MAL51'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS_A {
    source_name: 'INC',
    target_name: 'Ransomware',
    relationship_id: 'REL133',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// Lynx is a predecessor of INC
MATCH (source:Malware {id: 'MAL63'}), (target:Malware {id: 'MAL51'})
MERGE (source)-[:IS_A_PREDECESSOR_OF {
    source_name: 'Lynx',
    target_name: 'INC',
    relationship_id: 'REL134',
    original_relation: 'is a predecessor of',
    created_at: datetime()
}]->(target);

// Lynx targets Microsoft Windows
MATCH (source:Malware {id: 'MAL63'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'Lynx',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL135',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// INC targets Microsoft Windows
MATCH (source:Malware {id: 'MAL51'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'INC',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL136',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// INC targets ESXi
MATCH (source:Malware {id: 'MAL51'}), (target:Tools {id: 'TOO88'})
MERGE (source)-[:TARGETS {
    source_name: 'INC',
    target_name: 'ESXi',
    relationship_id: 'REL137',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Lynx is a predecessor of INC
MATCH (source:Malware {id: 'MAL63'}), (target:Malware {id: 'MAL51'})
MERGE (source)-[:IS_A_PREDECESSOR_OF {
    source_name: 'Lynx',
    target_name: 'INC',
    relationship_id: 'REL138',
    original_relation: 'is a predecessor of',
    created_at: datetime()
}]->(target);

// INC is a predecessor of Lynx
MATCH (source:Malware {id: 'MAL51'}), (target:Malware {id: 'MAL63'})
MERGE (source)-[:IS_A_PREDECESSOR_OF {
    source_name: 'INC',
    target_name: 'Lynx',
    relationship_id: 'REL139',
    original_relation: 'is a predecessor of',
    created_at: datetime()
}]->(target);

// Lynx is a Ransomware
MATCH (source:Malware {id: 'MAL63'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS_A {
    source_name: 'Lynx',
    target_name: 'Ransomware',
    relationship_id: 'REL140',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// INC is a Ransomware
MATCH (source:Malware {id: 'MAL51'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS_A {
    source_name: 'INC',
    target_name: 'Ransomware',
    relationship_id: 'REL141',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// INC is a predecessor of Lynx
MATCH (source:Malware {id: 'MAL51'}), (target:Malware {id: 'MAL63'})
MERGE (source)-[:IS_A_PREDECESSOR_OF {
    source_name: 'INC',
    target_name: 'Lynx',
    relationship_id: 'REL142',
    original_relation: 'is a predecessor of',
    created_at: datetime()
}]->(target);

// Lynx targets Microsoft Windows
MATCH (source:Malware {id: 'MAL63'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'Lynx',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL143',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// INC targets Microsoft Windows
MATCH (source:Malware {id: 'MAL51'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'INC',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL144',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// INC targets ESXi
MATCH (source:Malware {id: 'MAL51'}), (target:Tools {id: 'TOO88'})
MERGE (source)-[:TARGETS {
    source_name: 'INC',
    target_name: 'ESXi',
    relationship_id: 'REL145',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// ELF/Sshdinjector.A!tris attributed to DaggerFly
MATCH (source:Malware {id: 'MAL31'}), (target:Tools {id: 'TOO71'})
MERGE (source)-[:ATTRIBUTED_TO {
    source_name: 'ELF/Sshdinjector.A!tris',
    target_name: 'DaggerFly',
    relationship_id: 'REL146',
    original_relation: 'attributed to',
    created_at: datetime()
}]->(target);

// ELF/Sshdinjector.A!tris targets Linux
MATCH (source:Malware {id: 'MAL31'}), (target:Tools {id: 'TOO154'})
MERGE (source)-[:TARGETS {
    source_name: 'ELF/Sshdinjector.A!tris',
    target_name: 'Linux',
    relationship_id: 'REL147',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// ELF/Sshdinjector.A!tris contains libsshd.so
MATCH (source:Malware {id: 'MAL31'}), (target:Files {id: 'FIL99'})
MERGE (source)-[:CONTAINS {
    source_name: 'ELF/Sshdinjector.A!tris',
    target_name: 'libsshd.so',
    relationship_id: 'REL148',
    original_relation: 'contains',
    created_at: datetime()
}]->(target);

// ELF/Sshdinjector.A!tris uses ls
MATCH (source:Malware {id: 'MAL31'}), (target:Tools {id: 'TOO158'})
MERGE (source)-[:USES {
    source_name: 'ELF/Sshdinjector.A!tris',
    target_name: 'ls',
    relationship_id: 'REL152',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// ELF/Sshdinjector.A!tris uses netstat
MATCH (source:Malware {id: 'MAL31'}), (target:Tools {id: 'TOO181'})
MERGE (source)-[:USES {
    source_name: 'ELF/Sshdinjector.A!tris',
    target_name: 'netstat',
    relationship_id: 'REL153',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// ELF/Sshdinjector.A!tris uses crond
MATCH (source:Malware {id: 'MAL31'}), (target:Tools {id: 'TOO62'})
MERGE (source)-[:USES {
    source_name: 'ELF/Sshdinjector.A!tris',
    target_name: 'crond',
    relationship_id: 'REL154',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// ELF/Sshdinjector.A!tris contains WATERDROP
MATCH (source:Malware {id: 'MAL31'}), (target:Tools {id: 'TOO272'})
MERGE (source)-[:CONTAINS {
    source_name: 'ELF/Sshdinjector.A!tris',
    target_name: 'WATERDROP',
    relationship_id: 'REL155',
    original_relation: 'contains',
    created_at: datetime()
}]->(target);

// Coyote Banking Trojan uses PowerShell
MATCH (source:Malware {id: 'MAL23'}), (target:Tools {id: 'TOO201'})
MERGE (source)-[:USES {
    source_name: 'Coyote Banking Trojan',
    target_name: 'PowerShell',
    relationship_id: 'REL156',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Coyote Banking Trojan targets Brazil
MATCH (source:Malware {id: 'MAL23'}), (target:Tools {id: 'TOO33'})
MERGE (source)-[:TARGETS {
    source_name: 'Coyote Banking Trojan',
    target_name: 'Brazil',
    relationship_id: 'REL158',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// rootkit is sysinitd.ko
MATCH (source:Malware {id: 'MAL98'}), (target:Files {id: 'FIL132'})
MERGE (source)-[:IS {
    source_name: 'rootkit',
    target_name: 'sysinitd.ko',
    relationship_id: 'REL163',
    original_relation: 'is',
    created_at: datetime()
}]->(target);

// rootkit is sysinitd
MATCH (source:Malware {id: 'MAL98'}), (target:Files {id: 'FIL131'})
MERGE (source)-[:IS {
    source_name: 'rootkit',
    target_name: 'sysinitd',
    relationship_id: 'REL164',
    original_relation: 'is',
    created_at: datetime()
}]->(target);

// Zebo-0.1.0 uses pynput
MATCH (source:Malware {id: 'MAL128'}), (target:Tools {id: 'TOO205'})
MERGE (source)-[:USES {
    source_name: 'Zebo-0.1.0',
    target_name: 'pynput',
    relationship_id: 'REL171',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Zebo-0.1.0 uses ImageGrab
MATCH (source:Malware {id: 'MAL128'}), (target:Tools {id: 'TOO130'})
MERGE (source)-[:USES {
    source_name: 'Zebo-0.1.0',
    target_name: 'ImageGrab',
    relationship_id: 'REL172',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Zebo-0.1.0 uses Screen Capturing
MATCH (source:Malware {id: 'MAL128'}), (target:Attackers {id: 'ATT22'})
MERGE (source)-[:USES {
    source_name: 'Zebo-0.1.0',
    target_name: 'Screen Capturing',
    relationship_id: 'REL173',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Zebo-0.1.0 uses Data Exfiltration
MATCH (source:Malware {id: 'MAL128'}), (target:Tools {id: 'TOO73'})
MERGE (source)-[:USES {
    source_name: 'Zebo-0.1.0',
    target_name: 'Data Exfiltration',
    relationship_id: 'REL174',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// SmokeLoader targets Microsoft Windows
MATCH (source:Malware {id: 'MAL104'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'SmokeLoader',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL184',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// SmokeLoader targets Taiwan
MATCH (source:Malware {id: 'MAL104'}), (target:Tools {id: 'TOO241'})
MERGE (source)-[:TARGETS {
    source_name: 'SmokeLoader',
    target_name: 'Taiwan',
    relationship_id: 'REL185',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// SmokeLoader uses phishing
MATCH (source:Malware {id: 'MAL104'}), (target:Tools {id: 'TOO192'})
MERGE (source)-[:USES {
    source_name: 'SmokeLoader',
    target_name: 'phishing',
    relationship_id: 'REL186',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// SmokeLoader communicatesWith C2 server
MATCH (source:Malware {id: 'MAL104'}), (target:Tools {id: 'TOO38'})
MERGE (source)-[:COMMUNICATESWITH {
    source_name: 'SmokeLoader',
    target_name: 'C2 server',
    relationship_id: 'REL187',
    original_relation: 'communicatesWith',
    created_at: datetime()
}]->(target);

// SmokeLoader drop VBS file
MATCH (source:Malware {id: 'MAL104'}), (target:Files {id: 'FIL144'})
MERGE (source)-[:DROP {
    source_name: 'SmokeLoader',
    target_name: 'VBS file',
    relationship_id: 'REL188',
    original_relation: 'drop',
    created_at: datetime()
}]->(target);

// SmokeLoader uses AndeLoader
MATCH (source:Malware {id: 'MAL104'}), (target:Malware {id: 'MAL10'})
MERGE (source)-[:USES {
    source_name: 'SmokeLoader',
    target_name: 'AndeLoader',
    relationship_id: 'REL189',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Interlock is Ransomware
MATCH (source:Malware {id: 'MAL53'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS {
    source_name: 'Interlock',
    target_name: 'Ransomware',
    relationship_id: 'REL190',
    original_relation: 'is',
    created_at: datetime()
}]->(target);

// Interlock targets Microsoft Windows
MATCH (source:Malware {id: 'MAL53'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'Interlock',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL191',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Interlock targets FreeBSD
MATCH (source:Malware {id: 'MAL53'}), (target:Tools {id: 'TOO107'})
MERGE (source)-[:TARGETS {
    source_name: 'Interlock',
    target_name: 'FreeBSD',
    relationship_id: 'REL192',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Remcos RAT target Windows Users
MATCH (source:Malware {id: 'MAL91'}), (target:Tools {id: 'TOO277'})
MERGE (source)-[:TARGET {
    source_name: 'Remcos RAT',
    target_name: 'Windows Users',
    relationship_id: 'REL200',
    original_relation: 'target',
    created_at: datetime()
}]->(target);

// Remcos RAT use Excel
MATCH (source:Malware {id: 'MAL91'}), (target:Tools {id: 'TOO89'})
MERGE (source)-[:USE {
    source_name: 'Remcos RAT',
    target_name: 'Excel',
    relationship_id: 'REL201',
    original_relation: 'use',
    created_at: datetime()
}]->(target);

// Remcos RAT use MS Excel
MATCH (source:Malware {id: 'MAL91'}), (target:Tools {id: 'TOO175'})
MERGE (source)-[:USE {
    source_name: 'Remcos RAT',
    target_name: 'MS Excel',
    relationship_id: 'REL202',
    original_relation: 'use',
    created_at: datetime()
}]->(target);

// GOREVERSE exploit CVE-2024-36401
MATCH (source:Malware {id: 'MAL40'}), (target:Vulnerabilities {id: 'VUL20'})
MERGE (source)-[:EXPLOIT {
    source_name: 'GOREVERSE',
    target_name: 'CVE-2024-36401',
    relationship_id: 'REL216',
    original_relation: 'exploit',
    created_at: datetime()
}]->(target);

// Emansrepo uses phishing
MATCH (source:Malware {id: 'MAL32'}), (target:Tools {id: 'TOO192'})
MERGE (source)-[:USES {
    source_name: 'Emansrepo',
    target_name: 'phishing',
    relationship_id: 'REL217',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Emansrepo download Purchase-Order.7z
MATCH (source:Malware {id: 'MAL32'}), (target:Files {id: 'FIL122'})
MERGE (source)-[:DOWNLOAD {
    source_name: 'Emansrepo',
    target_name: 'Purchase-Order.7z',
    relationship_id: 'REL218',
    original_relation: 'download',
    created_at: datetime()
}]->(target);

// Emansrepo uses PyInstaller
MATCH (source:Malware {id: 'MAL32'}), (target:Tools {id: 'TOO204'})
MERGE (source)-[:USES {
    source_name: 'Emansrepo',
    target_name: 'PyInstaller',
    relationship_id: 'REL220',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Emansrepo uses Python
MATCH (source:Malware {id: 'MAL32'}), (target:Tools {id: 'TOO207'})
MERGE (source)-[:USES {
    source_name: 'Emansrepo',
    target_name: 'Python',
    relationship_id: 'REL221',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Underground is a Ransomware
MATCH (source:Malware {id: 'MAL114'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS_A {
    source_name: 'Underground',
    target_name: 'Ransomware',
    relationship_id: 'REL222',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// Underground targets Microsoft Windows
MATCH (source:Malware {id: 'MAL114'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'Underground',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL223',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Underground exploits CVE-2023-36884
MATCH (source:Malware {id: 'MAL114'}), (target:Vulnerabilities {id: 'VUL16'})
MERGE (source)-[:EXPLOITS {
    source_name: 'Underground',
    target_name: 'CVE-2023-36884',
    relationship_id: 'REL224',
    original_relation: 'exploits',
    created_at: datetime()
}]->(target);

// Underground uses Microsoft Office
MATCH (source:Malware {id: 'MAL114'}), (target:Tools {id: 'TOO167'})
MERGE (source)-[:USES {
    source_name: 'Underground',
    target_name: 'Microsoft Office',
    relationship_id: 'REL225',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Snake Keylogger aka 404 Keylogger
MATCH (source:Malware {id: 'MAL105'}), (target:Tools {id: 'TOO7'})
MERGE (source)-[:AKA {
    source_name: 'Snake Keylogger',
    target_name: '404 Keylogger',
    relationship_id: 'REL229',
    original_relation: 'aka',
    created_at: datetime()
}]->(target);

// Snake Keylogger aka KrakenKeylogger
MATCH (source:Malware {id: 'MAL105'}), (target:Tools {id: 'TOO148'})
MERGE (source)-[:AKA {
    source_name: 'Snake Keylogger',
    target_name: 'KrakenKeylogger',
    relationship_id: 'REL230',
    original_relation: 'aka',
    created_at: datetime()
}]->(target);

// ValleyRAT targets Chinese speakers
MATCH (source:Malware {id: 'MAL117'}), (target:Tools {id: 'TOO49'})
MERGE (source)-[:TARGETS {
    source_name: 'ValleyRAT',
    target_name: 'Chinese speakers',
    relationship_id: 'REL235',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// ValleyRAT targets e-commerce
MATCH (source:Malware {id: 'MAL117'}), (target:Tools {id: 'TOO84'})
MERGE (source)-[:TARGETS {
    source_name: 'ValleyRAT',
    target_name: 'e-commerce',
    relationship_id: 'REL236',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// ValleyRAT targets finance
MATCH (source:Malware {id: 'MAL117'}), (target:Tools {id: 'TOO93'})
MERGE (source)-[:TARGETS {
    source_name: 'ValleyRAT',
    target_name: 'finance',
    relationship_id: 'REL237',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// ValleyRAT targets sales
MATCH (source:Malware {id: 'MAL117'}), (target:Tools {id: 'TOO220'})
MERGE (source)-[:TARGETS {
    source_name: 'ValleyRAT',
    target_name: 'sales',
    relationship_id: 'REL238',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// ValleyRAT targets management enterprises
MATCH (source:Malware {id: 'MAL117'}), (target:Tools {id: 'TOO161'})
MERGE (source)-[:TARGETS {
    source_name: 'ValleyRAT',
    target_name: 'management enterprises',
    relationship_id: 'REL239',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// ValleyRAT uses Microsoft Office
MATCH (source:Malware {id: 'MAL117'}), (target:Tools {id: 'TOO167'})
MERGE (source)-[:USES {
    source_name: 'ValleyRAT',
    target_name: 'Microsoft Office',
    relationship_id: 'REL240',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// ValleyRAT drop dome.doc
MATCH (source:Malware {id: 'MAL117'}), (target:Files {id: 'FIL65'})
MERGE (source)-[:DROP {
    source_name: 'ValleyRAT',
    target_name: 'dome.doc',
    relationship_id: 'REL241',
    original_relation: 'drop',
    created_at: datetime()
}]->(target);

// ValleyRAT execute dome.doc
MATCH (source:Malware {id: 'MAL117'}), (target:Files {id: 'FIL65'})
MERGE (source)-[:EXECUTE {
    source_name: 'ValleyRAT',
    target_name: 'dome.doc',
    relationship_id: 'REL242',
    original_relation: 'execute',
    created_at: datetime()
}]->(target);

// ValleyRAT create TEST
MATCH (source:Malware {id: 'MAL117'}), (target:Tools {id: 'TOO246'})
MERGE (source)-[:CREATE {
    source_name: 'ValleyRAT',
    target_name: 'TEST',
    relationship_id: 'REL243',
    original_relation: 'create',
    created_at: datetime()
}]->(target);

// ValleyRAT delete registry entries
MATCH (source:Malware {id: 'MAL117'}), (target:Vulnerabilities {id: 'VUL27'})
MERGE (source)-[:DELETE {
    source_name: 'ValleyRAT',
    target_name: 'registry entries',
    relationship_id: 'REL244',
    original_relation: 'delete',
    created_at: datetime()
}]->(target);

// XWorm uses Kramer
MATCH (source:Malware {id: 'MAL127'}), (target:Tools {id: 'TOO149'})
MERGE (source)-[:USES {
    source_name: 'XWorm',
    target_name: 'Kramer',
    relationship_id: 'REL251',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// XWorm uses donut
MATCH (source:Malware {id: 'MAL127'}), (target:Tools {id: 'TOO82'})
MERGE (source)-[:USES {
    source_name: 'XWorm',
    target_name: 'donut',
    relationship_id: 'REL252',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// XWorm uses laZzzy
MATCH (source:Malware {id: 'MAL127'}), (target:Tools {id: 'TOO152'})
MERGE (source)-[:USES {
    source_name: 'XWorm',
    target_name: 'laZzzy',
    relationship_id: 'REL253',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// AsyncRAT uses Kramer
MATCH (source:Malware {id: 'MAL12'}), (target:Tools {id: 'TOO149'})
MERGE (source)-[:USES {
    source_name: 'AsyncRAT',
    target_name: 'Kramer',
    relationship_id: 'REL254',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// AsyncRAT uses donut
MATCH (source:Malware {id: 'MAL12'}), (target:Tools {id: 'TOO82'})
MERGE (source)-[:USES {
    source_name: 'AsyncRAT',
    target_name: 'donut',
    relationship_id: 'REL255',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// AsyncRAT uses laZzzy
MATCH (source:Malware {id: 'MAL12'}), (target:Tools {id: 'TOO152'})
MERGE (source)-[:USES {
    source_name: 'AsyncRAT',
    target_name: 'laZzzy',
    relationship_id: 'REL256',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// PureHVNC uses Kramer
MATCH (source:Malware {id: 'MAL80'}), (target:Tools {id: 'TOO149'})
MERGE (source)-[:USES {
    source_name: 'PureHVNC',
    target_name: 'Kramer',
    relationship_id: 'REL257',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// PureHVNC uses donut
MATCH (source:Malware {id: 'MAL80'}), (target:Tools {id: 'TOO82'})
MERGE (source)-[:USES {
    source_name: 'PureHVNC',
    target_name: 'donut',
    relationship_id: 'REL258',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// PureHVNC uses laZzzy
MATCH (source:Malware {id: 'MAL80'}), (target:Tools {id: 'TOO152'})
MERGE (source)-[:USES {
    source_name: 'PureHVNC',
    target_name: 'laZzzy',
    relationship_id: 'REL259',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// MerkSpy exploit CVE-2021-40444
MATCH (source:Malware {id: 'MAL67'}), (target:Vulnerabilities {id: 'VUL12'})
MERGE (source)-[:EXPLOIT {
    source_name: 'MerkSpy',
    target_name: 'CVE-2021-40444',
    relationship_id: 'REL271',
    original_relation: 'exploit',
    created_at: datetime()
}]->(target);

// MerkSpy use Spyware
MATCH (source:Malware {id: 'MAL67'}), (target:Tools {id: 'TOO235'})
MERGE (source)-[:USE {
    source_name: 'MerkSpy',
    target_name: 'Spyware',
    relationship_id: 'REL272',
    original_relation: 'use',
    created_at: datetime()
}]->(target);

// MerkSpy exploit CVE-2021-40444
MATCH (source:Malware {id: 'MAL67'}), (target:Vulnerabilities {id: 'VUL12'})
MERGE (source)-[:EXPLOIT {
    source_name: 'MerkSpy',
    target_name: 'CVE-2021-40444',
    relationship_id: 'REL275',
    original_relation: 'exploit',
    created_at: datetime()
}]->(target);

// MerkSpy target Microsoft Windows
MATCH (source:Malware {id: 'MAL67'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGET {
    source_name: 'MerkSpy',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL276',
    original_relation: 'target',
    created_at: datetime()
}]->(target);

// Fickle Stealer use Rust
MATCH (source:Malware {id: 'MAL36'}), (target:Tools {id: 'TOO219'})
MERGE (source)-[:USE {
    source_name: 'Fickle Stealer',
    target_name: 'Rust',
    relationship_id: 'REL285',
    original_relation: 'use',
    created_at: datetime()
}]->(target);

// Fickle Stealer use VBA dropper
MATCH (source:Malware {id: 'MAL36'}), (target:Tools {id: 'TOO264'})
MERGE (source)-[:USE {
    source_name: 'Fickle Stealer',
    target_name: 'VBA dropper',
    relationship_id: 'REL286',
    original_relation: 'use',
    created_at: datetime()
}]->(target);

// Fickle Stealer use VBA downloader
MATCH (source:Malware {id: 'MAL36'}), (target:Tools {id: 'TOO263'})
MERGE (source)-[:USE {
    source_name: 'Fickle Stealer',
    target_name: 'VBA downloader',
    relationship_id: 'REL287',
    original_relation: 'use',
    created_at: datetime()
}]->(target);

// Fickle Stealer use link downloader
MATCH (source:Malware {id: 'MAL36'}), (target:Tools {id: 'TOO153'})
MERGE (source)-[:USE {
    source_name: 'Fickle Stealer',
    target_name: 'link downloader',
    relationship_id: 'REL288',
    original_relation: 'use',
    created_at: datetime()
}]->(target);

// Fickle Stealer use executable downloader
MATCH (source:Malware {id: 'MAL36'}), (target:Tools {id: 'TOO90'})
MERGE (source)-[:USE {
    source_name: 'Fickle Stealer',
    target_name: 'executable downloader',
    relationship_id: 'REL289',
    original_relation: 'use',
    created_at: datetime()
}]->(target);

// Fickle Stealer use PowerShell
MATCH (source:Malware {id: 'MAL36'}), (target:Tools {id: 'TOO201'})
MERGE (source)-[:USE {
    source_name: 'Fickle Stealer',
    target_name: 'PowerShell',
    relationship_id: 'REL290',
    original_relation: 'use',
    created_at: datetime()
}]->(target);

// Fickle Stealer drop TEMP folder
MATCH (source:Malware {id: 'MAL36'}), (target:Files {id: 'FIL137'})
MERGE (source)-[:DROP {
    source_name: 'Fickle Stealer',
    target_name: 'TEMP folder',
    relationship_id: 'REL291',
    original_relation: 'drop',
    created_at: datetime()
}]->(target);

// Shinra is a Ransomware
MATCH (source:Malware {id: 'MAL103'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS_A {
    source_name: 'Shinra',
    target_name: 'Ransomware',
    relationship_id: 'REL294',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// Limpopo is a Ransomware
MATCH (source:Malware {id: 'MAL60'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS_A {
    source_name: 'Limpopo',
    target_name: 'Ransomware',
    relationship_id: 'REL295',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// Shinra targets Microsoft Windows
MATCH (source:Malware {id: 'MAL103'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'Shinra',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL296',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Shinra targets VMWare ESXi
MATCH (source:Malware {id: 'MAL103'}), (target:Tools {id: 'TOO271'})
MERGE (source)-[:TARGETS {
    source_name: 'Shinra',
    target_name: 'VMWare ESXi',
    relationship_id: 'REL297',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Shinra submitted by Poland
MATCH (source:Malware {id: 'MAL103'}), (target:Tools {id: 'TOO196'})
MERGE (source)-[:SUBMITTED_BY {
    source_name: 'Shinra',
    target_name: 'Poland',
    relationship_id: 'REL298',
    original_relation: 'submitted by',
    created_at: datetime()
}]->(target);

// Shinra submitted by Russia
MATCH (source:Malware {id: 'MAL103'}), (target:Tools {id: 'TOO218'})
MERGE (source)-[:SUBMITTED_BY {
    source_name: 'Shinra',
    target_name: 'Russia',
    relationship_id: 'REL299',
    original_relation: 'submitted by',
    created_at: datetime()
}]->(target);

// Shinra submitted by United Kingdom
MATCH (source:Malware {id: 'MAL103'}), (target:Tools {id: 'TOO258'})
MERGE (source)-[:SUBMITTED_BY {
    source_name: 'Shinra',
    target_name: 'United Kingdom',
    relationship_id: 'REL300',
    original_relation: 'submitted by',
    created_at: datetime()
}]->(target);

// Shinra submitted by United States
MATCH (source:Malware {id: 'MAL103'}), (target:Tools {id: 'TOO259'})
MERGE (source)-[:SUBMITTED_BY {
    source_name: 'Shinra',
    target_name: 'United States',
    relationship_id: 'REL301',
    original_relation: 'submitted by',
    created_at: datetime()
}]->(target);

// Agent Tesla uses phishing
MATCH (source:Malware {id: 'MAL5'}), (target:Tools {id: 'TOO192'})
MERGE (source)-[:USES {
    source_name: 'Agent Tesla',
    target_name: 'phishing',
    relationship_id: 'REL302',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Agent Tesla uses MS Office
MATCH (source:Malware {id: 'MAL5'}), (target:Tools {id: 'TOO176'})
MERGE (source)-[:USES {
    source_name: 'Agent Tesla',
    target_name: 'MS Office',
    relationship_id: 'REL303',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Agent Tesla uses JavaScript
MATCH (source:Malware {id: 'MAL5'}), (target:Tools {id: 'TOO141'})
MERGE (source)-[:USES {
    source_name: 'Agent Tesla',
    target_name: 'JavaScript',
    relationship_id: 'REL304',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Agent Tesla uses PowerShell
MATCH (source:Malware {id: 'MAL5'}), (target:Tools {id: 'TOO201'})
MERGE (source)-[:USES {
    source_name: 'Agent Tesla',
    target_name: 'PowerShell',
    relationship_id: 'REL305',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Agent Tesla uses fileless modules
MATCH (source:Malware {id: 'MAL5'}), (target:Files {id: 'FIL85'})
MERGE (source)-[:USES {
    source_name: 'Agent Tesla',
    target_name: 'fileless modules',
    relationship_id: 'REL306',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// zEus distributed via Minecraft
MATCH (source:Malware {id: 'MAL129'}), (target:Tools {id: 'TOO171'})
MERGE (source)-[:DISTRIBUTED_VIA {
    source_name: 'zEus',
    target_name: 'Minecraft',
    relationship_id: 'REL314',
    original_relation: 'distributed via',
    created_at: datetime()
}]->(target);

// zEus distributed via YouTube
MATCH (source:Malware {id: 'MAL129'}), (target:Tools {id: 'TOO287'})
MERGE (source)-[:DISTRIBUTED_VIA {
    source_name: 'zEus',
    target_name: 'YouTube',
    relationship_id: 'REL315',
    original_relation: 'distributed via',
    created_at: datetime()
}]->(target);

// zEus uses WinRAR
MATCH (source:Malware {id: 'MAL129'}), (target:Tools {id: 'TOO279'})
MERGE (source)-[:USES {
    source_name: 'zEus',
    target_name: 'WinRAR',
    relationship_id: 'REL316',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// zEus communicatesWith Discord
MATCH (source:Malware {id: 'MAL129'}), (target:Tools {id: 'TOO80'})
MERGE (source)-[:COMMUNICATESWITH {
    source_name: 'zEus',
    target_name: 'Discord',
    relationship_id: 'REL317',
    original_relation: 'communicatesWith',
    created_at: datetime()
}]->(target);

// zEus saves C:\ProgramData
MATCH (source:Malware {id: 'MAL129'}), (target:Tools {id: 'TOO58'})
MERGE (source)-[:SAVES {
    source_name: 'zEus',
    target_name: 'C:\ProgramData',
    relationship_id: 'REL318',
    original_relation: 'saves',
    created_at: datetime()
}]->(target);

// KageNoHitobito targets Microsoft Windows
MATCH (source:Malware {id: 'MAL55'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'KageNoHitobito',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL321',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// KageNoHitobito targets Microsoft Windows Users
MATCH (source:Malware {id: 'MAL55'}), (target:Tools {id: 'TOO169'})
MERGE (source)-[:TARGETS {
    source_name: 'KageNoHitobito',
    target_name: 'Microsoft Windows Users',
    relationship_id: 'REL322',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// KageNoHitobito is Ransomware
MATCH (source:Malware {id: 'MAL55'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS {
    source_name: 'KageNoHitobito',
    target_name: 'Ransomware',
    relationship_id: 'REL323',
    original_relation: 'is',
    created_at: datetime()
}]->(target);

// KageNoHitobito uses TOR
MATCH (source:Malware {id: 'MAL55'}), (target:Tools {id: 'TOO251'})
MERGE (source)-[:USES {
    source_name: 'KageNoHitobito',
    target_name: 'TOR',
    relationship_id: 'REL324',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// KageNoHitobito submitted from Chile
MATCH (source:Malware {id: 'MAL55'}), (target:Tools {id: 'TOO47'})
MERGE (source)-[:SUBMITTED_FROM {
    source_name: 'KageNoHitobito',
    target_name: 'Chile',
    relationship_id: 'REL325',
    original_relation: 'submitted from',
    created_at: datetime()
}]->(target);

// KageNoHitobito submitted from China
MATCH (source:Malware {id: 'MAL55'}), (target:Tools {id: 'TOO48'})
MERGE (source)-[:SUBMITTED_FROM {
    source_name: 'KageNoHitobito',
    target_name: 'China',
    relationship_id: 'REL326',
    original_relation: 'submitted from',
    created_at: datetime()
}]->(target);

// KageNoHitobito submitted from Cuba
MATCH (source:Malware {id: 'MAL55'}), (target:Tools {id: 'TOO65'})
MERGE (source)-[:SUBMITTED_FROM {
    source_name: 'KageNoHitobito',
    target_name: 'Cuba',
    relationship_id: 'REL327',
    original_relation: 'submitted from',
    created_at: datetime()
}]->(target);

// KageNoHitobito submitted from Germany
MATCH (source:Malware {id: 'MAL55'}), (target:Tools {id: 'TOO111'})
MERGE (source)-[:SUBMITTED_FROM {
    source_name: 'KageNoHitobito',
    target_name: 'Germany',
    relationship_id: 'REL328',
    original_relation: 'submitted from',
    created_at: datetime()
}]->(target);

// KageNoHitobito submitted from Iran
MATCH (source:Malware {id: 'MAL55'}), (target:Tools {id: 'TOO136'})
MERGE (source)-[:SUBMITTED_FROM {
    source_name: 'KageNoHitobito',
    target_name: 'Iran',
    relationship_id: 'REL329',
    original_relation: 'submitted from',
    created_at: datetime()
}]->(target);

// KageNoHitobito submitted from Lithuania
MATCH (source:Malware {id: 'MAL55'}), (target:Tools {id: 'TOO155'})
MERGE (source)-[:SUBMITTED_FROM {
    source_name: 'KageNoHitobito',
    target_name: 'Lithuania',
    relationship_id: 'REL330',
    original_relation: 'submitted from',
    created_at: datetime()
}]->(target);

// KageNoHitobito submitted from Peru
MATCH (source:Malware {id: 'MAL55'}), (target:Tools {id: 'TOO191'})
MERGE (source)-[:SUBMITTED_FROM {
    source_name: 'KageNoHitobito',
    target_name: 'Peru',
    relationship_id: 'REL331',
    original_relation: 'submitted from',
    created_at: datetime()
}]->(target);

// KageNoHitobito submitted from Romania
MATCH (source:Malware {id: 'MAL55'}), (target:Tools {id: 'TOO216'})
MERGE (source)-[:SUBMITTED_FROM {
    source_name: 'KageNoHitobito',
    target_name: 'Romania',
    relationship_id: 'REL332',
    original_relation: 'submitted from',
    created_at: datetime()
}]->(target);

// discordpy_bypass-1.7 published March 10
MATCH (source:Malware {id: 'MAL28'}), (target:Tools {id: 'TOO162'})
MERGE (source)-[:PUBLISHED {
    source_name: 'discordpy_bypass-1.7',
    target_name: 'March 10',
    relationship_id: 'REL336',
    original_relation: 'published',
    created_at: datetime()
}]->(target);

// discordpy_bypass-1.7 detected March 12
MATCH (source:Malware {id: 'MAL28'}), (target:Tools {id: 'TOO163'})
MERGE (source)-[:DETECTED {
    source_name: 'discordpy_bypass-1.7',
    target_name: 'March 12',
    relationship_id: 'REL337',
    original_relation: 'detected',
    created_at: datetime()
}]->(target);

// AGoent associated with CVE-2023-1389
MATCH (source:Malware {id: 'MAL7'}), (target:Vulnerabilities {id: 'VUL15'})
MERGE (source)-[:ASSOCIATED_WITH {
    source_name: 'AGoent',
    target_name: 'CVE-2023-1389',
    relationship_id: 'REL340',
    original_relation: 'associated with',
    created_at: datetime()
}]->(target);

// AGoent drop exec.sh
MATCH (source:Malware {id: 'MAL7'}), (target:Files {id: 'FIL75'})
MERGE (source)-[:DROP {
    source_name: 'AGoent',
    target_name: 'exec.sh',
    relationship_id: 'REL342',
    original_relation: 'drop',
    created_at: datetime()
}]->(target);

// Byakugan drop require.exe
MATCH (source:Malware {id: 'MAL17'}), (target:Files {id: 'FIL125'})
MERGE (source)-[:DROP {
    source_name: 'Byakugan',
    target_name: 'require.exe',
    relationship_id: 'REL349',
    original_relation: 'drop',
    created_at: datetime()
}]->(target);

// Byakugan download chrome.exe
MATCH (source:Malware {id: 'MAL17'}), (target:Files {id: 'FIL52'})
MERGE (source)-[:DOWNLOAD {
    source_name: 'Byakugan',
    target_name: 'chrome.exe',
    relationship_id: 'REL350',
    original_relation: 'download',
    created_at: datetime()
}]->(target);

// RA World is a Ransomware
MATCH (source:Malware {id: 'MAL82'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS_A {
    source_name: 'RA World',
    target_name: 'Ransomware',
    relationship_id: 'REL352',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// RA World targets Microsoft Windows
MATCH (source:Malware {id: 'MAL82'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'RA World',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL353',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// RA World affects Microsoft Windows Users
MATCH (source:Malware {id: 'MAL82'}), (target:Tools {id: 'TOO169'})
MERGE (source)-[:AFFECTS {
    source_name: 'RA World',
    target_name: 'Microsoft Windows Users',
    relationship_id: 'REL354',
    original_relation: 'affects',
    created_at: datetime()
}]->(target);

// RA World severity level High
MATCH (source:Malware {id: 'MAL82'}), (target:Tools {id: 'TOO124'})
MERGE (source)-[:SEVERITY_LEVEL {
    source_name: 'RA World',
    target_name: 'High',
    relationship_id: 'REL355',
    original_relation: 'severity level',
    created_at: datetime()
}]->(target);

// RA World first seen December 2023
MATCH (source:Malware {id: 'MAL82'}), (target:Tools {id: 'TOO77'})
MERGE (source)-[:FIRST_SEEN {
    source_name: 'RA World',
    target_name: 'December 2023',
    relationship_id: 'REL356',
    original_relation: 'first seen',
    created_at: datetime()
}]->(target);

// RA World submitted from Netherlands
MATCH (source:Malware {id: 'MAL82'}), (target:Tools {id: 'TOO179'})
MERGE (source)-[:SUBMITTED_FROM {
    source_name: 'RA World',
    target_name: 'Netherlands',
    relationship_id: 'REL357',
    original_relation: 'submitted from',
    created_at: datetime()
}]->(target);

// RA World submitted from France
MATCH (source:Malware {id: 'MAL82'}), (target:Tools {id: 'TOO106'})
MERGE (source)-[:SUBMITTED_FROM {
    source_name: 'RA World',
    target_name: 'France',
    relationship_id: 'REL358',
    original_relation: 'submitted from',
    created_at: datetime()
}]->(target);

// RA World submitted from United Kingdom
MATCH (source:Malware {id: 'MAL82'}), (target:Tools {id: 'TOO258'})
MERGE (source)-[:SUBMITTED_FROM {
    source_name: 'RA World',
    target_name: 'United Kingdom',
    relationship_id: 'REL359',
    original_relation: 'submitted from',
    created_at: datetime()
}]->(target);

// RA World submitted from Czech Republic
MATCH (source:Malware {id: 'MAL82'}), (target:Tools {id: 'TOO69'})
MERGE (source)-[:SUBMITTED_FROM {
    source_name: 'RA World',
    target_name: 'Czech Republic',
    relationship_id: 'REL360',
    original_relation: 'submitted from',
    created_at: datetime()
}]->(target);

// RA World submitted from Poland
MATCH (source:Malware {id: 'MAL82'}), (target:Tools {id: 'TOO196'})
MERGE (source)-[:SUBMITTED_FROM {
    source_name: 'RA World',
    target_name: 'Poland',
    relationship_id: 'REL361',
    original_relation: 'submitted from',
    created_at: datetime()
}]->(target);

// RA World submitted from Colombia
MATCH (source:Malware {id: 'MAL82'}), (target:Tools {id: 'TOO55'})
MERGE (source)-[:SUBMITTED_FROM {
    source_name: 'RA World',
    target_name: 'Colombia',
    relationship_id: 'REL362',
    original_relation: 'submitted from',
    created_at: datetime()
}]->(target);

// RA World submitted from Japan
MATCH (source:Malware {id: 'MAL82'}), (target:Tools {id: 'TOO139'})
MERGE (source)-[:SUBMITTED_FROM {
    source_name: 'RA World',
    target_name: 'Japan',
    relationship_id: 'REL363',
    original_relation: 'submitted from',
    created_at: datetime()
}]->(target);

// CHAVECLOAK target Brazil
MATCH (source:Malware {id: 'MAL19'}), (target:Tools {id: 'TOO33'})
MERGE (source)-[:TARGET {
    source_name: 'CHAVECLOAK',
    target_name: 'Brazil',
    relationship_id: 'REL374',
    original_relation: 'target',
    created_at: datetime()
}]->(target);

// Casbaneiro aka Metamorfo/Ponteiro
MATCH (source:Malware {id: 'MAL18'}), (target:Malware {id: 'MAL68'})
MERGE (source)-[:AKA {
    source_name: 'Casbaneiro',
    target_name: 'Metamorfo/Ponteiro',
    relationship_id: 'REL375',
    original_relation: 'aka',
    created_at: datetime()
}]->(target);

// Abyss Locker aka AbyssLocker
MATCH (source:Malware {id: 'MAL3'}), (target:Malware {id: 'MAL4'})
MERGE (source)-[:AKA {
    source_name: 'Abyss Locker',
    target_name: 'AbyssLocker',
    relationship_id: 'REL376',
    original_relation: 'aka',
    created_at: datetime()
}]->(target);

// Abyss Locker targets Microsoft Windows
MATCH (source:Malware {id: 'MAL3'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'Abyss Locker',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL377',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Abyss Locker targets Linux
MATCH (source:Malware {id: 'MAL3'}), (target:Tools {id: 'TOO154'})
MERGE (source)-[:TARGETS {
    source_name: 'Abyss Locker',
    target_name: 'Linux',
    relationship_id: 'REL378',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Abyss Locker severity High
MATCH (source:Malware {id: 'MAL3'}), (target:Tools {id: 'TOO124'})
MERGE (source)-[:SEVERITY {
    source_name: 'Abyss Locker',
    target_name: 'High',
    relationship_id: 'REL379',
    original_relation: 'severity',
    created_at: datetime()
}]->(target);

// Abyss Locker based on HelloKitty
MATCH (source:Malware {id: 'MAL3'}), (target:Malware {id: 'MAL47'})
MERGE (source)-[:BASED_ON {
    source_name: 'Abyss Locker',
    target_name: 'HelloKitty',
    relationship_id: 'REL380',
    original_relation: 'based on',
    created_at: datetime()
}]->(target);

// Spynote is a Remote Access Trojan
MATCH (source:Malware {id: 'MAL107'}), (target:Malware {id: 'MAL93'})
MERGE (source)-[:IS_A {
    source_name: 'Spynote',
    target_name: 'Remote Access Trojan',
    relationship_id: 'REL381',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// Spynote targets Android
MATCH (source:Malware {id: 'MAL107'}), (target:Tools {id: 'TOO15'})
MERGE (source)-[:TARGETS {
    source_name: 'Spynote',
    target_name: 'Android',
    relationship_id: 'REL382',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Spynote integrates CypherRat
MATCH (source:Malware {id: 'MAL107'}), (target:Malware {id: 'MAL25'})
MERGE (source)-[:INTEGRATES {
    source_name: 'Spynote',
    target_name: 'CypherRat',
    relationship_id: 'REL383',
    original_relation: 'integrates',
    created_at: datetime()
}]->(target);

// SpyNote RAT uses Accessibility API
MATCH (source:Malware {id: 'MAL108'}), (target:Tools {id: 'TOO10'})
MERGE (source)-[:USES {
    source_name: 'SpyNote RAT',
    target_name: 'Accessibility API',
    relationship_id: 'REL384',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// SpyNote RAT uses WebView
MATCH (source:Malware {id: 'MAL108'}), (target:Tools {id: 'TOO274'})
MERGE (source)-[:USES {
    source_name: 'SpyNote RAT',
    target_name: 'WebView',
    relationship_id: 'REL385',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// SpyNote RAT uses HTML
MATCH (source:Malware {id: 'MAL108'}), (target:Tools {id: 'TOO128'})
MERGE (source)-[:USES {
    source_name: 'SpyNote RAT',
    target_name: 'HTML',
    relationship_id: 'REL386',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// SpyNote RAT uses Base64
MATCH (source:Malware {id: 'MAL108'}), (target:Tools {id: 'TOO27'})
MERGE (source)-[:USES {
    source_name: 'SpyNote RAT',
    target_name: 'Base64',
    relationship_id: 'REL387',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// SpyNote RAT contains fake wallets
MATCH (source:Malware {id: 'MAL108'}), (target:Files {id: 'FIL77'})
MERGE (source)-[:CONTAINS {
    source_name: 'SpyNote RAT',
    target_name: 'fake wallets',
    relationship_id: 'REL388',
    original_relation: 'contains',
    created_at: datetime()
}]->(target);

// TicTacToe dropper uses Leonem
MATCH (source:Malware {id: 'MAL113'}), (target:Malware {id: 'MAL59'})
MERGE (source)-[:USES {
    source_name: 'TicTacToe dropper',
    target_name: 'Leonem',
    relationship_id: 'REL389',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// TicTacToe dropper uses AgentTesla
MATCH (source:Malware {id: 'MAL113'}), (target:Malware {id: 'MAL6'})
MERGE (source)-[:USES {
    source_name: 'TicTacToe dropper',
    target_name: 'AgentTesla',
    relationship_id: 'REL390',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// TicTacToe dropper uses SnakeLogger
MATCH (source:Malware {id: 'MAL113'}), (target:Malware {id: 'MAL106'})
MERGE (source)-[:USES {
    source_name: 'TicTacToe dropper',
    target_name: 'SnakeLogger',
    relationship_id: 'REL391',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// TicTacToe dropper uses RemLoader
MATCH (source:Malware {id: 'MAL113'}), (target:Malware {id: 'MAL92'})
MERGE (source)-[:USES {
    source_name: 'TicTacToe dropper',
    target_name: 'RemLoader',
    relationship_id: 'REL392',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// TicTacToe dropper uses Sabsik
MATCH (source:Malware {id: 'MAL113'}), (target:Malware {id: 'MAL101'})
MERGE (source)-[:USES {
    source_name: 'TicTacToe dropper',
    target_name: 'Sabsik',
    relationship_id: 'REL393',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// TicTacToe dropper uses LokiBot
MATCH (source:Malware {id: 'MAL113'}), (target:Malware {id: 'MAL61'})
MERGE (source)-[:USES {
    source_name: 'TicTacToe dropper',
    target_name: 'LokiBot',
    relationship_id: 'REL394',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// TicTacToe dropper uses Taskun
MATCH (source:Malware {id: 'MAL113'}), (target:Malware {id: 'MAL112'})
MERGE (source)-[:USES {
    source_name: 'TicTacToe dropper',
    target_name: 'Taskun',
    relationship_id: 'REL395',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// TicTacToe dropper uses Androm
MATCH (source:Malware {id: 'MAL113'}), (target:Malware {id: 'MAL11'})
MERGE (source)-[:USES {
    source_name: 'TicTacToe dropper',
    target_name: 'Androm',
    relationship_id: 'REL396',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// TicTacToe dropper uses Upatre
MATCH (source:Malware {id: 'MAL113'}), (target:Malware {id: 'MAL115'})
MERGE (source)-[:USES {
    source_name: 'TicTacToe dropper',
    target_name: 'Upatre',
    relationship_id: 'REL397',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// TicTacToe dropper uses Remcos
MATCH (source:Malware {id: 'MAL113'}), (target:Malware {id: 'MAL90'})
MERGE (source)-[:USES {
    source_name: 'TicTacToe dropper',
    target_name: 'Remcos',
    relationship_id: 'REL398',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// TicTacToe dropper associated with Kolko_i_krzyzyk
MATCH (source:Malware {id: 'MAL113'}), (target:Files {id: 'FIL98'})
MERGE (source)-[:ASSOCIATED_WITH {
    source_name: 'TicTacToe dropper',
    target_name: 'Kolko_i_krzyzyk',
    relationship_id: 'REL399',
    original_relation: 'associated with',
    created_at: datetime()
}]->(target);

// TicTacToe dropper uses phishing
MATCH (source:Malware {id: 'MAL113'}), (target:Tools {id: 'TOO192'})
MERGE (source)-[:USES {
    source_name: 'TicTacToe dropper',
    target_name: 'phishing',
    relationship_id: 'REL400',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// info-stealer used by Vietnamese-based group
MATCH (source:Malware {id: 'MAL52'}), (target:Attackers {id: 'ATT25'})
MERGE (source)-[:USED_BY {
    source_name: 'info-stealer',
    target_name: 'Vietnamese-based group',
    relationship_id: 'REL402',
    original_relation: 'used by',
    created_at: datetime()
}]->(target);

// 8base is a Ransomware
MATCH (source:Malware {id: 'MAL2'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS_A {
    source_name: '8base',
    target_name: 'Ransomware',
    relationship_id: 'REL456',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// 8base based on Phobos
MATCH (source:Malware {id: 'MAL2'}), (target:Tools {id: 'TOO193'})
MERGE (source)-[:BASED_ON {
    source_name: '8base',
    target_name: 'Phobos',
    relationship_id: 'REL457',
    original_relation: 'based on',
    created_at: datetime()
}]->(target);

// SmokeLoader delivers 8base
MATCH (source:Malware {id: 'MAL104'}), (target:Malware {id: 'MAL2'})
MERGE (source)-[:DELIVERS {
    source_name: 'SmokeLoader',
    target_name: '8base',
    relationship_id: 'REL458',
    original_relation: 'delivers',
    created_at: datetime()
}]->(target);

// 8base targets United States
MATCH (source:Malware {id: 'MAL2'}), (target:Tools {id: 'TOO259'})
MERGE (source)-[:TARGETS {
    source_name: '8base',
    target_name: 'United States',
    relationship_id: 'REL459',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Bandook targets Microsoft Windows
MATCH (source:Malware {id: 'MAL15'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'Bandook',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL460',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Bandook drop PDF file
MATCH (source:Malware {id: 'MAL15'}), (target:Files {id: 'FIL116'})
MERGE (source)-[:DROP {
    source_name: 'Bandook',
    target_name: 'PDF file',
    relationship_id: 'REL461',
    original_relation: 'drop',
    created_at: datetime()
}]->(target);

// Bandook inject msinfo32.exe
MATCH (source:Malware {id: 'MAL15'}), (target:Files {id: 'FIL109'})
MERGE (source)-[:INJECT {
    source_name: 'Bandook',
    target_name: 'msinfo32.exe',
    relationship_id: 'REL462',
    original_relation: 'inject',
    created_at: datetime()
}]->(target);

// Bandook use PID of msinfo32.exe
MATCH (source:Malware {id: 'MAL15'}), (target:Files {id: 'FIL118'})
MERGE (source)-[:USE {
    source_name: 'Bandook',
    target_name: 'PID of msinfo32.exe',
    relationship_id: 'REL463',
    original_relation: 'use',
    created_at: datetime()
}]->(target);

// MrAnon Stealer is Python
MATCH (source:Malware {id: 'MAL71'}), (target:Tools {id: 'TOO207'})
MERGE (source)-[:IS {
    source_name: 'MrAnon Stealer',
    target_name: 'Python',
    relationship_id: 'REL471',
    original_relation: 'is',
    created_at: datetime()
}]->(target);

// MrAnon Stealer compressed with cx-Freeze
MATCH (source:Malware {id: 'MAL71'}), (target:Tools {id: 'TOO68'})
MERGE (source)-[:COMPRESSED_WITH {
    source_name: 'MrAnon Stealer',
    target_name: 'cx-Freeze',
    relationship_id: 'REL472',
    original_relation: 'compressed with',
    created_at: datetime()
}]->(target);

// MrAnon Stealer steals credentials
MATCH (source:Malware {id: 'MAL71'}), (target:Tools {id: 'TOO59'})
MERGE (source)-[:STEALS {
    source_name: 'MrAnon Stealer',
    target_name: 'credentials',
    relationship_id: 'REL473',
    original_relation: 'steals',
    created_at: datetime()
}]->(target);

// MrAnon Stealer steals browser sessions
MATCH (source:Malware {id: 'MAL71'}), (target:Tools {id: 'TOO35'})
MERGE (source)-[:STEALS {
    source_name: 'MrAnon Stealer',
    target_name: 'browser sessions',
    relationship_id: 'REL474',
    original_relation: 'steals',
    created_at: datetime()
}]->(target);

// MrAnon Stealer steals cryptocurrency extensions
MATCH (source:Malware {id: 'MAL71'}), (target:Tools {id: 'TOO64'})
MERGE (source)-[:STEALS {
    source_name: 'MrAnon Stealer',
    target_name: 'cryptocurrency extensions',
    relationship_id: 'REL475',
    original_relation: 'steals',
    created_at: datetime()
}]->(target);

// NoEscape is Ransomware-as-a-Service
MATCH (source:Malware {id: 'MAL75'}), (target:Malware {id: 'MAL85'})
MERGE (source)-[:IS {
    source_name: 'NoEscape',
    target_name: 'Ransomware-as-a-Service',
    relationship_id: 'REL493',
    original_relation: 'is',
    created_at: datetime()
}]->(target);

// NoEscape related to Avaddon
MATCH (source:Malware {id: 'MAL75'}), (target:Malware {id: 'MAL14'})
MERGE (source)-[:RELATED_TO {
    source_name: 'NoEscape',
    target_name: 'Avaddon',
    relationship_id: 'REL494',
    original_relation: 'related to',
    created_at: datetime()
}]->(target);

// NoEscape targets Microsoft Windows
MATCH (source:Malware {id: 'MAL75'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'NoEscape',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL495',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// NoEscape targets Linux
MATCH (source:Malware {id: 'MAL75'}), (target:Tools {id: 'TOO154'})
MERGE (source)-[:TARGETS {
    source_name: 'NoEscape',
    target_name: 'Linux',
    relationship_id: 'REL496',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// NoEscape targets ESXi
MATCH (source:Malware {id: 'MAL75'}), (target:Tools {id: 'TOO88'})
MERGE (source)-[:TARGETS {
    source_name: 'NoEscape',
    target_name: 'ESXi',
    relationship_id: 'REL497',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// NoEscape affects government
MATCH (source:Malware {id: 'MAL75'}), (target:Tools {id: 'TOO118'})
MERGE (source)-[:AFFECTS {
    source_name: 'NoEscape',
    target_name: 'government',
    relationship_id: 'REL498',
    original_relation: 'affects',
    created_at: datetime()
}]->(target);

// NoEscape affects energy
MATCH (source:Malware {id: 'MAL75'}), (target:Tools {id: 'TOO87'})
MERGE (source)-[:AFFECTS {
    source_name: 'NoEscape',
    target_name: 'energy',
    relationship_id: 'REL499',
    original_relation: 'affects',
    created_at: datetime()
}]->(target);

// NoEscape affects hospitals
MATCH (source:Malware {id: 'MAL75'}), (target:Tools {id: 'TOO126'})
MERGE (source)-[:AFFECTS {
    source_name: 'NoEscape',
    target_name: 'hospitals',
    relationship_id: 'REL500',
    original_relation: 'affects',
    created_at: datetime()
}]->(target);

// NoEscape affects physicians clinics
MATCH (source:Malware {id: 'MAL75'}), (target:Tools {id: 'TOO194'})
MERGE (source)-[:AFFECTS {
    source_name: 'NoEscape',
    target_name: 'physicians clinics',
    relationship_id: 'REL501',
    original_relation: 'affects',
    created_at: datetime()
}]->(target);

// Knight is a Ransomware
MATCH (source:Malware {id: 'MAL56'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS_A {
    source_name: 'Knight',
    target_name: 'Ransomware',
    relationship_id: 'REL506',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// Knight targets Microsoft Windows
MATCH (source:Malware {id: 'MAL56'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'Knight',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL507',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Knight uses phishing
MATCH (source:Malware {id: 'MAL56'}), (target:Tools {id: 'TOO192'})
MERGE (source)-[:USES {
    source_name: 'Knight',
    target_name: 'phishing',
    relationship_id: 'REL508',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Knight uses Remcos
MATCH (source:Malware {id: 'MAL56'}), (target:Malware {id: 'MAL90'})
MERGE (source)-[:USES {
    source_name: 'Knight',
    target_name: 'Remcos',
    relationship_id: 'REL509',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Knight uses Qakbot
MATCH (source:Malware {id: 'MAL56'}), (target:Malware {id: 'MAL81'})
MERGE (source)-[:USES {
    source_name: 'Knight',
    target_name: 'Qakbot',
    relationship_id: 'REL510',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Cyclops is a Ransomware
MATCH (source:Malware {id: 'MAL24'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS_A {
    source_name: 'Cyclops',
    target_name: 'Ransomware',
    relationship_id: 'REL511',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// Knight successor of Cyclops
MATCH (source:Malware {id: 'MAL56'}), (target:Malware {id: 'MAL24'})
MERGE (source)-[:SUCCESSOR_OF {
    source_name: 'Knight',
    target_name: 'Cyclops',
    relationship_id: 'REL512',
    original_relation: 'successor of',
    created_at: datetime()
}]->(target);

// ExelaStealer uses Python
MATCH (source:Malware {id: 'MAL34'}), (target:Tools {id: 'TOO207'})
MERGE (source)-[:USES {
    source_name: 'ExelaStealer',
    target_name: 'Python',
    relationship_id: 'REL514',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// ExelaStealer uses JavaScript
MATCH (source:Malware {id: 'MAL34'}), (target:Tools {id: 'TOO141'})
MERGE (source)-[:USES {
    source_name: 'ExelaStealer',
    target_name: 'JavaScript',
    relationship_id: 'REL515',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// ExelaStealer targets Windows
MATCH (source:Malware {id: 'MAL34'}), (target:Tools {id: 'TOO275'})
MERGE (source)-[:TARGETS {
    source_name: 'ExelaStealer',
    target_name: 'Windows',
    relationship_id: 'REL516',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// ExelaStealer sold by quicaxd
MATCH (source:Malware {id: 'MAL34'}), (target:Tools {id: 'TOO209'})
MERGE (source)-[:SOLD_BY {
    source_name: 'ExelaStealer',
    target_name: 'quicaxd',
    relationship_id: 'REL517',
    original_relation: 'sold by',
    created_at: datetime()
}]->(target);

// ExelaStealer advertised on Telegram
MATCH (source:Malware {id: 'MAL34'}), (target:Tools {id: 'TOO245'})
MERGE (source)-[:ADVERTISED_ON {
    source_name: 'ExelaStealer',
    target_name: 'Telegram',
    relationship_id: 'REL518',
    original_relation: 'advertised on',
    created_at: datetime()
}]->(target);

// Akira is a Ransomware
MATCH (source:Malware {id: 'MAL8'}), (target:Malware {id: 'MAL84'})
MERGE (source)-[:IS_A {
    source_name: 'Akira',
    target_name: 'Ransomware',
    relationship_id: 'REL519',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// Akira targets Microsoft Windows
MATCH (source:Malware {id: 'MAL8'}), (target:Tools {id: 'TOO168'})
MERGE (source)-[:TARGETS {
    source_name: 'Akira',
    target_name: 'Microsoft Windows',
    relationship_id: 'REL520',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// Akira targets Linux
MATCH (source:Malware {id: 'MAL8'}), (target:Tools {id: 'TOO154'})
MERGE (source)-[:TARGETS {
    source_name: 'Akira',
    target_name: 'Linux',
    relationship_id: 'REL521',
    original_relation: 'targets',
    created_at: datetime()
}]->(target);

// IZ1H9 uses Mirai
MATCH (source:Malware {id: 'MAL54'}), (target:Tools {id: 'TOO173'})
MERGE (source)-[:USES {
    source_name: 'IZ1H9',
    target_name: 'Mirai',
    relationship_id: 'REL525',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// IZ1H9 exploits CVE-2015-1187
MATCH (source:Malware {id: 'MAL54'}), (target:Vulnerabilities {id: 'VUL3'})
MERGE (source)-[:EXPLOITS {
    source_name: 'IZ1H9',
    target_name: 'CVE-2015-1187',
    relationship_id: 'REL526',
    original_relation: 'exploits',
    created_at: datetime()
}]->(target);

// IZ1H9 exploits CVE-2016-20017
MATCH (source:Malware {id: 'MAL54'}), (target:Vulnerabilities {id: 'VUL5'})
MERGE (source)-[:EXPLOITS {
    source_name: 'IZ1H9',
    target_name: 'CVE-2016-20017',
    relationship_id: 'REL527',
    original_relation: 'exploits',
    created_at: datetime()
}]->(target);

// IZ1H9 exploits CVE-2020-25506
MATCH (source:Malware {id: 'MAL54'}), (target:Vulnerabilities {id: 'VUL11'})
MERGE (source)-[:EXPLOITS {
    source_name: 'IZ1H9',
    target_name: 'CVE-2020-25506',
    relationship_id: 'REL528',
    original_relation: 'exploits',
    created_at: datetime()
}]->(target);

// IZ1H9 exploits CVE-2021-45382
MATCH (source:Malware {id: 'MAL54'}), (target:Vulnerabilities {id: 'VUL13'})
MERGE (source)-[:EXPLOITS {
    source_name: 'IZ1H9',
    target_name: 'CVE-2021-45382',
    relationship_id: 'REL529',
    original_relation: 'exploits',
    created_at: datetime()
}]->(target);

// MidgeDropper uses RAR
MATCH (source:Malware {id: 'MAL69'}), (target:Tools {id: 'TOO211'})
MERGE (source)-[:USES {
    source_name: 'MidgeDropper',
    target_name: 'RAR',
    relationship_id: 'REL537',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// MidgeDropper drop 062023_PENTING_LIST OF SUPERVISORY OFFICERS WHO STILL HAVE NOT REPORT.pdf.exe
MATCH (source:Malware {id: 'MAL69'}), (target:Files {id: 'FIL42'})
MERGE (source)-[:DROP {
    source_name: 'MidgeDropper',
    target_name: '062023_PENTING_LIST OF SUPERVISORY OFFICERS WHO STILL HAVE NOT REPORT.pdf.exe',
    relationship_id: 'REL538',
    original_relation: 'drop',
    created_at: datetime()
}]->(target);

// Agent Tesla uses Remote Access Trojan
MATCH (source:Malware {id: 'MAL5'}), (target:Malware {id: 'MAL93'})
MERGE (source)-[:USES {
    source_name: 'Agent Tesla',
    target_name: 'Remote Access Trojan',
    relationship_id: 'REL545',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Agent Tesla uses data stealer
MATCH (source:Malware {id: 'MAL5'}), (target:Tools {id: 'TOO74'})
MERGE (source)-[:USES {
    source_name: 'Agent Tesla',
    target_name: 'data stealer',
    relationship_id: 'REL546',
    original_relation: 'uses',
    created_at: datetime()
}]->(target);

// Agent Tesla is a Malware-as-a-Service
MATCH (source:Malware {id: 'MAL5'}), (target:Malware {id: 'MAL65'})
MERGE (source)-[:IS_A {
    source_name: 'Agent Tesla',
    target_name: 'Malware-as-a-Service',
    relationship_id: 'REL547',
    original_relation: 'is a',
    created_at: datetime()
}]->(target);

// Agent Tesla exploits CVE-2017-11882
MATCH (source:Malware {id: 'MAL5'}), (target:Vulnerabilities {id: 'VUL7'})
MERGE (source)-[:EXPLOITS {
    source_name: 'Agent Tesla',
    target_name: 'CVE-2017-11882',
    relationship_id: 'REL549',
    original_relation: 'exploits',
    created_at: datetime()
}]->(target);

// Agent Tesla exploits CVE-2018-0802
MATCH (source:Malware {id: 'MAL5'}), (target:Vulnerabilities {id: 'VUL8'})
MERGE (source)-[:EXPLOITS {
    source_name: 'Agent Tesla',
    target_name: 'CVE-2018-0802',
    relationship_id: 'REL550',
    original_relation: 'exploits',
    created_at: datetime()
}]->(target);

// ========================================
// 3. VERIFICATION QUERIES
// ========================================

// Count Malware outgoing relationships
MATCH (s:Malware)-[r]->()
RETURN type(r) AS relationship_type, count(r) AS count
ORDER BY count DESC;

// Show sample Malware relationships
MATCH (s:Malware)-[r]->(target)
RETURN s.name AS source, type(r) AS relationship,
       labels(target)[0] AS target_type, target.name AS target
ORDER BY source, relationship
LIMIT 20;

// Summary: Relationship types for Malware
// USES: 77
// TARGETS: 46
// IS_A: 17
// SUBMITTED_FROM: 15
// USE: 11
// DROP: 10
// IS: 9
// EXPLOITS: 8
// AKA: 6
// TARGET: 5
// AFFECTS: 5
// COMMUNICATESWITH: 4
// STEALS: 4
// IS_A_PREDECESSOR_OF: 4
// SUBMITTED_BY: 4
// ASSOCIATED_WITH: 3
// COLLECTS: 3
// CONTAINS: 3
// EXPLOIT: 3
// USED_BY: 2
// DOWNLOAD: 2
// DISTRIBUTED_VIA: 2
// BASED_ON: 2
// HASH: 1
// HARVESTS: 1
// INSTALLS: 1
// STEAL: 1
// ATTRIBUTED_TO: 1
// EXECUTE: 1
// CREATE: 1
// DELETE: 1
// SAVES: 1
// PUBLISHED: 1
// DETECTED: 1
// SEVERITY_LEVEL: 1
// FIRST_SEEN: 1
// SEVERITY: 1
// INTEGRATES: 1
// DELIVERS: 1
// INJECT: 1
// COMPRESSED_WITH: 1
// RELATED_TO: 1
// SUCCESSOR_OF: 1
// SOLD_BY: 1
// ADVERTISED_ON: 1